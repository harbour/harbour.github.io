From antonioharbour at gmail.com  Tue May  1 02:52:20 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Tue May  1 02:52:32 2007
Subject: [Harbour] Changelog 2007-05-01 08:48 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <4636e3aa.449a1b56.4d33.2e30@mx.google.com>

2007-05-01 08:48 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.ch
   * contrib/adordd/adordd.prg
     * LOCATE and CONTINUE support
     
   + contrib/adordd/mysql3.prg
     * MySQL LOCATE and CONTINUE sample 

Regards,

Antonio

From fmancera at viaopen.com  Tue May  1 09:58:51 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Tue May  1 09:59:25 2007
Subject: [Harbour] USE Question
Message-ID: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>

Hello Premzeck,

 

USE TEST

 

USE TEST NEW

 

Shouldn't the second USE give a runtime error ?

 

What is your opinion ?

 

Thank You.

 

Best Regards,

 

Fernando Mancera

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070501/967eadee/attachment.html
From i at kevincarmody.com  Tue May  1 13:54:54 2007
From: i at kevincarmody.com (Kevin Carmody)
Date: Tue May  1 13:53:20 2007
Subject: [Harbour] USE Question
In-Reply-To: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>
Message-ID: <46377EEE.7090803@kevincarmody.com>

Fernando Mancera wrote:
>
> Hello Premzeck,
>
>  
>
> USE TEST
>
>  
>
> USE TEST NEW
>
>  
>
> Shouldn't the second USE give a runtime error ?
>

Clipper 5.2 gives a sharing violation error on this code, but Harbour 
gives no error.

If we change the code to

USE TEST SHARED

USE TEST SHARED NEW

then both Clipper and Harbour give the error "Alias already in use".

Using an EXCLUSIVE clause gives the same result as the first case in 
both Clipper or Harbour.

In the first case, Harbour reports the same values of SELECT and ALIAS 
after the second USE as after the first.  If we do a GO TO after the 
first USE, and then examine RECNO() after each USE, we find that the 
record pointer has not moved after the second USE..  Harbour seems to be 
just ignoring the second USE. 

If we FOPEN two files in exclusive mode, e.g.

nHandle1 := FOPEN('test.prg', 32)
nHandle2 := FOPEN('test.prg', 32)

then the second FOPEN generates an FERROR of 32 (sharing violation) in 
both Clipper and Harbour.

IMHO Harbour should generate a sharing violation in the original 
condition, the same as Clipper.

Kevin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070501/8c485fa5/attachment.html
From e.m.giordano at emagsoftware.it  Tue May  1 13:59:53 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Tue May  1 14:00:29 2007
Subject: [Harbour] USE Question
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>
	<46377EEE.7090803@kevincarmody.com>
Message-ID: <012a01c78c1a$853c5330$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Kevin Carmody" <i@kevincarmody.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: marted? 1 maggio 2007 19.54
Oggetto: Re: [Harbour] USE Question


> > Shouldn't the second USE give a runtime error ?
>
> Clipper 5.2 gives a sharing violation error on this code, but Harbour
> gives no error.

No, the following sample

FUNCTION MAIN()

    USE TEST

    USE TEST NEW

    RETURN NIL

gives no error in both Clipper and Harbour.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From mpaliwoda at interia.pl  Tue May  1 14:18:58 2007
From: mpaliwoda at interia.pl (Marek Paliwoda)
Date: Tue May  1 14:20:34 2007
Subject: [Harbour] OT: Microsoft and the future of [x]harbour ?
Message-ID: <46378492.8040700@interia.pl>

Hi,

I didn't have time to even follow this mailing list for a long
long time, but I coudn't resist to post the following info here
<g>

      http://blogs.msdn.com/hugunin/

Looks like [x]harbour.NET is at least imaginable :)

BTW, not that I am "pushing" or "forcing" anything.
      It's just an info which might be usefull in a
      future :)

-- 

Marek


----------------------------------------------------------------------
Wicie, rozumicie....
Zobacz >>> http://link.interia.pl/f1a74

From antonioharbour at gmail.com  Tue May  1 16:55:48 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Tue May  1 16:55:55 2007
Subject: [Harbour] Changelog 2007-05-01 22:53 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <4637a955.7d315919.47a1.4a90@mx.google.com>

2007-05-01 22:53 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * DbCreate() implementation just for Microsoft Access

   + contrib/adordd/access2.prg
     * DbCreate() sample with Microsoft Access

Regards,

Antonio

From info at fsgiudice.com  Tue May  1 18:36:20 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Tue May  1 18:37:08 2007
Subject: [xHarbour-developers] [Harbour] OT: Happy Birthday Enrico!
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL><46377EEE.7090803@kevincarmody.com>
	<012a01c78c1a$853c5330$0100a8c0@emag>
Message-ID: <000401c78c41$29d36070$6501a8c0@ASUSFSG>

Sorry for this Off Topic, but I would like to tell a big Happy Birthday to 
Enrico Maria :-)

Best Regards

Francesco
From budyanto at centrin.net.id  Tue May  1 21:08:18 2007
From: budyanto at centrin.net.id (Budyanto Dj.)
Date: Tue May  1 21:06:16 2007
Subject: [xHarbour-developers] [Harbour] OT: Happy Birthday Enrico!
In-Reply-To: <000401c78c41$29d36070$6501a8c0@ASUSFSG>
Message-ID: <463846F2.30720.1E897931@localhost>

On 2 May 2007 at 0:36, Francesco Saverio Giudice wrote:
> Sorry for this Off Topic, but I would like to tell a big Happy Birthday to
> Enrico Maria :-)

Enrico, happy birthday :-)

regards,
budyanto

From e.m.giordano at emagsoftware.it  Wed May  2 03:05:31 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  2 03:06:05 2007
Subject: [xHarbour-developers] [Harbour] OT: Happy Birthday Enrico!
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL><46377EEE.7090803@kevincarmody.com>
	<012a01c78c1a$853c5330$0100a8c0@emag>
	<000401c78c41$29d36070$6501a8c0@ASUSFSG>
Message-ID: <005501c78c88$45d84230$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Francesco Saverio Giudice" <info@fsgiudice.com>
A: "Enrico Maria Giordano" <e.m.giordano@emagsoftware.it>
Cc: "Xharbour-Developers" <xharbour-developers@lists.sourceforge.net>; 
"Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 2 maggio 2007 0.36
Oggetto: [xHarbour-developers] [Harbour] OT: Happy Birthday Enrico!

Thank you all! :-)

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From i at kevincarmody.com  Wed May  2 06:42:33 2007
From: i at kevincarmody.com (Kevin Carmody)
Date: Wed May  2 06:40:58 2007
Subject: [Harbour] USE Question
In-Reply-To: <012a01c78c1a$853c5330$0100a8c0@emag>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com>
	<012a01c78c1a$853c5330$0100a8c0@emag>
Message-ID: <46386B19.2060103@kevincarmody.com>

Enrico Maria Giordano wrote:
>
> -----Messaggio Originale----- Da: "Kevin Carmody" <i@kevincarmody.com>
> A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
> Data invio: marted? 1 maggio 2007 19.54
> Oggetto: Re: [Harbour] USE Question
>
>> > Shouldn't the second USE give a runtime error ?
>>
>> Clipper 5.2 gives a sharing violation error on this code, but Harbour
>> gives no error.
>
> No, the following sample
>
> FUNCTION MAIN()
>
>    USE TEST
>
>    USE TEST NEW
>
>    RETURN NIL
>
> gives no error in both Clipper and Harbour.

On your machine.  On my machine, Clipper gives an error, and Harbour 
does not.

I'm using Clipper 5.2 under Windows 98.

Kevin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070502/d3642160/attachment.html
From e.m.giordano at emagsoftware.it  Wed May  2 06:48:22 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  2 06:48:58 2007
Subject: [Harbour] USE Question
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag>
	<46386B19.2060103@kevincarmody.com>
Message-ID: <01e001c78ca7$672d0820$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Kevin Carmody" <i@kevincarmody.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 2 maggio 2007 12.42
Oggetto: Re: [Harbour] USE Question


> > > Clipper 5.2 gives a sharing violation error on this code,
> > > but Harbour gives no error.
> >
> > No, the following sample
> >
> > FUNCTION MAIN()
> >
> >    USE TEST
> >
> >    USE TEST NEW
> >
> >    RETURN NIL
> >
> > gives no error in both Clipper and Harbour.
>
> On your machine.  On my machine, Clipper gives an error, and
> Harbour does not.
>
> I'm using Clipper 5.2 under Windows 98.

I don't think it's a matter of used machine. I tried Clipper 5.2e, Clipper 
5.3b, latest Harbour from CVS and latest xHarbour from CVS and none of them 
give any error on the above example. I'm confused...

Do you want my EXE compiled with Clipper to test it there?

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From dbtopas at dbtopas.lt  Wed May  2 09:25:25 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Wed May  2 09:22:34 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070428125131.GA24073@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>	<20070424154331.GB656@localhost.localdomain>	<004501c786b1$50e22600$d801a8c0@ingachka>	<20070424221200.GA3517@localhost.localdomain>	<462EA5A5.5050905@dbtopas.lt>	<20070428100918.GB17193@localhost.localdomain>
	<20070428125131.GA24073@localhost.localdomain>
Message-ID: <46389145.4090607@dbtopas.lt>

> I've just made some test with xHarbour and the idea if representing
> the time interval (INT) as numeric value where integer part is number of
> days from Julian's day and fractional part is time in this day seems to
> be reasonable for me. 

The idea of numeric datetime interval is nice, because it makes easy to 
understand the difference between absolute and interval datetime. We do 
not need functions DatetimeIsInterval(), DattimeIsAbsolute(), etc. It is 
also compatible with Clipper's date type interval.

But I see one drawback, float point arithmetics errors. People will expect
   ? (DATETIME("2007-01-02 00:01:00") - DATETIME("2007-01-01 23:59:00")) 
== 120/86400
to print .T., and will indicate it as bug, if it will print .F.

"valid date" interval in bits = (10000 years in milliseconds) in bits = 
log_2(3652425 * 86400000) ~= 48.165

double has 52 bit mantissa, so we have about 3.8 bits for managing 
rounding errors. We can make a function to map numeric day fraction 
to/from "hh:mm:ss.ttt", this will display interval without rounding 
errors. But if people will try to compare numeric (but not string 
formated) datetime intervals, they will have a problem anyway.

Maybe integer interval representing difference of datetime values in 
milliseconds is the solution. To convert date interval to/from datetime 
interval we just need to multiple/divide value by 86400000, so some 
"Clipper compability" still exist.


> IMHO Victor's idea to start with some functions (without date constants)
> will be good choice. Finally we can add support for some constants.

I agree. The same situation is in Clipper (was in [x]Harbour) with date 
values.
Perhaps we need to introduce PCODE HB_P_[PUSH]DATETIME or 
HB_P_[PUSH]TIMESTAMP, and optimise DATETIME("2007-01-02 00:01:00") to 
this PCODE to allow initialisation of variables with datetime values.


Best regards,
Mindaugas
From lorenzo.fiorini at gmail.com  Wed May  2 10:13:40 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May  2 10:13:43 2007
Subject: [Harbour] gtxwc inkey(0) under fc7-test4 eats 100% cpu
Message-ID: <9257026e0705020713v5f3abdbaucae57502f726a584@mail.gmail.com>

Under fc5 it is ok.
Is there anything I can check?
Should I report sth to fc7 bugzilla?

regards,
Lorenzo
From lkrausem at shaw.ca  Wed May  2 11:03:00 2007
From: lkrausem at shaw.ca (Luis Krause Mantilla)
Date: Wed May  2 11:04:57 2007
Subject: [xHarbour-developers] [Harbour] OT: Happy Birthday Enrico!
In-Reply-To: <000401c78c41$29d36070$6501a8c0@ASUSFSG>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>
	<46377EEE.7090803@kevincarmody.com>
	<012a01c78c1a$853c5330$0100a8c0@emag>
	<000401c78c41$29d36070$6501a8c0@ASUSFSG>
Message-ID: <4638A824.80707@shaw.ca>

Enrico:

Feliz Cumplea?os :-)

Francesco Saverio Giudice wrote:

> Sorry for this Off Topic, but I would like to tell a big Happy 
> Birthday to Enrico Maria :-)
>
> Best Regards
>
> Francesco
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
>

-- 
Luis Krause Mantilla
lkrausem at shaw dot ca
luis_krause at hotmail dot com
"May the Source be with GNU"


From carlos.mora at cpcipc.org  Wed May  2 11:48:36 2007
From: carlos.mora at cpcipc.org (Carlos Mora)
Date: Wed May  2 11:49:23 2007
Subject: [Harbour] USE Question
In-Reply-To: <01e001c78ca7$672d0820$0100a8c0@emag>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag>	<46386B19.2060103@kevincarmody.com>
	<01e001c78ca7$672d0820$0100a8c0@emag>
Message-ID: <4638B2D4.7050200@cpcipc.org>

Enrico,

>> > > Clipper 5.2 gives a sharing violation error on this code,
>> > > but Harbour gives no error.
>> >
>> > No, the following sample
>> >
>> > FUNCTION MAIN()
>> >
>> >    USE TEST
>> >
>> >    USE TEST NEW
>> >
>> >    RETURN NIL
>> >
>> > gives no error in both Clipper and Harbour.
> I don't think it's a matter of used machine. I tried Clipper 5.2e, 
> Clipper 5.3b, latest Harbour from CVS and latest xHarbour from CVS and 
> none of them give any error on the above example. I'm confused...
> 
> Do you want my EXE compiled with Clipper to test it there?

I got a clue. The first USE is failing because a sharing violation 
condition. If the first use fails of a sharing violation that piece of 
code should't fail. From the Clipper doc:

about USE command:
"Opening a database file in a network environment requires some special
handling to be successful.  First, attempt to USE the database file
without specifying the INDEX list.  Then, test for the success of the
operation using NETERR().  If NETERR() returns false (.F.), the open
operation succeeded and you can SET INDEX TO the index list.  A USE will
fail in a network environment if another user has EXCLUSIVE USE of the
database file."

about SET EXCLUSIVE command:
" Notes
Error handling: Attempting to USE a database file already
opened EXCLUSIVE by another user generates a runtime error and sets
NETERR() to true (.T.).  After control returns to the point of error,
you can test NETERR() to determine whether the USE failed."

and in standard errorsys provided with Clipper:
----------------8<----------------------------
// for network open error, set NETERR() and subsystem default
if ( e:genCode == EG_OPEN .and. e:osCode == 32 .and. e:canDefault )
    NetErr(.t.)
    return (.f.)						----------------8<----------------------------

So the first use may fail without any error message, the error condition 
should be checked using NETERR().

If both USEs failed because of a sharing problem, the program will fail 
silently. What happen putting an ? NetErr(), Alias() just after the 
first use?

REgards,

Carlos.





From e.m.giordano at emagsoftware.it  Wed May  2 12:00:21 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  2 12:01:00 2007
Subject: [Harbour] USE Question
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag>	<46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag>
	<4638B2D4.7050200@cpcipc.org>
Message-ID: <006801c78cd2$fcc9e8a0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Carlos Mora" <carlos.mora@cpcipc.org>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 2 maggio 2007 17.48
Oggetto: Re: [Harbour] USE Question


> > FUNCTION MAIN()
> >
> >     USE TEST
> >
> >     USE TEST NEW
> >
> >     RETURN NIL
>
> I got a clue. The first USE is failing because a sharing violation
> condition.

Maybe I'm missing something but why the firse USE should be fail with a 
sharing violation error?

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From i at kevincarmody.com  Wed May  2 12:40:03 2007
From: i at kevincarmody.com (Kevin Carmody)
Date: Wed May  2 12:38:31 2007
Subject: [Harbour] USE Question
In-Reply-To: <01e001c78ca7$672d0820$0100a8c0@emag>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag>	<46386B19.2060103@kevincarmody.com>
	<01e001c78ca7$672d0820$0100a8c0@emag>
Message-ID: <4638BEE3.8040903@kevincarmody.com>

Enrico Maria Giordano wrote:
>
> -----Messaggio Originale----- Da: "Kevin Carmody" <i@kevincarmody.com>
> A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
> Data invio: mercoled? 2 maggio 2007 12.42
> Oggetto: Re: [Harbour] USE Question
>
>> > > Clipper 5.2 gives a sharing violation error on this code,
>> > > but Harbour gives no error.
>> >
>> > No, the following sample
>> >
>> > FUNCTION MAIN()
>> >
>> >    USE TEST
>> >
>> >    USE TEST NEW
>> >
>> >    RETURN NIL
>> >
>> > gives no error in both Clipper and Harbour.
>>
>> On your machine.  On my machine, Clipper gives an error, and
>> Harbour does not.
>>
>> I'm using Clipper 5.2 under Windows 98.
>
> I don't think it's a matter of used machine.

But, you see, Enrico, it simply is.

> I tried Clipper 5.2e, Clipper 5.3b, latest Harbour from CVS and latest 
> xHarbour from CVS and none of them give any error on the above 
> example. I'm confused...

Other factors outside of the EXE can affect this type of error.

>
> Do you want my EXE compiled with Clipper to test it there?

I doubt your EXE will produce any different results from my EXE.  But if 
you want to send it to me so that you can find out for sure, then send 
it along.

Kevin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070502/c7910eda/attachment.html
From e.m.giordano at emagsoftware.it  Wed May  2 12:55:47 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  2 12:56:21 2007
Subject: [Harbour] USE Question
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag>	<46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag>
	<4638BEE3.8040903@kevincarmody.com>
Message-ID: <008801c78cda$bb24d1a0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Kevin Carmody" <i@kevincarmody.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 2 maggio 2007 18.40
Oggetto: Re: [Harbour] USE Question


> > I don't think it's a matter of used machine.
>
> But, you see, Enrico, it simply is.

If it were true then it would be impossible to write software that run fine on 
the PCs of our clients.

> Other factors outside of the EXE can affect this type of error.

Yes, but no with the sample we are testing. It would be unacceptable.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From carlos.mora at cpcipc.org  Wed May  2 13:23:37 2007
From: carlos.mora at cpcipc.org (Carlos Mora)
Date: Wed May  2 13:27:18 2007
Subject: [Harbour] USE Question
In-Reply-To: <006801c78cd2$fcc9e8a0$0100a8c0@emag>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag>	<46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag>	<4638B2D4.7050200@cpcipc.org>
	<006801c78cd2$fcc9e8a0$0100a8c0@emag>
Message-ID: <4638C919.9010006@cpcipc.org>

Enrico,
> Maybe I'm missing something but why the firse USE should be fail with a 
> sharing violation error?

It's a little bit difficult for me to write english so it is posible 
that i don?t express my ideas with enough presition.

I've been speculating about the posible causes of the described 
behavoir. A cause can be the sharing violation error, so I asked for the 
status of neterr() just after the first USE.

Regards,

Carlos.

From e.m.giordano at emagsoftware.it  Wed May  2 13:40:50 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  2 13:41:59 2007
Subject: [Harbour] USE Question
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag>	<46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag>	<4638B2D4.7050200@cpcipc.org><006801c78cd2$fcc9e8a0$0100a8c0@emag>
	<4638C919.9010006@cpcipc.org>
Message-ID: <00d701c78ce1$066808c0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Carlos Mora" <carlos.mora@cpcipc.org>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 2 maggio 2007 19.23
Oggetto: Re: [Harbour] USE Question


> > Maybe I'm missing something but why the firse USE should be fail with a 
> > sharing violation error?
>
> It's a little bit difficult for me to write english so it is posible that i 
> don?t express my ideas with enough presition.
>
> I've been speculating about the posible causes of the described behavoir. A 
> cause can be the sharing violation error, so I asked for the status of 
> neterr() just after the first USE.

If we are talking about my four-line sample then the firse USE can't violates 
any sharing. Of course I assume that TEST is not opened by any other program.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Wed May  2 14:22:56 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  2 14:23:17 2007
Subject: [Harbour] USE Question
In-Reply-To: <01e001c78ca7$672d0820$0100a8c0@emag>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag>
	<46386B19.2060103@kevincarmody.com>
	<01e001c78ca7$672d0820$0100a8c0@emag>
Message-ID: <9BF6A073-20B6-4A9D-B9DE-426D593B72AB@syenar.hu>

This is a matter of the underlying operating system, file system,
network server and network client components, and even the
version of these components.

All Harbour can do is to be as close to the CA-Clipper file
opening modes as possible while keeping up portability. Yet,
the exact behaviour can vary depending on the above factors.

Brgds,
Viktor

On 2007.05.02., at 12:48, Enrico Maria Giordano wrote:

>
> -----Messaggio Originale----- Da: "Kevin Carmody" <i@kevincarmody.com>
> A: "Harbour Project Main Developer List." <harbour@harbour- 
> project.org>
> Data invio: mercoled? 2 maggio 2007 12.42
> Oggetto: Re: [Harbour] USE Question
>
>
>> > > Clipper 5.2 gives a sharing violation error on this code,
>> > > but Harbour gives no error.
>> >
>> > No, the following sample
>> >
>> > FUNCTION MAIN()
>> >
>> >    USE TEST
>> >
>> >    USE TEST NEW
>> >
>> >    RETURN NIL
>> >
>> > gives no error in both Clipper and Harbour.
>>
>> On your machine.  On my machine, Clipper gives an error, and
>> Harbour does not.
>>
>> I'm using Clipper 5.2 under Windows 98.
>
> I don't think it's a matter of used machine. I tried Clipper 5.2e,  
> Clipper 5.3b, latest Harbour from CVS and latest xHarbour from CVS  
> and none of them give any error on the above example. I'm confused...
>
> Do you want my EXE compiled with Clipper to test it there?
>
> EMG
>
> --
> EMAG Software Homepage:     http://www.emagsoftware.it
> The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
> The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
> The EMG Music page:         http://www.emagsoftware.it/emgmusic
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From e.m.giordano at emagsoftware.it  Wed May  2 14:31:16 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  2 14:31:52 2007
Subject: [Harbour] USE Question
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag><46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag>
	<9BF6A073-20B6-4A9D-B9DE-426D593B72AB@syenar.hu>
Message-ID: <00f401c78ce8$11e4d820$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Szak?ts Viktor" <harbour.01@syenar.hu>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 2 maggio 2007 20.22
Oggetto: Re: [Harbour] USE Question


> This is a matter of the underlying operating system, file system,
> network server and network client components, and even the
> version of these components.
>
> All Harbour can do is to be as close to the CA-Clipper file
> opening modes as possible while keeping up portability. Yet,
> the exact behaviour can vary depending on the above factors.

Yes, but here we are talking about Clipper behavior. The following sample 
doesn't give any errors if compiled with Clipper:

> FUNCTION MAIN()
>
 >     USE TEST
>
>     USE TEST NEW
>
>     RETURN NIL

And this is a fact. I don't know if this behavior is desirable, though.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Wed May  2 14:43:15 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  2 14:43:32 2007
Subject: [Harbour] USE Question
In-Reply-To: <00f401c78ce8$11e4d820$0100a8c0@emag>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag><46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag>
	<9BF6A073-20B6-4A9D-B9DE-426D593B72AB@syenar.hu>
	<00f401c78ce8$11e4d820$0100a8c0@emag>
Message-ID: <2E5B1609-36F9-46BE-881F-2532155C89AE@syenar.hu>

>> This is a matter of the underlying operating system, file system,
>> network server and network client components, and even the
>> version of these components.
>>
>> All Harbour can do is to be as close to the CA-Clipper file
>> opening modes as possible while keeping up portability. Yet,
>> the exact behaviour can vary depending on the above factors.
>
> Yes, but here we are talking about Clipper behavior. The following  
> sample doesn't give any errors if compiled with Clipper:
>
>> FUNCTION MAIN()
>>
> >     USE TEST
>>
>>     USE TEST NEW
>>
>>     RETURN NIL
>
> And this is a fact. I don't know if this behavior is desirable,  
> though.

Not desirable for sure, but the result of a file system
operation is a given fact on app level; if the OS reports a
failure we can do no other than trust it (maybe retry it). And
OSes do behave differently, sometimes oddly (see for example
the "opportunistic locking" issue, or there are a number NetWare
server access issues, or that fact that you can rename a
running .exe on a Windows server, but not one on a NetWare
server, deletion behaviour is also different).

For this reason my app is testing on each startup some basic
file-sharing capabilities of the host drive to (try to) avoid problems.

If you go deeper into the topic, you'll find several smaller
differences between environments in this regard, I've for
example had to revert to a very rudamentary logged-user-tracking
system (which just needed very basic file-sharing capabilities)
instead of a more sophisticated one because of these issues.
Yet even this basic one has performance issue on some operating
systems.

The whole topic is of course wider using Harbour, because of the
wider selection of OSes it can run on.

Brgds,
Viktor


From e.m.giordano at emagsoftware.it  Wed May  2 15:50:24 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  2 15:51:28 2007
Subject: [Harbour] USE Question
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag><46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag><9BF6A073-20B6-4A9D-B9DE-426D593B72AB@syenar.hu><00f401c78ce8$11e4d820$0100a8c0@emag>
	<2E5B1609-36F9-46BE-881F-2532155C89AE@syenar.hu>
Message-ID: <010701c78cf3$204b8430$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Szak?ts Viktor" <harbour.01@syenar.hu>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 2 maggio 2007 20.43
Oggetto: Re: [Harbour] USE Question


> Not desirable for sure, but the result of a file system
> operation is a given fact on app level; [...]

I can agree on most thing that you said but the fact is: the following sample 
can't fail under normal conditions:

FUNCTION MAIN()

    USE TEST

    RETURN NIL

Otherwise I can't write working software for my clients. If your test has been 
done under specific conditions then you would have to specify them and we can 
discuss on what and how.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Wed May  2 16:58:41 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  2 16:59:03 2007
Subject: [Harbour] USE Question
In-Reply-To: <010701c78cf3$204b8430$0100a8c0@emag>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag><46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag><9BF6A073-20B6-4A9D-B9DE-426D593B72AB@syenar.hu><00f401c78ce8$11e4d820$0100a8c0@emag>
	<2E5B1609-36F9-46BE-881F-2532155C89AE@syenar.hu>
	<010701c78cf3$204b8430$0100a8c0@emag>
Message-ID: <5666608B-B8BC-4946-93FA-EE9F8F9E7245@syenar.hu>

>> Not desirable for sure, but the result of a file system
>> operation is a given fact on app level; [...]
>
> I can agree on most thing that you said but the fact is: the  
> following sample can't fail under normal conditions:
>
> FUNCTION MAIN()
>
>    USE TEST
>
>    RETURN NIL
>
> Otherwise I can't write working software for my clients. If your  
> test has been done under specific conditions then you would have to  
> specify them and we can discuss on what and how.

Well, given that "normal conditions" mean that the file is accessible,
non-readonly, the file [and it's compound index and memo file] is valid,
and there's no other process which keeps it open in a way that
prevents another station/session to open it in exclusive mode, this
one command should work on all systems.

When you want to open it two times though (from the same app like
in a previous example), you need to be careful about the OS details,
because for example under plain DOS (without SHARE.EXE), you
could easily mess up (=corrupt) the filesystem, or the file content.

Now while Win98/Win95/WinME actually have "share.exe" support
(with fatal bugs in unpatched Win95B), the implementation is far from
perfect, so there might be cases when you can mess up the OS from
an app, or get unexpected results (garbled data for example, when
looking into a file shared in a certain way). Hard to tell which cases
are these, but I'm usually recommeding an NT based OS on the client
side if there is a choice for the user. On the server side probably
all modern OSes would fit which have a proper SMB implementation
plus a proper shared filesystem. (In case of any SMB server it's always
a good idea to disable opportunistic locking when running classic
file-sharing based database apps.). I guess I went off topic :)

Brgds,
Viktor

From e.m.giordano at emagsoftware.it  Wed May  2 17:04:45 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  2 17:06:02 2007
Subject: [Harbour] USE Question
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag><46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag><9BF6A073-20B6-4A9D-B9DE-426D593B72AB@syenar.hu><00f401c78ce8$11e4d820$0100a8c0@emag><2E5B1609-36F9-46BE-881F-2532155C89AE@syenar.hu><010701c78cf3$204b8430$0100a8c0@emag>
	<5666608B-B8BC-4946-93FA-EE9F8F9E7245@syenar.hu>
Message-ID: <013001c78cfd$8320ae00$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Szak?ts Viktor" <harbour.01@syenar.hu>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 2 maggio 2007 22.58
Oggetto: Re: [Harbour] USE Question


> Well, given that "normal conditions" mean that the file is accessible,
> non-readonly, the file [and it's compound index and memo file] is valid,
> and there's no other process which keeps it open in a way that
> prevents another station/session to open it in exclusive mode, this
> one command should work on all systems.

Exactly.

> When you want to open it two times though (from the same app like
> in a previous example), you need to be careful about the OS details,
> because for example under plain DOS (without SHARE.EXE), you
> could easily mess up (=corrupt) the filesystem, or the file content.

I agree. But, if you read the thread back you will see that someone stated 
that the *first* USE can fail with sharing violation. Now I have the doubt 
that it was a typo and the poster meant "the second USE"...

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Wed May  2 18:16:41 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  2 18:17:03 2007
Subject: [Harbour] USE Question
In-Reply-To: <013001c78cfd$8320ae00$0100a8c0@emag>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>	<46377EEE.7090803@kevincarmody.com><012a01c78c1a$853c5330$0100a8c0@emag><46386B19.2060103@kevincarmody.com><01e001c78ca7$672d0820$0100a8c0@emag><9BF6A073-20B6-4A9D-B9DE-426D593B72AB@syenar.hu><00f401c78ce8$11e4d820$0100a8c0@emag><2E5B1609-36F9-46BE-881F-2532155C89AE@syenar.hu><010701c78cf3$204b8430$0100a8c0@emag>
	<5666608B-B8BC-4946-93FA-EE9F8F9E7245@syenar.hu>
	<013001c78cfd$8320ae00$0100a8c0@emag>
Message-ID: <156BB0BC-13F2-4D59-A337-737DC00B2331@syenar.hu>

>> When you want to open it two times though (from the same app like
>> in a previous example), you need to be careful about the OS details,
>> because for example under plain DOS (without SHARE.EXE), you
>> could easily mess up (=corrupt) the filesystem, or the file content.
>
> I agree. But, if you read the thread back you will see that someone  
> stated that the *first* USE can fail with sharing violation. Now I  
> have the doubt that it was a typo and the poster meant "the second  
> USE"...

Probably, or this is not a "normal case" (maybe the file was open in
Excel or *DBU - it used to happen with me from time to time).

Carlos could clarify :)

Brgds,
Viktor



From miguelangel at marchuet.net  Thu May  3 03:14:51 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Thu May  3 03:14:46 2007
Subject: [Harbour] Where I commit BMDBFCDX ?
Message-ID: <46398BEB.2010304@marchuet.net>

It works exactly as harbour DBFCDX when SET OPTIMIZE OFF
and works as CLipper 5.3b DBFCDX when SET OPTIMIZE ON. (too BMSIXCDX)

1.- I can upload it to Contrib
2.- As new RDD in source/rdd/bmdbfcdx (as xharbour)
3.- Substitute actual DBFCDX

I remain that has the same code as DBFCDX, only has modifications
to run static bitmap filters when SET OPTIMIZE ON.


Best regards,
Miguel Angel Marchuet
From e.m.giordano at emagsoftware.it  Thu May  3 03:17:45 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May  3 03:18:19 2007
Subject: [Harbour] Where I commit BMDBFCDX ?
References: <46398BEB.2010304@marchuet.net>
Message-ID: <005701c78d53$25a60df0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Miguel Angel Marchuet" <miguelangel@marchuet.net>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: gioved? 3 maggio 2007 9.14
Oggetto: [Harbour] Where I commit BMDBFCDX ?


> It works exactly as harbour DBFCDX when SET OPTIMIZE OFF
> and works as CLipper 5.3b DBFCDX when SET OPTIMIZE ON. (too BMSIXCDX)
>
> 1.- I can upload it to Contrib
> 2.- As new RDD in source/rdd/bmdbfcdx (as xharbour)
> 3.- Substitute actual DBFCDX
>
> I remain that has the same code as DBFCDX, only has modifications
> to run static bitmap filters when SET OPTIMIZE ON.

I vote for "as new RDD".

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From miguelangel at marchuet.net  Thu May  3 03:51:25 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Thu May  3 03:51:15 2007
Subject: [Harbour] Permision co correct this problem:
Message-ID: <4639947D.9030901@marchuet.net>

In Clipper when fails the open of a new workarea
remains in the new workarea.

Values printed by this example:
Clipper:
1
2
xHarbour:
1
1

//-----------------------------------------------------------//
 #include "dbinfo.ch"
 #include "ord.ch"

 PROCEDURE Main()
    FIELD F1

    CLEAR SCREEN

    request DBFCDX
    rddSetDefault("DBFCDX")

    DbCreate("_tst",{{"F1","C",1,0}},,.t.)
    CLOSE

    USE _tst NEW ALIAS "ADIN"
    ? SELECT()

    USE _tst NEW ALIAS "DUA"
    ? SELECT()

    ?

RETURN
//-----------------------------------------------------------//

Can I fix it ?

Best regards,
Miguel Angel Marchuet
From goosfancito at gmail.com  Thu May  3 04:35:56 2007
From: goosfancito at gmail.com (GoosFancito)
Date: Thu May  3 04:36:01 2007
Subject: [Harbour] [OT] al viejo modo DOS... ayuda
Message-ID: <002601c78d5e$1321e860$27fed4c9@Delorean>

Estimados,

    Necesito realizar un .bat que genere un directorio con el nombre correspondiente
a la hora actual, como hago para guardar el time() del sistema en una variable dentro
del DOS.

A esto me refiero:

    a = time()
    md a

Gracias.
Gustavo.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070503/e2e6b2fd/attachment.html
From dbtopas at dbtopas.lt  Thu May  3 04:45:49 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Thu May  3 04:42:55 2007
Subject: [Harbour] Where I commit BMDBFCDX ?
In-Reply-To: <46398BEB.2010304@marchuet.net>
References: <46398BEB.2010304@marchuet.net>
Message-ID: <4639A13D.3010105@dbtopas.lt>

Miguel Angel Marchuet wrote:
> It works exactly as harbour DBFCDX when SET OPTIMIZE OFF
> and works as CLipper 5.3b DBFCDX when SET OPTIMIZE ON. (too BMSIXCDX)
> 
> 1.- I can upload it to Contrib
> 2.- As new RDD in source/rdd/bmdbfcdx (as xharbour)
> 3.- Substitute actual DBFCDX
> 
> I remain that has the same code as DBFCDX, only has modifications
> to run static bitmap filters when SET OPTIMIZE ON.

Hello,


if bmdbfcdx is modified copy of dbfcdx, when contrib is best place for it.
I'm not sure if we need one more copy of the same code (with some 
appedices) at all. I think separation BM functionality into separate RDD 
would be much better idea.


Best regards,
Mindaugas
From lorenzo.fiorini at gmail.com  Thu May  3 05:26:03 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May  3 05:26:11 2007
Subject: [Harbour] Where I commit BMDBFCDX ?
In-Reply-To: <46398BEB.2010304@marchuet.net>
References: <46398BEB.2010304@marchuet.net>
Message-ID: <9257026e0705030226n4ac80176ud7e1d4d9e51f349@mail.gmail.com>

On 5/3/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:
> It works exactly as harbour DBFCDX when SET OPTIMIZE OFF
> and works as CLipper 5.3b DBFCDX when SET OPTIMIZE ON. (too BMSIXCDX)
>
> 1.- I can upload it to Contrib
> 2.- As new RDD in source/rdd/bmdbfcdx (as xharbour)
> 3.- Substitute actual DBFCDX

contrib

regards,
Lorenzo
From e.m.giordano at emagsoftware.it  Thu May  3 05:29:46 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May  3 05:30:37 2007
Subject: [Harbour] Where I commit BMDBFCDX ?
References: <46398BEB.2010304@marchuet.net> <4639A13D.3010105@dbtopas.lt>
Message-ID: <01af01c78d65$972cafd0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Mindaugas Kavaliauskas" <dbtopas@dbtopas.lt>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: gioved? 3 maggio 2007 10.45
Oggetto: Re: [Harbour] Where I commit BMDBFCDX ?


> if bmdbfcdx is modified copy of dbfcdx, when contrib is best place for it.
> I'm not sure if we need one more copy of the same code (with some appedices) 
> at all. I think separation BM functionality into separate RDD would be much 
> better idea.

I agree.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From e.m.giordano at emagsoftware.it  Thu May  3 06:18:40 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May  3 06:19:18 2007
Subject: [Harbour] [OT] al viejo modo DOS... ayuda
References: <002601c78d5e$1321e860$27fed4c9@Delorean>
Message-ID: <01e201c78d6c$6bdcdf10$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "GoosFancito" <goosfancito@gmail.com>
A: "Harbour Project Main Developer List.'" <harbour@harbour-project.org>
Data invio: gioved? 3 maggio 2007 10.35
Oggetto: [Harbour] [OT] al viejo modo DOS... ayuda


> Estimados,
>
>     Necesito realizar un .bat que genere un directorio con el nombre
> correspondiente a la hora actual, como hago para guardar el time()
> del sistema en una variable dentro del DOS.
>
> A esto me refiero:
>
>     a = time()
>     md a

Something like this?

FUNCTION MAIN()

    MAKEDIR( STRTRAN( TIME(), ":", "" ) )

    RETURN NIL

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From druzus at priv.onet.pl  Thu May  3 06:50:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 06:51:08 2007
Subject: [Harbour] USE Question
In-Reply-To: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>
References: <000001c78bf8$d9e2faf0$3e02a8c0@PORTATIL>
Message-ID: <20070503105032.GA461@localhost.localdomain>

On Tue, 01 May 2007, Fernando Mancera wrote:
> Hello Premzeck,
> USE TEST
> USE TEST NEW
> Shouldn't the second USE give a runtime error ?
> What is your opinion ?

It causes RT error and default error handler sets NETERR() for it.
See errorsys.prg.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May  3 06:56:36 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 06:57:11 2007
Subject: [Harbour] gtxwc inkey(0) under fc7-test4 eats 100% cpu
In-Reply-To: <9257026e0705020713v5f3abdbaucae57502f726a584@mail.gmail.com>
References: <9257026e0705020713v5f3abdbaucae57502f726a584@mail.gmail.com>
Message-ID: <20070503105636.GB461@localhost.localdomain>

On Wed, 02 May 2007, Lorenzo Fiorini wrote:
> Under fc5 it is ok.
> Is there anything I can check?
> Should I report sth to fc7 bugzilla?

See idle.c and:

      {
         static const struct timespec nanosecs = { 0, 1000 };
         /* NOTE: it will sleep at least 10 miliseconds (forced by kernel) */
         nanosleep( &nanosecs, NULL );
      }

This note is incorrect for modern Linux kernels (I'll remove it in next
commit) and it's quite possible that the kernel in FC7 can even sleep
only for above 1 microsecond what seems to be too small value. If
increasing the timeval to 1 milliseconds:
      {
         static const struct timespec nanosecs = { 0, 1000000 };
         nanosleep( &nanosecs, NULL );
      }

will not help then I suggest to use the trick with select() (so far
I haven't found *nix system where it will not work ;-)) and you should
report it to FC7 or kernel developers.

best regards,
Przemek
From goosfancito at gmail.com  Thu May  3 07:07:49 2007
From: goosfancito at gmail.com (GoosFancito)
Date: Thu May  3 07:07:51 2007
Subject: [Harbour] [OT] al viejo modo DOS... ayuda
In-Reply-To: <01e201c78d6c$6bdcdf10$0100a8c0@emag>
References: <002601c78d5e$1321e860$27fed4c9@Delorean>
	<01e201c78d6c$6bdcdf10$0100a8c0@emag>
Message-ID: <24bca0990705030407q48feaccu9637bb1a286ef284@mail.gmail.com>

Sorry my friend

 I need make with .bat file. not with xharbour.

Tank?s


2007/5/3, Enrico Maria Giordano <e.m.giordano@emagsoftware.it>:
>
>
> -----Messaggio Originale-----
> Da: "GoosFancito" < goosfancito@gmail.com>
> A: "Harbour Project Main Developer List.'" <harbour@harbour-project.org>
> Data invio: gioved? 3 maggio 2007 10.35
> Oggetto: [Harbour] [OT] al viejo modo DOS... ayuda
>
>
> > Estimados,
> >
> >     Necesito realizar un .bat que genere un directorio con el nombre
> > correspondiente a la hora actual, como hago para guardar el time()
> > del sistema en una variable dentro del DOS.
> >
> > A esto me refiero:
> >
> >     a = time()
> >     md a
>
> Something like this?
>
> FUNCTION MAIN()
>
>    MAKEDIR( STRTRAN( TIME(), ":", "" ) )
>
>    RETURN NIL
>
> EMG
>
> --
> EMAG Software Homepage:     http://www.emagsoftware.it
> The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
> The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
> The EMG Music page:         http://www.emagsoftware.it/emgmusic
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
>



-- 
Por MSN: gustavo@coepa.com.ar
Por Skype: GoosFancito
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070503/d3a1ac7e/attachment.html
From druzus at priv.onet.pl  Thu May  3 07:14:02 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 07:14:37 2007
Subject: [Harbour] Julian date functions
In-Reply-To: <200704290305.20241.philb@philb.us>
References: <200704290305.20241.philb@philb.us>
Message-ID: <20070503111401.GA1189@localhost.localdomain>

On Sun, 29 Apr 2007, Phil Barnett wrote:
> If anyone is thinking of including Julian date functions, they are here:
> http://www.the-oasis.net/files/general/julian.zip
> I'll change the license if you want me to.

Thank you for your proposition but we will need them on C level
and we already have Julian date functions so we will only have
to add support for time part. Anyhow some people who used these
functions in Clipper can be interesting in porting them to Harbour
so they will operate on new timeval items. it may greatly help in
data sharing.

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Thu May  3 07:21:33 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May  3 07:22:09 2007
Subject: [Harbour] [OT] al viejo modo DOS... ayuda
References: <002601c78d5e$1321e860$27fed4c9@Delorean><01e201c78d6c$6bdcdf10$0100a8c0@emag>
	<24bca0990705030407q48feaccu9637bb1a286ef284@mail.gmail.com>
Message-ID: <026401c78d75$34883420$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "GoosFancito" <goosfancito@gmail.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: gioved? 3 maggio 2007 13.07
Oggetto: Re: [Harbour] [OT] al viejo modo DOS... ayuda


> Sorry my friend
>
> I need make with .bat file. not with xharbour.

You can't with pure batch language, as far as I know.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From druzus at priv.onet.pl  Thu May  3 07:25:48 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 07:26:24 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <4635B42C.6010206@marchuet.net>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<462EA5A5.5050905@dbtopas.lt>
	<20070428100918.GB17193@localhost.localdomain>
	<2DE79C33-87B7-4417-95D6-CA58248DBE91@syenar.hu>
	<4635B42C.6010206@marchuet.net>
Message-ID: <20070503112548.GB1189@localhost.localdomain>

On Mon, 30 Apr 2007, Miguel Angel Marchuet wrote:
> And what about
> DBF compatibility
> FieldType @ for Timestamp
> format : 8 bytes (two longs)
> First long repecents date and second long time. Date is the number of
> days since January 1st,
> 4713 BC. Time is hours * 3600000L + minutes * 60000L + seconds * 1000L.

To be a little bit more precise these are two 32bit little endian numbers,
the first one is Julian's date and the second one is number of milliseconds
in this day.
The internal HVM representation of daytime value should not interact with
outer storage classes like in DBF so it will not be a problem for us.
Anyhow we may think about some more precise then milliseconds internal
representation. On some OSes (f.e. Linux) I can read current time with
microsecond or even nanosecond precision.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May  3 07:26:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 07:27:07 2007
Subject: [Harbour] Permision co correct this problem:
In-Reply-To: <4639947D.9030901@marchuet.net>
References: <4639947D.9030901@marchuet.net>
Message-ID: <20070503112632.GC1189@localhost.localdomain>

On Thu, 03 May 2007, Miguel Angel Marchuet wrote:
> In Clipper when fails the open of a new workarea
> remains in the new workarea.
> Values printed by this example:
> Clipper:
> 1
> 2
> xHarbour:
> 1
> 1
> //-----------------------------------------------------------//
>  #include "dbinfo.ch"
>  #include "ord.ch"
>  PROCEDURE Main()
>     FIELD F1
>     CLEAR SCREEN
>     request DBFCDX
>     rddSetDefault("DBFCDX")
>     DbCreate("_tst",{{"F1","C",1,0}},,.t.)
>     CLOSE
>     USE _tst NEW ALIAS "ADIN"
>     ? SELECT()
>     USE _tst NEW ALIAS "DUA"
>     ? SELECT()
>     ?
> RETURN
> //-----------------------------------------------------------//
> Can I fix it ?

Yes sure. Thank you very much.

best regards,
Przemek
From info at fsgiudice.com  Thu May  3 07:56:12 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Thu May  3 07:56:58 2007
Subject: [Harbour] [OT] al viejo modo DOS... ayuda
References: <002601c78d5e$1321e860$27fed4c9@Delorean>
Message-ID: <001701c78d7a$0cb9d3e0$b400a8c0@ASUSFSG>

Hi Gustavo,

----- Original Message ----- 
From: GoosFancito
To: Harbour Project Main Developer List.'
Sent: Thursday, May 03, 2007 10:35 AM
Subject: [Harbour] [OT] al viejo modo DOS... ayuda


Estimados,

    Necesito realizar un .bat que genere un directorio con el nombre 
correspondiente
a la hora actual, como hago para guardar el time() del sistema en una 
variable dentro
del DOS.

A esto me refiero:

    a = time()
    md a

----------------------------

I have some batch files that work creating files on fly using date and time.
You can use batch properties of ~ that works as substr() in clipper.
try this, not tested, directly translated from my batch file used on italian 
os, check also if it show date in desidered format and add minutes and 
seconds:

set OSVER=WIN2003

IF NOT %OSVER%.==WIN2003. GOTO DATE2000
rem *** this 4 rows are for windows 2003 server ****
set DAY=%DATE:~0,2%
set MONTH=%DATE:~3,2%
set YEAR=%DATE:~6,4%
set HOUR=%TIME:~0,8%
GOTO DATEOK

:DATE2000
rem *** this 4 rows are for windows 2000 server ****
set DATE=%DATE:~4,2%
set MONTH=%DATE:~7,2%
set YEAR=%DATE:~10,4%
set HOUR=%TIME:~0,8%

:DATEOK

REM *** now correct hour 0 prefix ******
if %HOUR:~0,1%.==. set HOUR=0%TIME:~1,7%

set MYDATE=%YEAR%%MONTH%%DAY%_%HOUR%

REM **** show date, it has to be YYYYMMDD_HH
echo.%MYDATE%

REM **** uncomment to create directory
rem MD %MYDATE%

Best Regards

Francesco Saverio Giudice
From gabor.salai at euroherc.hr  Thu May  3 08:30:53 2007
From: gabor.salai at euroherc.hr (gabor salai [intranet242])
Date: Thu May  3 08:28:53 2007
Subject: [Harbour] [OT] al viejo modo DOS... ayuda
References: <002601c78d5e$1321e860$27fed4c9@Delorean>
	<01e201c78d6c$6bdcdf10$0100a8c0@emag>
Message-ID: <023001c78d7e$e6a1af20$7e00520a@euroherc.ba>

----- Original Message ----- 
From: "Enrico Maria Giordano" <e.m.giordano@emagsoftware.it>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Thursday, May 03, 2007 12:18 PM
Subject: Re: [Harbour] [OT] al viejo modo DOS... ayuda


> > correspondiente a la hora actual, como hago para guardar el time()
> > del sistema en una variable dentro del DOS.
> >
> > A esto me refiero:
> >
> >     a = time()
> >     md a
 
 example with win/xp [having enhanced dos commands]

for /f %i ('time/t') do set tmpvar=%i
md %tmpvar::=_%

for .bat files, double %%
at cmd prompt check syntax and help: for/? and set/?


From druzus at priv.onet.pl  Thu May  3 08:39:36 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 08:40:11 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <463614A7.6000209@marchuet.net>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<46308E71.4050104@marchuet.net>
	<20070428091514.GA17193@localhost.localdomain>
	<463614A7.6000209@marchuet.net>
Message-ID: <20070503123936.GD1189@localhost.localdomain>

On Mon, 30 Apr 2007, Miguel Angel Marchuet wrote:
> With this code
>    x := Seconds()
>    FOR y := 1 TO 100000
>       APPEND BLANK
>       FIELD->One := '90000'
>    NEXT y
>    @ n++,0 SAY "Added records : " + Str( LastRec(), 7 )
>    @ n++,0 SAY "Seconds : " + Str( Seconds() - x, 5, 2 )
> clipper 5.3b (Rev.338) (1997-04-25) 	 7.58 s
> harbour	devel build 1.1-1 Intl.	   	10.11 s
> xharbour build 0.99.71 Intl. (Simplex)	10.22 s
> with this code
>    x := Seconds()
>    FOR y := 1 TO 100000
>       APPEND BLANK
>       FIELD->One := Str( y%509, 6 )
>    NEXT y
>    @ n++,0 SAY "Added records : " + Str( LastRec(), 7 )
>    @ n++,0 SAY "Seconds : " + Str( Seconds() - x, 5, 2 )
> clipper 5.3b (Rev.338) (1997-04-25) 	 8.40 s
> harbour	devel build 1.1-1 Intl.	   	13.55 s
> xharbour build 0.99.71 Intl. (Simplex)	13.92 s
> Any idea how to increase speed ... ?

Please always present the whole self contain example which can
be compiled _unmodified_ by other users. It will greatly help
and without it I can only guess about the reasons, so I'll start:
Changing:
    FIELD->One := '90000'
to
    FIELD->One := Str( y%509, 6 )
caused serious speed overhead so you had open index on filed One in
this operation and the speed difference is cause by much more expensive
index updating in second case.
Because so far we were talking about DBFCDX I also guess that this index
is created by DBFCDX not DBFNTX. In [x]Harbour DBFCDX I keep very strong
compression level. In test like above final CDX files are much smaller
then the one created by CL52/SIX3 or CL53/COMMIX (please compare the
difference is really huge) but with the cost of some speed overhead during
updating but later some extensions like bitmap filters can work faster
without reindexing.
Probably in new CDX implementation I'll add some options to control
compression level.
I do not know if it's SHARED or EXCLUSIVE mode. There are some fundamental
speed differences in both modes in append operation due to concurrent access
synchronization so it's _very_ important information even for pure code which
makes only dummy APPND BLANK for table without indexes.
In EXCLUSIVE mode Clipper uses extensively caches. You can see it if you
will add to your code just after
    NEXT y
a line with:
    WAIT
execute it and check on the second terminal window the size of DBF and CDX
files. Next press any key and compare the difference. Such extensive caching
has to cause speed big differences but it's sth what we can add globally
in practice with some very minor modification in current RDD code. Because
I'm working in *nixes and my programs can benefit from local file access
and very fast IO operations then I never needed such cache system and it's
the reason why it has very low priority on my TODO list but if you are
working in Windows then it may give even better speed improvement in some
cases then bitmap filters and even bitmap filters can strongly benefit from
it when you implement real index scanning for SET FILTER optimization. It
will be one of the most important thing to reach Clipper performance in
slow networks in SET FILTER command. If I would work with Windows then it's
the place I started current code optimization before bitmap filters which
will finally need efficient caching system.
And the last thing which may strongly effect the speed. Clipper has very
serious bug in INDEX ON operation. After INDEX ON it switches internally
open table to _EXCLUSIVE_ even if it is open in SHARED mode. It greatly
increase the speed of later tests but if you will compare the [x]Harbour
results with Clipper ones then you will compare SHARED mode with EXCLUSIVE
mode and SHARED mode will always be slower in such tests.
I'm attachin small test code. Please compile it with and without:
    #define CLBUG
by Clipper and compare the results and file sizes. Please also check
if [x]Harbour is slower in real SHARED mode then in Clipper.

best regards,
Przemek

ps. In the future please send whole self contain examples.
-------------- next part --------------
#define CLBUG
request DBFCDX
PROC MAIN()
   LOCAL x, y
   rddSetDefault("DBFCDX")
   ? OS(), VERSION(), rddSetDefault()
   FERASE("test.dbf")
   FERASE("test.cdx")
   DbCreate( "test", { {"One", "C", 6, 0} } )
   USE test SHARED
   INDEX ON FIELD->One TAG One TO test FOR ! Deleted()
#ifndef CLBUG     /* workaround for Clipper bug */
   CLOSE; USE test SHARED
#endif
   ? "Adding records ..."
   x := Seconds()
   FOR y := 1 TO 100000
      APPEND BLANK
      FIELD->One := '90000'
   NEXT y
   ? "Added records : " + Str( LastRec(), 7 )
   ? "Seconds : " + Str( Seconds() - x, 5, 2 )
   ? "Before commit..."
   AEVAL(DIRECTORY("test.*"),{|x| qout(x[1],x[2])})
   ? "After commit..."
   CLOSE
   AEVAL(DIRECTORY("test.*"),{|x| qout(x[1],x[2])})
RETURN
From lorenzo.fiorini at gmail.com  Thu May  3 09:03:33 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May  3 09:03:37 2007
Subject: [Harbour] gtxwc inkey(0) under fc7-test4 eats 100% cpu
In-Reply-To: <20070503105636.GB461@localhost.localdomain>
References: <9257026e0705020713v5f3abdbaucae57502f726a584@mail.gmail.com>
	<20070503105636.GB461@localhost.localdomain>
Message-ID: <9257026e0705030603y5a1a66t1a741c96cd522056@mail.gmail.com>

On 5/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> This note is incorrect for modern Linux kernels (I'll remove it in next
> commit) and it's quite possible that the kernel in FC7 can even sleep
> only for above 1 microsecond what seems to be too small value. If
> increasing the timeval to 1 milliseconds:
>       {
>          static const struct timespec nanosecs = { 0, 1000000 };
>          nanosleep( &nanosecs, NULL );
>       }
>
> will not help then I suggest to use the trick with select() (so far
> I haven't found *nix system where it will not work ;-)) and you should
> report it to FC7 or kernel developers.

You are right as usual, FC7 has the latest TICKLESS 2.6.21
grrrr why I didn't think about it :)

I've removed nanosleeep and left only:
...
#elif defined(HB_OS_UNIX)

   {
      struct timeval tv;
      tv.tv_sec = 0;
      tv.tv_usec = 1000;
      select( 0, NULL, NULL, NULL, &tv );
   }

and it works like a charm. Is it correct?

regards,
Lorenzo
From druzus at priv.onet.pl  Thu May  3 10:12:00 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 10:12:35 2007
Subject: [Harbour] ChangeLog 2007-05-03 16:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070503141159.GA2764@localhost.localdomain>

2007-05-03 16:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
  * harbour/include/hbapirdd.h
  - harbour/include/hbrddwrk.h
  * harbour/source/rdd/Makefile
  + harbour/source/rdd/wacore.c
  + harbour/source/rdd/wafunc.c
  * harbour/source/rdd/workarea.c
    * cleaned RDD code:
      * the default work area implementation from which each RDD inherits
        and RDD management is now in workarea.c file - this part will be
        common for all threads in future MT version
      * the code to mange workareas and aliases moved to wacore.c - this
        code uses some static variables which will be moved to HVM stack
        in MT version
      * helper RDD functions thread independent moved to wafunc.c

  * harbour/source/rdd/dbcmd.c
    * removed RDD/WorkArea management code - only independent HB_FUNCs
      left. IMHO it will be good to divide this file into few ones.
    * changed dbCreate() and dbUseArea() to return logical value

  * harbour/config/global.cf
    - removed nulsys from linked library list - it should not be here
      because it can confuse some linkers and wrong library will be
      created

  * harbour/contrib/rdd_ads/ads1.c
  * harbour/source/rdd/dbf1.c
  * harbour/source/rdd/delim1.c
  * harbour/source/rdd/sdf1.c
  * harbour/source/rdd/dbfcdx/dbfcdx1.c
  * harbour/source/rdd/dbfdbt/dbfdbt1.c
  * harbour/source/rdd/dbffpt/dbffpt1.c
  * harbour/source/rdd/dbfntx/dbfntx1.c
  * harbour/source/rdd/nulsys/nulsys.c
    * updated for recent modifications in RDD API

  * harbour/include/hbextern.ch
    - removed __RDDSETDEFAULT() - this function was necessary with old
      rdd register code and we not not need it for few years. It's not
      Clipper function so I do not see any reason to keep it but if you
      want we can add wrapper to standard RDDSETDEFAULT()

  * harbour/source/rdd/hbsix/sxcompr.c
    + added workaround for SIX3 bug which I intentionally replicated in
      [x]Harbour but it may cause data corruption so IMHO it will be better
      to fix it.

  * harbour/source/rtl/errorsys.prg
    * added default action for EG_LOCK - it's Clipper compatible behavior
      but done in differ way. Due to some differences in linker we are
      using we cannot exactly replicate Clipper behavior because it will
      not work on some platforms as expected so I decided to add it here.
      I think it's even more Clear then the trick with source/sys/ntxerr.prg
      done by Clipper. Many people do not even knows about it.

  * harbour/source/rtl/gtcrs/chrmap.c
    * changed environment variable name from HB_CHRMAP to HB_CHARMAP to
      be compatible with description in default map file

best regards,
Przemek
From druzus at priv.onet.pl  Thu May  3 10:24:21 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 10:24:57 2007
Subject: [Harbour] ChangeLog 2007-05-03 16:22 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070503142421.GB2764@localhost.localdomain>

2007-05-03 16:22 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rdd/usrrdd/usrrdd.c
    * updated casting for recent modifications in RDD API

best regards,
Przemek
From alex_degarate at hotmail.com  Thu May  3 12:21:06 2007
From: alex_degarate at hotmail.com (Alejandro de Garate)
Date: Thu May  3 12:21:40 2007
Subject: [Harbour] Ask Harbour Compiler
In-Reply-To: <529264.14712.qm@web55015.mail.re4.yahoo.com>
Message-ID: <BAY137-F11953A3B0F19C7168C23B085410@phx.gbl>


This is a mail I received from a Linux user (begginer), can anybody with 
better knowledge of Linux
than mine answer his questions. Thanks

---

Hi,
My name is Anton from Indonesia and allow me to ask you about harbour. I use 
Linux Ubuntu and finally..... I get success to compile a single program with 
harbour. Now I have 30 PRG file and use Foxpro Database. Among the PRG there 
is a function and procedure. My questions are :
1. How to compile 30 PRG became one executable file?
1. How the way to compile my 'function' PRG became lib.a ??
2. How to use that lib.a ??
3. How the way to connected file DBF with executable PRG (after compile with 
harbour)??

Sory for a lot of questions and hope you want to help me.... :)

Anton

_________________________________________________________________
Express yourself instantly with MSN Messenger! Download today it's FREE! 
http://messenger.msn.click-url.com/go/onm00200471ave/direct/01/

From goosfancito at gmail.com  Thu May  3 13:08:06 2007
From: goosfancito at gmail.com (GoosFancito)
Date: Thu May  3 13:08:14 2007
Subject: [Harbour] [OT] al viejo modo DOS... ayuda
References: <002601c78d5e$1321e860$27fed4c9@Delorean>
	<001701c78d7a$0cb9d3e0$b400a8c0@ASUSFSG>
Message-ID: <003201c78da5$9f957180$58c27fc8@Delorean>

Gracias a todos.
Tank?s all

----- Original Message ----- 
From: "Francesco Saverio Giudice" <info@fsgiudice.com>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Thursday, May 03, 2007 8:56 AM
Subject: Re: [Harbour] [OT] al viejo modo DOS... ayuda


> Hi Gustavo,
>
> ----- Original Message ----- 
> From: GoosFancito
> To: Harbour Project Main Developer List.'
> Sent: Thursday, May 03, 2007 10:35 AM
> Subject: [Harbour] [OT] al viejo modo DOS... ayuda
>
>
> Estimados,
>
>    Necesito realizar un .bat que genere un directorio con el nombre 
> correspondiente
> a la hora actual, como hago para guardar el time() del sistema en una 
> variable dentro
> del DOS.
>
> A esto me refiero:
>
>    a = time()
>    md a
>
> ----------------------------
>
> I have some batch files that work creating files on fly using date and 
> time.
> You can use batch properties of ~ that works as substr() in clipper.
> try this, not tested, directly translated from my batch file used on 
> italian os, check also if it show date in desidered format and add minutes 
> and seconds:
>
> set OSVER=WIN2003
>
> IF NOT %OSVER%.==WIN2003. GOTO DATE2000
> rem *** this 4 rows are for windows 2003 server ****
> set DAY=%DATE:~0,2%
> set MONTH=%DATE:~3,2%
> set YEAR=%DATE:~6,4%
> set HOUR=%TIME:~0,8%
> GOTO DATEOK
>
> :DATE2000
> rem *** this 4 rows are for windows 2000 server ****
> set DATE=%DATE:~4,2%
> set MONTH=%DATE:~7,2%
> set YEAR=%DATE:~10,4%
> set HOUR=%TIME:~0,8%
>
> :DATEOK
>
> REM *** now correct hour 0 prefix ******
> if %HOUR:~0,1%.==. set HOUR=0%TIME:~1,7%
>
> set MYDATE=%YEAR%%MONTH%%DAY%_%HOUR%
>
> REM **** show date, it has to be YYYYMMDD_HH
> echo.%MYDATE%
>
> REM **** uncomment to create directory
> rem MD %MYDATE%
>
> Best Regards
>
> Francesco Saverio Giudice
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour 

From druzus at priv.onet.pl  Thu May  3 14:19:10 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 14:19:46 2007
Subject: [Harbour] Ask Harbour Compiler
In-Reply-To: <BAY137-F11953A3B0F19C7168C23B085410@phx.gbl>
References: <529264.14712.qm@web55015.mail.re4.yahoo.com>
	<BAY137-F11953A3B0F19C7168C23B085410@phx.gbl>
Message-ID: <20070503181910.GA11997@localhost.localdomain>

On Thu, 03 May 2007, Alejandro de Garate wrote:
> Hi,
> My name is Anton from Indonesia and allow me to ask you about harbour. I 
> use Linux Ubuntu and finally..... I get success to compile a single program 
> with harbour. Now I have 30 PRG file and use Foxpro Database. Among the PRG 
> there is a function and procedure. My questions are :
> 1. How to compile 30 PRG became one executable file?

I guess compile and link.

    hbcmp file1.prg
    hbcmp file2.prg
    ...
    hbcmp file30.prg
    hblnk file1 file2 ... file30

> 1. How the way to compile my 'function' PRG became lib.a ??

static library:
    ar a mylib file1.o file2.o ...
shared library:
    hb-mkslib.sh myshlib mylib1.a ... mylibN.a obj1.o ... objN.o

> 2. How to use that lib.a ??

link it with your binaries (hblnk) using -l option. If you want to make
shared library global for whole system then read documentation to ldconfig,
f.e.:
    man ldconfig

> 3. How the way to connected file DBF with executable PRG (after compile 
> with harbour)??

I do not understand what "connected file DBF with executable PRG"
means.
If you want to open DBF file then simply use USE command.
If you want to create some DBFs then use dbCreate() function. Please
look at Clipper documentation (you will find it in the Internet) for
syntax details (please note that linux uses case sensitive file systems).
If you want to create some distribution packages then you should look
at your distribution descrpition, f.e. how to create RPM or DEB files,
Ubuntu is Debian basesed Linux distribution so you should look at DEB
files.

best regards,
Przemek
From harbour at rglab.pl  Thu May  3 16:52:07 2007
From: harbour at rglab.pl (=?iso-8859-2?Q?Ryszard_G=B3=B1b?=)
Date: Thu May  3 16:52:35 2007
Subject: [Harbour] Where I commit BMDBFCDX ?
References: <46398BEB.2010304@marchuet.net> <4639A13D.3010105@dbtopas.lt>
Message-ID: <f874bba439af4b227c4df48770d0a5bb.qmail@home.pl>

Mindaugas Kavaliauskas <dbtopas@dbtopas.lt> napisa?(a):

> if bmdbfcdx is modified copy of dbfcdx, when contrib is best place for 
> it.
> I'm not sure if we need one more copy of the same code (with some 
> appedices) at all. I think separation BM functionality into separate RDD 
> 
> would be much better idea.

  
I agree completly here. contrib is the only place for duplicated code.

Regards, Ryszard

From harbour.01 at syenar.hu  Thu May  3 17:47:35 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu May  3 17:47:52 2007
Subject: [Harbour] Where I commit BMDBFCDX ?
In-Reply-To: <46398BEB.2010304@marchuet.net>
References: <46398BEB.2010304@marchuet.net>
Message-ID: <D8F2A7EE-5A64-4E93-A5B4-47AABDC5AD23@syenar.hu>

Hi Miguel,

Since it doesn't fit into Harbour's RDD inheriting scheme,
pls upload it to contrib.

Brgds,
Viktor

On 2007.05.03., at 9:14, Miguel Angel Marchuet wrote:

> It works exactly as harbour DBFCDX when SET OPTIMIZE OFF
> and works as CLipper 5.3b DBFCDX when SET OPTIMIZE ON. (too BMSIXCDX)
>
> 1.- I can upload it to Contrib
> 2.- As new RDD in source/rdd/bmdbfcdx (as xharbour)
> 3.- Substitute actual DBFCDX
>
> I remain that has the same code as DBFCDX, only has modifications
> to run static bitmap filters when SET OPTIMIZE ON.
>
>
> Best regards,
> Miguel Angel Marchuet
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Thu May  3 19:04:23 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May  3 19:04:59 2007
Subject: [Harbour] gtxwc inkey(0) under fc7-test4 eats 100% cpu
In-Reply-To: <9257026e0705030603y5a1a66t1a741c96cd522056@mail.gmail.com>
References: <9257026e0705020713v5f3abdbaucae57502f726a584@mail.gmail.com>
	<20070503105636.GB461@localhost.localdomain>
	<9257026e0705030603y5a1a66t1a741c96cd522056@mail.gmail.com>
Message-ID: <20070503230423.GA3589@localhost.localdomain>

On Thu, 03 May 2007, Lorenzo Fiorini wrote:
> I've removed nanosleeep and left only:
> ...
> #elif defined(HB_OS_UNIX)
> 
>   {
>      struct timeval tv;
>      tv.tv_sec = 0;
>      tv.tv_usec = 1000;
>      select( 0, NULL, NULL, NULL, &tv );
>   }
> and it works like a charm. Is it correct?

Yes it is though maybe we should use:
      tv.tv_usec = 10000;
for two reasons:

1. we do not need such short time interval for sleep/wakeup when
   process is waiting for a key in inkey(0). 10 milliseconds is
   fast enough and it's much shorter then fastest keyboard and
   writer ;-)
   Please note that it always consume some CPU cycles. If you will
   have 50 clients then even if it will not be notices in programs
   like 'top' then such repeated sleep/wakeup may cause noticeable
   overhead.
2. 100HZ is the most often used kernel interrupt frequency in older
   *nixes and maybe some of them can round smaller timeout value
   in select() down what will cause immediate leaving from this
   function. IMHO it will be safer to set default to not less then
   10000 microseconds.

BTW In my programs I'm using my own code which uses select() with timeval
set to NULL and with fields read/write descriptors table for possible
input/output so when they are waiting for keys or some other events
they do not consume even single CPU cycle. But this code is not Clipper
compatible so I'm not committing to CVS. In GTCRS you can see how such
system can be implemented.

best regards,
Przemek
From fmancera at viaopen.com  Thu May  3 20:44:44 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Thu May  3 20:45:23 2007
Subject: [Harbour] Encrypt and DeCrypt DBF
Message-ID: <001401c78de5$691af4f0$3e02a8c0@PORTATIL>

Hello,

Is possible Encryp/Decrypt a DBF in Harbour?

I remember that with SIX3 it was possible, but not if is implemented in
Harbour.

Best Regards,

Fernando Mancera

From philb at philb.us  Fri May  4 00:27:35 2007
From: philb at philb.us (Phil Barnett)
Date: Fri May  4 00:27:39 2007
Subject: [Harbour] Julian date functions
In-Reply-To: <20070503111401.GA1189@localhost.localdomain>
References: <200704290305.20241.philb@philb.us>
	<20070503111401.GA1189@localhost.localdomain>
Message-ID: <200705040027.35342.philb@philb.us>

On Thursday 03 May 2007 07:14, Przemyslaw Czerpak wrote:

> Thank you for your proposition but we will need them on C level
> and we already have Julian date functions so we will only have
> to add support for time part. Anyhow some people who used these
> functions in Clipper can be interesting in porting them to Harbour
> so they will operate on new timeval items. it may greatly help in
> data sharing.

Ok, I wasn't thinking. Here's the C version from long ago.

Sorry for the confusion.

-- 
Phil Barnett
AI4OF
SKCC #600
-------------- next part --------------
A non-text attachment was scrubbed...
Name: prb_julc.zip
Type: application/x-zip
Size: 5837 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070504/3e852f4b/prb_julc-0001.bin
From miguelangel at marchuet.net  Fri May  4 04:21:13 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Fri May  4 04:21:14 2007
Subject: [Harbour] 2007-05-04 10:15 UTC+0100 Miguel Angel Marchuet
	(miguelangel/at/marchuet.net)
Message-ID: <463AECF9.2070701@marchuet.net>

2007-05-04 10:15 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  + contrib/bmdbfcdx/Makefile
  + contrib/bmdbfcdx/bmdbfcdx1.c
  + contrib/bmdbfcdx/bmsixcdx1.c
  + contrib/bmdbfcdx/hbrddbmcdx.h
  + contrib/bmdbfcdx/make_b32.bat
  + contrib/bmdbfcdx/makefile.bc
  + contrib/bmdbfcdx/readme.txt
    + BMDBFCDX RDD:

      Is a DBFCDX RDD compatible with clipper 5.3, use SET OPTIMIZE ON to make a
     static bitmap filters, with SET OPTIMIZE OFF works as harbour DBFCDX.

     Addons:

     BM_DbSeekWild( uKey, [lSoftSeek], [lFindLast], [lNext], [lAll] ) => .T./.F. or aSeekRec when lAll clause
     BM_Turbo( lOnOff ) // Is only recomendable to use it on creating FILTERS
     BM_DbGetFilterArray() => aFilterRec
     BM_DbSetFilterArray( aFilterRec )
     BM_DbSetFilterArrayAdd( aFilterRec )
     BM_DbSetFilterArrayDel( aFilterRec )

     Respecting command:

    SET OPTIMIZE
    Change the setting that determines whether to optimize using the open orders
    when processing a filtered database file
    ------------------------------------------------------------------------------
    Syntax

     SET OPTIMIZE ON | OFF | (<lToggle>)

     Arguments

     ON enables optimization.

     OFF disables optimization.

     <lToggle> is a logical expression that must be enclosed in
     parentheses.  A value of true (.T.) is the same as ON, and a value of
     false (.F.) is the same as OFF.

     Note:  The initial default of this setting depends on the RDD.

    Description

     For RDDs that support optimization, such as BMDBFCDX, SET OPTIMIZE
     determines whether to optimize filters based on the orders open in the
     current work area.  If this flag is ON, the RDD will optimize the search
     for records that meet the filter condition to the fullest extent
     possible, minimizing the need to read the actual data from the database
     file.

     If this flag is OFF, the RDD will not optimize.

    Examples

     ?  The following example enables optimization for the Inventor
        database file using the SET OPTIMIZE command:

        USE Inventor NEW VIA "BMDBFCDX"
        SET OPTIMIZE ON
From miguelangel at marchuet.net  Fri May  4 05:10:16 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Fri May  4 05:10:02 2007
Subject: [Harbour] 2007-05-04 11:06 UTC+0100 Miguel Angel Marchuet
	(miguelangel/at/marchuet.net)
Message-ID: <463AF878.7050502@marchuet.net>


2007-05-04 11:06 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * source/rdd/wafunc.c
    * change of the behavior of DbUseArea opening, so that one behaves like made Clipper, when it fails the
      opening of a table, does not recover the previous area.

Best regards,
Miguel Angel Marchuet
From druzus at priv.onet.pl  Fri May  4 08:35:56 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May  4 08:36:32 2007
Subject: [Harbour] 2007-05-04 11:06 UTC+0100 Miguel Angel Marchuet
	(miguelangel/at/marchuet.net)
In-Reply-To: <463AF878.7050502@marchuet.net>
References: <463AF878.7050502@marchuet.net>
Message-ID: <20070504123556.GA12383@localhost.localdomain>

On Fri, 04 May 2007, Miguel Angel Marchuet wrote:
> 2007-05-04 11:06 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
>   * source/rdd/wafunc.c
>     * change of the behavior of DbUseArea opening, so that one behaves like made Clipper, when it fails the
>       opening of a table, does not recover the previous area.

Miguel this was not correct modification.
We are still not Clipper compatible (I'm attaching test code) and
now on failure dbUseArea() leave open work area so functions like
used() will return true.
I'll commit fix with much more close to Clipper behavior in a while.
If you will borrow it to xHarbour then please remember that 0 WA has
special meaning and it's used to avoid race condition between threads
in commands like USE ... NEW - I left note about it for you.
Personally I think that in xHarbour like MT model where workareas are
shared between threads replicating exact Clipper behavior is not good
idea. Just simply after USE ... NEW which failed current work area
maybe the work area just allocated by other thread. WA save/restore
in dbUseArea() and special usage of 0 WA was added to RDD code for MT
mode.

best regards
Przemek
-------------- next part --------------
#define EOL chr(13)+chr(10)
#command ? [<x,...>] => outstd(EOL)[;outstd(<x>)]
proc main()
   ? OS(), VERSION()
   if !file("_tst.dbf")
      dbCreate("_tst",{{"F1","C",1,0}})
   endif
   if !file("_tst2.dbf")
      dbCreate("_tst2",{{"F1","C",1,0}})
   endif

   USE _tst NEW ALIAS "ONE" EXCLUSIVE
   ? select(), alias(), netErr(), used()
   ?

   mkTest( .T., "NORDD",, "TWO", .T., .F. )
   mkTest( .T., "DBF",, "TWO", .T., .F. )
   mkTest( .T., "DBF", "", "TWO", .T., .F. )
   mkTest( .T., "DBF", "nofile", "TWO", .T., .F. )
   mkTest( .T., "DBF", "_tst2", "ONE", .T., .F. )
   mkTest( .T., "DBF", "_tst", "ONE", .T., .F. )
   mkTest( .T., "DBF", "_tst", "TWO", .T., .F. )
   ?
   dbUseArea( .T., "DBF", "_tst", "ONE", .T., .F. )
   ? select(), alias(), netErr(), used()
   dbUseArea( .T., "DBF", "_tst", "TWO", .T., .F. )
   ? select(), alias(), netErr(), used()
   ?
   dbSelectArea( 1 )
   mkTest( .F., "NORDD",, "TWO", .T., .F. )
   ?
return

proc mkTest( lNewArea, cRdd, cFile, cAlias, lShared, lReadOnly )
local cbErr:=errorBlock({|oErr|break(oErr)}), oErr
netErr(.f.)
begin sequence
   dbUseArea( lNewArea, cRdd, cFile, cAlias, lShared, lReadOnly )
recover using oErr
   ? "Error:", oErr:subCode, oErr:description, oErr:operation, oErr:osCode
end
? select(), alias(), netErr(), used()
errorBlock(cbErr)
return
From druzus at priv.onet.pl  Fri May  4 09:37:52 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May  4 09:38:29 2007
Subject: [Harbour] ChangeLog 2007-05-04 15:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070504133752.GA18990@localhost.localdomain>

2007-05-04 15:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/contrib/Makefile
  * harbour/contrib/bmdbfcdx/Makefile
  * harbour/source/rdd/Makefile
    ! fixed GNU make compilation

  * harbour/include/hbapifs.h
  * harbour/source/rtl/filesys.c
    + added support for DOS/Windows DENY_* flag emulation in POSIX
      systems using BSD locks. So far such emulatin was done with
      standard POSIX locks. The new emulation can be enabled by setting
      HB_USE_BSDLOCKS and disabled by HB_USE_BSDLOCKS_OFF. By default
      it's enabled in Linux and BSD* based systems.
      Please not that it BSD locks work in differ way then POSIX ones.
      They are bound with file handle and process ID not i-node and PID.
      It will allow to synchronize even single process but it will not
      work in NFS and some old BSD and Linux kernels. This synchronization
      cannot be used also between different platforms. If someone needs
      such synchronization then he should build Harbour on all platforms
      with HB_USE_BSDLOCKS_OFF and HB_USE_SHARELOCKS with valid multi
      platform lock offset

  * harbour/source/rdd/dbcmd.c
    * removed all explicit NETERR setting - now it can be set only
      by NETERR() function (executed by default errorsys)
    * changed ordListAdd()/dbSetIndex() - now they return logical value
      with information about success

  * harbour/source/rdd/wafunc.c
    * changed hb_rddOpenTable()/hb_rddCreateTable() to make dbUseArea()/
      dbCreate() more Clipper compatible - it's not exact Clipper behavior
      but I intentionally do not want to replicate some strange for me
      things, f.e. I do not know why Clipper ignores RDDNAME when it has
      only one character

  + harbour/tests/tstuse.prg
    + test code for dbUseArea()

best regards,
Przemek
From miguelangel at marchuet.net  Fri May  4 10:30:16 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Fri May  4 10:30:08 2007
Subject: [Harbour] 2007-05-04 11:06 UTC+0100 Miguel Angel
	Marchuet	(miguelangel/at/marchuet.net)
In-Reply-To: <20070504123556.GA12383@localhost.localdomain>
References: <463AF878.7050502@marchuet.net>
	<20070504123556.GA12383@localhost.localdomain>
Message-ID: <463B4378.6030907@marchuet.net>

Thank's Prezmek, I will try to solve all situations.
and upload solved.

Best regards,
Miguel Angel Marchuet

Przemyslaw Czerpak escribi?:
> On Fri, 04 May 2007, Miguel Angel Marchuet wrote:
>> 2007-05-04 11:06 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
>>   * source/rdd/wafunc.c
>>     * change of the behavior of DbUseArea opening, so that one behaves like made Clipper, when it fails the
>>       opening of a table, does not recover the previous area.
> 
> Miguel this was not correct modification.
> We are still not Clipper compatible (I'm attaching test code) and
> now on failure dbUseArea() leave open work area so functions like
> used() will return true.
> I'll commit fix with much more close to Clipper behavior in a while.
> If you will borrow it to xHarbour then please remember that 0 WA has
> special meaning and it's used to avoid race condition between threads
> in commands like USE ... NEW - I left note about it for you.
> Personally I think that in xHarbour like MT model where workareas are
> shared between threads replicating exact Clipper behavior is not good
> idea. Just simply after USE ... NEW which failed current work area
> maybe the work area just allocated by other thread. WA save/restore
> in dbUseArea() and special usage of 0 WA was added to RDD code for MT
> mode.
> 
> best regards
> Przemek
> 
> 
> ------------------------------------------------------------------------
> 
> #define EOL chr(13)+chr(10)
> #command ? [<x,...>] => outstd(EOL)[;outstd(<x>)]
> proc main()
>    ? OS(), VERSION()
>    if !file("_tst.dbf")
>       dbCreate("_tst",{{"F1","C",1,0}})
>    endif
>    if !file("_tst2.dbf")
>       dbCreate("_tst2",{{"F1","C",1,0}})
>    endif
> 
>    USE _tst NEW ALIAS "ONE" EXCLUSIVE
>    ? select(), alias(), netErr(), used()
>    ?
> 
>    mkTest( .T., "NORDD",, "TWO", .T., .F. )
>    mkTest( .T., "DBF",, "TWO", .T., .F. )
>    mkTest( .T., "DBF", "", "TWO", .T., .F. )
>    mkTest( .T., "DBF", "nofile", "TWO", .T., .F. )
>    mkTest( .T., "DBF", "_tst2", "ONE", .T., .F. )
>    mkTest( .T., "DBF", "_tst", "ONE", .T., .F. )
>    mkTest( .T., "DBF", "_tst", "TWO", .T., .F. )
>    ?
>    dbUseArea( .T., "DBF", "_tst", "ONE", .T., .F. )
>    ? select(), alias(), netErr(), used()
>    dbUseArea( .T., "DBF", "_tst", "TWO", .T., .F. )
>    ? select(), alias(), netErr(), used()
>    ?
>    dbSelectArea( 1 )
>    mkTest( .F., "NORDD",, "TWO", .T., .F. )
>    ?
> return
> 
> proc mkTest( lNewArea, cRdd, cFile, cAlias, lShared, lReadOnly )
> local cbErr:=errorBlock({|oErr|break(oErr)}), oErr
> netErr(.f.)
> begin sequence
>    dbUseArea( lNewArea, cRdd, cFile, cAlias, lShared, lReadOnly )
> recover using oErr
>    ? "Error:", oErr:subCode, oErr:description, oErr:operation, oErr:osCode
> end
> ? select(), alias(), netErr(), used()
> errorBlock(cbErr)
> return
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From miguelangel at marchuet.net  Fri May  4 11:50:34 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Fri May  4 11:50:18 2007
Subject: [Harbour] 2007-05-04 11:06 UTC+0100 Miguel
	Angel	Marchuet	(miguelangel/at/marchuet.net)
In-Reply-To: <463B4378.6030907@marchuet.net>
References: <463AF878.7050502@marchuet.net>	<20070504123556.GA12383@localhost.localdomain>
	<463B4378.6030907@marchuet.net>
Message-ID: <463B564A.8010301@marchuet.net>

I solved yet all situations, except 2
this are the results:

Clipper:
DOS 5.00 Clipper (R) 5.3b Intl. (Rev. 338) (1997.04.25)
         1 ONE .F. .T.

Error:       1015 Argument error DBUSEAREA          0
         2  .F. .F.
Error:       1005 Argument error DBUSEAREA          0
         2  .F. .F.
Error:       1001 Open error           2
         2  .F. .F.
Error:       1001 Open error           2
         2  .F. .F.
Error:       1011 Alias already in use ONE          0
         2  .F. .F.
Error:       1001 Open error          32
         2  .F. .F.
Error:       1001 Open error          32
         2  .F. .F.

         2  .T. .F.
         2  .T. .F.

Error:       1015 Argument error DBUSEAREA          0
         1  .F. .F.

Harbour:
Windows 2000 5.0.2195 Service Pack 4 Harbour devel build 1.1-0 Intl.
         1 ONE .F. .T.

Error:       1015 Argument error DBUSEAREA          0
         2  .F. .F.
Error:       1005 Argument error DBUSEAREA          0
         2  .F. .T.
Error:       1001 Open error           2
         2  .T. .T.
Error:       1001 Open error           2
         2  .T. .T.
Error:       1011 Alias already in use ONE          0
         2  .T. .T.
Error:       1001 Open error          32
         2  .T. .T.
Error:       1001 Open error          32
         2  .T. .T.

         3  .T. .F.
         3  .T. .F.

Error:       1015 Argument error DBUSEAREA          0
         1  .F. .F.

If do you want, i can upload this modifications.

Best regards,
Miguel Angel Marchuet

Miguel Angel Marchuet escribi?:
> Thank's Prezmek, I will try to solve all situations.
> and upload solved.
> 
> Best regards,
> Miguel Angel Marchuet
> 
> Przemyslaw Czerpak escribi?:
>> On Fri, 04 May 2007, Miguel Angel Marchuet wrote:
>>> 2007-05-04 11:06 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
>>>   * source/rdd/wafunc.c
>>>     * change of the behavior of DbUseArea opening, so that one behaves like made Clipper, when it fails the
>>>       opening of a table, does not recover the previous area.
>> Miguel this was not correct modification.
>> We are still not Clipper compatible (I'm attaching test code) and
>> now on failure dbUseArea() leave open work area so functions like
>> used() will return true.
>> I'll commit fix with much more close to Clipper behavior in a while.
>> If you will borrow it to xHarbour then please remember that 0 WA has
>> special meaning and it's used to avoid race condition between threads
>> in commands like USE ... NEW - I left note about it for you.
>> Personally I think that in xHarbour like MT model where workareas are
>> shared between threads replicating exact Clipper behavior is not good
>> idea. Just simply after USE ... NEW which failed current work area
>> maybe the work area just allocated by other thread. WA save/restore
>> in dbUseArea() and special usage of 0 WA was added to RDD code for MT
>> mode.
>>
>> best regards
>> Przemek
>>
>>
>> ------------------------------------------------------------------------
>>
>> #define EOL chr(13)+chr(10)
>> #command ? [<x,...>] => outstd(EOL)[;outstd(<x>)]
>> proc main()
>>    ? OS(), VERSION()
>>    if !file("_tst.dbf")
>>       dbCreate("_tst",{{"F1","C",1,0}})
>>    endif
>>    if !file("_tst2.dbf")
>>       dbCreate("_tst2",{{"F1","C",1,0}})
>>    endif
>>
>>    USE _tst NEW ALIAS "ONE" EXCLUSIVE
>>    ? select(), alias(), netErr(), used()
>>    ?
>>
>>    mkTest( .T., "NORDD",, "TWO", .T., .F. )
>>    mkTest( .T., "DBF",, "TWO", .T., .F. )
>>    mkTest( .T., "DBF", "", "TWO", .T., .F. )
>>    mkTest( .T., "DBF", "nofile", "TWO", .T., .F. )
>>    mkTest( .T., "DBF", "_tst2", "ONE", .T., .F. )
>>    mkTest( .T., "DBF", "_tst", "ONE", .T., .F. )
>>    mkTest( .T., "DBF", "_tst", "TWO", .T., .F. )
>>    ?
>>    dbUseArea( .T., "DBF", "_tst", "ONE", .T., .F. )
>>    ? select(), alias(), netErr(), used()
>>    dbUseArea( .T., "DBF", "_tst", "TWO", .T., .F. )
>>    ? select(), alias(), netErr(), used()
>>    ?
>>    dbSelectArea( 1 )
>>    mkTest( .F., "NORDD",, "TWO", .T., .F. )
>>    ?
>> return
>>
>> proc mkTest( lNewArea, cRdd, cFile, cAlias, lShared, lReadOnly )
>> local cbErr:=errorBlock({|oErr|break(oErr)}), oErr
>> netErr(.f.)
>> begin sequence
>>    dbUseArea( lNewArea, cRdd, cFile, cAlias, lShared, lReadOnly )
>> recover using oErr
>>    ? "Error:", oErr:subCode, oErr:description, oErr:operation, oErr:osCode
>> end
>> ? select(), alias(), netErr(), used()
>> errorBlock(cbErr)
>> return
>>
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> Harbour mailing list
>> Harbour@harbour-project.org
>> http://lists.harbour-project.org/mailman/listinfo/harbour
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From teo at windtelsoft.com  Fri May  4 17:54:39 2007
From: teo at windtelsoft.com (Teo Fonrouge)
Date: Fri May  4 17:54:47 2007
Subject: [Harbour] Bug & Fix on source/rtl/tget.prg
Message-ID: <200705041654.40086.teo@windtelsoft.com>

Hello,

There is a small bug in the tget.prg. I notice this because this bug prevents 
the debugger to start ok.

Here is the diff:

/* start diff */
@@ -339,7 +339,8 @@
 
 METHOD ColorDisp( cColorSpec ) CLASS Get
 
-   ::ColorSpec( cColorSpec ):Display()
+   ::ColorSpec( cColorSpec )
+   ::Display()
 
 return Self
/* end diff */

Please someone with write access granted to the CVS kindly submit this patch.


best regards

Teo Fonrouge
From antonioharbour at gmail.com  Sat May  5 04:30:00 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sat May  5 04:30:17 2007
Subject: [Harbour] Changelog 2007-05-05 10:28 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <463c4092.2d3a2378.2a26.ffffb55c@mx.google.com>

2007-05-05 10:28 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * Improved formatting and xharbour compatibility

Regards,

Antonio

From harbour.01 at syenar.hu  Sat May  5 06:10:00 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat May  5 06:10:03 2007
Subject: [Harbour] CHANGELOG: 2007-05-05 12:08 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c78efd$Blat.v2.6.1$8a9fc4e8$138ce09f4792@127.0.0.1>

2007-05-05 12:08 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/tget.prg
     ! Fixed a recently introduced crash in Get():ColorDisp().
       (Thanks to Teo Fonrouge)

From lorenzo.fiorini at gmail.com  Sat May  5 07:47:40 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May  5 07:47:46 2007
Subject: [Harbour] HB_PCRE_REGEX build issue and memory leak
Message-ID: <9257026e0705050447x6f09a0b1w5226fd13e0b772a9@mail.gmail.com>

To build with HB_PCRE_REGEX under Fedora 7 I have to replace
pcre/pcre.h with pcre.h in hbregex.h and with this test:

procedure main()

  ? iif( hb_regex( "it", "is it in it?" ) != nil, "yes", "no" )

return

I get:

Memory Allocation Report : Application => ./testrgx1
  Application terminated at : 2007.05.05 13:45:03
Total memory allocated: 33949 bytes (570 block(s))
WARNING! Memory allocated but not released: 52 bytes (1 block(s))
Block 1 0x9cd9f98 (size 48) HB_REGEX(0),
")8)F,D09)8)F,D09/044080801000200-8*0,D09(C000000(C000000,6020101-0)F,D09000000000000000008000000"
------------------------------------------------------------------------

Any suggestion?

regards,
Lorenzo
From niki at synel.co.il  Sun May  6 04:16:11 2007
From: niki at synel.co.il (Chen Kedem)
Date: Sun May  6 04:16:20 2007
Subject: [Harbour] SF bugtracker#1635288: MLCTOPOS incompatibility
Message-ID: <463D8ECB.15F8@synel.co.il>

http://sourceforge.net/tracker/index.php?func=detail&aid=1635288&group_id=681&atid=100681

MLCTOPOS() is wrong, here is a patch which I think make it more
compatibe and fix wrong parameter check:

*** DIFF Start ***
--- source/rtl/mlctopos.c    Wed Jan 30 11:27:40 2002
+++ /tmp/newver/mlctopos.c   Sun May 06 11:02:18 2007
@@ -61,9 +61,9 @@
    ULONG  ulTabLength  = ISNUM( 5 ) ? hb_parni( 5 ) : 4;
    ULONG  ulLastSpace  = 0;
    ULONG  ulCurLength  = 0;
-   BOOL   bWordWrap    = ISLOG( 5 ) ? hb_parl( 5 ) : TRUE;
+   BOOL   bWordWrap    = ISLOG( 6 ) ? hb_parl( 6 ) : TRUE;
    ULONG  ulLen        = hb_parclen( 1 );
-   ULONG  ulLines      = 0;
+   ULONG  ulLines      = 1;
    ULONG  ulPos;
    ULONG  ulBegOfLine  = 0;
    ULONG  ulLastLen    = 0;
@@ -124,7 +124,6 @@

    if( ulCurLength > 0 )
    {
-      ulLines++;
       ulBegOfLine = ulPos - ulCurLength;
       ulLastLen   = ulCurLength ;
    }
@@ -132,7 +131,7 @@
    if( ulLine == ulLines )
    {
       ulLastLen--;   /* Column is zero based */
-      hb_retnl( ulBegOfLine + ( ( ulCol < ulLastLen ) ? ulCol : ulLastLen ) );
+      hb_retnl( ulBegOfLine + 1 + ( ( ulCol < ulLastLen ) ? ulCol : ulLastLen ) );
    }
    else
       hb_retnl( ulLen );
**** DIFF End ****

Here is a sample program:

--tt36.prg--
proc main
?  "(Clipper 11, Harbour 26) "
?? MLCTOPOS( 'A message from our founder', 10, 2, 0 )
?
?  "(Clipper 6, Harbour 26) "
?? MLCTOPOS( 'A message from our founder', 5, 2, 0, 4, .F. )
?
?  "(Clipper 3, Harbour 26) "
?? MLCTOPOS( 'A'+CHR(9)+'message'+CHR(9)+'from'+CHR(9)+'our'+CHR(9)+'founder', 10, 2, 0, 8 )
?
?  "(Clipper 10, Harbour 45) "
?? MLCTOPOS( 'Note the side on whith the bread is buttered.', 5, 3, 0 )
return
------------

I can patch it myself, but I don't know if it covers all possible
options. Some tests in HBTEST would be nice.


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From yamamoto at rocketmail.com  Sun May  6 05:36:20 2007
From: yamamoto at rocketmail.com (Mitja Podgornik)
Date: Sun May  6 05:36:55 2007
Subject: [Harbour] hb_randseed BUG
Message-ID: <430616.26437.qm@web30710.mail.mud.yahoo.com>

../source/rtl/hbrandom.c

Please, can somebody correct the line in HB_FUNC( HB_RANDOMSEED )

from 
  srand( ISNUM(1) ? (unsigned) time(NULL) : (unsigned) hb_parni(1) );
to 
  srand( ISNUM(1) ? (unsigned) hb_parni(1) : (unsigned) time(NULL) );

hb_randseed()       => time value is used as seed value
hb_randseed(nSeed)  => nSeed is used as seed value


Regards, 
Mitja Podgornik


 
____________________________________________________________________________________
It's here! Your new message!  
Get new email alerts with the free Yahoo! Toolbar.
http://tools.search.yahoo.com/toolbar/features/mail/
From harbour.01 at syenar.hu  Sun May  6 05:43:43 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sun May  6 05:43:39 2007
Subject: [Harbour] CHANGELOG: 2007-05-06 11:42 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c78fc3$Blat.v2.6.1$09199176$12c897804dfe@127.0.0.1>

2007-05-06 11:42 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/hbrandom.c
     ! HB_RANDOMSEED() fixed to correctly handle passed parameter.
       (Thanks to Mitja Podgornik)

From dmacias at mail.udg.mx  Sun May  6 05:48:15 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Sun May  6 05:48:18 2007
Subject: [Harbour] Re: Mysql wrapper problems
In-Reply-To: <142368.22221.qm@web30704.mail.mud.yahoo.com>
References: <142368.22221.qm@web30704.mail.mud.yahoo.com>
Message-ID: <463DA45F.9020005@mail.udg.mx>

Mitja send me message included below

I was searching for problem but can not resolve it

Any one have hints/solutions ?

Changes refered by Mitja for__CSLADDMSG()  and related were made by 
Przemek between 3 - 11 September 2006

changelog.016
----------------------------------
2006-09-03 16:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
...
  * harbour/source/vm/classes.c
...
    ! added basic parameter validation to __CLSADDMSG() to avoid some
      possible strange behavior at runtime when broken messages are
      defined.
----------------------------------


Perhaps problem rely around:
-------------------------------------------
  * harbour/include/hboo.ch
    + added: HB_OO_MSG_ASSIGN, HB_OO_MSG_ACCESS,
             HB_OO_MSG_CLSASSIGN, HB_OO_MSG_CLSACCESS
-------------------------------------------

and source\rtl\objfunc.prg
-------------------------------------------
FUNCTION __objAddData( oObject, cSymbol )
...
(next is line 214 refered in error message)
      __clsAddMsg( hClass,       cSymbol, nSeq, HB_OO_MSG_ACCESS, NIL, 1 )
-------------------------------------------

and source\vm\classes.c
( case HB_OO_MSG_ASSIGN: does nothing on fOK )
-------------------------------------------
static BOOL hb_clsAddMsg( USHORT uiClass, const char * szMessage,
                          USHORT uiType, USHORT uiScope,
                          PHB_ITEM pFunction, PHB_ITEM pInit )
...
      BOOL     fOK;
...
      /* basic parameter validation */
      switch( uiType )
...
         case HB_OO_MSG_ASSIGN:
         case HB_OO_MSG_ACCESS:
...
         default:
            fOK = FALSE;
...
      if( !fOK )
      {
         hb_errRT_BASE( EG_ARG, 3000, NULL, &hb_errFuncName, 
HB_ERR_ARGS_BASEPARAMS );
         return FALSE;
      }
-------------------------------------------


David Macias


Mitja Podgornik wrote:
> Hi David!
>
> I saw, that You was the latest person, who modified Tmysql.prg code
>
> Recently I switched from an old Harbour build (nov.2004) to new build.
> With new build I get this error with mysql wrapper (contrib\tmysql):
>
>   Error BASE/3000 Argument error: __CLSADDMSG
>   Called from __CLSADDMSG(0)
>   Called from __OBJADDDATA(214)
>   Called from TMYSQLQUERY:NEW(401)
>   Called from TMYSQLTABLE:NEW(854)
>   Called from TMYSQLSERVER:QUERY(1670)
>   Called from MAIN ...
>
>   On line 401 in ../contrib/tmysql.prg is:
>       __ObjAddData(Self,::aFieldStruct[nI][MYSQL_FS_NAME])
>
>      second parameter should be field name and is OK
>
> Here is sample program that produces this error. Actualy every "SELECT"
> crashes the same way. 
>
> Are You so kind and take a look for this part of code. I don't know,
> where to start...
> In year 2006 there were some modifications of __CSLADDMSG() accordingly
> to changelog.
>
> Sincerely,
>
> Mitja Podgornik
>
> /*-----------------------------------------------*/
>
> static oServer, oQuery
>
> proc main()
>
> oServer:=TMySQLServer():New("www.freesql.org", "harbour", "harbour" )
>
> if oServer:NetErr() 
>   ? oServer:Error()
>   return nil
> endif
>
> // here it happens...
> oQuery:=oServer:Query("SELECT field1, field2 FROM harbour.test")
> if oServer:NetErr() 
>   ? oServer:Error()
>   return nil
> endif 
>
> oQuery:destroy()
>
> return nil
>
>
>   

From druzus at priv.onet.pl  Sun May  6 09:26:29 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun May  6 09:27:04 2007
Subject: [Harbour] Re: Mysql wrapper problems
In-Reply-To: <463DA45F.9020005@mail.udg.mx>
References: <142368.22221.qm@web30704.mail.mud.yahoo.com>
	<463DA45F.9020005@mail.udg.mx>
Message-ID: <20070506132629.GA10366@localhost.localdomain>

On Sun, 06 May 2007, David Arturo Macias Corona wrote:
> Mitja send me message included below
> I was searching for problem but can not resolve it
> Any one have hints/solutions ?
> Changes refered by Mitja for__CSLADDMSG()  and related were made by 
> Przemek between 3 - 11 September 2006
> changelog.016
> ----------------------------------
> 2006-09-03 16:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> ...
>  * harbour/source/vm/classes.c
> ...
>    ! added basic parameter validation to __CLSADDMSG() to avoid some
>      possible strange behavior at runtime when broken messages are
>      defined.
> ----------------------------------
> Perhaps problem rely around:
> -------------------------------------------
>  * harbour/include/hboo.ch
>    + added: HB_OO_MSG_ASSIGN, HB_OO_MSG_ACCESS,
>             HB_OO_MSG_CLSASSIGN, HB_OO_MSG_CLSACCESS
> -------------------------------------------
> 
> and source\rtl\objfunc.prg
> -------------------------------------------
> FUNCTION __objAddData( oObject, cSymbol )
> ...
> (next is line 214 refered in error message)
>      __clsAddMsg( hClass,       cSymbol, nSeq, HB_OO_MSG_ACCESS, NIL, 1 )
> -------------------------------------------
> 
> and source\vm\classes.c
> ( case HB_OO_MSG_ASSIGN: does nothing on fOK )

It does sth - check how switch/case works in C

> -------------------------------------------
> static BOOL hb_clsAddMsg( USHORT uiClass, const char * szMessage,
>                          USHORT uiType, USHORT uiScope,
>                          PHB_ITEM pFunction, PHB_ITEM pInit )
> ...
>      BOOL     fOK;
> ...
>      /* basic parameter validation */
>      switch( uiType )
> ...
>         case HB_OO_MSG_ASSIGN:
>         case HB_OO_MSG_ACCESS:
> ...
>         default:
>            fOK = FALSE;
> ...
>      if( !fOK )
>      {
>         hb_errRT_BASE( EG_ARG, 3000, NULL, &hb_errFuncName, 
> HB_ERR_ARGS_BASEPARAMS );
>         return FALSE;
>      }
> -------------------------------------------

This is correct code. But you can find a note I left:

         case HB_OO_MSG_ASSIGN:
         case HB_OO_MSG_ACCESS:
            uiIndex = ( USHORT ) hb_itemGetNI( pFunction );
            /* This validation can break buggy .prg code which wrongly
             * sets data offsets but IMHO it will help to clean the code.
             * [druzus]
             */
            fOK = uiIndex && uiIndex <= pClass->uiDatas - pClass->uiDataFirst;
            break;

and probably sth like that happens in this case.
The old classes code did not validate in practice anything and
many internal errors in calculating instance area offsets was hidden
by automatic instance area resizing, f.e. each object had one item
set to NIL at offset 1 due to typo in index calculation in rtl/tclass.prg
and this forced some other errors during inheritance (BTW this bug still
exists in xHarbour)
I cleaned all such situation but it will effect 3-rd party code which
tries to manipulate with class definition and also some other code like
functions in rtl/objfunc.prg, f.e.: __objAddData() never properly set
offsets. Now when I added offset validation and protection of inherited
instance area to make this function working with classes which inherited
some instance variables I will have to change __CLS_INCDATA() function
to return offset to new instance item not total number of instance items.
To make __CLS_DECDATA() similar I'll change it to return number of not
inherited instance variables. Anyhow please remember that __objDelData()
has never been working correctly. In practice this function can be executed
only for the last instance variable. In all other cases it will corrupt
class definition. I'll commit the modification in __CLS_INCDATA() and
__CLS_DECDATA() soon and it will probably resolve the problem but I strongly
suggest to clean code which uses these __obj*() functions to change class
definition - it's potentially very dangerous code which may not work as
expected and even corrupt class definition.

best regards,
Przemek
From druzus at priv.onet.pl  Sun May  6 10:16:39 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun May  6 10:17:14 2007
Subject: [Harbour] ChangeLog 2007-05-06 16:15 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070506141639.GB10366@localhost.localdomain>

2007-05-06 16:15 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/vm/classes.c
    * changed __cls_IncData() to return index to newly allocated instance
      item and __cls_DecData() to return number of local (not inherited)
      instance items

best regards,
Przemek
From druzus at priv.onet.pl  Sun May  6 11:01:17 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun May  6 11:01:52 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <46343D6B.6838@synel.co.il>
References: <46343D6B.6838@synel.co.il>
Message-ID: <20070506150117.GC10366@localhost.localdomain>

On Sun, 29 Apr 2007, Chen Kedem wrote:
> >> At the moment, I have one problem because index of paradox has
> >> more than one extension .px ant others :(
> > In Clipper's RDD such situation also exists. DBFCDX in CL52 and
> > SIXCDX can create .idx and .cdx indexes. I do not know paradox
> > but if you give me some more precise information about index
> > extensions then maybe I can suggest you some solutions. Now I do
> > not know what is the real problem.
> Paradox use the following file extensions:
> DB  = Main database file, once open it usually auto-open all the rest.
> MB  = Memo file.
> VAL = Validity checks and default values.
> PX  = Primary index.
> XGn = Secondary index - (Maintained, Case sensivive) key is one field
>                         "n" is the field number.
> YGn = Secondary index - (Maintained, Case sensivive) key is one field
>                         "n" is the field number.
> Xnn = Secondary index (other index type). "nn" is the index number.
> Ynn = Secondary index (other index type). "nn" is the index number.
> Apart from the DB all other files are optional
> (you must have a primary index before you can have a Secondary index).
> Secondary indices are paired X and Y.

Thank you for the information. So seems that the extensions are strictly
defined and cannot be managed by user I guess that the names have to be
the same as table name.
I think that we should accept Paradox restrictions to keep data integrity
and allow concurrent access so I do not see any problem with user interface
and only we should chose sth for ordBagExt() function.
I've just check that CL52 has DBPX RDD too so maybe we should try to
replicate its behavior and here ordBagExt() returns ".x??"

best regards,
Przemek
From antonioharbour at gmail.com  Sun May  6 12:11:05 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun May  6 12:11:17 2007
Subject: [Harbour] USRRDD UR_SETREL
Message-ID: <463dfe20.01dc5a55.2299.5b3e@mx.google.com>

Przemek,

We are trying to implement UR_SETREL member, and we get a GPF just here:

(source/rdd/dbcmd.c):

      SELF_SETREL( pArea, &dbRelations );

In the ADORDD we have this:

   aMyFunc[ UR_SETREL ]    := ( @ADO_SETREL() )

...

static function ADO_SETREL( nWA, aRelInfo )

   ? "SetRel"

return SUCCESS

So it GPFs before executing ADO_SETREL(). Any hints ?

Thanks,

Regards,

Antonio

From antonioharbour at gmail.com  Sun May  6 12:17:26 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun May  6 12:17:39 2007
Subject: [Harbour] RE: USRRDD UR_SETREL
Message-ID: <463dff9e.368785e7.6da8.ffffbba4@mx.google.com>

Przemek,

Its GPFing here:

hb_usrRelInfoToItem( pRelInfo );

Regards,

Antonio

From antonioharbour at gmail.com  Sun May  6 12:25:57 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun May  6 12:26:09 2007
Subject: [Harbour] RE: USRRDD UR_SETREL
Message-ID: <463e019c.06b651d4.39c5.ffffb2a2@mx.google.com>

Przemek,

The GPF comes from here:

   hb_itemPutNI( hb_arrayGetItemPtr( pItem, UR_RI_PARENT ),
pRelInfo->lpaParent->uiArea );

In usrrdd.c function hb_usrRelInfoToItem()

Regards,

Antonio

From antonioharbour at gmail.com  Sun May  6 12:36:07 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun May  6 12:36:24 2007
Subject: [Harbour] RE: USRRDD UR_SETREL
Message-ID: <463e03ff.4e158ec4.253f.0b6d@mx.google.com>

Przemek,

Fixed :-)

This line is missing from source/rdd/dbcmd.c:

      dbRelations.lpaParent = pArea;

In function HB_FUNC( DBSETRELATION )

Please commit the change if you agree with it, thanks

Regards,

Antonio

From druzus at priv.onet.pl  Sun May  6 13:04:16 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun May  6 13:04:52 2007
Subject: [Harbour] RE: USRRDD UR_SETREL
In-Reply-To: <463e03ff.4e158ec4.253f.0b6d@mx.google.com>
References: <463e03ff.4e158ec4.253f.0b6d@mx.google.com>
Message-ID: <20070506170416.GA7447@localhost.localdomain>

On Sun, 06 May 2007, Antonio Linares wrote:
> Przemek,
> Fixed :-)
> This line is missing from source/rdd/dbcmd.c:
>       dbRelations.lpaParent = pArea;
> In function HB_FUNC( DBSETRELATION )
> Please commit the change if you agree with it, thanks

Thank you - I'll commit it ASAP.
The side effect of using USRRDD is cleaning the RDD code.
AFAIR it's 5-th uninitialized member in some of RDD structures
reported by USRRDD users.

best regards,
Przemek
From yamamoto at rocketmail.com  Sun May  6 14:20:44 2007
From: yamamoto at rocketmail.com (Mitja Podgornik)
Date: Sun May  6 14:21:17 2007
Subject: [Harbour] Mysql wrapper problems
Message-ID: <560762.10856.qm@web30709.mail.mud.yahoo.com>

Przemek, thank You very much!

Let me write a tribute to Harbour:

Here in Slovenia forest service (SFS) is Harbour the main tool for SW
development.
SFS has network of 14 regional units, 120 local units (entry points)
and about 700 users.

We are running Harbour (+MiniGUI) application clients and Linux MySQL
server cluster. All clients support OLTP (online transactional
processing).
Not to mention, that Harbour programs are covering complete EU forestry
subvention gathering and evaluation here in Slovenia!

Regards to whole Harbour Team!

Mitja Podgornik

__________________________________________________
Do You Yahoo!?
Tired of spam?  Yahoo! Mail has the best spam protection around 
http://mail.yahoo.com 
From druzus at priv.onet.pl  Sun May  6 14:35:28 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun May  6 14:36:04 2007
Subject: [Harbour] ChangeLog 2007-05-06 20:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070506183528.GA30405@localhost.localdomain>

2007-05-06 20:30 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rdd/wacore.c
  * harbour/source/vm/classes.c
  * harbour/include/hbapirdd.h
  * harbour/source/compiler/hbmain.c
    * updated HB_TRACE messages and some minor cleanups

  * harbour/source/rdd/dbcmd.c
    ! fixed initialisation of DBRELINFO dbSetRelation() - thanks to Antonio
      for locating the problem

  * harbour/source/rtl/idle.c
   * increase timeout in nanosleep() from 1 microsecond to 1 millisecond
   - removed some wrong comment

best regards,
Przemek
From antonioharbour at gmail.com  Sun May  6 16:40:43 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun May  6 16:40:56 2007
Subject: [Harbour] ChangeLog 2007-05-06 20:30 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
In-Reply-To: <20070506183528.GA30405@localhost.localdomain>
Message-ID: <463e3d54.62adc2c0.2f75.ffffaee7@mx.google.com>

Przemek,

In dbcmd.c:

dbRelations.lpaParent = NULL;

Can't be NULL. It should be dbRelations.lpaParent = pArea;

Because in usrrdd.c we have:

hb_itemPutNI( hb_arrayGetItemPtr( pItem, UR_RI_PARENT ),
pRelInfo->lpaParent->uiArea );

Thanks,

Antonio

From antonioharbour at gmail.com  Sun May  6 16:45:02 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun May  6 16:45:14 2007
Subject: [Harbour] Changelog 2007-05-06 11:42 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <463e3e56.08ad505e.57a2.ffff9dd2@mx.google.com>

2007-05-06 11:42 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.ch
     * New define added
     
   * contrib/adordd/adordd.prg
     * SET RELATION implementation

Regards,

Antonio

From druzus at priv.onet.pl  Sun May  6 20:02:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun May  6 20:03:10 2007
Subject: [Harbour] ChangeLog 2007-05-06 20:30 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
In-Reply-To: <463e3d54.62adc2c0.2f75.ffffaee7@mx.google.com>
References: <20070506183528.GA30405@localhost.localdomain>
	<463e3d54.62adc2c0.2f75.ffffaee7@mx.google.com>
Message-ID: <20070507000235.GA8224@localhost.localdomain>

On Sun, 06 May 2007, Antonio Linares wrote:
> Przemek,
> In dbcmd.c:
> dbRelations.lpaParent = NULL;
> Can't be NULL. It should be dbRelations.lpaParent = pArea;

It can be but not need to.

> Because in usrrdd.c we have:
> hb_itemPutNI( hb_arrayGetItemPtr( pItem, UR_RI_PARENT ),
> pRelInfo->lpaParent->uiArea );

and this should be fixed - I'll do that in next commit.

best regards,
Przemek
From druzus at priv.onet.pl  Sun May  6 20:21:50 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun May  6 20:22:25 2007
Subject: [Harbour] ChangeLog 2007-05-07 02:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070507002150.GA11414@localhost.localdomain>

2007-05-07 02:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rdd/dbcmd.c
    * initialize lpaParent in DBRELINFO structure to pArea - please
      note that this initialization is ignored by default SETREL()
      RDD method

  * harbour/source/rdd/usrrdd/usrrdd.c
    ! fixed GPF when NULL lpaParent or lpaChild was used in DBRELINFO
      structure

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Mon May  7 02:38:01 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May  7 02:38:04 2007
Subject: [Harbour] SF bugtracker#1635288: MLCTOPOS incompatibility
In-Reply-To: <463D8ECB.15F8@synel.co.il>
References: <463D8ECB.15F8@synel.co.il>
Message-ID: <9257026e0705062338s3f4ef61amb5b16af87a60f173@mail.gmail.com>

On 5/6/07, Chen Kedem <niki@synel.co.il> wrote:
>
> I can patch it myself, but I don't know if it covers all possible
> options. Some tests in HBTEST would be nice.

I've done some tests and it is much better with your patch.

Please commit it.

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Mon May  7 02:55:05 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May  7 02:55:08 2007
Subject: [Harbour] Mysql wrapper problems
In-Reply-To: <560762.10856.qm@web30709.mail.mud.yahoo.com>
References: <560762.10856.qm@web30709.mail.mud.yahoo.com>
Message-ID: <9257026e0705062355l5c71a172w9f0e95a0d8f6ea07@mail.gmail.com>

On 5/6/07, Mitja Podgornik <yamamoto@rocketmail.com> wrote:

> Let me write a tribute to Harbour:
>
> Regards to whole Harbour Team!

I'm not far from Slovenia and I know it is a nice country.
Now I know the secret: they use Harbour :)

best regards,
Lorenzo Fiorini
From niki at synel.co.il  Mon May  7 03:05:16 2007
From: niki at synel.co.il (Chen Kedem)
Date: Mon May  7 03:05:46 2007
Subject: [Harbour] Re: SF bugtracker#1635288: MLCTOPOS incompatibility
References: <463D8ECB.15F8@synel.co.il>
Message-ID: <463ECFAC.5F7C@synel.co.il>

Lorenzo,

> I've done some tests and it is much better with your patch.

Thanks to Kevim Carmody I have a better version:

*** DIFF Start ***
--- source/rtl/mlctopos.c        Wed Jan 30 11:27:40 2002
+++ /tmp/newver/mlctopos.c       Mon May 07 09:56:18 2007
@@ -61,9 +61,9 @@
    ULONG  ulTabLength  = ISNUM( 5 ) ? hb_parni( 5 ) : 4;
    ULONG  ulLastSpace  = 0;
    ULONG  ulCurLength  = 0;
-   BOOL   bWordWrap    = ISLOG( 5 ) ? hb_parl( 5 ) : TRUE;
+   BOOL   bWordWrap    = ISLOG( 6 ) ? hb_parl( 6 ) : TRUE;
    ULONG  ulLen        = hb_parclen( 1 );
-   ULONG  ulLines      = 0;
+   ULONG  ulLines      = 1;
    ULONG  ulPos;
    ULONG  ulBegOfLine  = 0;
    ULONG  ulLastLen    = 0;
@@ -124,15 +124,21 @@

    if( ulCurLength > 0 )
    {
-      ulLines++;
       ulBegOfLine = ulPos - ulCurLength;
       ulLastLen   = ulCurLength ;
    }

    if( ulLine == ulLines )
    {
-      ulLastLen--;   /* Column is zero based */
-      hb_retnl( ulBegOfLine + ( ( ulCol < ulLastLen ) ? ulCol : ulLastLen ) );
+      if( ulLastLen )
+         ulLastLen--;   /* Column is zero based */
+      ulPos = ulBegOfLine + 1 + ( ( ulCol < ulLastLen ) ? ulCol : ulLastLen );
+
+      /* When wordwrap is active, skip the first space if not on the first line */
+      if( bWordWrap )
+      if( !ulCol && ulLine > 1 && pszString[ ulPos - 1 ] == ' ' )
+         ulPos++;
+      hb_retnl( ulPos );
    }
    else
       hb_retnl( ulLen );
**** DIFF End ****

Here is a sample program:

--tt36.prg--
proc main
? "Clipper    Harbour    Char"
t1( 11, 'A message from our founder', 10, 2, 0 )
t1(  6, 'A message from our founder', 5, 2, 0, 4, .F. )
t1(  3, 'A'+CHR(9)+'message'+CHR(9)+'from'+CHR(9)+'our'+CHR(9)+'founder', 10, 2, 0, 8 )
t1( 10, 'Note the side on which the bread is buttered.', 5, 3, 0 )
t1( 10, 'Note the side on which the bread is buttered.', 8, 2, 0 )
t1( 11, 'A message from our founder', 9, 2, 0 )
t1( 11, 'A message from our founder', 10, 2, 0 )
t1( 11, 'A message  from our founder', 9, 2, 0 )
t1(  9, 'Note the side on which the bread is buttered.', 8, 2, 0,, .F. )
t1( 10, 'A message from our founder', 9, 2, 0,, .F. )
t1( 10, 'A message  from our founder', 9, 2, 0,, .F. )
t1(  3, 'A message"+CHR(141)+"from our founder', 10, 2, 0 )
t1(  1, ' message from our founder', 10, 1, 0 )
return

proc t1( nClp, cStr, nLen, nLine, nCol, nTab, bWrap )
local i
i := MLCTOPOS( cStr, nLen, nLine, nCol, nTab, bWrap )
? nClp, i, "[" + substr( cStr, i, 1 ) + "]"
return
------------

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From harbour.01 at syenar.hu  Mon May  7 03:29:21 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon May  7 03:29:44 2007
Subject: [Harbour] Mysql wrapper problems
In-Reply-To: <9257026e0705062355l5c71a172w9f0e95a0d8f6ea07@mail.gmail.com>
References: <560762.10856.qm@web30709.mail.mud.yahoo.com>
	<9257026e0705062355l5c71a172w9f0e95a0d8f6ea07@mail.gmail.com>
Message-ID: <D8DEF076-3CC0-4BD4-84C2-408FACDDAD82@syenar.hu>

I don't know about Harbour usage :) but Slovenia is so
nice I used to visit there every year. (to and around the
lake Bohinj most of the time)

Brgds,
Viktor

On 2007.05.07., at 8:55, Lorenzo Fiorini wrote:

> On 5/6/07, Mitja Podgornik <yamamoto@rocketmail.com> wrote:
>
>> Let me write a tribute to Harbour:
>>
>> Regards to whole Harbour Team!
>
> I'm not far from Slovenia and I know it is a nice country.
> Now I know the secret: they use Harbour :)
>
> best regards,
> Lorenzo Fiorini
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From niki at synel.co.il  Mon May  7 04:07:25 2007
From: niki at synel.co.il (Chen Kedem)
Date: Mon May  7 04:07:35 2007
Subject: [Harbour] ChangeLog: 2007-05-07 11:04 UTC+0300 Chen Kedem
Message-ID: <463EDE3D.1D02@synel.co.il>

2007-05-07 11:04 UTC+0300 Chen Kedem <niki@actcom.co.il>
  * source/rtl/mlctopos.c
    ! Fix bug#1635288 - Make the function MLCTOPOS() more Clipper
      compatible. Also, the WordWrap value was taken from the wrong
      parameter.

This version contain yet another change I made after the last patch
I posted. Please test it now with edge values.

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From antonioharbour at gmail.com  Mon May  7 05:34:29 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon May  7 05:34:36 2007
Subject: [Harbour] Changelog 2007-05-07 11:28 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <463ef2a8.45668e87.3819.2781@mx.google.com>

2007-05-07 11:28 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * INDEX ON ... Implementation
     * OrdListClear() and OrdListAdd() implementation

INDEX ON ... its working though it does not support all possible clauses yet

Regards,

Antonio

From fmancera at viaopen.com  Mon May  7 08:08:40 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Mon May  7 08:09:13 2007
Subject: [Harbour] Changelog 2007-05-07 14:06 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
Message-ID: <002001c790a0$739aa430$3e02a8c0@PORTATIL>


2007-05-07 14:06 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
   * contrib/adordd/adordd.prg
    * DbRSelect() and DbRelation() implemented

Regards,

Fernando Mancera

From fmancera at viaopen.com  Mon May  7 09:48:08 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Mon May  7 09:48:43 2007
Subject: [Harbour] Changelog 2007-05-07 15:46 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
Message-ID: <001301c790ae$593cbb10$3e02a8c0@PORTATIL>


2007-05-07 15:46 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
   * contrib/adordd/adordd.prg
    * ADO_GOTOID() borrowed from xHarbour with modifications

Regards,

Fernando Mancera

From antonioharbour at gmail.com  Mon May  7 14:26:33 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon May  7 14:27:01 2007
Subject: [Harbour] Changelog 2007-05-07 19:42 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <463f6f64.40e935bf.73d3.ffffd684@mx.google.com>

2007-05-07 19:42 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * Added some connection strings, borrowed from xharbour

Regards,

Antonio

From niki at synel.co.il  Tue May  8 06:22:48 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue May  8 06:23:08 2007
Subject: [Harbour] Re: SF bugtracker#1635288: MLCTOPOS incompatibility
References: <463D8ECB.15F8@synel.co.il> <463ECFAC.5F7C@synel.co.il>
Message-ID: <46404F78.40CD@synel.co.il>

There are still problems with the version commited. TAB's are not
expanted if there are on the requested line (only on previous lines).
There are some more problems (see rest program).

MLCTOPOS() is an esoteric function, and I'm afraid that this is a bit
too complicated for me to invest me time on it now. I'm afraid I don't
understand the algorithm and just patched it here and there to give the
same results as clipper. I know it works better than the original
version that was in CVS till last week.

*** DIFF Start ***
--- /harbour/source/rtl/mlctopos.c	Mon May 07 11:04:18 2007
+++ /tmp/newver/mlctopos.c		Tue May 08 12:52:08 2007
@@ -66,7 +66,7 @@
    ULONG  ulLines      = 1;
    ULONG  ulPos;
    ULONG  ulBegOfLine  = 0;
-   ULONG  ulLastLen    = 0;
+// ULONG  ulLastLen    = 0;
 
    if( ulLineLength < 4 || ulLineLength > 254 )
       ulLineLength = 79;
@@ -85,7 +85,7 @@
 
          case HB_CHAR_LF:
             ulBegOfLine = ulPos - ulCurLength;
-            ulLastLen   = ulCurLength;
+//          ulLastLen   = ulCurLength;
             ulCurLength = 0;
             ulLastSpace = 0;
             ulLines++;
@@ -118,26 +118,31 @@
          ulLines++;
          ulLastSpace = 0;
          ulBegOfLine = ulPos - ulCurLength;
-         ulLastLen   = ulCurLength ;
+//       ulLastLen   = ulCurLength ;
       }
    }
 
    if( ulCurLength > 0 )
    {
       ulBegOfLine = ulPos - ulCurLength;
-      ulLastLen   = ulCurLength ;
+//    ulLastLen   = ulCurLength ;
    }
 
+   ulLen++;
+
    if( ulLine == ulLines )
    {
-      if( ulLastLen )
-         ulLastLen--;   /* Column is zero based */
-      ulPos = ulBegOfLine + 1 + ( ( ulCol < ulLastLen ) ? ulCol : ulLastLen );
+//    if( ulLastLen )
+//       ulLastLen--;   /* Column is zero based */
+//    ulPos = ulBegOfLine + 1 + ( ( ulCol < ulLastLen ) ? ulCol : ulLastLen );
+      ulPos = ulBegOfLine + 1 + ulCol;
 
       /* When wordwrap is active, skip the first space if not on the first line */
       if( bWordWrap && !ulCol && ulLine > 1 )
       if( pszString[ ulPos - 1 ] == ' ' || pszString[ ulPos - 1 ] == HB_CHAR_HT )
          ulPos++;
+      if( ulPos > ulLen )
+         ulPos = ulLen;
       hb_retnl( ulPos );
    }
    else
**** DIFF End ****

Here is a sample program:

--tt36.prg--
proc main
? "! Clipper    Harbour    Char"
t1( 11, 'A message from our founder', 10, 2, 0 )
t1(  6, 'A message from our founder', 5, 2, 0, 4, .F. )
t1(  3, 'A'+CHR(9)+'message'+CHR(9)+'from'+CHR(9)+'our'+CHR(9)+'founder', 10, 2, 0, 8 )
t1( 10, 'Note the side on which the bread is buttered.', 5, 3, 0 )
t1( 10, 'Note the side on which the bread is buttered.', 8, 2, 0 )
t1( 11, 'A message from our founder', 9, 2, 0 )
t1( 11, 'A message  from our founder', 9, 2, 0 )
t1( 11, 'A message'+CHR(9)+'from our founder', 10, 2, 0 )
t1(  9, 'Note the side on which the bread is buttered.', 8, 2, 0,, .F. )
t1( 10, 'A message from our founder', 9, 2, 0,, .F. )
t1( 10, 'A message  from our founder', 9, 2, 0,, .F. )
t1(  3, 'A message'+CHR(141)+'from our founder', 10, 2, 0 )
t1(  3, 'A message'+CHR(141)+'from our founder', 9, 2, 0 )
t1( 11, 'A message'+CHR(141)+'from our founder', 10, 2, 0,, .F. )
t1( 10, 'A message'+CHR(141)+'from our founder', 9, 2, 0,, .F. )
t1(  1, ' message from our founder', 10, 1, 0 )
t1(  9, ' message from our founder', 10, 1, 8 )
t1( 10, ' message from our founder', 10, 1, 9 )
t1( 11, ' message from our founder', 10, 1, 10 )
t1( 12, ' message from our founder', 10, 1, 11 )
t1( 26, ' message from our founder', 10, 1, 360 )
wait
t1(  1, ' message from our founder', 10, 1, 0,, .F. )
t1(  9, ' message from our founder', 10, 1, 8,, .F. )
t1( 10, ' message from our founder', 10, 1, 9,, .F. )
t1( 11, ' message from our founder', 10, 1, 10,, .F. )
t1( 12, ' message from our founder', 10, 1, 11,, .F. )
t1( 26, ' message from our founder', 10, 1, 360,, .F. )
t1(  9, ' message'+CHR(9)+'from our founder', 10, 1, 11,, .T. )
t1(  9, ' message'+CHR(9)+'from our founder', 10, 1, 11,, .F. )
t1( 21, ' message'+CHR(9)+'from our founder', 10, 2, 11 )
t1( 13, ' message'+CHR(9)+'from our founder', 10, 1, 15,, .T. )
t1( 13, ' message'+CHR(9)+'from our founder', 10, 1, 15,, .F. )
t1(  1, CHR(13)+CHR(10)+' message'+CHR(9)+'from our founder', 10, 1, 15,, .F. )
t1(  1, CHR(13)+CHR(10)+' message'+CHR(9)+'from our founder', 10, 1, 15,, .T. )
t1(  5, 'A '+CHR(13)+CHR(10)+'message from our founder', 9, 2, 0 )
t1( 13, 'A '+CHR(141)+CHR(10)+'message from our founder', 9, 2, 0 )
t1( 12, 'A'+CHR(141)+CHR(10)+'message from our founder', 9, 2, 0 )
t1( 11, 'A'+CHR(141)+'message from our founder', 9, 2, 0 )
t1( 11, 'A'+CHR(13)+'message from our founder', 9, 2, 0 )
t1( 11, 'A'+CHR(10)+'message from our founder', 9, 2, 0 )
t1(  3, 'A '+CHR(13)+'message from our founder', 9, 2, 0 )
t1(  3, 'A '+CHR(10)+'message from our founder', 9, 2, 0 )
t1( 27, 'A message from our founder', 10, 7, 0 )
return

proc t1( nClp, cStr, nLen, nLine, nCol, nTab, bWrap )
local i, c
i := MLCTOPOS( cStr, nLen, nLine, nCol, nTab, bWrap )
c := substr( cStr, i, 1 )
if !(c == "") .and. ( c < ' ' .or. c > '~' )
   c = "CHR(" + alltrim( str( asc( c ) ) ) + ")"
endif
? iif( nClp != i, "!", " " ), nClp, i, "[" + c + "]"
return
------------

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From lorenzo.fiorini at gmail.com  Tue May  8 07:18:34 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May  8 07:18:47 2007
Subject: [Harbour] Re: SF bugtracker#1635288: MLCTOPOS incompatibility
In-Reply-To: <46404F78.40CD@synel.co.il>
References: <463D8ECB.15F8@synel.co.il> <463ECFAC.5F7C@synel.co.il>
	<46404F78.40CD@synel.co.il>
Message-ID: <9257026e0705080418va3fc3d7qad761fb4de3ccd61@mail.gmail.com>

On 5/8/07, Chen Kedem <niki@synel.co.il> wrote:

> MLCTOPOS() is an esoteric function, and I'm afraid that this is a bit
> too complicated for me to invest me time on it now. I'm afraid I don't
> understand the algorithm and just patched it here and there to give the
> same results as clipper. I know it works better than the original
> version that was in CVS till last week.

I think there are better ways to invest your valuable time than fixing MLCTOPOS.
Now it is much better than before.
What about mark simply mark it as "not compatible"?

regards,
Lorenzo
From harbour.01 at syenar.hu  Tue May  8 07:27:58 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue May  8 07:28:11 2007
Subject: [Harbour] Re: SF bugtracker#1635288: MLCTOPOS incompatibility
In-Reply-To: <46404F78.40CD@synel.co.il>
References: <463D8ECB.15F8@synel.co.il> <463ECFAC.5F7C@synel.co.il>
	<46404F78.40CD@synel.co.il>
Message-ID: <5AB8AA1C-46CE-4EDB-90A5-226C53EC2413@syenar.hu>

Chen, could you add your test cases to HBTEST?

It would be a nice way to document the differences. (with the
added bonus that ppl will be able to more easily contibutefixes
in the future)

Brgds,
Viktor

On 2007.05.08., at 12:22, Chen Kedem wrote:

> There are still problems with the version commited. TAB's are not
> expanted if there are on the requested line (only on previous lines).
> There are some more problems (see rest program).
>
> MLCTOPOS() is an esoteric function, and I'm afraid that this is a bit
> too complicated for me to invest me time on it now. I'm afraid I don't
> understand the algorithm and just patched it here and there to give  
> the
> same results as clipper. I know it works better than the original
> version that was in CVS till last week.
>
> *** DIFF Start ***
> --- /harbour/source/rtl/mlctopos.c	Mon May 07 11:04:18 2007
> +++ /tmp/newver/mlctopos.c		Tue May 08 12:52:08 2007
> @@ -66,7 +66,7 @@
>     ULONG  ulLines      = 1;
>     ULONG  ulPos;
>     ULONG  ulBegOfLine  = 0;
> -   ULONG  ulLastLen    = 0;
> +// ULONG  ulLastLen    = 0;
>
>     if( ulLineLength < 4 || ulLineLength > 254 )
>        ulLineLength = 79;
> @@ -85,7 +85,7 @@
>
>           case HB_CHAR_LF:
>              ulBegOfLine = ulPos - ulCurLength;
> -            ulLastLen   = ulCurLength;
> +//          ulLastLen   = ulCurLength;
>              ulCurLength = 0;
>              ulLastSpace = 0;
>              ulLines++;
> @@ -118,26 +118,31 @@
>           ulLines++;
>           ulLastSpace = 0;
>           ulBegOfLine = ulPos - ulCurLength;
> -         ulLastLen   = ulCurLength ;
> +//       ulLastLen   = ulCurLength ;
>        }
>     }
>
>     if( ulCurLength > 0 )
>     {
>        ulBegOfLine = ulPos - ulCurLength;
> -      ulLastLen   = ulCurLength ;
> +//    ulLastLen   = ulCurLength ;
>     }
>
> +   ulLen++;
> +
>     if( ulLine == ulLines )
>     {
> -      if( ulLastLen )
> -         ulLastLen--;   /* Column is zero based */
> -      ulPos = ulBegOfLine + 1 + ( ( ulCol < ulLastLen ) ? ulCol :  
> ulLastLen );
> +//    if( ulLastLen )
> +//       ulLastLen--;   /* Column is zero based */
> +//    ulPos = ulBegOfLine + 1 + ( ( ulCol < ulLastLen ) ? ulCol :  
> ulLastLen );
> +      ulPos = ulBegOfLine + 1 + ulCol;
>
>        /* When wordwrap is active, skip the first space if not on  
> the first line */
>        if( bWordWrap && !ulCol && ulLine > 1 )
>        if( pszString[ ulPos - 1 ] == ' ' || pszString[ ulPos - 1 ]  
> == HB_CHAR_HT )
>           ulPos++;
> +      if( ulPos > ulLen )
> +         ulPos = ulLen;
>        hb_retnl( ulPos );
>     }
>     else
> **** DIFF End ****
>
> Here is a sample program:
>
> --tt36.prg--
> proc main
> ? "! Clipper    Harbour    Char"
> t1( 11, 'A message from our founder', 10, 2, 0 )
> t1(  6, 'A message from our founder', 5, 2, 0, 4, .F. )
> t1(  3, 'A'+CHR(9)+'message'+CHR(9)+'from'+CHR(9)+'our'+CHR(9) 
> +'founder', 10, 2, 0, 8 )
> t1( 10, 'Note the side on which the bread is buttered.', 5, 3, 0 )
> t1( 10, 'Note the side on which the bread is buttered.', 8, 2, 0 )
> t1( 11, 'A message from our founder', 9, 2, 0 )
> t1( 11, 'A message  from our founder', 9, 2, 0 )
> t1( 11, 'A message'+CHR(9)+'from our founder', 10, 2, 0 )
> t1(  9, 'Note the side on which the bread is buttered.', 8, 2,  
> 0,, .F. )
> t1( 10, 'A message from our founder', 9, 2, 0,, .F. )
> t1( 10, 'A message  from our founder', 9, 2, 0,, .F. )
> t1(  3, 'A message'+CHR(141)+'from our founder', 10, 2, 0 )
> t1(  3, 'A message'+CHR(141)+'from our founder', 9, 2, 0 )
> t1( 11, 'A message'+CHR(141)+'from our founder', 10, 2, 0,, .F. )
> t1( 10, 'A message'+CHR(141)+'from our founder', 9, 2, 0,, .F. )
> t1(  1, ' message from our founder', 10, 1, 0 )
> t1(  9, ' message from our founder', 10, 1, 8 )
> t1( 10, ' message from our founder', 10, 1, 9 )
> t1( 11, ' message from our founder', 10, 1, 10 )
> t1( 12, ' message from our founder', 10, 1, 11 )
> t1( 26, ' message from our founder', 10, 1, 360 )
> wait
> t1(  1, ' message from our founder', 10, 1, 0,, .F. )
> t1(  9, ' message from our founder', 10, 1, 8,, .F. )
> t1( 10, ' message from our founder', 10, 1, 9,, .F. )
> t1( 11, ' message from our founder', 10, 1, 10,, .F. )
> t1( 12, ' message from our founder', 10, 1, 11,, .F. )
> t1( 26, ' message from our founder', 10, 1, 360,, .F. )
> t1(  9, ' message'+CHR(9)+'from our founder', 10, 1, 11,, .T. )
> t1(  9, ' message'+CHR(9)+'from our founder', 10, 1, 11,, .F. )
> t1( 21, ' message'+CHR(9)+'from our founder', 10, 2, 11 )
> t1( 13, ' message'+CHR(9)+'from our founder', 10, 1, 15,, .T. )
> t1( 13, ' message'+CHR(9)+'from our founder', 10, 1, 15,, .F. )
> t1(  1, CHR(13)+CHR(10)+' message'+CHR(9)+'from our founder', 10,  
> 1, 15,, .F. )
> t1(  1, CHR(13)+CHR(10)+' message'+CHR(9)+'from our founder', 10,  
> 1, 15,, .T. )
> t1(  5, 'A '+CHR(13)+CHR(10)+'message from our founder', 9, 2, 0 )
> t1( 13, 'A '+CHR(141)+CHR(10)+'message from our founder', 9, 2, 0 )
> t1( 12, 'A'+CHR(141)+CHR(10)+'message from our founder', 9, 2, 0 )
> t1( 11, 'A'+CHR(141)+'message from our founder', 9, 2, 0 )
> t1( 11, 'A'+CHR(13)+'message from our founder', 9, 2, 0 )
> t1( 11, 'A'+CHR(10)+'message from our founder', 9, 2, 0 )
> t1(  3, 'A '+CHR(13)+'message from our founder', 9, 2, 0 )
> t1(  3, 'A '+CHR(10)+'message from our founder', 9, 2, 0 )
> t1( 27, 'A message from our founder', 10, 7, 0 )
> return
>
> proc t1( nClp, cStr, nLen, nLine, nCol, nTab, bWrap )
> local i, c
> i := MLCTOPOS( cStr, nLen, nLine, nCol, nTab, bWrap )
> c := substr( cStr, i, 1 )
> if !(c == "") .and. ( c < ' ' .or. c > '~' )
>    c = "CHR(" + alltrim( str( asc( c ) ) ) + ")"
> endif
> ? iif( nClp != i, "!", " " ), nClp, i, "[" + c + "]"
> return
> ------------
>
>   Chen.
> ********************************************************************** 
> ************************
> IMPORTANT: The contents of this email and any attachments are  
> confidential. They are intended for the
> named recipient(s) only.
> If you have received this email in error, please notify the system  
> manager or the sender immediately and do
> not disclose the contents to anyone or make copies thereof.
> *** eSafe scanned this email for viruses, vandals, and malicious  
> content. ***
> ********************************************************************** 
> ************************
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From niki at synel.co.il  Tue May  8 09:08:00 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue May  8 09:08:31 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
Message-ID: <46407630.3468@synel.co.il>

2007-05-08 16:06 UTC+0300 Chen Kedem <niki@actcom.co.il>
  * source/rtl/mlctopos.c
    ! Make the function MLCTOPOS() more compatible.
      TOFIX note added about existing problems.

  * utils/hbtest/rt_misc.prg
    + Add some tests for MLCTOPOS()


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From randy at palmasdev.com  Tue May  8 14:48:41 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Tue May  8 14:48:02 2007
Subject: [Harbour] Where is latest Beta 2?
In-Reply-To: <5AB8AA1C-46CE-4EDB-90A5-226C53EC2413@syenar.hu>
References: <463D8ECB.15F8@synel.co.il> <463ECFAC.5F7C@synel.co.il>
	<46404F78.40CD@synel.co.il>
	<5AB8AA1C-46CE-4EDB-90A5-226C53EC2413@syenar.hu>
Message-ID: <20070508184759.75579668AB@smtp.tor.pathcom.com>

Hi all,

The Beta 2 download on the Harbour site is dated 03/28/07 but there 
have been fixes applied to Beta 2 since then.

Where can I find the latest Beta 2 release?

TIA.

Regards,
Randy.

From harbour.01 at syenar.hu  Tue May  8 14:55:59 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue May  8 14:56:12 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <46407630.3468@synel.co.il>
References: <46407630.3468@synel.co.il>
Message-ID: <D245A197-1114-4340-9B9C-A125BDCE08AD@syenar.hu>

Thanks Chen.

Brgds,
Viktor

On 2007.05.08., at 15:08, Chen Kedem wrote:

> 2007-05-08 16:06 UTC+0300 Chen Kedem <niki@actcom.co.il>
>   * source/rtl/mlctopos.c
>     ! Make the function MLCTOPOS() more compatible.
>       TOFIX note added about existing problems.
>
>   * utils/hbtest/rt_misc.prg
>     + Add some tests for MLCTOPOS()
>
>
>   Chen.
> ********************************************************************** 
> ************************
> IMPORTANT: The contents of this email and any attachments are  
> confidential. They are intended for the
> named recipient(s) only.
> If you have received this email in error, please notify the system  
> manager or the sender immediately and do
> not disclose the contents to anyone or make copies thereof.
> *** eSafe scanned this email for viruses, vandals, and malicious  
> content. ***
> ********************************************************************** 
> ************************
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Tue May  8 16:06:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May  8 16:07:18 2007
Subject: [Harbour] Where is latest Beta 2?
In-Reply-To: <20070508184759.75579668AB@smtp.tor.pathcom.com>
References: <463D8ECB.15F8@synel.co.il> <463ECFAC.5F7C@synel.co.il>
	<46404F78.40CD@synel.co.il>
	<5AB8AA1C-46CE-4EDB-90A5-226C53EC2413@syenar.hu>
	<20070508184759.75579668AB@smtp.tor.pathcom.com>
Message-ID: <20070508200642.GA5289@localhost.localdomain>

On Tue, 08 May 2007, Randy Portnoff wrote:
> Hi all,
> The Beta 2 download on the Harbour site is dated 03/28/07 but there 
> have been fixes applied to Beta 2 since then.
> Where can I find the latest Beta 2 release?

No where. The fixes will be included in BETA3.

BTW In few minutes I'll commit fixes with some minor API modifications
in devel branch I think should be in release 1.0. I would like to ask
other developers to check which of their fixes should be applied to BETA
branch and commit them.

best regards,
Przemek
From randy at palmasdev.com  Tue May  8 16:24:27 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Tue May  8 16:23:48 2007
Subject: [Harbour] Where is latest Beta 2?
In-Reply-To: <20070508200642.GA5289@localhost.localdomain>
References: <463D8ECB.15F8@synel.co.il> <463ECFAC.5F7C@synel.co.il>
	<46404F78.40CD@synel.co.il>
	<5AB8AA1C-46CE-4EDB-90A5-226C53EC2413@syenar.hu>
	<20070508184759.75579668AB@smtp.tor.pathcom.com>
	<20070508200642.GA5289@localhost.localdomain>
Message-ID: <20070508202344.E6352100113@smtp.tor.pathcom.com>

When do you think Beta 3 will be available?

At 04:06 PM 5/8/2007, you wrote:
>On Tue, 08 May 2007, Randy Portnoff wrote:
> > Hi all,
> > The Beta 2 download on the Harbour site is dated 03/28/07 but there
> > have been fixes applied to Beta 2 since then.
> > Where can I find the latest Beta 2 release?
>
>No where. The fixes will be included in BETA3.
>
>BTW In few minutes I'll commit fixes with some minor API modifications
>in devel branch I think should be in release 1.0. I would like to ask
>other developers to check which of their fixes should be applied to BETA
>branch and commit them.
>
>best regards,
>Przemek
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour

From dbtopas at dbtopas.lt  Tue May  8 16:31:53 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Tue May  8 16:28:50 2007
Subject: [Harbour] Where is latest Beta 2?
In-Reply-To: <20070508200642.GA5289@localhost.localdomain>
References: <463D8ECB.15F8@synel.co.il>
	<463ECFAC.5F7C@synel.co.il>	<46404F78.40CD@synel.co.il>	<5AB8AA1C-46CE-4EDB-90A5-226C53EC2413@syenar.hu>	<20070508184759.75579668AB@smtp.tor.pathcom.com>
	<20070508200642.GA5289@localhost.localdomain>
Message-ID: <4640DE39.6060803@dbtopas.lt>

>>Where can I find the latest Beta 2 release?
> 
> No where. The fixes will be included in BETA3.

Hello,


you can download branch "beta1" from CVS, if you'd like to have the 
latest beta CVS version.


Best regards,
Mindaugas
From druzus at priv.onet.pl  Tue May  8 17:22:43 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May  8 17:23:26 2007
Subject: [Harbour] ChangeLog BETA 2007-05-08 23:20 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
Message-ID: <20070508212243.GA28253@localhost.localdomain>

2007-05-08 23:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/bin/hb-func.sh
  * harbour/config/global.cf
  * harbour/config/w32/mingw32.cf
  * harbour/contrib/mysql/Makefile
  * harbour/contrib/rdd_ads/ads1.c
  * harbour/include/Makefile
  * harbour/include/hbapi.h
  * harbour/include/hbapicls.h
  * harbour/include/hbapirdd.h
  * harbour/include/hbextern.ch
  - harbour/include/usrrdd.ch
  + harbour/include/hbusrrdd.ch
  * harbour/include/hbvm.h
  * harbour/source/compiler/harbour.c
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/compiler/harbour.yyh
  * harbour/source/macro/macro.y
  * harbour/source/macro/macro.yyc
  * harbour/source/macro/macro.yyh
  * harbour/source/rdd/Makefile
  * harbour/source/rdd/dbcmd.c
  * harbour/source/rdd/dbf1.c
  * harbour/source/rdd/delim1.c
  * harbour/source/rdd/sdf1.c
  * harbour/source/rdd/workarea.c
  * harbour/source/rdd/dbfcdx/dbfcdx1.c
  * harbour/source/rdd/dbfdbt/dbfdbt1.c
  * harbour/source/rdd/dbffpt/dbffpt1.c
  * harbour/source/rdd/dbfntx/dbfntx1.c
  * harbour/source/rdd/nulsys/nulsys.c
  * harbour/source/rdd/usrrdd/usrrdd.c
  * harbour/source/rtl/empty.c
  * harbour/source/rtl/errorsys.c
  * harbour/source/rtl/idle.c
  * harbour/source/rtl/tclass.prg
  * harbour/source/rtl/terror.prg
  * harbour/source/rtl/tmenuitm.prg
  * harbour/source/rtl/tobject.prg
  * harbour/source/rtl/tpopup.prg
  * harbour/source/rtl/gtstd/gtstd.c
  * harbour/source/vm/classes.c
  * harbour/source/vm/dynsym.c
  * harbour/source/vm/hvm.c
    * synced with some important fixes and cleanups in devel branch
      - fixed FIELD f1, f2 IN db1 IN db2 ...
      - some other minor compiler and grammar fixes
      - fixed releasing idle CPU cycles
      - changed some declarations from 'char *' to 'const char *'
      - cleaned some OW and BCC warnings
      - regenerated grammar parser with modified bison version
      - MenuItem() and PopUp() changed for new classy code
      - do not stop Harbour process using GTSTD when controlling terminal
        has TOSTOP attribute set
      - clear NetErr() flag in dbSetIndex()
      - removed all NetErr() setting other then in error handler
      - changed dbSetIndex(), dbUseArea(), dbCreate(), dbAppend() to
        return logical value indicating success
      - changed library name from mysql to hbmysql
      - changed usrrdd.ch to hbusrrdd.ch
      - changed EMPTY( <symboItem> ) - not it returns .T. when <symboItem>
        is not a function symbol
      - use default RDD instead of current one in COPY TO and APPEND FROM
      - removed __RDDSETDEFAULT()
      - added workaround for SIX3 bug in compression
      - synced with RDD API
      - some other minor fixes and cleanups

best regards,
Przemek
From druzus at priv.onet.pl  Tue May  8 23:14:59 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May  8 23:15:36 2007
Subject: [Harbour] multiline codeblocks - final version
Message-ID: <20070509031459.GA2556@localhost.localdomain>

Hi All,

Finally I found a while to finish multiline codeblock implementation
in compiler with only one small restriction to normal functions.
Below I'm attaching ChangeLog proposition. I do not want to commit it
without confirmation that such form can be accepted by other developers.

IMHO yes - it's full implementation which does not need any future
modification (maybe one if we decide to remove the limitation with
accessing internal codeblock LOCALs by nested codeblocks - see note
below but it's a problem also in normal codeblocks) other then bug
fixing (if any).
We can discuss yet on used names:
    [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
        ...
    END[CODE]
looks nice for me and in the future for nested functions/procedures
we can use:
    BEGIN FUNCTION <funcName> [WITH <params,...>]
        ...
    END[FUNC]
but maybe you have other/better propositions, f.e. I also like
    SUBF[UNCTION] 
proposed by Mindaugas. I can add alternativ support for declaring local
parameters like in normal functions so we may have:
    CODEBLOCK <cbVar> ( [ <params,...> ] )
        ...
    ENDCODE
and:
    SUBFUNC <funcName> ( [ <params,...> ] )
        ...
    ENDFUNC


Your opinion?

best regards,
Przemek




2007-05-XX XX:XX UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbcomp.h
  * harbour/include/hbcompdf.h
  * harbour/include/hbexpra.c
  * harbour/include/hbexprb.c
  * harbour/include/hbexprop.h
  * harbour/include/hbpp.h
  * harbour/source/compiler/complex.c
  * harbour/source/compiler/genc.c
  * harbour/source/compiler/gencli.c
  * harbour/source/compiler/genobj32.c
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/compiler/harbour.yyh
  * harbour/source/compiler/hbmain.c
    * changed code used for variable scoping - now it's much more
      simple (only one function) and allows to use declarations in
      nested functions/codeblocks with visibility similar to Pascal
    ! fixed parsing FILED <fields,...> IN <alias>
      we were accepting code like:
         FIELD f1, f2 IN db1, f3 IN db2 IN db3
      and for all fields the last alias (db2 in this example) was used
    ! fixed calculating number of static variables with -b (debugger)
      compilation (number of file wide statics were doubled)
    ! fixed generation of static variable names for debugger when declared
      with array dimensions, f.e.:
         static sVar[3]
    + added support for extended codeblocks:
         [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
            <statement1>
            ...
            <statementN>
            return <val>
         END[CODE]
      Such codeblocks allow nested definitions. They can also have their
      own variable declarations (local, static, field, memvar, parameters,
      private, public) and visibility of declared variables is similar to
      nested function in Pascal but please note that there is one limitation
      which exists also for normal codeblocks (Clipper compatible behavior):
      internal codeblock local parameters and local variables cannot be
      used in nested codeblocks, f.e. such code:
            eval( { |p| eval( {|| qout( p + 1 ) } ) } )
      is illegal in Clipper and Harbour. This limitation also can be
      eliminated but but it will be necessary to make deeper modifications
      in code for local detaching changing the method of generating
      codeblocks local variables in nested blocks so unlike the above
      also some modifications in HVM will be necessary.


      The syntax is intentionally differ then the one used by xHarbour:
            <cbVar> := < |<params,...>|
               <statement1>
               ...
               <statementN>
            >
      because such "expression like" form breaks PP rules. For grammar parser
      it's multi line expression when whole PP logic and other grammar rules
      are line oriented (the line concatenator ';' creates single line for
      compiler). It causes bad side effects, f.e.:
         qout( eval( <||
                        ? "Hello"
                        return "world!!!"
                     > ) )
      works but when used as part of preprocessor command:
         ? eval( <||
                    ? "Hello"
                    return "world!!!"
                 > )
      will never work and it's not sth what can be "fixed". See .ppo file
      generated for the above example to find why.
      To avoid users confusions I intentionally chose differ syntax.
      There are also some other differences to xHarbour:
         - any variable declarations like in normal function can be used
           also STATICs, PARAMETERs and variable number of parameters are
           supported, f.e.:
               codeblock cbVar with p1, p2, ...
                  local l1:="l1", l2:="l2"
                  static s1:="s1", s2:="s2"
                  ? p1, p2, "[", ..., "]"
                  ? l1, l2
                  ? s1, s2
               endcode
         - locals are not emulated by adding them to parameter list so
           they are initialized by default to NIL and do not interact
           with parameters passed to eval().
         - return statement is suggested by compiler when -w switch is used
           when return statement is missing then codeblock is finished like
           normal procedure without popping the top most HVM stack value to
           return item.
         - the visibility of declared variables is like in nested Pascal
           functions (see note above about exception for locals)
From miguelangel at marchuet.net  Wed May  9 03:54:38 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May  9 03:54:13 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <20070509031459.GA2556@localhost.localdomain>
References: <20070509031459.GA2556@localhost.localdomain>
Message-ID: <46417E3E.5090806@marchuet.net>


> We can discuss yet on used names:
>     [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
>         ...
>     END[CODE]

Perfect...

I prefer this one because is more similar to

BEGIN SEQUENCE
 <statements_Normal>

 [ BREAK [<expression>] ]

 [ RECOVER [USING <errorVar>]
   <statements_Error>
 ]
END[SEQUENCE]


Best regards,
Miguel Angel marchuet
From harbour.01 at syenar.hu  Wed May  9 04:08:32 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 04:08:54 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <20070509031459.GA2556@localhost.localdomain>
References: <20070509031459.GA2556@localhost.localdomain>
Message-ID: <C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>

> looks nice for me and in the future for nested functions/procedures
> we can use:
>     BEGIN FUNCTION <funcName> [WITH <params,...>]
>         ...
>     END[FUNC]

BEGIN CODE[BLOCK] and BEGIN FUNCTION look nice to me.

I would also welcome some real world examples from those who
have experience with this language feature to show its usefullness.

Brgds,
Viktor

> but maybe you have other/better propositions, f.e. I also like
>     SUBF[UNCTION]
> proposed by Mindaugas. I can add alternativ support for declaring  
> local
> parameters like in normal functions so we may have:
>     CODEBLOCK <cbVar> ( [ <params,...> ] )
>         ...
>     ENDCODE
> and:
>     SUBFUNC <funcName> ( [ <params,...> ] )
>         ...
>     ENDFUNC
>
>
> Your opinion?
>
> best regards,
> Przemek
>
>
>
>
> 2007-05-XX XX:XX UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/include/hbcomp.h
>   * harbour/include/hbcompdf.h
>   * harbour/include/hbexpra.c
>   * harbour/include/hbexprb.c
>   * harbour/include/hbexprop.h
>   * harbour/include/hbpp.h
>   * harbour/source/compiler/complex.c
>   * harbour/source/compiler/genc.c
>   * harbour/source/compiler/gencli.c
>   * harbour/source/compiler/genobj32.c
>   * harbour/source/compiler/harbour.y
>   * harbour/source/compiler/harbour.yyc
>   * harbour/source/compiler/harbour.yyh
>   * harbour/source/compiler/hbmain.c
>     * changed code used for variable scoping - now it's much more
>       simple (only one function) and allows to use declarations in
>       nested functions/codeblocks with visibility similar to Pascal
>     ! fixed parsing FILED <fields,...> IN <alias>
>       we were accepting code like:
>          FIELD f1, f2 IN db1, f3 IN db2 IN db3
>       and for all fields the last alias (db2 in this example) was used
>     ! fixed calculating number of static variables with -b (debugger)
>       compilation (number of file wide statics were doubled)
>     ! fixed generation of static variable names for debugger when  
> declared
>       with array dimensions, f.e.:
>          static sVar[3]
>     + added support for extended codeblocks:
>          [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
>             <statement1>
>             ...
>             <statementN>
>             return <val>
>          END[CODE]
>       Such codeblocks allow nested definitions. They can also have  
> their
>       own variable declarations (local, static, field, memvar,  
> parameters,
>       private, public) and visibility of declared variables is  
> similar to
>       nested function in Pascal but please note that there is one  
> limitation
>       which exists also for normal codeblocks (Clipper compatible  
> behavior):
>       internal codeblock local parameters and local variables  
> cannot be
>       used in nested codeblocks, f.e. such code:
>             eval( { |p| eval( {|| qout( p + 1 ) } ) } )
>       is illegal in Clipper and Harbour. This limitation also can be
>       eliminated but but it will be necessary to make deeper  
> modifications
>       in code for local detaching changing the method of generating
>       codeblocks local variables in nested blocks so unlike the above
>       also some modifications in HVM will be necessary.
>
>
>       The syntax is intentionally differ then the one used by  
> xHarbour:
>             <cbVar> := < |<params,...>|
>                <statement1>
>                ...
>                <statementN>
>>
>       because such "expression like" form breaks PP rules. For  
> grammar parser
>       it's multi line expression when whole PP logic and other  
> grammar rules
>       are line oriented (the line concatenator ';' creates single  
> line for
>       compiler). It causes bad side effects, f.e.:
>          qout( eval( <||
>                         ? "Hello"
>                         return "world!!!"
>> ) )
>       works but when used as part of preprocessor command:
>          ? eval( <||
>                     ? "Hello"
>                     return "world!!!"
>> )
>       will never work and it's not sth what can be "fixed".  
> See .ppo file
>       generated for the above example to find why.
>       To avoid users confusions I intentionally chose differ syntax.
>       There are also some other differences to xHarbour:
>          - any variable declarations like in normal function can be  
> used
>            also STATICs, PARAMETERs and variable number of  
> parameters are
>            supported, f.e.:
>                codeblock cbVar with p1, p2, ...
>                   local l1:="l1", l2:="l2"
>                   static s1:="s1", s2:="s2"
>                   ? p1, p2, "[", ..., "]"
>                   ? l1, l2
>                   ? s1, s2
>                endcode
>          - locals are not emulated by adding them to parameter list so
>            they are initialized by default to NIL and do not interact
>            with parameters passed to eval().
>          - return statement is suggested by compiler when -w switch  
> is used
>            when return statement is missing then codeblock is  
> finished like
>            normal procedure without popping the top most HVM stack  
> value to
>            return item.
>          - the visibility of declared variables is like in nested  
> Pascal
>            functions (see note above about exception for locals)
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Wed May  9 04:12:43 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May  9 04:12:47 2007
Subject: [Harbour] ChangeLog 2007-05-09 10:10 UTC+0200
Message-ID: <9257026e0705090112i65496f0bjcf7dc0605fb21647@mail.gmail.com>

2007-05-09 10:10 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
  * harbour/config/w32/mingw32.cf
    * fixed typo
  * harbour/include/Makefile
    * removed reference to deleted hbrddwrk.h
  * harbour/include/std.ch
    * added SET EOL <x> clause
  * harbour/include/hbcompat.ch
    * fixed typos and added TEXT INTO
  * harbour/contrib/gd/Makefile
    * fixed install of includes
  * harbour/contrib/gd/gdwrp.c
    * fixed warnings

regards,
Lorenzo
From maurilio.longo at libero.it  Wed May  9 04:31:07 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Wed May  9 04:31:52 2007
Subject: [Harbour] multiline codeblocks - final version
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
Message-ID: <464186CA.6320F697@libero.it>

Viktor,

I'm using extended codeblocks with xharbour just like pascal nested
procedures.

They are handy when, for example, you issue a dbEval() or an AEval() and a
simple codeblock becomes an obscure concatenation of iif()s while calling a
functions is a little bit of an overkill.

I'd like to use them with hwGUI as well, but there are problems with the
pre-processor so I cannot simply use them when defining some GUI element
behaviour.

I mean,

@ x,y OWNERBUTTON ....
      ON SIZE {|| ... }

Here, at the ON SIZE it would be very handy to be able to write an extended
codeblock, and xharbour syntax seem more apt to this task, but the
pre-processor does not like a 

      ON SIZE < | ... | 
              >

and this is a pity!

So, I think, it would be usefull to find a way to address this issue now that
you're rewriting extended codeblocks.

Maurilio.


Szak?ts Viktor ha scritto:
> 
> > looks nice for me and in the future for nested functions/procedures
> > we can use:
> >     BEGIN FUNCTION <funcName> [WITH <params,...>]
> >         ...
> >     END[FUNC]
> 
> BEGIN CODE[BLOCK] and BEGIN FUNCTION look nice to me.
> 
> I would also welcome some real world examples from those who
> have experience with this language feature to show its usefullness.
> 
> Brgds,
> Viktor
> 
> > but maybe you have other/better propositions, f.e. I also like
> >     SUBF[UNCTION]
> > proposed by Mindaugas. I can add alternativ support for declaring
> > local
> > parameters like in normal functions so we may have:
> >     CODEBLOCK <cbVar> ( [ <params,...> ] )
> >         ...
> >     ENDCODE
> > and:
> >     SUBFUNC <funcName> ( [ <params,...> ] )
> >         ...
> >     ENDFUNC
> >
> >
> > Your opinion?
> >
> > best regards,
> > Przemek
> >
> >
> >
> >
> > 2007-05-XX XX:XX UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> >   * harbour/include/hbcomp.h
> >   * harbour/include/hbcompdf.h
> >   * harbour/include/hbexpra.c
> >   * harbour/include/hbexprb.c
> >   * harbour/include/hbexprop.h
> >   * harbour/include/hbpp.h
> >   * harbour/source/compiler/complex.c
> >   * harbour/source/compiler/genc.c
> >   * harbour/source/compiler/gencli.c
> >   * harbour/source/compiler/genobj32.c
> >   * harbour/source/compiler/harbour.y
> >   * harbour/source/compiler/harbour.yyc
> >   * harbour/source/compiler/harbour.yyh
> >   * harbour/source/compiler/hbmain.c
> >     * changed code used for variable scoping - now it's much more
> >       simple (only one function) and allows to use declarations in
> >       nested functions/codeblocks with visibility similar to Pascal
> >     ! fixed parsing FILED <fields,...> IN <alias>
> >       we were accepting code like:
> >          FIELD f1, f2 IN db1, f3 IN db2 IN db3
> >       and for all fields the last alias (db2 in this example) was used
> >     ! fixed calculating number of static variables with -b (debugger)
> >       compilation (number of file wide statics were doubled)
> >     ! fixed generation of static variable names for debugger when
> > declared
> >       with array dimensions, f.e.:
> >          static sVar[3]
> >     + added support for extended codeblocks:
> >          [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
> >             <statement1>
> >             ...
> >             <statementN>
> >             return <val>
> >          END[CODE]
> >       Such codeblocks allow nested definitions. They can also have
> > their
> >       own variable declarations (local, static, field, memvar,
> > parameters,
> >       private, public) and visibility of declared variables is
> > similar to
> >       nested function in Pascal but please note that there is one
> > limitation
> >       which exists also for normal codeblocks (Clipper compatible
> > behavior):
> >       internal codeblock local parameters and local variables
> > cannot be
> >       used in nested codeblocks, f.e. such code:
> >             eval( { |p| eval( {|| qout( p + 1 ) } ) } )
> >       is illegal in Clipper and Harbour. This limitation also can be
> >       eliminated but but it will be necessary to make deeper
> > modifications
> >       in code for local detaching changing the method of generating
> >       codeblocks local variables in nested blocks so unlike the above
> >       also some modifications in HVM will be necessary.
> >
> >
> >       The syntax is intentionally differ then the one used by
> > xHarbour:
> >             <cbVar> := < |<params,...>|
> >                <statement1>
> >                ...
> >                <statementN>
> >>
> >       because such "expression like" form breaks PP rules. For
> > grammar parser
> >       it's multi line expression when whole PP logic and other
> > grammar rules
> >       are line oriented (the line concatenator ';' creates single
> > line for
> >       compiler). It causes bad side effects, f.e.:
> >          qout( eval( <||
> >                         ? "Hello"
> >                         return "world!!!"
> >> ) )
> >       works but when used as part of preprocessor command:
> >          ? eval( <||
> >                     ? "Hello"
> >                     return "world!!!"
> >> )
> >       will never work and it's not sth what can be "fixed".
> > See .ppo file
> >       generated for the above example to find why.
> >       To avoid users confusions I intentionally chose differ syntax.
> >       There are also some other differences to xHarbour:
> >          - any variable declarations like in normal function can be
> > used
> >            also STATICs, PARAMETERs and variable number of
> > parameters are
> >            supported, f.e.:
> >                codeblock cbVar with p1, p2, ...
> >                   local l1:="l1", l2:="l2"
> >                   static s1:="s1", s2:="s2"
> >                   ? p1, p2, "[", ..., "]"
> >                   ? l1, l2
> >                   ? s1, s2
> >                endcode
> >          - locals are not emulated by adding them to parameter list so
> >            they are initialized by default to NIL and do not interact
> >            with parameters passed to eval().
> >          - return statement is suggested by compiler when -w switch
> > is used
> >            when return statement is missing then codeblock is
> > finished like
> >            normal procedure without popping the top most HVM stack
> > value to
> >            return item.
> >          - the visibility of declared variables is like in nested
> > Pascal
> >            functions (see note above about exception for locals)
> > _______________________________________________
> > Harbour mailing list
> > Harbour@harbour-project.org
> > http://lists.harbour-project.org/mailman/listinfo/harbour
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From lorenzo.fiorini at gmail.com  Wed May  9 04:41:21 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May  9 04:41:24 2007
Subject: [Harbour] inkey.ch and gtxxx.ch cleanup
Message-ID: <9257026e0705090141jfd731f9kc73fc20255b16637@mail.gmail.com>

To avoid duplications, I would delete the definitions below from every
gtxxx.ch and add them to inkey.ch.

xHarbour's inkey.ch has #ifdef HB_EXT_INKEY that change K_CTRL and
K_SH codes to avoid "collisions" of codes. I know that it can't be the
default but I think that it could be useful to others and it doesn't
change normal behavour.

May I change inkey.ch?

regards,
Lorenzo

/* xHarbour compatible definitions */
#define K_SH_LEFT            K_LEFT   /* Shift-Left  == Left  */
#define K_SH_UP              K_UP     /* Shift-Up    == Up    */
#define K_SH_RIGHT           K_RIGHT  /* Shift-Right == Right */
#define K_SH_DOWN            K_DOWN   /* Shift-Down  == Down  */
#define K_SH_INS             K_INS    /* Shift-Ins   == Ins   */
#define K_SH_DEL             K_DEL    /* Shift-Del   == Del   */
#define K_SH_HOME            K_HOME   /* Shift-Home  == Home  */
#define K_SH_END             K_END    /* Shift-End   == End   */
#define K_SH_PGUP            K_PGUP   /* Shift-PgUp  == PgUp  */
#define K_SH_PGDN            K_PGDN   /* Shift-PgDn  == PgDn  */
#define K_SH_RETURN          K_RETURN /* Shift-Enter == Enter */
#define K_SH_ENTER           K_ENTER  /* Shift-Enter == Enter */
From antonioharbour at gmail.com  Wed May  9 04:43:15 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Wed May  9 04:43:23 2007
Subject: [Harbour] Changelog 2007-05-09 10:41 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <464189a6.127a7a07.557c.2947@mx.google.com>

2007-05-09 10:41 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     + New functions HB_AdoRddGetConnection( [<nWorkArea>] ) -->
oAdoConnection
       and HB_AdoRddGetCatalog( [<nWorkArea>] ) --> oAdoCatalog

Regards,

Antonio

From antonioharbour at gmail.com  Wed May  9 04:57:06 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Wed May  9 04:57:18 2007
Subject: [Harbour] Changelog 2007-05-09 10:55 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <46418ce4.177ea61a.7521.6734@mx.google.com>

2007-05-09 10:55 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     + Added function HB_AdoRddGetRecordSet( [<nWorkArea>] ) -->
oAdoRecordset

Regards,

Antonio

From harbour.01 at syenar.hu  Wed May  9 05:05:00 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 05:05:15 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <464186CA.6320F697@libero.it>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
Message-ID: <7CE202B7-CFF9-481A-94DC-0E2571F2EEE8@syenar.hu>

Thanks Maurilio,

What I still wonder is what could be the advantage of them
compared to a FUNCTION and function pointer (or a codeblock
wrapper, besides the small overhead).

--------------------------------------------------- Classic
PROC Main()
       ...
       nResult := AScan( array, {|x,y| ComplicateCompare( x, y ) } )
       ...
       RETURN

STATIC FUNCTION ComplicateCompare( x, y )
       ...
       RETURN r

--------------------------------------------------- With inline  
codeblock
PROC Main()
       LOCAL bBlock

       BEGIN CODEBLOCK bBlock WITH x, y
             ...
       END BLOCK
       ...
       nResult := AScan( array, bBlock )
       ...
       RETURN

or (if I understand correctly)

--------------------------------------------------- Classic
PROC Main()
       ...
       @ 10, 10 GET string VALID Check()
       ...
       RETURN

STATIC FUNCTION Check( GetList, string )
       ...
       RETURN .T.

--------------------------------------------------- With inline function
PROC Main()
       ...
       BEGIN FUNCTION Check WITH GetList, string
             ...
             RETURN .T.
       END
       ...
       @ 10, 10 GET string VALID Check()
       ...
       RETURN

The advantage I see here, it's that it's visually obvious that the  
helper
function is only used in Main() and that it belongs to it's  
functionality.
A STATIC can be called from anywhere.

I tend to like this feature.

As for the syntax, can we support this:
BEGIN FUNCTION Check( GetList, string) ??
END

It would be much easier to move around STATIC FUNCs this way,
and the syntax would almost similar to a "normal" function, which
is IMO nicer.

Brgds,
Viktor


On 2007.05.09., at 10:31, Maurilio Longo wrote:

> Viktor,
>
> I'm using extended codeblocks with xharbour just like pascal nested
> procedures.
>
> They are handy when, for example, you issue a dbEval() or an AEval 
> () and a
> simple codeblock becomes an obscure concatenation of iif()s while  
> calling a
> functions is a little bit of an overkill.
>
> I'd like to use them with hwGUI as well, but there are problems  
> with the
> pre-processor so I cannot simply use them when defining some GUI  
> element
> behaviour.
>
> I mean,
>
> @ x,y OWNERBUTTON ....
>       ON SIZE {|| ... }
>
> Here, at the ON SIZE it would be very handy to be able to write an  
> extended
> codeblock, and xharbour syntax seem more apt to this task, but the
> pre-processor does not like a
>
>       ON SIZE < | ... |
>>
>
> and this is a pity!
>
> So, I think, it would be usefull to find a way to address this  
> issue now that
> you're rewriting extended codeblocks.
>
> Maurilio.
>
>
> Szak?ts Viktor ha scritto:
>>
>>> looks nice for me and in the future for nested functions/procedures
>>> we can use:
>>>     BEGIN FUNCTION <funcName> [WITH <params,...>]
>>>         ...
>>>     END[FUNC]
>>
>> BEGIN CODE[BLOCK] and BEGIN FUNCTION look nice to me.
>>
>> I would also welcome some real world examples from those who
>> have experience with this language feature to show its usefullness.
>>
>> Brgds,
>> Viktor
>>
>>> but maybe you have other/better propositions, f.e. I also like
>>>     SUBF[UNCTION]
>>> proposed by Mindaugas. I can add alternativ support for declaring
>>> local
>>> parameters like in normal functions so we may have:
>>>     CODEBLOCK <cbVar> ( [ <params,...> ] )
>>>         ...
>>>     ENDCODE
>>> and:
>>>     SUBFUNC <funcName> ( [ <params,...> ] )
>>>         ...
>>>     ENDFUNC
>>>
>>>
>>> Your opinion?
>>>
>>> best regards,
>>> Przemek
>>>
>>>
>>>
>>>
>>> 2007-05-XX XX:XX UTC+0200 Przemyslaw Czerpak (druzus/at/ 
>>> priv.onet.pl)
>>>   * harbour/include/hbcomp.h
>>>   * harbour/include/hbcompdf.h
>>>   * harbour/include/hbexpra.c
>>>   * harbour/include/hbexprb.c
>>>   * harbour/include/hbexprop.h
>>>   * harbour/include/hbpp.h
>>>   * harbour/source/compiler/complex.c
>>>   * harbour/source/compiler/genc.c
>>>   * harbour/source/compiler/gencli.c
>>>   * harbour/source/compiler/genobj32.c
>>>   * harbour/source/compiler/harbour.y
>>>   * harbour/source/compiler/harbour.yyc
>>>   * harbour/source/compiler/harbour.yyh
>>>   * harbour/source/compiler/hbmain.c
>>>     * changed code used for variable scoping - now it's much more
>>>       simple (only one function) and allows to use declarations in
>>>       nested functions/codeblocks with visibility similar to Pascal
>>>     ! fixed parsing FILED <fields,...> IN <alias>
>>>       we were accepting code like:
>>>          FIELD f1, f2 IN db1, f3 IN db2 IN db3
>>>       and for all fields the last alias (db2 in this example) was  
>>> used
>>>     ! fixed calculating number of static variables with -b  
>>> (debugger)
>>>       compilation (number of file wide statics were doubled)
>>>     ! fixed generation of static variable names for debugger when
>>> declared
>>>       with array dimensions, f.e.:
>>>          static sVar[3]
>>>     + added support for extended codeblocks:
>>>          [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
>>>             <statement1>
>>>             ...
>>>             <statementN>
>>>             return <val>
>>>          END[CODE]
>>>       Such codeblocks allow nested definitions. They can also have
>>> their
>>>       own variable declarations (local, static, field, memvar,
>>> parameters,
>>>       private, public) and visibility of declared variables is
>>> similar to
>>>       nested function in Pascal but please note that there is one
>>> limitation
>>>       which exists also for normal codeblocks (Clipper compatible
>>> behavior):
>>>       internal codeblock local parameters and local variables
>>> cannot be
>>>       used in nested codeblocks, f.e. such code:
>>>             eval( { |p| eval( {|| qout( p + 1 ) } ) } )
>>>       is illegal in Clipper and Harbour. This limitation also can be
>>>       eliminated but but it will be necessary to make deeper
>>> modifications
>>>       in code for local detaching changing the method of generating
>>>       codeblocks local variables in nested blocks so unlike the  
>>> above
>>>       also some modifications in HVM will be necessary.
>>>
>>>
>>>       The syntax is intentionally differ then the one used by
>>> xHarbour:
>>>             <cbVar> := < |<params,...>|
>>>                <statement1>
>>>                ...
>>>                <statementN>
>>>>
>>>       because such "expression like" form breaks PP rules. For
>>> grammar parser
>>>       it's multi line expression when whole PP logic and other
>>> grammar rules
>>>       are line oriented (the line concatenator ';' creates single
>>> line for
>>>       compiler). It causes bad side effects, f.e.:
>>>          qout( eval( <||
>>>                         ? "Hello"
>>>                         return "world!!!"
>>>> ) )
>>>       works but when used as part of preprocessor command:
>>>          ? eval( <||
>>>                     ? "Hello"
>>>                     return "world!!!"
>>>> )
>>>       will never work and it's not sth what can be "fixed".
>>> See .ppo file
>>>       generated for the above example to find why.
>>>       To avoid users confusions I intentionally chose differ syntax.
>>>       There are also some other differences to xHarbour:
>>>          - any variable declarations like in normal function can be
>>> used
>>>            also STATICs, PARAMETERs and variable number of
>>> parameters are
>>>            supported, f.e.:
>>>                codeblock cbVar with p1, p2, ...
>>>                   local l1:="l1", l2:="l2"
>>>                   static s1:="s1", s2:="s2"
>>>                   ? p1, p2, "[", ..., "]"
>>>                   ? l1, l2
>>>                   ? s1, s2
>>>                endcode
>>>          - locals are not emulated by adding them to parameter  
>>> list so
>>>            they are initialized by default to NIL and do not  
>>> interact
>>>            with parameters passed to eval().
>>>          - return statement is suggested by compiler when -w switch
>>> is used
>>>            when return statement is missing then codeblock is
>>> finished like
>>>            normal procedure without popping the top most HVM stack
>>> value to
>>>            return item.
>>>          - the visibility of declared variables is like in nested
>>> Pascal
>>>            functions (see note above about exception for locals)
>>> _______________________________________________
>>> Harbour mailing list
>>> Harbour@harbour-project.org
>>> http://lists.harbour-project.org/mailman/listinfo/harbour
>>
>> _______________________________________________
>> Harbour mailing list
>> Harbour@harbour-project.org
>> http://lists.harbour-project.org/mailman/listinfo/harbour
>
> -- 
>  __________
> |  |  | |__| Maurilio Longo
> |_|_|_|____| farmaconsult s.r.l.
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Wed May  9 05:13:10 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 05:13:23 2007
Subject: [Harbour] inkey.ch and gtxxx.ch cleanup
In-Reply-To: <9257026e0705090141jfd731f9kc73fc20255b16637@mail.gmail.com>
References: <9257026e0705090141jfd731f9kc73fc20255b16637@mail.gmail.com>
Message-ID: <E334D13A-C68D-4A46-BF53-EA3385F8A5DF@syenar.hu>

Hi Lorenzo,

I think the right place for these is hbcompat.ch.
(until none of these keycodes are doing anything
extra beyond the original behaviour, which is the
case now in Harbour).

If they'd really mean what they are, I'd consider
hbinkey.ch (which would add these, and include
inkey.ch).

Brgds,
Viktor

On 2007.05.09., at 10:41, Lorenzo Fiorini wrote:

> To avoid duplications, I would delete the definitions below from every
> gtxxx.ch and add them to inkey.ch.
>
> xHarbour's inkey.ch has #ifdef HB_EXT_INKEY that change K_CTRL and
> K_SH codes to avoid "collisions" of codes. I know that it can't be the
> default but I think that it could be useful to others and it doesn't
> change normal behavour.
>
> May I change inkey.ch?
>
> regards,
> Lorenzo
>
> /* xHarbour compatible definitions */
> #define K_SH_LEFT            K_LEFT   /* Shift-Left  == Left  */
> #define K_SH_UP              K_UP     /* Shift-Up    == Up    */
> #define K_SH_RIGHT           K_RIGHT  /* Shift-Right == Right */
> #define K_SH_DOWN            K_DOWN   /* Shift-Down  == Down  */
> #define K_SH_INS             K_INS    /* Shift-Ins   == Ins   */
> #define K_SH_DEL             K_DEL    /* Shift-Del   == Del   */
> #define K_SH_HOME            K_HOME   /* Shift-Home  == Home  */
> #define K_SH_END             K_END    /* Shift-End   == End   */
> #define K_SH_PGUP            K_PGUP   /* Shift-PgUp  == PgUp  */
> #define K_SH_PGDN            K_PGDN   /* Shift-PgDn  == PgDn  */
> #define K_SH_RETURN          K_RETURN /* Shift-Enter == Enter */
> #define K_SH_ENTER           K_ENTER  /* Shift-Enter == Enter */
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Wed May  9 05:28:46 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May  9 05:29:23 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <7CE202B7-CFF9-481A-94DC-0E2571F2EEE8@syenar.hu>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<7CE202B7-CFF9-481A-94DC-0E2571F2EEE8@syenar.hu>
Message-ID: <20070509092846.GA3235@localhost.localdomain>

On Wed, 09 May 2007, Szak?ts Viktor wrote:
> Thanks Maurilio,
> What I still wonder is what could be the advantage of them
> compared to a FUNCTION and function pointer (or a codeblock
> wrapper, besides the small overhead).

Common detached local variables which you will not have to pass
by reference to other functions and which are also shared with
other codeblocks defined in the same function.

[...]
> The advantage I see here, it's that it's visually obvious that the  
> helper
> function is only used in Main() and that it belongs to it's  
> functionality.
> A STATIC can be called from anywhere.
> I tend to like this feature.
> 
> As for the syntax, can we support this:
> BEGIN FUNCTION Check( GetList, string) ??
> END
> It would be much easier to move around STATIC FUNCs this way,
> and the syntax would almost similar to a "normal" function, which
> is IMO nicer.

There is a problem with detaching local variables in nested functions.
Even if I'll add them then I will have to forbid local variable sharing
or storing internal function pointers because executed in other context
will not work. It means that they cannot be used in natural form inside
codeblocks (using function in a codeblock is strong pointer to it).
To make nested functions well I will have to strongly change the code
to manage and detach local variables in HVM - I do not want to make it
in the nearest future - there are some other more important things.

best regards,
Przemek
From maurilio.longo at libero.it  Wed May  9 05:37:48 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Wed May  9 05:38:34 2007
Subject: [Harbour] multiline codeblocks - final version
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<7CE202B7-CFF9-481A-94DC-0E2571F2EEE8@syenar.hu>
Message-ID: <4641966C.1FD7CCFC@libero.it>

Szak?ts Viktor ha scritto:
> 
> Thanks Maurilio,
> 
> What I still wonder is what could be the advantage of them
> compared to a FUNCTION and function pointer (or a codeblock
> wrapper, besides the small overhead).
> 

Sometimes they call it 'syntactic sugar', that is, a way to write something
that is easier to the eye and to the writer :)


> --------------------------------------------------- Classic
> PROC Main()
>        ...
>        nResult := AScan( array, {|x,y| ComplicateCompare( x, y ) } )
>        ...
>        RETURN
> 
> STATIC FUNCTION ComplicateCompare( x, y )
>        ...
>        RETURN r
> 

But if you have a lot of them you end up with a lot of static functions which
do very little, while a 

nResult := AScan( array, < | x, y |
                             if x ....
		             elseif ...
                             elseif ...
                             ...
                         > )

is, at least for me, a lot more 'clean' a way to write it.
			      

> --------------------------------------------------- With inline
> codeblock
> PROC Main()
>        LOCAL bBlock
> 
>        BEGIN CODEBLOCK bBlock WITH x, y
>              ...
>        END BLOCK
>        ...
>        nResult := AScan( array, bBlock )
>        ...
>        RETURN
> 

This one is 'ugly' and should, IMHO, be changed to the one I wrote before, but
if I'm not wrong, current harbour syntax does not allow this. 


> or (if I understand correctly)
> 
> --------------------------------------------------- Classic
> PROC Main()
>        ...
>        @ 10, 10 GET string VALID Check()
>        ...
>        RETURN
> 
> STATIC FUNCTION Check( GetList, string )
>        ...
>        RETURN .T.
> 
> --------------------------------------------------- With inline function
> PROC Main()
>        ...
>        BEGIN FUNCTION Check WITH GetList, string
>              ...
>              RETURN .T.
>        END
>        ...
>        @ 10, 10 GET string VALID Check()
>        ...
>        RETURN
> 

I'd like to write it like

@ 10, 10 GET string VALID < | GetList, string |
                             ...
                             ...
                          >

So that all that you need to understand what the code is doing is clearly
visible where it is used (think about a complex form with tens of GETs...)

> The advantage I see here, it's that it's visually obvious that the
> helper
> function is only used in Main() and that it belongs to it's
> functionality.

Exactly.

> A STATIC can be called from anywhere.
> 
> I tend to like this feature.

:)

> 
> As for the syntax, can we support this:
> BEGIN FUNCTION Check( GetList, string) ??
> END
> 

IMHO, it should say

BEGIN BLOCK Check( ... )

since it is not a 'function' but a code block, but, it is the inline syntax
which is the more clear to write and the more 'sweet' :), since here we are
just replacing a 

static function x()

with a 

begin function x()

and this causes that visual 'pollution' of functions of which I was taking
before, and 'breaks' the fact that in clipper codeblocks don't have names.

Regards.

Maurilio.


> It would be much easier to move around STATIC FUNCs this way,
> and the syntax would almost similar to a "normal" function, which
> is IMO nicer.
> 
> Brgds,
> Viktor
> 
> On 2007.05.09., at 10:31, Maurilio Longo wrote:
> 
> > Viktor,
> >
> > I'm using extended codeblocks with xharbour just like pascal nested
> > procedures.
> >
> > They are handy when, for example, you issue a dbEval() or an AEval
> > () and a
> > simple codeblock becomes an obscure concatenation of iif()s while
> > calling a
> > functions is a little bit of an overkill.
> >
> > I'd like to use them with hwGUI as well, but there are problems
> > with the
> > pre-processor so I cannot simply use them when defining some GUI
> > element
> > behaviour.
> >
> > I mean,
> >
> > @ x,y OWNERBUTTON ....
> >       ON SIZE {|| ... }
> >
> > Here, at the ON SIZE it would be very handy to be able to write an
> > extended
> > codeblock, and xharbour syntax seem more apt to this task, but the
> > pre-processor does not like a
> >
> >       ON SIZE < | ... |
> >>
> >
> > and this is a pity!
> >
> > So, I think, it would be usefull to find a way to address this
> > issue now that
> > you're rewriting extended codeblocks.
> >
> > Maurilio.
> >
> >
> > Szak?ts Viktor ha scritto:
> >>
> >>> looks nice for me and in the future for nested functions/procedures
> >>> we can use:
> >>>     BEGIN FUNCTION <funcName> [WITH <params,...>]
> >>>         ...
> >>>     END[FUNC]
> >>
> >> BEGIN CODE[BLOCK] and BEGIN FUNCTION look nice to me.
> >>
> >> I would also welcome some real world examples from those who
> >> have experience with this language feature to show its usefullness.
> >>
> >> Brgds,
> >> Viktor
> >>
> >>> but maybe you have other/better propositions, f.e. I also like
> >>>     SUBF[UNCTION]
> >>> proposed by Mindaugas. I can add alternativ support for declaring
> >>> local
> >>> parameters like in normal functions so we may have:
> >>>     CODEBLOCK <cbVar> ( [ <params,...> ] )
> >>>         ...
> >>>     ENDCODE
> >>> and:
> >>>     SUBFUNC <funcName> ( [ <params,...> ] )
> >>>         ...
> >>>     ENDFUNC
> >>>
> >>>
> >>> Your opinion?
> >>>
> >>> best regards,
> >>> Przemek
> >>>
> >>>
> >>>
> >>>
> >>> 2007-05-XX XX:XX UTC+0200 Przemyslaw Czerpak (druzus/at/
> >>> priv.onet.pl)
> >>>   * harbour/include/hbcomp.h
> >>>   * harbour/include/hbcompdf.h
> >>>   * harbour/include/hbexpra.c
> >>>   * harbour/include/hbexprb.c
> >>>   * harbour/include/hbexprop.h
> >>>   * harbour/include/hbpp.h
> >>>   * harbour/source/compiler/complex.c
> >>>   * harbour/source/compiler/genc.c
> >>>   * harbour/source/compiler/gencli.c
> >>>   * harbour/source/compiler/genobj32.c
> >>>   * harbour/source/compiler/harbour.y
> >>>   * harbour/source/compiler/harbour.yyc
> >>>   * harbour/source/compiler/harbour.yyh
> >>>   * harbour/source/compiler/hbmain.c
> >>>     * changed code used for variable scoping - now it's much more
> >>>       simple (only one function) and allows to use declarations in
> >>>       nested functions/codeblocks with visibility similar to Pascal
> >>>     ! fixed parsing FILED <fields,...> IN <alias>
> >>>       we were accepting code like:
> >>>          FIELD f1, f2 IN db1, f3 IN db2 IN db3
> >>>       and for all fields the last alias (db2 in this example) was
> >>> used
> >>>     ! fixed calculating number of static variables with -b
> >>> (debugger)
> >>>       compilation (number of file wide statics were doubled)
> >>>     ! fixed generation of static variable names for debugger when
> >>> declared
> >>>       with array dimensions, f.e.:
> >>>          static sVar[3]
> >>>     + added support for extended codeblocks:
> >>>          [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
> >>>             <statement1>
> >>>             ...
> >>>             <statementN>
> >>>             return <val>
> >>>          END[CODE]
> >>>       Such codeblocks allow nested definitions. They can also have
> >>> their
> >>>       own variable declarations (local, static, field, memvar,
> >>> parameters,
> >>>       private, public) and visibility of declared variables is
> >>> similar to
> >>>       nested function in Pascal but please note that there is one
> >>> limitation
> >>>       which exists also for normal codeblocks (Clipper compatible
> >>> behavior):
> >>>       internal codeblock local parameters and local variables
> >>> cannot be
> >>>       used in nested codeblocks, f.e. such code:
> >>>             eval( { |p| eval( {|| qout( p + 1 ) } ) } )
> >>>       is illegal in Clipper and Harbour. This limitation also can be
> >>>       eliminated but but it will be necessary to make deeper
> >>> modifications
> >>>       in code for local detaching changing the method of generating
> >>>       codeblocks local variables in nested blocks so unlike the
> >>> above
> >>>       also some modifications in HVM will be necessary.
> >>>
> >>>
> >>>       The syntax is intentionally differ then the one used by
> >>> xHarbour:
> >>>             <cbVar> := < |<params,...>|
> >>>                <statement1>
> >>>                ...
> >>>                <statementN>
> >>>>
> >>>       because such "expression like" form breaks PP rules. For
> >>> grammar parser
> >>>       it's multi line expression when whole PP logic and other
> >>> grammar rules
> >>>       are line oriented (the line concatenator ';' creates single
> >>> line for
> >>>       compiler). It causes bad side effects, f.e.:
> >>>          qout( eval( <||
> >>>                         ? "Hello"
> >>>                         return "world!!!"
> >>>> ) )
> >>>       works but when used as part of preprocessor command:
> >>>          ? eval( <||
> >>>                     ? "Hello"
> >>>                     return "world!!!"
> >>>> )
> >>>       will never work and it's not sth what can be "fixed".
> >>> See .ppo file
> >>>       generated for the above example to find why.
> >>>       To avoid users confusions I intentionally chose differ syntax.
> >>>       There are also some other differences to xHarbour:
> >>>          - any variable declarations like in normal function can be
> >>> used
> >>>            also STATICs, PARAMETERs and variable number of
> >>> parameters are
> >>>            supported, f.e.:
> >>>                codeblock cbVar with p1, p2, ...
> >>>                   local l1:="l1", l2:="l2"
> >>>                   static s1:="s1", s2:="s2"
> >>>                   ? p1, p2, "[", ..., "]"
> >>>                   ? l1, l2
> >>>                   ? s1, s2
> >>>                endcode
> >>>          - locals are not emulated by adding them to parameter
> >>> list so
> >>>            they are initialized by default to NIL and do not
> >>> interact
> >>>            with parameters passed to eval().
> >>>          - return statement is suggested by compiler when -w switch
> >>> is used
> >>>            when return statement is missing then codeblock is
> >>> finished like
> >>>            normal procedure without popping the top most HVM stack
> >>> value to
> >>>            return item.
> >>>          - the visibility of declared variables is like in nested
> >>> Pascal
> >>>            functions (see note above about exception for locals)
> >>> _______________________________________________
> >>> Harbour mailing list
> >>> Harbour@harbour-project.org
> >>> http://lists.harbour-project.org/mailman/listinfo/harbour
> >>
> >> _______________________________________________
> >> Harbour mailing list
> >> Harbour@harbour-project.org
> >> http://lists.harbour-project.org/mailman/listinfo/harbour
> >
> > --
> >  __________
> > |  |  | |__| Maurilio Longo
> > |_|_|_|____| farmaconsult s.r.l.
> > _______________________________________________
> > Harbour mailing list
> > Harbour@harbour-project.org
> > http://lists.harbour-project.org/mailman/listinfo/harbour
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From harbour.01 at syenar.hu  Wed May  9 05:43:38 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 05:43:53 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <20070509092846.GA3235@localhost.localdomain>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<7CE202B7-CFF9-481A-94DC-0E2571F2EEE8@syenar.hu>
	<20070509092846.GA3235@localhost.localdomain>
Message-ID: <EDCDFEA8-480B-4C36-A6AC-FD77E16DFFC1@syenar.hu>

>> It would be much easier to move around STATIC FUNCs this way,
>> and the syntax would almost similar to a "normal" function, which
>> is IMO nicer.
>
> There is a problem with detaching local variables in nested functions.
> Even if I'll add them then I will have to forbid local variable  
> sharing
> or storing internal function pointers because executed in other  
> context
> will not work. It means that they cannot be used in natural form  
> inside
> codeblocks (using function in a codeblock is strong pointer to it).
> To make nested functions well I will have to strongly change the code
> to manage and detach local variables in HVM - I do not want to make it
> in the nearest future - there are some other more important things.

In "moving around" I meant changing existing code by moving
STATICs inside the real host function as "inline" functions.

Now that you told that vars of the host function will be visible
the whole problem changes as bit, since the original parameter
list would not be needed in most of the cases. This is fine then.

(I'm not sure I had fully grasped the detach problem though)

Brgds,
Viktor

From lorenzo.fiorini at gmail.com  Wed May  9 06:14:03 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May  9 06:14:06 2007
Subject: [Harbour] inkey.ch and gtxxx.ch cleanup
In-Reply-To: <E334D13A-C68D-4A46-BF53-EA3385F8A5DF@syenar.hu>
References: <9257026e0705090141jfd731f9kc73fc20255b16637@mail.gmail.com>
	<E334D13A-C68D-4A46-BF53-EA3385F8A5DF@syenar.hu>
Message-ID: <9257026e0705090314g48d04237u7e8f1575bb673c7e@mail.gmail.com>

On 5/9/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> I think the right place for these is hbcompat.ch.
> (until none of these keycodes are doing anything
> extra beyond the original behaviour, which is the
> case now in Harbour).

No problem I'll keep them local.

regards,
Lorenzo
From dbtopas at dbtopas.lt  Wed May  9 08:00:10 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Wed May  9 07:57:05 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <20070509031459.GA2556@localhost.localdomain>
References: <20070509031459.GA2556@localhost.localdomain>
Message-ID: <4641B7CA.4090000@dbtopas.lt>

> We can discuss yet on used names:
>     [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
>         ...
>     END[CODE]
> looks nice for me and in the future for nested functions/procedures
> we can use:
>     BEGIN FUNCTION <funcName> [WITH <params,...>]
>         ...
>     END[FUNC]
> but maybe you have other/better propositions, f.e. I also like
>     SUBF[UNCTION] 
> proposed by Mindaugas. I can add alternativ support for declaring local
> parameters like in normal functions so we may have:
>     CODEBLOCK <cbVar> ( [ <params,...> ] )
>         ...
>     ENDCODE
> and:
>     SUBFUNC <funcName> ( [ <params,...> ] )
>         ...
>     ENDFUNC

Hello,


since we have discussion about syntax style, I want to explain my point 
of view more detail. The most difference between
   [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
and
   CODEBLOCK <cbVar> ( [ <params,...> ] )
is the difference between command vs function style of programming.

I do not like command style. I never write
    SET DATE FORMAT TO "yyyy-mm-dd"
but always
    SET( 4, "yyyy-mm-dd" ).

I do not use commands at all (with a small exceptions), so I do not like 
CODEBLOCK <cbVar> WITH <params> syntax also. You can say, that it is 
only my style of programming, but let's look at the Clipper language itself.
Clipper (like majority of other compiled languages) has function like 
syntax. But it was created in the age of dBase, and compability with 
dBase (command style) syntax was required. Preprocessor functionality 
was extended to solve this compability problem. And now we have:
   #command USE ...          => DBUSEAREA(...)
   #command GO TOP           => DBGOTOP()
   #command SKIP             => DBSKIP()
   #command INDEX ON ...     => ORDCONDSET(...);  ORDCREATE(...)
If we follow the same language development model, than perhaps we must 
have syntax
   CODEBLOCK <cbVar> ( [ <params,...> ] )
and a line in std.ch:
    #command [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>] => ;
             CODEBLOCK <cbVar> ( <params,...> )

BTW, Clipper has codeblock, but other languages does not have such type 
of variables with detached locals. I thing codeblock were created also 
to support dBase style syntax via preprocessor. Codeblocks are the way 
to support executable expressions inside dBase style commands, ex.
    index on FIELD1+SOMEFUNC(FIELD2) to ...


Best regards,
Mindaugas
From fmancera at viaopen.com  Wed May  9 09:05:26 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Wed May  9 09:06:01 2007
Subject: [Harbour] Changelog 2007-05-09 15:03 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
Message-ID: <000001c7923a$b6f95320$3e02a8c0@PORTATIL>


2007-05-09 15:03 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
   * contrib/adordd/adordd.prg
     + Improved Deleted()

Regards,

Fernando Mancera

From antonioharbour at gmail.com  Wed May  9 09:29:39 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Wed May  9 09:29:57 2007
Subject: [Harbour] Changelog 2007-05-09 15:28 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
In-Reply-To: <000001c7923a$b6f95320$3e02a8c0@PORTATIL>
Message-ID: <4641ccc7.3e2266ce.6043.ffffe1be@mx.google.com>

2007-05-09 15:28 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * Improved ADO_CLEARREL()

Regards,

Antonio

From harbour.01 at syenar.hu  Wed May  9 11:44:04 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 11:44:22 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <4641966C.1FD7CCFC@libero.it>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<7CE202B7-CFF9-481A-94DC-0E2571F2EEE8@syenar.hu>
	<4641966C.1FD7CCFC@libero.it>
Message-ID: <1F167569-9623-4429-BF7A-08B011786627@syenar.hu>

> But if you have a lot of them you end up with a lot of static  
> functions which
> do very little, while a
>
> nResult := AScan( array, < | x, y |
>                              if x ....
> 		             elseif ...
>                              elseif ...
>                              ...
>> )
>
> is, at least for me, a lot more 'clean' a way to write it.

I see. but we don't plan to support this Harbour, just because
its possible flaws and PP problems. (If we'd ever support it, I'd  
still vote
to use {||} syntax for it)

> So that all that you need to understand what the code is doing is  
> clearly
> visible where it is used (think about a complex form with tens of  
> GETs...)
>
>> The advantage I see here, it's that it's visually obvious that the
>> helper
>> function is only used in Main() and that it belongs to it's
>> functionality.
>
> Exactly.
>
>> A STATIC can be called from anywhere.
>>
>> I tend to like this feature.
>
> :)
>
>>
>> As for the syntax, can we support this:
>> BEGIN FUNCTION Check( GetList, string) ??
>> END
>>
>
> IMHO, it should say
>
> BEGIN BLOCK Check( ... )
>
> since it is not a 'function' but a code block, but, it is the  
> inline syntax
> which is the more clear to write and the more 'sweet' :), since  
> here we are
> just replacing a
>
> static function x()
>
> with a
>
> begin function x()
>
> and this causes that visual 'pollution' of functions of which I was  
> taking
> before, and 'breaks' the fact that in clipper codeblocks don't have  
> names.

Still it has two advantages:
1) The function lies inside the one which is using it, so the source  
is better sttructured.
      (for example you can add helper functions inside methods  
without the need to
      pollute even the local file's namespace with STATICs.
      To make this smooth and familiar looking, and you a syntax as  
similar to normal
      functions as possible.
2) The function would "see" the variables of the host function, so  
you wouldn't have
      to pass them as parameters (which is very common in my code for  
GET VALID/WHEN
      checks for example).

We're indeed not getting the namelessness and inlineness.

Brgds,
Viktor

From druzus at priv.onet.pl  Wed May  9 12:22:14 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May  9 12:22:49 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <464186CA.6320F697@libero.it>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
Message-ID: <20070509162214.GA3730@localhost.localdomain>

On Wed, 09 May 2007, Maurilio Longo wrote:
> I mean,
> @ x,y OWNERBUTTON ....
>       ON SIZE {|| ... }
> Here, at the ON SIZE it would be very handy to be able to write an extended
> codeblock, and xharbour syntax seem more apt to this task, but the
> pre-processor does not like a 
>       ON SIZE < | ... | 
> and this is a pity!
> So, I think, it would be usefull to find a way to address this issue now that
> you're rewriting extended codeblocks.

It's impossible to "fix" - you will have to define new mutliline PP logic.
Please read carefully what I wrote and analyze this example:

    ? eval( <||
               ? "Hello"
               return "world!!!"
            > )

Please note that you need #command translation for all the above
4 lines used as single line for external '?' command but in such
case you will break internal '?' command translation. You will
need #commands working inside #commands so we are starting with
sth what is not Clipper compatible. The same if for all other
translation preprocessor directives.
The above is very trivial example and I can create much more complicated
ones with nested multiline codeblocks or with preprocessor directives
inside extended codeblock, f.e. with #include what means that PP cannot
be longer line oriented but will have to be able preprocess whole code
in at least two passes with some additional rules. It should not make
#[x]command translations for lines which ends with:
    < | [ <!var!,...> ] |
and lines which starts with:
    >
in the first pass and translates the rest using standard rules.
The line contents should be control during preprocessing not just after
reading the line from file because such code can appear after some #define/
#[x]translate translations.
Then it should try to create internally single expression(s) from existing
extended codeblock and repeat preprocessing starting from the line where
extended codeblock begins. Unfortunately inside extended codeblock new
preprocessor rules can appear so we will have sth like rules working for
the lines before the place where they were defined. We can ignore this
problem though I do not like very much such things. The most important
thing is that PP does not know anything about grammar rules and it's
very nice feature because it allows to keep PP separated from compiler
and create new PP commands with expressions which are not accepted by
grammar parser. Here we will have to hardcode some grammar construction
into PP logic. We will also change the PP behavior what may interact with
existing code but starting expression:
    < | [ <!var!,...> ] | <EOL>
seems to be unique enough to reduce the problem - PP will look for lines
starting with '>' character (end of codeblock) only when it finds valid
starting expression and just after locating it it can begin the second
pass translation with multiline codeblock used as single expression
returning to the line when code block definition starts. It will work
with minimal compatibility overhead. I hope I described quite precisely
what should be done and with new PP code it does not seems to be very
hard job. Anyone interested can start such PP modifications - personally
I'm not, at least now.

best regards,
Przemek
From harbour.01 at syenar.hu  Wed May  9 12:37:36 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 12:37:50 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <20070509162214.GA3730@localhost.localdomain>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<20070509162214.GA3730@localhost.localdomain>
Message-ID: <80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>

>     < | [ <!var!,...> ] | <EOL>
> seems to be unique enough to reduce the problem - PP will look for  
> lines
> starting with '>' character (end of codeblock) only when it finds  
> valid
> starting expression and just after locating it it can begin the second
> pass translation with multiline codeblock used as single expression
> returning to the line when code block definition starts. It will work
> with minimal compatibility overhead. I hope I described quite  
> precisely
> what should be done and with new PP code it does not seems to be very
> hard job. Anyone interested can start such PP modifications -  
> personally
> I'm not, at least now.

Let's pls keep it clean and modular, otherwise we'll be creating
problems for the future.

As an aside what is the difference in using {|| ... } for "extended"
codeblocks as opposed to the <|| ... > ? I mean, does using the
new synatx introduce any advantage in the implementation?

Brgds,
Viktor

From miguelangel at marchuet.net  Wed May  9 12:48:07 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May  9 12:47:43 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>
References: <20070509031459.GA2556@localhost.localdomain>	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>	<464186CA.6320F697@libero.it>	<20070509162214.GA3730@localhost.localdomain>
	<80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>
Message-ID: <4641FB47.6020903@marchuet.net>

Because some many people who works with harbour and xharbour can't use
the same code...

I think that is better to use {|| ... } syntax than others, but some people
use two compilers, harbour and xharbour and for this reason, Why not <|| ... >

and possible confusions of 2 type of codeblocks will be easily identifies.

Best regards,
Miguel Angel Marchuet

Szak?ts Viktor escribi?:
>>     < | [ <!var!,...> ] | <EOL>
>> seems to be unique enough to reduce the problem - PP will look for lines
>> starting with '>' character (end of codeblock) only when it finds valid
>> starting expression and just after locating it it can begin the second
>> pass translation with multiline codeblock used as single expression
>> returning to the line when code block definition starts. It will work
>> with minimal compatibility overhead. I hope I described quite precisely
>> what should be done and with new PP code it does not seems to be very
>> hard job. Anyone interested can start such PP modifications - personally
>> I'm not, at least now.
> 
> Let's pls keep it clean and modular, otherwise we'll be creating
> problems for the future.
> 
> As an aside what is the difference in using {|| ... } for "extended"
> codeblocks as opposed to the <|| ... > ? I mean, does using the
> new synatx introduce any advantage in the implementation?
> 
> Brgds,
> Viktor
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From harbour.01 at syenar.hu  Wed May  9 12:55:46 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 12:55:55 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <4641FB47.6020903@marchuet.net>
References: <20070509031459.GA2556@localhost.localdomain>	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>	<464186CA.6320F697@libero.it>	<20070509162214.GA3730@localhost.localdomain>
	<80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>
	<4641FB47.6020903@marchuet.net>
Message-ID: <21311A10-7E4C-41E3-BC05-FD8AB1DF9A9F@syenar.hu>

> Because some many people who works with harbour and xharbour can't use
> the same code...

They can stay with xhb or not use the extension. Both are valid choices.

> I think that is better to use {|| ... } syntax than others, but  
> some people
> use two compilers, harbour and xharbour and for this reason, Why  
> not <|| ... >
>
> and possible confusions of 2 type of codeblocks will be easily  
> identifies.

I was rather asking the technical side.

Brgds,
Viktor

From druzus at priv.onet.pl  Wed May  9 13:08:37 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May  9 13:09:12 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<20070509162214.GA3730@localhost.localdomain>
	<80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>
Message-ID: <20070509170837.GA4613@localhost.localdomain>

On Wed, 09 May 2007, Szak?ts Viktor wrote:
> Let's pls keep it clean and modular, otherwise we'll be creating
> problems for the future.

This is always very important issue.
Extension which cannot be fixed and removed due to backward
compatibility is not a feature but very serious problem with
funny side effect: it blocks farther developing and adding
new features. So finally it reduce overall functionality
instead of giving valuable improvement.

> As an aside what is the difference in using {|| ... } for "extended"
> codeblocks as opposed to the <|| ... > ? I mean, does using the
> new synatx introduce any advantage in the implementation?

Nothing special. Usually it's easier to use different syntax.
With the same it will be necessary to make some additional small
modifications in grammar parser but I agree that using the same
codeblocks markers for expression like syntax looks nicer and
it's worth to invest additional few minutes for encoding.

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Wed May  9 13:10:27 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May  9 13:11:03 2007
Subject: [Harbour] Error updating latest CVS
Message-ID: <009f01c7925c$f0a6ac90$0100a8c0@emag>

cvs [update aborted]: unable to parse 
/cvsroot/harbour-project/harbour/source/vm/hvm.c,v; `author' not in the 
expected place

Error, CVS operation failed

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Wed May  9 13:23:32 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 13:24:18 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <20070509170837.GA4613@localhost.localdomain>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<20070509162214.GA3730@localhost.localdomain>
	<80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>
	<20070509170837.GA4613@localhost.localdomain>
Message-ID: <2E6AC19E-7BFC-44B3-80A0-36FA43A329F9@syenar.hu>


On 2007.05.09., at 19:08, Przemyslaw Czerpak wrote:

> On Wed, 09 May 2007, Szak?ts Viktor wrote:
>> Let's pls keep it clean and modular, otherwise we'll be creating
>> problems for the future.
>
> This is always very important issue.
> Extension which cannot be fixed and removed due to backward
> compatibility is not a feature but very serious problem with
> funny side effect: it blocks farther developing and adding
> new features. So finally it reduce overall functionality
> instead of giving valuable improvement.

This is called a hidden development/support cost (or something similar)
to be paid in the future. Sometimes it can also block further
development if we want to keep feature compatibility. (see Windows
where the developers are effectively blocked out of several
choices in current development because of past non-optimal, or
technically non-justified decisions.) (C++ could be another example,
but I don't know it enough to judge, it's just a hinch)

>> As an aside what is the difference in using {|| ... } for "extended"
>> codeblocks as opposed to the <|| ... > ? I mean, does using the
>> new synatx introduce any advantage in the implementation?
>
> Nothing special. Usually it's easier to use different syntax.
> With the same it will be necessary to make some additional small
> modifications in grammar parser but I agree that using the same
> codeblocks markers for expression like syntax looks nicer and
> it's worth to invest additional few minutes for encoding.

In this case, there is another choice for cross compatibility: xhb could
probably implement {|| ... } as "extended" codeblocks with similar
amount of work. In case we happen to opt in Harbour for this feature.

Brgds,
Viktor

From maurilio.longo at libero.it  Wed May  9 13:23:35 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Wed May  9 13:24:25 2007
Subject: [Harbour] multiline codeblocks - final version
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<20070509162214.GA3730@localhost.localdomain>
	<80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>
	<20070509170837.GA4613@localhost.localdomain>
Message-ID: <46420397.AF5235F8@libero.it>

And what if we say that an extended codeblock has the same delimiters of a
standard one, that is {|| } (there is no real need to use <||>), but every
line of it ends with a ';' ?

I mean

{ |a,b,c| ;
  ;	
  if a > b .and.;
     b < c;
     return 1;
  else;
     return 2;
  endif;
  ;
  ;
}

I looks a little bit strange at first, but gives the extended syntax advantage
without breaking the one line at a time rule.

Is this feasible?

Maurilio.



Przemyslaw Czerpak ha scritto:
> 
> On Wed, 09 May 2007, Szak?ts Viktor wrote:
> > Let's pls keep it clean and modular, otherwise we'll be creating
> > problems for the future.
> 
> This is always very important issue.
> Extension which cannot be fixed and removed due to backward
> compatibility is not a feature but very serious problem with
> funny side effect: it blocks farther developing and adding
> new features. So finally it reduce overall functionality
> instead of giving valuable improvement.
> 
> > As an aside what is the difference in using {|| ... } for "extended"
> > codeblocks as opposed to the <|| ... > ? I mean, does using the
> > new synatx introduce any advantage in the implementation?
> 
> Nothing special. Usually it's easier to use different syntax.
> With the same it will be necessary to make some additional small
> modifications in grammar parser but I agree that using the same
> codeblocks markers for expression like syntax looks nicer and
> it's worth to invest additional few minutes for encoding.
> 
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From lorenzo.fiorini at gmail.com  Wed May  9 13:24:33 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May  9 13:24:37 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
Message-ID: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>

Is it expected?

regards,
Lorenzo
From harbour.01 at syenar.hu  Wed May  9 13:32:00 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 13:32:12 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
Message-ID: <20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>

It should return .f. in Harbour too. Seems like a bug.

Brgds,
Viktor

On 2007.05.09., at 19:24, Lorenzo Fiorini wrote:

> Is it expected?
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Wed May  9 17:08:27 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May  9 17:08:35 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
Message-ID: <9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>

On 5/9/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> It should return .f. in Harbour too. Seems like a bug.

I've copied source/rtl/file.c from xHarbour and it's ok.

Should I commit it?

regards,
Lorenzo
From harbour.01 at syenar.hu  Wed May  9 17:26:11 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 17:26:27 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
Message-ID: <9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>

I'll check this more closely. xhb code is pretty unclear
and does extra tricks not found in Clipper. Moreover,
Harbour returns .F. for me for File("").

Can you show example when Harbour returns .T. for File("")?

Brgds,
Viktor

On 2007.05.09., at 23:08, Lorenzo Fiorini wrote:

> On 5/9/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
>
>> It should return .f. in Harbour too. Seems like a bug.
>
> I've copied source/rtl/file.c from xHarbour and it's ok.
>
> Should I commit it?
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Wed May  9 17:29:45 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May  9 17:29:55 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
Message-ID: <9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>

On 5/9/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> Can you show example when Harbour returns .T. for File("")?

procedure main()

  ? file("")

return

built with hbmk -n -static -gtstd test2 under Fedora 7 test4

regards,
Lorenzo
From harbour.01 at syenar.hu  Wed May  9 17:52:16 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 17:52:29 2007
Subject: [Harbour] Error updating latest CVS
In-Reply-To: <009f01c7925c$f0a6ac90$0100a8c0@emag>
References: <009f01c7925c$f0a6ac90$0100a8c0@emag>
Message-ID: <DE85A608-2003-4A33-B9E0-DD2521DCCDB9@syenar.hu>

I'm getting the same.

Brgds,
Viktor

On 2007.05.09., at 19:10, Enrico Maria Giordano wrote:

> cvs [update aborted]: unable to parse /cvsroot/harbour-project/ 
> harbour/source/vm/hvm.c,v; `author' not in the expected place
>
> Error, CVS operation failed
>
> EMG
>
> --
> EMAG Software Homepage:     http://www.emagsoftware.it
> The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
> The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
> The EMG Music page:         http://www.emagsoftware.it/emgmusic
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Wed May  9 18:11:48 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 18:12:27 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
Message-ID: <B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>

There is a much simpler fix for this in FILE() itself, but now it
looks to me the real problem is deeper inside the Harbour filefind API.

Can you check on your platform, what is the result of Directory( "" )
in a non-empty directory?

Brgds,
Viktor

On 2007.05.09., at 23:29, Lorenzo Fiorini wrote:

> On 5/9/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
>
>> Can you show example when Harbour returns .T. for File("")?
>
> procedure main()
>
>  ? file("")
>
> return
>
> built with hbmk -n -static -gtstd test2 under Fedora 7 test4
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Wed May  9 18:26:29 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May  9 18:26:32 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
Message-ID: <9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>

On 5/10/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> Can you check on your platform, what is the result of Directory( "" )
> in a non-empty directory?

I get the list of the files.

I've found that findfirst does not manage HB_FA_ALL. Is this the problem?

regards,
Lorenzo
From harbour.01 at syenar.hu  Wed May  9 18:29:52 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 18:30:07 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
Message-ID: <2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>

>> Can you check on your platform, what is the result of Directory( "" )
>> in a non-empty directory?
>
> I get the list of the files.
>
> I've found that findfirst does not manage HB_FA_ALL. Is this the  
> problem?

HB_FA_ALL should be okey, the problem is that fnmatch() (or maybe  
hb_strMatchWild()
in case of Watcom) is returning true when the mask is empty.

Empty mask string should be special case for the Unix branch,
always returning FALSE.

Brgds,
Viktor
From druzus at priv.onet.pl  Wed May  9 19:04:04 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May  9 19:04:40 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
	<2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>
Message-ID: <20070509230404.GA6117@localhost.localdomain>

On Thu, 10 May 2007, Szak?ts Viktor wrote:
> HB_FA_ALL should be okey, the problem is that fnmatch() (or maybe  
> hb_strMatchWild() in case of Watcom) is returning true when the mask
> is empty.

Both function are OK the problem is caused by:
         if( info->pattern[ 0 ] == '\0' )
            hb_strncpy( info->pattern, "*", sizeof( info->pattern ) - 1 );
few lines above where the given pattern is explicitly changed.
Seems that in xHarbour the additional code in hb_fsFile() function
is a workaround for for problems with hb_fsFindFirst()/hb_fsFindNext()
and cleaning this functions should resolve the problem.
Have we ever documented expected behavior for these functions?

> Empty mask string should be special case for the Unix branch,
> always returning FALSE.

I do not understand the above.

best regards,
Przemek
From harbour.01 at syenar.hu  Wed May  9 19:06:12 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 19:06:25 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
Message-ID: <2E18945F-9103-4101-9948-38B3E883360D@syenar.hu>

Okey, I'll commit a fix for the Unix branch of the FF API
to check for empty masks. This will fix FILE()/DIRECTORY()/ADIR()
and all low level FF API dependent functions. I'll also commit a fix to
HB_WILDMATCH() and it's C level worker functions to not return
TRUE when the mask is empty. (This seems to be needed for the
advertised sx_WildMatch()) compatibility and also for common
sense. (I've also marked WILDMATCH() as HB_COMPAT_XHB.)

Notice however that the behaviour of File("") can still be platform
dependent (if let's say Win32 FindFirstFile() would return success
for an empty mask).

I've also changed a FILE() TOFIX to a NOTE, because full
CA-Cl*pper compatibility (RTrimming the passed parameter)
would be against portability.

I'll wait with the commit until the CVS problem resolves.

Brgds,
Viktor

On 2007.05.10., at 0:26, Lorenzo Fiorini wrote:

> On 5/10/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
>
>> Can you check on your platform, what is the result of Directory( "" )
>> in a non-empty directory?
>
> I get the list of the files.
>
> I've found that findfirst does not manage HB_FA_ALL. Is this the  
> problem?
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Wed May  9 19:14:40 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 19:14:54 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <20070509230404.GA6117@localhost.localdomain>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
	<2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>
	<20070509230404.GA6117@localhost.localdomain>
Message-ID: <5EB8D73E-41B1-4E19-A400-123C1D49B868@syenar.hu>

> On Thu, 10 May 2007, Szak?ts Viktor wrote:
>> HB_FA_ALL should be okey, the problem is that fnmatch() (or maybe
>> hb_strMatchWild() in case of Watcom) is returning true when the mask
>> is empty.
>
> Both function are OK the problem is caused by:
>          if( info->pattern[ 0 ] == '\0' )
>             hb_strncpy( info->pattern, "*", sizeof( info->pattern )  
> - 1 );

Thanks, true. I'll fix that too.

> few lines above where the given pattern is explicitly changed.
> Seems that in xHarbour the additional code in hb_fsFile() function
> is a workaround for for problems with hb_fsFindFirst()/hb_fsFindNext()
> and cleaning this functions should resolve the problem.
> Have we ever documented expected behavior for these functions?
>
>> Empty mask string should be special case for the Unix branch,
>> always returning FALSE.
>
> I do not understand the above.

I've noticed that hb_strMatchWildExact() and hb_strMatchWild()
were even returning TRUE when the mask was empty but the
string was not. Is this expected behaviour? I would think it's not  
right.

It also makes HB_WILDMATCH() incompatible with sx_WILDMATCH().

Brgds,
Viktor

From harbour.01 at syenar.hu  Wed May  9 19:22:36 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May  9 19:23:10 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <5EB8D73E-41B1-4E19-A400-123C1D49B868@syenar.hu>
References: <9257026e0705091024i515573b8i8ba0a31071b0ce7f@mail.gmail.com>
	<20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
	<2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>
	<20070509230404.GA6117@localhost.localdomain>
	<5EB8D73E-41B1-4E19-A400-123C1D49B868@syenar.hu>
Message-ID: <499CA275-91D3-4335-BF53-50621D1B0F4E@syenar.hu>

> I've noticed that hb_strMatchWildExact() and hb_strMatchWild()
> were even returning TRUE when the mask was empty but the
> string was not. Is this expected behaviour? I would think it's not  
> right.
>
> It also makes HB_WILDMATCH() incompatible with sx_WILDMATCH().

Sorry, only hb_strMatchWild() seems to do that. The *Exact() version
looks okey.

Brgds,
Viktor

From druzus at priv.onet.pl  Wed May  9 20:21:11 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May  9 20:21:47 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <499CA275-91D3-4335-BF53-50621D1B0F4E@syenar.hu>
References: <20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
	<2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>
	<20070509230404.GA6117@localhost.localdomain>
	<5EB8D73E-41B1-4E19-A400-123C1D49B868@syenar.hu>
	<499CA275-91D3-4335-BF53-50621D1B0F4E@syenar.hu>
Message-ID: <20070510002111.GA12629@localhost.localdomain>

On Thu, 10 May 2007, Szak?ts Viktor wrote:
> >I've noticed that hb_strMatchWildExact() and hb_strMatchWild()
> >were even returning TRUE when the mask was empty but the
> >string was not. Is this expected behaviour? I would think it's not  
> >right.
> >It also makes HB_WILDMATCH() incompatible with sx_WILDMATCH().
> Sorry, only hb_strMatchWild() seems to do that. The *Exact() version
> looks okey.

Exactly. The pattern in hb_strMatchWildExact() has to cover whole
string when in hb_strMatchWild() can be only prefix.
SIX3 SX_WILDMATCH() works like hb_strMatchWild() with the exception
for empty pattern - it's not accepted at all but IMHO it's not
proper behavior which causes that sx_wildSeek("") does not work
like dbSeek("") so I haven't replicated it but if you plan to
write 100% SIX3 compatible sx_wild{match,seek}() then you should
add special case for empty patterns.
This small SIX3 code which illustrates why in SIX only empty string ""
is served in special way (exception) when in all other cases it accepts
patterns as value prefix.

    proc main()
    ? sx_wildmatch("abc","abc")
    ? sx_wildmatch("ab*","abc")
    ? sx_wildmatch("ab?","abc")
    ? sx_wildmatch("ab" ,"abc")
    ? sx_wildmatch("a*" ,"abc")
    ? sx_wildmatch("a?" ,"abc")
    ? sx_wildmatch("*"  ,"abc")
    ? sx_wildmatch("?"  ,"abc")
    ? sx_wildmatch(""   ,"abc")
    return

best regards,
Przemek
From niki at synel.co.il  Thu May 10 02:09:09 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu May 10 02:09:19 2007
Subject: [Harbour] CVS problem - broken source/vm/hvm.c
Message-ID: <4642B705.7C9D@synel.co.il>

If you look at:
http://harbour-project.cvs.sourceforge.net/harbour-project/harbour/source/vm/

At the buttom you would see hvm.c with wrong information.
Do someone knows that it is? is there are other admin that want to
contact SF? if not, let my know and I'll try to submit a support
request (I don't know what to tell them).

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From antonioharbour at gmail.com  Thu May 10 02:15:20 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu May 10 02:15:33 2007
Subject: [Harbour] Changelog 2007-05-10 08:13 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <4642b880.71c1eba2.0292.66d3@mx.google.com>

2007-05-10 08:13 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * FoxPro support

Regards,

Antonio

From niki at synel.co.il  Thu May 10 02:25:54 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu May 10 02:28:03 2007
Subject: [Harbour] Re: CVS problem - broken source/vm/hvm.c
References: <4642B705.7C9D@synel.co.il>
Message-ID: <4642BAF2.28A6@synel.co.il>

All,

Please do not commit (some other files like ChangeLog are broken too)
I'm submitting a support request on SF.

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From niki at synel.co.il  Thu May 10 02:39:04 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu May 10 02:39:14 2007
Subject: [Harbour] Re: CVS problem - broken source/vm/hvm.c
References: <4642B705.7C9D@synel.co.il> <4642BAF2.28A6@synel.co.il>
Message-ID: <4642BE08.6AEF@synel.co.il>

Here is the support request:
http://sourceforge.net/tracker/index.php?func=detail&aid=1716288&group_id=1&atid=200001

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From antonioharbour at gmail.com  Thu May 10 02:42:11 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu May 10 02:42:26 2007
Subject: [Harbour] Re: CVS problem - broken source/vm/hvm.c
In-Reply-To: <4642BAF2.28A6@synel.co.il>
Message-ID: <4642bece.43a40d31.0292.6fe8@mx.google.com>

Chen, 

>
Please do not commit (some other files like ChangeLog are broken too) I'm
submitting a support request on SF.
>

Thanks,

Antonio

From harbour.01 at syenar.hu  Thu May 10 02:54:20 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu May 10 02:54:28 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <20070510002111.GA12629@localhost.localdomain>
References: <20F40AC7-E467-4497-A123-969579F30DA1@syenar.hu>
	<9257026e0705091408p514a0537n380ba3595d6c831@mail.gmail.com>
	<9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
	<2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>
	<20070509230404.GA6117@localhost.localdomain>
	<5EB8D73E-41B1-4E19-A400-123C1D49B868@syenar.hu>
	<499CA275-91D3-4335-BF53-50621D1B0F4E@syenar.hu>
	<20070510002111.GA12629@localhost.localdomain>
Message-ID: <427CBD3F-EF98-4F6D-ABD7-FA00928EA7C3@syenar.hu>

> Exactly. The pattern in hb_strMatchWildExact() has to cover whole
> string when in hb_strMatchWild() can be only prefix.
> SIX3 SX_WILDMATCH() works like hb_strMatchWild() with the exception
> for empty pattern - it's not accepted at all but IMHO it's not
> proper behavior which causes that sx_wildSeek("") does not work
> like dbSeek("") so I haven't replicated it but if you plan to
> write 100% SIX3 compatible sx_wild{match,seek}() then you should
> add special case for empty patterns.
> This small SIX3 code which illustrates why in SIX only empty string ""
> is served in special way (exception) when in all other cases it  
> accepts
> patterns as value prefix.
>
>     proc main()
>     ? sx_wildmatch("abc","abc")
>     ? sx_wildmatch("ab*","abc")
>     ? sx_wildmatch("ab?","abc")
>     ? sx_wildmatch("ab" ,"abc")
>     ? sx_wildmatch("a*" ,"abc")
>     ? sx_wildmatch("a?" ,"abc")
>     ? sx_wildmatch("*"  ,"abc")
>     ? sx_wildmatch("?"  ,"abc")
>     ? sx_wildmatch(""   ,"abc")
>     return

My main concern is not sx_wildmatch() (but if we advertise
hb_wildmatch() to be sx_wildmatch() compatible, this is a real
concern, too), but if hb_strMatchWild() works like this, the FF API
is still broken for Unix/Watcom builds, since this platform uses
the above function to match the pattern against the filename.
In other words File("") would still always return .T. on Unix/Watcom.
That's why I've added a "special case" in the FF code to solve this,
but I think it would be better to "fix" hb_strWildMatch() instead.

(Notice also that hb_wildmatch() is not compatible with sx_wildmatch()
regardless of the third parameter.)

What do you think?

Brgds,
Viktor

From lorenzo.fiorini at gmail.com  Thu May 10 04:43:25 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 10 04:43:28 2007
Subject: [Harbour] Re: CVS problem - broken source/vm/hvm.c
In-Reply-To: <4642BAF2.28A6@synel.co.il>
References: <4642B705.7C9D@synel.co.il> <4642BAF2.28A6@synel.co.il>
Message-ID: <9257026e0705100143r7742cb63vda4c789e7e18f2c5@mail.gmail.com>

On 5/10/07, Chen Kedem <niki@synel.co.il> wrote:

> Please do not commit (some other files like ChangeLog are broken too)
> I'm submitting a support request on SF.

I've just done a checkout and compared CVS with my local copy and it seems ok.

I've also tried an update without problem.

Could it be solved?

regards,
Lorenzo
From niki at synel.co.il  Thu May 10 04:49:28 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu May 10 04:49:38 2007
Subject: [Harbour] Re: CVS problem - broken source/vm/hvm.c
References: <4642B705.7C9D@synel.co.il> <4642BAF2.28A6@synel.co.il>
	<4642BE08.6AEF@synel.co.il>
Message-ID: <4642DC98.310C@synel.co.il>

Lorenzo,

> I've just done a checkout and compared CVS with my local copy and it
> seems ok.
> I've also tried an update without problem.

It is still broken, now ChangeLog is shown in ViewVC as:
rlog error: missing 'author' keyword.

What client you are using? maybe something is not compatible?


   Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From miguelangel at marchuet.net  Thu May 10 05:02:21 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Thu May 10 05:01:58 2007
Subject: [Harbour] Re: CVS problem - broken source/vm/hvm.c
In-Reply-To: <4642DC98.310C@synel.co.il>
References: <4642B705.7C9D@synel.co.il>
	<4642BAF2.28A6@synel.co.il>	<4642BE08.6AEF@synel.co.il>
	<4642DC98.310C@synel.co.il>
Message-ID: <4642DF9D.4080007@marchuet.net>

Chen Kedem escribi?:
> Lorenzo,
> 
>> I've just done a checkout and compared CVS with my local copy and it
>> seems ok.
>> I've also tried an update without problem.
> 
> It is still broken, now ChangeLog is shown in ViewVC as:
> rlog error: missing 'author' keyword.
> 
> What client you are using? maybe something is not compatible?
> 
> 
>    Chen.
> **********************************************************************************************
> IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
> named recipient(s) only.
> If you have received this email in error, please notify the system manager or the sender immediately and do 
> not disclose the contents to anyone or make copies thereof.
> *** eSafe scanned this email for viruses, vandals, and malicious content. ***
> **********************************************************************************************
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

Can you try to delete it and upload altogether

Best regards
Miguel Angel Marchuet
From lorenzo.fiorini at gmail.com  Thu May 10 05:06:06 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 10 05:06:09 2007
Subject: [Harbour] Re: CVS problem - broken source/vm/hvm.c
In-Reply-To: <4642DC98.310C@synel.co.il>
References: <4642B705.7C9D@synel.co.il> <4642BAF2.28A6@synel.co.il>
	<4642BE08.6AEF@synel.co.il> <4642DC98.310C@synel.co.il>
Message-ID: <9257026e0705100206s78081877l3dfbf2ebc36f8f77@mail.gmail.com>

On 5/10/07, Chen Kedem <niki@synel.co.il> wrote:

> It is still broken, now ChangeLog is shown in ViewVC as:
> rlog error: missing 'author' keyword.

I'm working under Fedora Linux FC7test4

cvs --version returns Concurrent Versions System (CVS) 1.11.22 (client/server)

regards,
Lorenzo
From e.m.giordano at emagsoftware.it  Thu May 10 05:13:14 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May 10 05:13:50 2007
Subject: [Harbour] Re: CVS problem - broken source/vm/hvm.c
References: <4642B705.7C9D@synel.co.il> <4642BAF2.28A6@synel.co.il>
	<9257026e0705100143r7742cb63vda4c789e7e18f2c5@mail.gmail.com>
Message-ID: <009e01c792e3$70aa9f10$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Lorenzo Fiorini" <lorenzo.fiorini@gmail.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: gioved? 10 maggio 2007 10.43
Oggetto: Re: [Harbour] Re: CVS problem - broken source/vm/hvm.c


> I've just done a checkout and compared CVS with my local copy
> and it seems ok.
>
> I've also tried an update without problem.
>
> Could it be solved?

No, I just tried and got

can't create temporary directory /tmp/cvs-serv25984

Read-only file system

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic

From druzus at priv.onet.pl  Thu May 10 05:15:45 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 10 05:16:21 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <427CBD3F-EF98-4F6D-ABD7-FA00928EA7C3@syenar.hu>
References: <9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
	<2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>
	<20070509230404.GA6117@localhost.localdomain>
	<5EB8D73E-41B1-4E19-A400-123C1D49B868@syenar.hu>
	<499CA275-91D3-4335-BF53-50621D1B0F4E@syenar.hu>
	<20070510002111.GA12629@localhost.localdomain>
	<427CBD3F-EF98-4F6D-ABD7-FA00928EA7C3@syenar.hu>
Message-ID: <20070510091545.GA14385@localhost.localdomain>

On Thu, 10 May 2007, Szak?ts Viktor wrote:
> My main concern is not sx_wildmatch() (but if we advertise
> hb_wildmatch() to be sx_wildmatch() compatible, this is a real
> concern, too), but if hb_strMatchWild() works like this, the FF API
> is still broken for Unix/Watcom builds, since this platform uses
> the above function to match the pattern against the filename.

I added this as temporary workaround because OW had no fnmatch().
But also many other functions were missing and I had to make some
modifications inside OW code to be able to compile xHarbour with
this compiler on Linux. But Linux OW version is systematically extended
and I hope soon we will be able to use fnmatch() so it's not a problem.
But please note the if we define what hb_fsFindFirst() should do then
its possible that we will never have to compare for empty pattern.
Now such comparison exists because we forced it ourself by modifying
passed parameters.

> In other words File("") would still always return .T. on Unix/Watcom.
> That's why I've added a "special case" in the FF code to solve this,
> but I think it would be better to "fix" hb_strWildMatch() instead.

Please forget about this temporary workaround for OpenWatcom - it
will be removed in the future - now I'm probably the only one person
who is making [x]Harbour OW Linux build because [x]Harbour cannot be
compiled by standard non patched OW and I never public OW patches (at
least it was situation from last year maybe now it's possible, I plan
to check it on summer). In short words make any modifications in
hb_fsFindFirst() only for fnmatch().

I strongly prefer to define how hb_fsFindFirst() should work and then
force this behavior for all platforms if possible.

> (Notice also that hb_wildmatch() is not compatible with sx_wildmatch()
> regardless of the third parameter.)
> What do you think?

hb_strWildMatch() is used also by other code and I would like to leave it
as is. It works exactly as I wanted when I was creating this function.
This modification is like changing HVM string compare function to return
false for:
    cVar = ""
and then adding in the whole code exceptions for it. We can make it but
I'm not sure it's good idea. I don't like that:
    sx_wildSeek("a")
finds first value starting with "a" when
    sx_wildSeek("")
finds nothing and I intentionally not replicated such behavior in
ordWildSeek() but maybe other users have differ opinion - it's really
minor problem for me.

best regards,
Przemek
From harbour.01 at syenar.hu  Thu May 10 05:30:12 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu May 10 05:30:51 2007
Subject: [Harbour] file("") return .t. in Harbour and .f. in xHarbour and
	C53b
In-Reply-To: <20070510091545.GA14385@localhost.localdomain>
References: <9ADC7631-D386-44E6-B254-668FAF66DDBE@syenar.hu>
	<9257026e0705091429q3561d9c3obabc58efd939dd76@mail.gmail.com>
	<B3CDA12A-B9A8-4988-89B8-A8548FA20297@syenar.hu>
	<9257026e0705091526y3ea5fabem756dc2e9bf6bfe2d@mail.gmail.com>
	<2DB21A56-8A08-49B7-90CC-D6F094376F68@syenar.hu>
	<20070509230404.GA6117@localhost.localdomain>
	<5EB8D73E-41B1-4E19-A400-123C1D49B868@syenar.hu>
	<499CA275-91D3-4335-BF53-50621D1B0F4E@syenar.hu>
	<20070510002111.GA12629@localhost.localdomain>
	<427CBD3F-EF98-4F6D-ABD7-FA00928EA7C3@syenar.hu>
	<20070510091545.GA14385@localhost.localdomain>
Message-ID: <A37896DB-8051-43FD-ACFE-77619BCDFFB5@syenar.hu>

> I added this as temporary workaround because OW had no fnmatch().
> But also many other functions were missing and I had to make some
> modifications inside OW code to be able to compile xHarbour with
> this compiler on Linux. But Linux OW version is systematically  
> extended
> and I hope soon we will be able to use fnmatch() so it's not a  
> problem.
> But please note the if we define what hb_fsFindFirst() should do then
> its possible that we will never have to compare for empty pattern.
> Now such comparison exists because we forced it ourself by modifying
> passed parameters.

That's right (if we disregard the temp branch, and if fnmatch() works
as "expected" for empty strings).

>> In other words File("") would still always return .T. on Unix/Watcom.
>> That's why I've added a "special case" in the FF code to solve this,
>> but I think it would be better to "fix" hb_strWildMatch() instead.
>
> Please forget about this temporary workaround for OpenWatcom - it
> will be removed in the future - now I'm probably the only one person
> who is making [x]Harbour OW Linux build because [x]Harbour cannot be
> compiled by standard non patched OW and I never public OW patches (at
> least it was situation from last year maybe now it's possible, I plan
> to check it on summer). In short words make any modifications in
> hb_fsFindFirst() only for fnmatch().
>
> I strongly prefer to define how hb_fsFindFirst() should work and then
> force this behavior for all platforms if possible.

In this empty-string case it's pretty straightforward, but this can  
lead far
away if we consider all possible differences, for example different  
pattern
matching capabilities and behaviour of different platforms.

Current FF API code does nothing in area regarding the pattern
itself. (it does so however in regards of the file attributes).

What do you think we should fix on FF API level then?

>> (Notice also that hb_wildmatch() is not compatible with  
>> sx_wildmatch()
>> regardless of the third parameter.)
>> What do you think?
>
> hb_strWildMatch() is used also by other code and I would like to  
> leave it
> as is. It works exactly as I wanted when I was creating this function.
> This modification is like changing HVM string compare function to  
> return
> false for:
>     cVar = ""
> and then adding in the whole code exceptions for it. We can make it  
> but
> I'm not sure it's good idea. I don't like that:
>     sx_wildSeek("a")
> finds first value starting with "a" when
>     sx_wildSeek("")
> finds nothing and I intentionally not replicated such behavior in
> ordWildSeek() but maybe other users have differ opinion - it's really
> minor problem for me.

Good, I'll do something on HB_WILDMATCH() level then, probably
just documenting this sort of difference with sx_WildMatch().

Brgds,
Viktor

From niki at synel.co.il  Thu May 10 14:47:49 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu May 10 14:51:12 2007
Subject: [Harbour] SF Project CVS Service 
References: <EXCHFBmqb6DmcppCP12000000b7@exch.SYNEL-COMPANY.LTD>
Message-ID: <B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>

This is from the SF update page:
http://sourceforge.net/docs/A04
 
 
( 2007-05-10 03:07:21 - Project CVS Service )   As of 2007-05-10 at 02:00 Pacific developer CVS services (and ViewVC) for projects starting with the letters e, f and h and anonymous pserver CVS for projects starting with the letter c are offline due to hardware failure. We anticipate bringing them up by end of business today. 

So we share our problem with the other server users. Again, do not try to commit untill this would be fixed, and then you should check if your last changes are still there.

  Chen.

 

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/ms-tnef
Size: 3508 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070510/29d5edbe/attachment.bin
From antonioharbour at gmail.com  Thu May 10 19:01:42 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu May 10 19:02:23 2007
Subject: [Harbour] SF Project CVS Service 
In-Reply-To: <B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>
Message-ID: <4643a45c.031da9a0.08e5.fffff56d@mx.google.com>

>  Again, do not try to commit untill this would be fixed, and then you
should check if your last changes are still there.

It looks ok again and my latest commit its there :-)

Regards,

Antonio


From antonioharbour at gmail.com  Thu May 10 19:07:24 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu May 10 19:08:04 2007
Subject: [Harbour] Changelog 2007-05-11 01:04 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <4643a5b2.0b9bc4f5.07be.ffffea5b@mx.google.com>

2007-05-11 01:04 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * Reduced used variables and memory

Many changes in adordd.prg to get an improved implementation

Regards,

Antonio

From harbour.01 at syenar.hu  Fri May 11 04:33:58 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri May 11 04:36:02 2007
Subject: [Harbour] CHANGELOG: 2007-05-11 10:17 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c793a7$Blat.v2.6.1$1e87a0d8$16a836ba1b88@127.0.0.1>

2007-05-11 10:17 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/filehb.c
     * Changed one old TOFIX to a NOTE regarding a minor 
       incompatibility in FILE() where the filename is RTrim()-ed 
       in Clipper but not in Harbour. It became a NOTE because 
       making it compatible would mean losing some portability.

   * harbour/source/rtl/hbffind.c
     ! Removed code in UNIX branch which would change an empty 
       file mask to "*" (thus causing FILE("") to return .T. 
       and DIRECTORY("") to return the whole dir content.)
     ! Made sure in UNIX branch that an empty file mask won't 
       return any files regardless of the filename matching 
       method used.

   * harbour/source/rtl/strmatch.c
     + Added NOTE about hb_WildMatch() / sx_WildMatch() 
       incompatibility.
     ! Guarded WILDMATCH() with HB_COMPAT_XHB.
     * WILDMATCH() now calls HB_WILDMATCH() internally.

From antonioharbour at gmail.com  Fri May 11 08:28:48 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Fri May 11 08:28:56 2007
Subject: [Harbour] Changelog 2007-05-11 14:27 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <46446183.65f9a554.7031.fffff480@mx.google.com>

2007-05-11 14:27 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * some minor changes

Regards,

Antonio

From dbtopas at dbtopas.lt  Fri May 11 09:33:03 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Fri May 11 09:29:57 2007
Subject: [Harbour] SF Project CVS Service
In-Reply-To: <4643a45c.031da9a0.08e5.fffff56d@mx.google.com>
References: <4643a45c.031da9a0.08e5.fffff56d@mx.google.com>
Message-ID: <4644708F.6090801@dbtopas.lt>

Antonio Linares wrote:
>> Again, do not try to commit untill this would be fixed, and then you
> 
> should check if your last changes are still there.
> 
> It looks ok again and my latest commit its there :-)

Hello,


I'm not sure if it is related with last CVS problem, but I can not do 
anonymous checkout anymore:

In C:\harbourcvs: "C:\Program Files\TortoiseCVS\cvs.exe" "-q" "checkout" 
"-P" "harbour"
CVSROOT=:pserver:anonymous@cvs.sourceforge.net:/cvsroot/harbour-project

Empty password used - try 'cvs login' with a real password
cvs.exe [checkout aborted]: authorization failed: server 
harbour-project.cvs.sourceforge.net rejected access to 
/cvsroot/harbour-project for user anonymous

Error, CVS operation failed

In C:\harbourcvs: "C:\Program Files\TortoiseCVS\cvs.exe" "-q" "login"
CVSROOT=:pserver:anonymous@cvs.sourceforge.net:/cvsroot/harbour-project

Logging in to 
:pserver:anonymous@harbour-project.cvs.sourceforge.net:2401:/cvsroot/harbour-project
------------

And here I'm waiting for along time without any result.
Sourceforge (http://sourceforge.net/cvs/?group_id=69750) suggests to use 
projectname.cvs.sourceforge.net, but it does not work:

In C:\harbourcvs: "C:\Program Files\TortoiseCVS\cvs.exe" "-q" "checkout" 
"-P" "harbour"
CVSROOT=:pserver:anonymous@harbour-project.cvs.sourceforge.net:/cvsroot/harbour-project

Empty password used - try 'cvs login' with a real password
cvs.exe [checkout aborted]: authorization failed: server 
harbour-project.cvs.sourceforge.net rejected access to 
/cvsroot/harbour-project for user anonymous

Error, CVS operation failed
------------


Can other users do anonymous checkout?


Best regards,
Mindaugas


From druzus at priv.onet.pl  Fri May 11 09:37:04 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 11 09:37:42 2007
Subject: [Harbour] SF Project CVS Service
In-Reply-To: <4644708F.6090801@dbtopas.lt>
References: <4643a45c.031da9a0.08e5.fffff56d@mx.google.com>
	<4644708F.6090801@dbtopas.lt>
Message-ID: <20070511133704.GA14433@localhost.localdomain>

On Fri, 11 May 2007, Mindaugas Kavaliauskas wrote:
> I'm not sure if it is related with last CVS problem, but I can not do 
> anonymous checkout anymore:

I think you should have read/write access - few times in the past I was
adding to CVS your modifications but it will be much better if you can
make them yourself.

Chen? Phil?

best regards,
Przemek
From niki at synel.co.il  Fri May 11 09:52:33 2007
From: niki at synel.co.il (Chen Kedem)
Date: Fri May 11 09:59:44 2007
Subject: [Harbour] RE: SF Project CVS Service 
References: <EXCHFBmqb6DmcppCP12000000b7@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>
Message-ID: <B75D4A6BE471094AB02513DB81890397088F75@exch.SYNEL-COMPANY.LTD>

Mindaugas,
 
> I'm not sure if it is related with last CVS problem, but I can not do
> anonymous checkout anymore:

I saw other users reporting that for other projects, so it seems to
be a global problem which should be fixed by SF staff.
 
Przemek wrote:
> I think you should have read/write access
 
Mindaugas, we'll need your SF userid in order to add you to the project.
 
 
  Chen.
 
(sorry for the stupid HTML post, don't have other access from home)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070511/f0d7787f/attachment-0001.html
From antonioharbour at gmail.com  Fri May 11 12:10:28 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Fri May 11 12:10:48 2007
Subject: [Harbour] Changelog 2007-05-11 18:09 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <46449578.53b94c9a.4ffe.49ce@mx.google.com>

2007-05-11 18:09 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * COMMIT changes

Regards,

Antonio

From druzus at priv.onet.pl  Fri May 11 16:51:56 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 11 16:52:33 2007
Subject: [Harbour] ChangeLog 2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070511205156.GA3309@localhost.localdomain>

2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbcomp.h
  * harbour/include/hbcompdf.h
  * harbour/include/hbexpra.c
  * harbour/include/hbexprb.c
  * harbour/source/compiler/complex.c
  * harbour/source/compiler/genc.c
  * harbour/source/compiler/gencli.c
  * harbour/source/compiler/genobj32.c
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/compiler/harbour.yyh
  * harbour/source/compiler/hbmain.c
    * changed code used for variable scoping - now it's much more
      simple (only one function) and allows to use declarations in
      nested functions/codeblocks with visibility similar to Pascal
    ! fixed parsing FILED <fields,...> IN <alias>
      we were accepting code like:
         FIELD f1, f2 IN db1, f3 IN db2 IN db3
      and for all fields the last alias (db2 in this example) was used
    ! fixed calculating number of static variables with -b (debugger)
      compilation (number of file wide statics were doubled)
    ! fixed generation of static variable names for debugger when declared
      with array dimensions, f.e.:
         static sVar[3]

  * harbour/source/rtl/hbffind.c
    * minor cleanup *nix version

  * harbour/contrib/bmdbfcdx/bmdbfcdx1.c
    ! fixed casting for C++ compilation

  * harbour/source/rdd/dbfdbt/dbfdbt1.c
    * updated for some old API modifications (this library is not used now
      but if we keep it in CVS then I think it should be updated)

best regards,
Przemek
From philb at philb.us  Fri May 11 19:40:05 2007
From: philb at philb.us (Phil Barnett)
Date: Fri May 11 19:40:08 2007
Subject: [Harbour] SF Project CVS Service
In-Reply-To: <20070511133704.GA14433@localhost.localdomain>
References: <4643a45c.031da9a0.08e5.fffff56d@mx.google.com>
	<4644708F.6090801@dbtopas.lt>
	<20070511133704.GA14433@localhost.localdomain>
Message-ID: <200705111940.05276.philb@philb.us>

On Friday 11 May 2007 09:37, Przemyslaw Czerpak wrote:
> On Fri, 11 May 2007, Mindaugas Kavaliauskas wrote:
> > I'm not sure if it is related with last CVS problem, but I can not do
> > anonymous checkout anymore:
>
> I think you should have read/write access - few times in the past I was
> adding to CVS your modifications but it will be much better if you can
> make them yourself.
>
> Chen? Phil?

Sure, no problem. What is the ID?

-- 
Phil Barnett
AI4OF
SKCC #600
From lorenzo.fiorini at gmail.com  Sat May 12 04:28:59 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 12 04:29:02 2007
Subject: [Harbour] ChangeLog 2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070511205156.GA3309@localhost.localdomain>
References: <20070511205156.GA3309@localhost.localdomain>
Message-ID: <9257026e0705120128o7f8630c3g3ebe0d20b442a1b3@mail.gmail.com>

On 5/11/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> 2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)

Thanks but after this I get errors in some "for each in h:keys".

I'm still trying to find a valid test case, I'll send it asap.

regards,
Lorenzo
From druzus at priv.onet.pl  Sat May 12 04:44:18 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 12 04:44:54 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <46420397.AF5235F8@libero.it>
References: <20070509031459.GA2556@localhost.localdomain>
	<C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu>
	<464186CA.6320F697@libero.it>
	<20070509162214.GA3730@localhost.localdomain>
	<80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu>
	<20070509170837.GA4613@localhost.localdomain>
	<46420397.AF5235F8@libero.it>
Message-ID: <20070512084418.GA19092@localhost.localdomain>

On Wed, 09 May 2007, Maurilio Longo wrote:
> And what if we say that an extended codeblock has the same delimiters of a
> standard one, that is {|| } (there is no real need to use <||>), but every
> line of it ends with a ';' ?
> I mean
> { |a,b,c| ;
>   ;	
>   if a > b .and.;
>      b < c;
>      return 1;
>   else;
>      return 2;
>   endif;
>   ;
>   ;
> }
> I looks a little bit strange at first, but gives the extended syntax advantage
> without breaking the one line at a time rule.

As I can see in xHarbour Ron already added static support for preporcessing
multiline clodeblocks in PP. Though it's only static version (it will not
recognize properly multiline codeblocks which can appear in the code after
preprocessing) then it's quite good idea and we can define it as expected
behavior just like ';' substituted by a translation rule does not work like
line concatenator. And of course it makes the modifications much simpler.
There are still some other things which should be fixed yet (f.e. line
numbering) but it begins to be working feature.
I'll be absent for next few days so for test I'll commit version which uses
standard codeblock markers to build multiline codeblocks with similar to
xHarbour modification in PP so such code can be compiled:

   proc main()
   local v1:="local1", v2:="local2", v3:="local3"
   ? { |p1,p2| qout(p1,p2), qout(v1,v2,v3), "cbSTD" }:eval("p1","p2","p3")
   ?
   ? { |p1,p2|
               local v1:="localInt1"
               static v2:="staticInt2"
               ? "[cbEXT]"
               ? p1,p2
               ? v1,v2,v3
               ? {||
                     local v1:="localInt1"
                     static v2:="nestedStatic2"
                     ?
                     ? "[cbNestedEXT]"
                     ? v1,v2,v3
                    return "cbNestedEXT"
                 }:eval()
               ?
               return "cbEXT"
     }:eval("p1","p2","p3")
   return

Please test and then take final decision if you want this feature or not.

Best regards,
Przemek
From druzus at priv.onet.pl  Sat May 12 04:49:59 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 12 04:50:34 2007
Subject: [Harbour] ChangeLog 2007-05-12 10:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070512084959.GB19092@localhost.localdomain>

2007-05-12 12:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbcomp.h
  * harbour/include/hbexpra.c
  * harbour/include/hbexprb.c
  * harbour/include/hbexprop.h
  * harbour/include/hbpp.h
  * harbour/source/compiler/complex.c
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/compiler/harbour.yyh
  * harbour/source/compiler/hbmain.c
  * harbour/source/pp/ppcore.c
    + added support for extended multiline codeblocks:
         { |<params,...>| <EOL>
            <statement1>
            ...
            <statementN>
            return <val>
         }
      Such codeblocks allow nested definitions. They can also have their
      own variable declarations (local, static, field, memvar, parameters,
      private, public) and visibility of declared variables is similar to
      nested function in Pascal but please note that there is one limitation
      which exists also for normal codeblocks (Clipper compatible behavior):
      internal codeblock local parameters and local variables cannot be
      used in nested codeblocks, f.e. such code:
            eval( { |p| eval( {|| qout( p + 1 ) } ) } )
      is illegal in Clipper and Harbour. This limitation also can be
      eliminated but but it will be necessary to make deeper modifications
      in code for local detaching changing the method of generating
      codeblocks local variables in nested blocks so unlike the above
      also some modifications in HVM will be necessary.

      Please make real tests - your decision will be final for me so
      if you decide to remove the above from CVS then I'll do that and
      I will not want to return to this subject.

best regards,
Przemek
From antonioharbour at gmail.com  Sat May 12 04:57:09 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sat May 12 04:57:20 2007
Subject: [Harbour] Changelog 2007-05-12 10:48 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <4645816c.7cfd3ac3.4e7d.ffff9741@mx.google.com>

2007-05-12 10:48 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * OrdCreate() fixed 
     * OrdDestroy() implemented

Regards,

Antonio

From lorenzo.fiorini at gmail.com  Sat May 12 04:58:12 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 12 04:58:15 2007
Subject: [Harbour] ChangeLog 2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705120128o7f8630c3g3ebe0d20b442a1b3@mail.gmail.com>
References: <20070511205156.GA3309@localhost.localdomain>
	<9257026e0705120128o7f8630c3g3ebe0d20b442a1b3@mail.gmail.com>
Message-ID: <9257026e0705120158v46925e21i684234f586e2e3b5@mail.gmail.com>

On 5/12/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

> Thanks but after this I get errors in some "for each in h:keys".

Sorry it was only a side effect the problem seems to be in hbfind.c

? file( "test.ini" ) return .f.

regards,
Lorenzo
From druzus at priv.onet.pl  Sat May 12 05:04:13 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 12 05:04:48 2007
Subject: [Harbour] ChangeLog 2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705120128o7f8630c3g3ebe0d20b442a1b3@mail.gmail.com>
References: <20070511205156.GA3309@localhost.localdomain>
	<9257026e0705120128o7f8630c3g3ebe0d20b442a1b3@mail.gmail.com>
Message-ID: <20070512090413.GC19092@localhost.localdomain>

On Sat, 12 May 2007, Lorenzo Fiorini wrote:
> On 5/11/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
> >2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> Thanks but after this I get errors in some "for each in h:keys".
> I'm still trying to find a valid test case, I'll send it asap.

If the above caused problem then it's probably sth with  variable
visibility. If you can reduce the problem to some example then
for sure I'll fix it.

BTW in Harbour FOR EACH has native support for hashes so you do not
need to create temporary arrays with h:keys or h:values and you can
simply make:
    for each v in h
       ? "  KEY:", v:__enumKey()
       ? "VALUE:", v
    next    

best regards,
Przemek
From druzus at priv.onet.pl  Sat May 12 05:08:12 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 12 05:08:49 2007
Subject: [Harbour] ChangeLog 2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705120158v46925e21i684234f586e2e3b5@mail.gmail.com>
References: <20070511205156.GA3309@localhost.localdomain>
	<9257026e0705120128o7f8630c3g3ebe0d20b442a1b3@mail.gmail.com>
	<9257026e0705120158v46925e21i684234f586e2e3b5@mail.gmail.com>
Message-ID: <20070512090812.GD19092@localhost.localdomain>

On Sat, 12 May 2007, Lorenzo Fiorini wrote:
> On 5/12/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:
> >Thanks but after this I get errors in some "for each in h:keys".
> Sorry it was only a side effect the problem seems to be in hbfind.c
> ? file( "test.ini" ) return .f.

Fixed - thanks for the info.

best regards,
Przemek
From druzus at priv.onet.pl  Sat May 12 05:09:53 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 12 05:10:28 2007
Subject: [Harbour] ChangeLog 2007-05-12 11:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070512090953.GE19092@localhost.localdomain>

2007-05-12 11:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rtl/hbffind.c
    ! fixed typo in my previous commit

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Sat May 12 05:25:46 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 12 05:25:49 2007
Subject: [Harbour] ChangeLog 2007-05-11 22:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070512090812.GD19092@localhost.localdomain>
References: <20070511205156.GA3309@localhost.localdomain>
	<9257026e0705120128o7f8630c3g3ebe0d20b442a1b3@mail.gmail.com>
	<9257026e0705120158v46925e21i684234f586e2e3b5@mail.gmail.com>
	<20070512090812.GD19092@localhost.localdomain>
Message-ID: <9257026e0705120225i40706a70q2deaed69823c9f40@mail.gmail.com>

On 5/12/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Fixed - thanks for the info.

Thanks to you, it's ok now.

regards,
Lorenzo
From harbour.01 at syenar.hu  Sat May 12 12:26:51 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat May 12 12:28:54 2007
Subject: [Harbour] CHANGELOG: 2007-05-11 18:24 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c794b2$Blat.v2.6.1$5866af04$b24fd91f98c@127.0.0.1>

2007-05-11 18:24 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/compiler/harbour.y
     ! Fixed error message text when unclosed multiline codeblock 
       was detected (said: <||...> instead of {||...}).
     ; TOFIX: In this same case two memory blocks are not released:
       source\main\harbour.c:329: HB_TR_ERROR Block 1 0098C39C (size 100)
       source\main\harbour.c:329: HB_TR_ERROR Block 2 0098C200 (size 92)

From harbour.01 at syenar.hu  Sat May 12 18:30:27 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat May 12 18:32:29 2007
Subject: [Harbour] CHANGELOG: 2007-05-11 18:34 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c794e5$Blat.v2.6.1$23e17bf0$dc8ce0512c6@127.0.0.1>

2007-05-11 18:34 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/compiler/hbmain.c 
   * harbour/source/compiler/harbour.yyc
     ! Fixed error message text when unclosed multiline codeblock 
       was detected (said: <||...> instead of {||...}).
       (two more places)

From niki at synel.co.il  Sun May 13 01:33:06 2007
From: niki at synel.co.il (Chen Kedem)
Date: Sun May 13 01:33:10 2007
Subject: [Harbour] Re: SF Project CVS Service
References: <EXCHFBmqb6DmcppCP12000000b7@exch.SYNEL-COMPANY.LTD>	<B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>	
	<B75D4A6BE471094AB02513DB81890397088F75@exch.SYNEL-COMPANY.LTD>
	<46447C16.7010704@dbtopas.lt>
Message-ID: <4646A312.337A@synel.co.il>

Mindaugas,

> "snaiperis" is my user name. My userid is: 1003153

Done.

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From antonioharbour at gmail.com  Sun May 13 03:21:03 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun May 13 03:21:19 2007
Subject: [Harbour] Changelog 2007-05-13 09:20 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <4646bc6a.5f9405f7.0a1d.3792@mx.google.com>

2007-05-13 09:20 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * Improved ADO_PUTVALUE()

Regards,

Antonio

From mbelgrano at deltain.it  Mon May 14 09:34:09 2007
From: mbelgrano at deltain.it (Massimo Belgrano)
Date: Mon May 14 09:34:21 2007
Subject: [Harbour] harbour work with gtwvw
Message-ID: <AFB948164110ED43B5EB849E8DEEF03809A4D4@SRV02.deltain.net>

I have donwnload cvs version of xharbour

Is aivable gtwvw ?

 

 

Massimo Belgrano <mailto:mbelgrano@deltain.com> 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070514/5f62e444/attachment.html
From druzus at priv.onet.pl  Mon May 14 09:39:33 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 14 09:40:09 2007
Subject: [Harbour] ChangeLog 2007-05-14 15:40 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070514133933.GA7422@localhost.localdomain>

2007-05-14 15:40 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/compiler/hbmain.c
    ! fixed memory leak when error appears during generating codeblock

best regards,
Przemek
From budyanto at centrin.net.id  Mon May 14 21:23:39 2007
From: budyanto at centrin.net.id (Budyanto Dj.)
Date: Mon May 14 21:20:59 2007
Subject: [Harbour] harbour work with gtwvw
In-Reply-To: <AFB948164110ED43B5EB849E8DEEF03809A4D4@SRV02.deltain.net>
Message-ID: <46496E0B.16117.24A1AC9@localhost>

Massimo,

On 14 May 2007 at 15:34, Massimo Belgrano wrote:
> I have donwnload cvs version of xharbour
> 
> Is aivable gtwvw ?

Gtwvw is not available in Harbour, yet.

Regards,
Budyanto Dj.
--
http://klikvnet.net

From niki at synel.co.il  Tue May 15 01:48:26 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue May 15 01:50:50 2007
Subject: [Harbour] Re: SF Project CVS Service
References: <EXCHFBmqb6DmcppCP12000000b7@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F75@exch.SYNEL-COMPANY.LTD>
Message-ID: <B75D4A6BE471094AB02513DB81890397088F78@exch.SYNEL-COMPANY.LTD>

Hi,
 
There is a problem without ChangeLog file on CVS
(probably because it was updated during the hardware problem in SF).
Here is the reply I got from SF staff:
 
---------------
http://sourceforge.net/tracker/index.php?func=detail&aid=1716288&group_id=1&atid=200001
 
Sender: wdavison SourceForge.net Site Admin<http://images.sourceforge.net/images/sf_adm.png> 
The harbour/ChangeLog file is corrupted, so it will need to be fixed.  If
you have an old copy of the ChangeLog,v repository file (from a repository
backup), you may be able to reconstruct it by comparing the newest file and
the older version.  If you don't have it, it is possible to use the "rlog
-rREVISION ChangeLog,v" command on the corrupted file to find which
revisions are bad (use a step-size larger than 1, and narrow in on the
problem values).  If you create something you want to be put in place of
the current file, let us know.
---------------

I don't know the technical details, and would be glad if someone that
do will take care for it.
 
Thanks,
 
  Chen.
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070515/46f4eedc/attachment.html
From soporte at dsgsoftware.com  Tue May 15 03:53:12 2007
From: soporte at dsgsoftware.com (=?iso-8859-2?Q?Juan_G=E1lvez?=)
Date: Tue May 15 03:54:15 2007
Subject: [Harbour] multiline codeblocks - final version
References: <20070509031459.GA2556@localhost.localdomain><C0F78E59-C680-4B00-A454-13FBD25ADA90@syenar.hu><464186CA.6320F697@libero.it><20070509162214.GA3730@localhost.localdomain><80C178C3-CB1D-4535-B0C9-993BE30C4BF5@syenar.hu><20070509170837.GA4613@localhost.localdomain><46420397.AF5235F8@libero.it>
	<20070512084418.GA19092@localhost.localdomain>
Message-ID: <00b101c796c6$26cc1b30$6c00000a@PcJuanxp>

Przemek,

My opinion is this is the best extended codeblocks implementation.

Regarding topics commented in previous conversations :

What about direct access to hash items with message interface ?

If the general opinion is the one of not allowing them ... Please, can you 
publish the changes that you made for your tests?

Many thanks
Juan

----- Original Message ----- 
From: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Saturday, May 12, 2007 10:44 AM
Subject: Re: [Harbour] multiline codeblocks - final version


> On Wed, 09 May 2007, Maurilio Longo wrote:
>> And what if we say that an extended codeblock has the same delimiters of 
>> a
>> standard one, that is {|| } (there is no real need to use <||>), but 
>> every
>> line of it ends with a ';' ?
>> I mean
>> { |a,b,c| ;
>>   ;
>>   if a > b .and.;
>>      b < c;
>>      return 1;
>>   else;
>>      return 2;
>>   endif;
>>   ;
>>   ;
>> }
>> I looks a little bit strange at first, but gives the extended syntax 
>> advantage
>> without breaking the one line at a time rule.
>
> As I can see in xHarbour Ron already added static support for 
> preporcessing
> multiline clodeblocks in PP. Though it's only static version (it will not
> recognize properly multiline codeblocks which can appear in the code after
> preprocessing) then it's quite good idea and we can define it as expected
> behavior just like ';' substituted by a translation rule does not work 
> like
> line concatenator. And of course it makes the modifications much simpler.
> There are still some other things which should be fixed yet (f.e. line
> numbering) but it begins to be working feature.
> I'll be absent for next few days so for test I'll commit version which 
> uses
> standard codeblock markers to build multiline codeblocks with similar to
> xHarbour modification in PP so such code can be compiled:
>
>   proc main()
>   local v1:="local1", v2:="local2", v3:="local3"
>   ? { |p1,p2| qout(p1,p2), qout(v1,v2,v3), "cbSTD" }:eval("p1","p2","p3")
>   ?
>   ? { |p1,p2|
>               local v1:="localInt1"
>               static v2:="staticInt2"
>               ? "[cbEXT]"
>               ? p1,p2
>               ? v1,v2,v3
>               ? {||
>                     local v1:="localInt1"
>                     static v2:="nestedStatic2"
>                     ?
>                     ? "[cbNestedEXT]"
>                     ? v1,v2,v3
>                    return "cbNestedEXT"
>                 }:eval()
>               ?
>               return "cbEXT"
>     }:eval("p1","p2","p3")
>   return
>
> Please test and then take final decision if you want this feature or not.
>
> Best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour 

From mbelgrano at deltain.it  Tue May 15 04:35:45 2007
From: mbelgrano at deltain.it (Massimo Belgrano)
Date: Tue May 15 04:36:23 2007
Subject: R: [Harbour] harbour work with gtwvw
In-Reply-To: <46496E0B.16117.24A1AC9@localhost>
References: <AFB948164110ED43B5EB849E8DEEF03809A4D4@SRV02.deltain.net>
	<46496E0B.16117.24A1AC9@localhost>
Message-ID: <AFB948164110ED43B5EB849E8DEEF03809A4DA@SRV02.deltain.net>

If you made a beta i am interested to test it.
Also wvwtools can be an interesting library
What differences have harbour vs xharbour?
What future implementation are paned in harbour?


-----Messaggio originale-----
Da: harbour-bounces@harbour-project.org [mailto:harbour-bounces@harbour-project.org] Per conto di Budyanto Dj.
Inviato: marted? 15 maggio 2007 3.24
A: Harbour Project Main Developer List.
Oggetto: Re: [Harbour] harbour work with gtwvw

Massimo,

On 14 May 2007 at 15:34, Massimo Belgrano wrote:
> I have donwnload cvs version of xharbour
> 
> Is aivable gtwvw ?

Gtwvw is not available in Harbour, yet.

Regards,
Budyanto Dj.
--
http://klikvnet.net

_______________________________________________
Harbour mailing list
Harbour@harbour-project.org
http://lists.harbour-project.org/mailman/listinfo/harbour
From druzus at priv.onet.pl  Tue May 15 06:26:10 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 15 06:26:47 2007
Subject: [Harbour] multiline codeblocks - final version
In-Reply-To: <00b101c796c6$26cc1b30$6c00000a@PcJuanxp>
References: <20070512084418.GA19092@localhost.localdomain>
	<00b101c796c6$26cc1b30$6c00000a@PcJuanxp>
Message-ID: <20070515102610.GA10964@localhost.localdomain>

On Tue, 15 May 2007, Juan G?lvez wrote:
> What about direct access to hash items with message interface ?
> If the general opinion is the one of not allowing them ... Please, can you 
> publish the changes that you made for your tests?

Patch for source/vm/classes.c in attachment.
Below small test code which also illustrates some differences between
Harbour and xHarbour.

Best regards,
Przemek


    proc main()
    local h:={"ABC"=>123.456}
    ? "=============="
    hEval( h, {|k,v,i| qout( i, k, v ) } )
    ? "=============="
    h:QWE:=12345
    p(@h:QWE)
    #ifndef __XHARBOUR__
    p2(@h:ASD)
    ? h:ZXC
    #endif
    ? "=============="
    hEval( h, {|k,v,i| qout( i, k, v ) } )
    ? "=============="
    ?
    return

    proc p(x)
    x:="refAssign"
    return
    proc p2(x)
    x:="refAssign2"
    return
-------------- next part --------------
Index: classes.c
===================================================================
RCS file: /cvsroot/harbour-project/harbour/source/vm/classes.c,v
retrieving revision 1.175
diff -u -r1.175 classes.c
--- classes.c	6 May 2007 18:35:12 -0000	1.175
+++ classes.c	15 May 2007 10:18:46 -0000
@@ -251,6 +251,7 @@
 static HARBOUR  hb___msgScopeErr( void );
 static HARBOUR  hb___msgTypeErr( void );
 static HARBOUR  hb___msgNull( void );
+static HARBOUR  hb___msgHashItem( void );
 
 static HARBOUR  hb___msgClassH( void );
 static HARBOUR  hb___msgClassName( void );
@@ -310,6 +311,7 @@
 static HB_SYMB s___msgNoMethod   = { "__msgNoMethod",   {HB_FS_MESSAGE}, {hb___msgNoMethod},   NULL };
 static HB_SYMB s___msgScopeErr   = { "__msgScopeErr",   {HB_FS_MESSAGE}, {hb___msgScopeErr},   NULL };
 static HB_SYMB s___msgTypeErr    = { "__msgTypeErr",    {HB_FS_MESSAGE}, {hb___msgTypeErr},    NULL };
+static HB_SYMB s___msgHashItem   = { "__msgHashItem",   {HB_FS_MESSAGE}, {hb___msgHashItem},   NULL };
 
 static HB_SYMB s___msgNew        = { "NEW",             {HB_FS_MESSAGE}, {NULL},               NULL };
 static HB_SYMB s___msgSymbol     = { "SYMBOL",          {HB_FS_MESSAGE}, {NULL},               NULL };
@@ -1614,6 +1616,33 @@
          hb_itemRelease( hb_itemReturnForward( hb_hashGetValues( pObject ) ) );
          return &s___msgValues;
       }
+      else
+      {
+         if( hb_pcount() == 1 && pMessage->szName[ 0 ] == '_' )
+         {  /* ASSIGN */
+            PHB_ITEM pIndex = hb_itemPutCConst( hb_stackAllocItem(), pMessage->szName + 1 );
+            PHB_ITEM pDest = hb_hashGetItemPtr( pObject, pIndex );
+            hb_stackPop();
+            if( pDest )
+            {
+               PHB_ITEM pValue = hb_param( 1, HB_IT_ANY );
+               hb_itemCopyFromRef( pDest, pValue );
+               hb_itemReturn( pValue );
+               return &s___msgHashItem;
+            }
+         }
+         else if( hb_pcount() == 0 )
+         {  /* ACCESS */
+            PHB_ITEM pIndex = hb_itemPutCConst( hb_stackAllocItem(), pMessage->szName );
+            PHB_ITEM pValue = hb_hashGetItemPtr( pObject, pIndex );
+            hb_stackPop();
+            if( pValue )
+            {
+               hb_itemReturn( pValue );
+               return &s___msgHashItem;
+            }
+         }
+      }
    }
 
    /* Default messages here */
@@ -1684,8 +1713,17 @@
 {
    PHB_SYMB pExecSym;
 
-   pExecSym = hb_objGetMethod( pObject, pMessage, pStack );
+   if( HB_IS_HASH( pObject ) )
+   {
+      PHB_ITEM pIndex = hb_itemPutCConst( hb_stackAllocItem(), pMessage->szName + 1 );
+      PHB_ITEM pValue = hb_hashGetItemRefPtr( pObject, pIndex );
+      hb_stackPop();
+      if( pValue )
+         hb_itemReturn( pValue );
+      return pValue != NULL;
+   }
 
+   pExecSym = hb_objGetMethod( pObject, pMessage, pStack );
    if( pExecSym )
    {
       if( pExecSym->value.pFunPtr == hb___msgSetData )
@@ -3888,6 +3926,11 @@
    ;
 }
 
+static HARBOUR hb___msgHashItem( void )
+{
+   ;
+}
+
 
 #ifndef HB_NO_PROFILER
 void hb_mthAddTime( ULONG ulClockTicks )
From soporte at dsgsoftware.com  Tue May 15 07:05:43 2007
From: soporte at dsgsoftware.com (=?iso-8859-2?Q?Juan_G=E1lvez?=)
Date: Tue May 15 07:06:37 2007
Subject: [Harbour] multiline codeblocks - final version
References: <20070512084418.GA19092@localhost.localdomain><00b101c796c6$26cc1b30$6c00000a@PcJuanxp>
	<20070515102610.GA10964@localhost.localdomain>
Message-ID: <002601c796e1$07805f50$6c00000a@PcJuanxp>

Przemek,

Many thanks :)

Juan

----- Original Message ----- 
From: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Tuesday, May 15, 2007 12:26 PM
Subject: Re: [Harbour] multiline codeblocks - final version


> On Tue, 15 May 2007, Juan G?lvez wrote:
>> What about direct access to hash items with message interface ?
>> If the general opinion is the one of not allowing them ... Please, can 
>> you
>> publish the changes that you made for your tests?
>
> Patch for source/vm/classes.c in attachment.
> Below small test code which also illustrates some differences between
> Harbour and xHarbour.
>
> Best regards,
> Przemek
>
>
>    proc main()
>    local h:={"ABC"=>123.456}
>    ? "=============="
>    hEval( h, {|k,v,i| qout( i, k, v ) } )
>    ? "=============="
>    h:QWE:=12345
>    p(@h:QWE)
>    #ifndef __XHARBOUR__
>    p2(@h:ASD)
>    ? h:ZXC
>    #endif
>    ? "=============="
>    hEval( h, {|k,v,i| qout( i, k, v ) } )
>    ? "=============="
>    ?
>    return
>
>    proc p(x)
>    x:="refAssign"
>    return
>    proc p2(x)
>    x:="refAssign2"
>    return
>


--------------------------------------------------------------------------------


> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From dbtopas at dbtopas.lt  Tue May 15 08:42:16 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Tue May 15 08:38:59 2007
Subject: [Harbour] ChangeLog 2007-05-15 15:40 UTC+0300 Mindaugas
	Kavaliauskas 
Message-ID: <4649AAA8.2030806@dbtopas.lt>

2007-05-15 15:40 UTC+0300 Mindaugas Kavaliauskas (dbtopas/at/dbtopas.lt)
   * harbour/source/compiler/gencobj.c
     ! fixed unrecoverable error "hb_xfree called with an invalid pointer"
       related to HB_CFG_FILE implementation

-------------------

P.S. since we have problems with ChangeLog integrity, I've not changed 
and not commited this file.
From druzus at priv.onet.pl  Tue May 15 12:19:04 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 15 12:19:40 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <B75D4A6BE471094AB02513DB81890397088F78@exch.SYNEL-COMPANY.LTD>
References: <EXCHFBmqb6DmcppCP12000000b7@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F75@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F78@exch.SYNEL-COMPANY.LTD>
Message-ID: <20070515161904.GA19998@localhost.localdomain>

On Tue, 15 May 2007, Chen Kedem wrote:
> Hi,
> There is a problem without ChangeLog file on CVS
> (probably because it was updated during the hardware problem in SF).
> Here is the reply I got from SF staff:
> ---------------
> http://sourceforge.net/tracker/index.php?func=detail&aid=1716288&group_id=1&atid=200001
> Sender: wdavison SourceForge.net Site Admin<http://images.sourceforge.net/images/sf_adm.png> 
> The harbour/ChangeLog file is corrupted, so it will need to be fixed.  If
> you have an old copy of the ChangeLog,v repository file (from a repository
> backup), you may be able to reconstruct it by comparing the newest file and
> the older version.  If you don't have it, it is possible to use the "rlog
> -rREVISION ChangeLog,v" command on the corrupted file to find which
> revisions are bad (use a step-size larger than 1, and narrow in on the
> problem values).  If you create something you want to be put in place of
> the current file, let us know.
> ---------------
> I don't know the technical details, and would be glad if someone that
> do will take care for it.

The ChangeLog file body seems to be OK. I compared it with some backup
versions and I cannot find anything wrong so IMHO if sth is corrupted
then additional CVS internal information about ChangeLog revisions.
I've checked the revisions from 1.5298 to 1.5331 and they are OK - rest
I've got in backup. So for me ChangeLog itself does not need any
modifications.

best regards,
Przemek
From miguelangel at marchuet.net  Tue May 15 13:06:32 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue May 15 13:06:03 2007
Subject: [Harbour] INLINE can't contain HB_ITEM
Message-ID: <4649E898.8070801@marchuet.net>


Example:

#pragma BEGINDUMP

#include "hbapi.h"

#pragma ENDDUMP

PROCEDURE Main()

      HB_INLINE() ;
      {
         HB_ITEM SubItems;
      }
RETURN


Error:

Error E2451 ....prg ...: Undefined symbol 'HB_ITEM' in function HB_FUN_HB_INLINE_001


How we can do it ?


Best regards,
Miguel Angel Marchuet
From druzus at priv.onet.pl  Tue May 15 13:34:38 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 15 13:35:14 2007
Subject: [Harbour] INLINE can't contain HB_ITEM
In-Reply-To: <4649E898.8070801@marchuet.net>
References: <4649E898.8070801@marchuet.net>
Message-ID: <20070515173438.GA20577@localhost.localdomain>

On Tue, 15 May 2007, Miguel Angel Marchuet wrote:
> Example:
> #pragma BEGINDUMP
> #include "hbapi.h"
> #pragma ENDDUMP
> PROCEDURE Main()
>       HB_INLINE() ;
>       {
>          HB_ITEM SubItems;
>       }
> RETURN
> Error:
> Error E2451 ....prg ...: Undefined symbol 'HB_ITEM' in function HB_FUN_HB_INLINE_001
> How we can do it ?

You cannot. Accessing HVM internals like HB_ITEM body is intentionally
blocked in Harbour. Code like above is very often reason of very bad bugs.
Garbage collector does not know anything about SubItems and when you
pass pointer to it to some other functions you can cause global HVM
memory corruption. _NEVER_ use directly HB_ITEM. In xHarbour API
allows to use HB_ITEM and people use it creating buggy code which
GPFs sometimes when GC is activated by some internal HVM code. These
are very hard to replicate and fix bugs so I strongly suggest you
to forget about it even if you are creating xHarbour only code.

best regards,
Przemek
From harbour.01 at syenar.hu  Tue May 15 15:35:35 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue May 15 15:36:02 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <20070515161904.GA19998@localhost.localdomain>
References: <EXCHFBmqb6DmcppCP12000000b7@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F75@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F78@exch.SYNEL-COMPANY.LTD>
	<20070515161904.GA19998@localhost.localdomain>
Message-ID: <F39C0FB6-342B-41F3-B829-FC4BF3C43F7C@syenar.hu>

Something is wrong, but I'm not sure what (and I'm also
not sure whether these worked before the sf problem or not).

These links are returning strange results:
http://harbour-project.cvs.sourceforge.net/harbour-project/harbour/ 
ChangeLog?view=markup
http://harbour-project.cvs.sourceforge.net/harbour-project/harbour/ 
ChangeLog?view=log

Also, this entry is missing from ChangeLog:
2007-05-15 15:40 UTC+0300 Mindaugas Kavaliauskas (dbtopas/at/dbtopas.lt)

Brgds,
Viktor

On 2007.05.15., at 18:19, Przemyslaw Czerpak wrote:

> On Tue, 15 May 2007, Chen Kedem wrote:
>> Hi,
>> There is a problem without ChangeLog file on CVS
>> (probably because it was updated during the hardware problem in SF).
>> Here is the reply I got from SF staff:
>> ---------------
>> http://sourceforge.net/tracker/index.php? 
>> func=detail&aid=1716288&group_id=1&atid=200001
>> Sender: wdavison SourceForge.net Site Admin<http:// 
>> images.sourceforge.net/images/sf_adm.png>
>> The harbour/ChangeLog file is corrupted, so it will need to be  
>> fixed.  If
>> you have an old copy of the ChangeLog,v repository file (from a  
>> repository
>> backup), you may be able to reconstruct it by comparing the newest  
>> file and
>> the older version.  If you don't have it, it is possible to use  
>> the "rlog
>> -rREVISION ChangeLog,v" command on the corrupted file to find which
>> revisions are bad (use a step-size larger than 1, and narrow in on  
>> the
>> problem values).  If you create something you want to be put in  
>> place of
>> the current file, let us know.
>> ---------------
>> I don't know the technical details, and would be glad if someone that
>> do will take care for it.
>
> The ChangeLog file body seems to be OK. I compared it with some backup
> versions and I cannot find anything wrong so IMHO if sth is corrupted
> then additional CVS internal information about ChangeLog revisions.
> I've checked the revisions from 1.5298 to 1.5331 and they are OK -  
> rest
> I've got in backup. So for me ChangeLog itself does not need any
> modifications.
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Tue May 15 15:45:08 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 15 15:45:44 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <F39C0FB6-342B-41F3-B829-FC4BF3C43F7C@syenar.hu>
References: <EXCHFBmqb6DmcppCP12000000b7@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F75@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F78@exch.SYNEL-COMPANY.LTD>
	<20070515161904.GA19998@localhost.localdomain>
	<F39C0FB6-342B-41F3-B829-FC4BF3C43F7C@syenar.hu>
Message-ID: <20070515194508.GA26288@localhost.localdomain>

On Tue, 15 May 2007, Szak?ts Viktor wrote:
> Something is wrong, but I'm not sure what (and I'm also
> not sure whether these worked before the sf problem or not).
> These links are returning strange results:
> http://harbour-project.cvs.sourceforge.net/harbour-project/harbour/ 
> ChangeLog?view=markup
> http://harbour-project.cvs.sourceforge.net/harbour-project/harbour/ 
> ChangeLog?view=log

Yes, but the ChangeLog file body is OK.

> Also, this entry is missing from ChangeLog:
> 2007-05-15 15:40 UTC+0300 Mindaugas Kavaliauskas (dbtopas/at/dbtopas.lt)

See Mindaugas message. He intentionally didn't touch ChangeLog file.

best regards,
Przemek
From harbour.01 at syenar.hu  Tue May 15 16:00:06 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue May 15 16:00:19 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <20070515194508.GA26288@localhost.localdomain>
References: <EXCHFBmqb6DmcppCP12000000b7@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F74@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F75@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F78@exch.SYNEL-COMPANY.LTD>
	<20070515161904.GA19998@localhost.localdomain>
	<F39C0FB6-342B-41F3-B829-FC4BF3C43F7C@syenar.hu>
	<20070515194508.GA26288@localhost.localdomain>
Message-ID: <1D04761D-3965-4BAF-86ED-9AE36879BF3B@syenar.hu>

>> http://harbour-project.cvs.sourceforge.net/harbour-project/harbour/
>> ChangeLog?view=markup
>> http://harbour-project.cvs.sourceforge.net/harbour-project/harbour/
>> ChangeLog?view=log
>
> Yes, but the ChangeLog file body is OK.

Yes, after all, losing the history is not a big loss for this file.

...switching to SVN again crossed my mind :)

>> Also, this entry is missing from ChangeLog:
>> 2007-05-15 15:40 UTC+0300 Mindaugas Kavaliauskas (dbtopas/at/ 
>> dbtopas.lt)
>
> See Mindaugas message. He intentionally didn't touch ChangeLog file.

Yup, now I saw it, sorry.

Brgds,
Viktor

From niki at synel.co.il  Wed May 16 02:52:31 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed May 16 02:52:26 2007
Subject: [Harbour] Re: SF Project CVS Service
Message-ID: <464AAA2F.687D@synel.co.il>

Viktor,

> Yes, after all, losing the history is not a big loss for this file.

You forgot the beta branch. It contain different information than the
latest devel branch. Also, for each TAG you can get it last changelog
entry.

Do anyone keep a tar backup of the CVS itself (all the v files)?
Is there anyone who knows how to fix this?

Is there an option to give SF two files and tell them:
This is the latest for branch A and this is the lastest for branch B?

If you can help, please reply to the following SF tracker,
so SF could start do something, I don't even know what to ask:
http://sourceforge.net/tracker/index.php?func=detail&aid=1716288&group_id=1&atid=200001


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From miguelangel at marchuet.net  Wed May 16 03:49:35 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May 16 03:49:03 2007
Subject: [Harbour] Posible bug in FOR clause
Message-ID: <464AB78F.5070807@marchuet.net>


PROCEDURE Main()
   LOCAL cGrupo, acGrupos := {'1','2'}, nGrupo
   FOR EACH cGrupo IN acGrupos
      // Cerramos grupos inferiores
      FOR nGrupo := Len( acGrupos ) TO HB_EnumIndex() STEP -1
      NEXT nGrupo
   NEXT
RETURN


Generates the next syntax error:

prg\Senior.prg(60) Warning W0031  Invalid variable 'NGRUPO' for enumerator message

for line

      FOR nGrupo := Len( acGrupos ) TO HB_EnumIndex() STEP -1



Best regards,
Miguel Angel Marchuet
From miguelangel at marchuet.net  Wed May 16 03:59:01 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May 16 03:58:21 2007
Subject: [Harbour] Its possible add c unary operators ?
Message-ID: <464AB9C5.4060306@marchuet.net>

prg\VRD.prg(3951) Error E0030  Syntax error: "syntax error at '|'"

MessageBox( GetActiveWindow(), 'Operation : '  + oErr:Operation, 'Error', MB_CANCELTRYCONTINUE | MB_ICONSTOP )


| binary OR

& binary AND

^^ binary XOR


Best regards,
Miguel Angel Marchuet
From harbour.01 at syenar.hu  Wed May 16 04:15:42 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 04:15:50 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <464AB9C5.4060306@marchuet.net>
References: <464AB9C5.4060306@marchuet.net>
Message-ID: <F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>

Hi,

> MessageBox( GetActiveWindow(), 'Operation : '  + oErr:Operation,  
> 'Error', MB_CANCELTRYCONTINUE | MB_ICONSTOP )
>
>
> | binary OR
>
> & binary AND

If posing no technical or future problems and we hear other opinions,
I vote a dim yes.

> ^^ binary XOR

This is not a C operator. I vote against it. For the rare cases this one
is useful, a regular function can be used just as well while keeping
backwards compatibility. The function in question could be even
optimized by the compiler. Same applies to "&" and "|".

Brgds,
Viktor

From miguelangel at marchuet.net  Wed May 16 04:29:31 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May 16 04:28:54 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>
References: <464AB9C5.4060306@marchuet.net>
	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>
Message-ID: <464AC0EB.8090007@marchuet.net>

Szak?ts Viktor escribi?:
> Hi,
> 
>> MessageBox( GetActiveWindow(), 'Operation : '  + oErr:Operation,
>> 'Error', MB_CANCELTRYCONTINUE | MB_ICONSTOP )
>>
>>
>> | binary OR
>>
>> & binary AND
> 
> If posing no technical or future problems and we hear other opinions,
> I vote a dim yes.
> 
>> ^^ binary XOR
> 
> This is not a C operator. I vote against it. For the rare cases this one
> is useful, a regular function can be used just as well while keeping
> backwards compatibility. The function in question could be even
> optimized by the compiler. Same applies to "&" and "|".
> 


Bitwise Exclusive OR ^ its occupied by Exp for this reason will be used ^^ instead of ^

Its very useful, for example:

FUNCTION RC4EnCryptASC( plaintxt, psw )

      LOCAL temp, a, i, j, k, cipherby, cipher := '', sBox, rc4Key

      i := 0
      j := 0

      RC4Initialize( psw, @sBox, @rc4Key )

      for a := 1 To Len(plaintxt)
         i       := ( i + 1 ) % 256
         j       := ( j + sbox[i+1] ) % 256
         temp    := sbox[i+1]
         sbox[i+1] := sbox[j+1]
         sbox[j+1] := temp

         k       := sbox[ ((sbox[i+1] + sbox[j+1]) % 256) + 1 ]

         cipherby := Asc( plaintxt[a] ) ^^ k  //---------------------- XOR
         cipher  += "|" + cValToChar( cipherby )
      next

RETURN cipher



From harbour.01 at syenar.hu  Wed May 16 04:38:30 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 04:38:33 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <464AC0EB.8090007@marchuet.net>
References: <464AB9C5.4060306@marchuet.net>
	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>
	<464AC0EB.8090007@marchuet.net>
Message-ID: <1947520D-059B-4111-AA82-F835FF00B989@syenar.hu>

> Bitwise Exclusive OR ^ its occupied by Exp for this reason will be  
> used ^^ instead of ^

I know, but that doesn't make it a C operator :) It's a xhb language  
extension.

> Its very useful, for example:

Of course it can be useful, but it so rarely occurs in a normal
application, that I don't feel adding yet another extension,
(especially a new operator) to address it.

HB_XOR() or HB_NUMXOR() could solve the problem in a clean
and backward compatible way. (meaning you can implement HB_*XOR()
in Clipper/xBase++/Flagship even, and have you application still
compile and work).

It might be better to implement such functions in plain C for optimum
performance. Even if Harbour optimized the XOR operation, it wouldn't
majorly effect the execution speed.

Brgds,
Viktor

>
> FUNCTION RC4EnCryptASC( plaintxt, psw )
>
>       LOCAL temp, a, i, j, k, cipherby, cipher := '', sBox, rc4Key
>
>       i := 0
>       j := 0
>
>       RC4Initialize( psw, @sBox, @rc4Key )
>
>       for a := 1 To Len(plaintxt)
>          i       := ( i + 1 ) % 256
>          j       := ( j + sbox[i+1] ) % 256
>          temp    := sbox[i+1]
>          sbox[i+1] := sbox[j+1]
>          sbox[j+1] := temp
>
>          k       := sbox[ ((sbox[i+1] + sbox[j+1]) % 256) + 1 ]
>
>          cipherby := Asc( plaintxt[a] ) ^^  
> k  //---------------------- XOR
>          cipher  += "|" + cValToChar( cipherby )
>       next
>
> RETURN cipher
>
>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From miguelangel at marchuet.net  Wed May 16 04:45:54 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May 16 04:45:15 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <1947520D-059B-4111-AA82-F835FF00B989@syenar.hu>
References: <464AB9C5.4060306@marchuet.net>	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>	<464AC0EB.8090007@marchuet.net>
	<1947520D-059B-4111-AA82-F835FF00B989@syenar.hu>
Message-ID: <464AC4C2.8010106@marchuet.net>

Szak?ts Viktor escribi?:
>> Bitwise Exclusive OR ^ its occupied by Exp for this reason will be
>> used ^^ instead of ^
> 
> I know, but that doesn't make it a C operator :) It's a xhb language
> extension.
> 

Sorry but MSVC use ^ as exclusive bitwise or, and BCC uses it too.


this is a copy/paste of MSDN documentation of MSVC:

The C bitwise operators are described below:

Operator  Description
&
 The bitwise-AND operator compares each bit of its first operand to the corresponding bit of its second operand. If both bits
are 1, the corresponding result bit is set to 1. Otherwise, the corresponding result bit is set to 0.

^
 The bitwise-exclusive-OR operator compares each bit of its first operand to the corresponding bit of its second operand. If one
bit is 0 and the other bit is 1, the corresponding result bit is set to 1. Otherwise, the corresponding result bit is set to 0.

|
 The bitwise-inclusive-OR operator compares each bit of its first operand to the corresponding bit of its second operand. If
either bit is 1, the corresponding result bit is set to 1. Otherwise, the corresponding result bit is set to 0.

Best regards,
Miguel Angel Marchuet

From fmancera at viaopen.com  Wed May 16 04:54:25 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Wed May 16 04:55:02 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <464AB9C5.4060306@marchuet.net>
References: <464AB9C5.4060306@marchuet.net>
Message-ID: <000f01c79797$ce49d6f0$3e010a0a@PORTATIL>

Hi,

>>prg\VRD.prg(3951) Error E0030  Syntax error: "syntax error at '|'"
>>MessageBox( GetActiveWindow(), 'Operation : '  + oErr:Operation, 'Error',
MB_CANCELTRYCONTINUE | MB_ICONSTOP )
>>| binary OR
>>& binary AND
>>^^ binary XOR

I think that the extensions must follow the model of Clipper/xBase language.
Otherwise in the future Harbour will not be looked in anything like the
Clipper language.
We do not have to forget that Harbour was born like Clipper/xBase Compiler.

Best Regards,

Fernando Mancera




From harbour.01 at syenar.hu  Wed May 16 04:57:54 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 04:58:03 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <464AC4C2.8010106@marchuet.net>
References: <464AB9C5.4060306@marchuet.net>	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>	<464AC0EB.8090007@marchuet.net>
	<1947520D-059B-4111-AA82-F835FF00B989@syenar.hu>
	<464AC4C2.8010106@marchuet.net>
Message-ID: <460D090E-E730-45E9-8754-0AA5E0B78A6B@syenar.hu>

> Szak?ts Viktor escribi?:
>>> Bitwise Exclusive OR ^ its occupied by Exp for this reason will be
>>> used ^^ instead of ^
>>
>> I know, but that doesn't make it a C operator :) It's a xhb language
>> extension.
>>
>
> Sorry but MSVC use ^ as exclusive bitwise or, and BCC uses it too.

I know the C operators, but Clipper is not C language, and ^^ is not
even a C operator.

Brgds,
Viktor

From sscc at mweb.co.za  Wed May 16 05:04:37 2007
From: sscc at mweb.co.za (Alex Strickland)
Date: Wed May 16 05:05:07 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>
References: <464AB9C5.4060306@marchuet.net>
	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>
Message-ID: <464AC925.9060100@mweb.co.za>

Szak?ts Viktor wrote:

> This is not a C operator. I vote against it. For the rare cases this one
> is useful, a regular function can be used just as well while keeping
> backwards compatibility. The function in question could be even
> optimized by the compiler. Same applies to "&" and "|".

I wrote this a while ago on xHarbour, note possible compiler ambiguities 
with & mean white space is required in xHarbour, which I think is ugly:

...

I would like to introduce these possibilities for discussion:

Logical:

.and., and, &&
.or., or, ||
.not., not, !
.gt., gt, >
.lt., lt, <
.gteq., gteq, >=
.lteq., lteq, <=
.eq., eq, =
.eeq., eeq, == (exactly equal)
.noteq. noteq, !=, <>
.noteeq. noteeq, !==

Bitwise:

.bitand., bitand, &, .&. (& requires white space)
.bitor., bitor, |, .|.
.bitxor., bitxor, ^^, .^., .^^.
.bitsr., bitsr, >>, .>., .>>.
.bitsl., bitsl, <<, .<., .<<.

What are these called?:

.in., in, $ (possibly extend semantics for $)
.has., has
.like., like

It starts to look like a bunch of bad smileys but ...

I really don't like the whitespace requirement for the & bitwise
operator. I agree that in general the dots are ugly but I'm kind of fond
of them, that's life in xWhatever.

Also, I would like to see the introduction of a pass by reference
indicator in function declarations :

procedure main()
	local i := 1
	fred(@i) /* OK */
	fred(i)	 /*Causes compile time error, or maybe runtime error*/
return

procedure fred(@i)
	i := 2
return nil

Perhaps this could be introduced with strong type checking. A runtime
error would be second best, as I guess forward declarations are hard.
Perhaps forward declarations are fundamentally required for compile time
type checking?

Regards
Alex
From druzus at priv.onet.pl  Wed May 16 05:05:22 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 16 05:05:59 2007
Subject: [Harbour] Posible bug in FOR clause
In-Reply-To: <464AB78F.5070807@marchuet.net>
References: <464AB78F.5070807@marchuet.net>
Message-ID: <20070516090522.GA4484@localhost.localdomain>

On Wed, 16 May 2007, Miguel Angel Marchuet wrote:
> PROCEDURE Main()
>    LOCAL cGrupo, acGrupos := {'1','2'}, nGrupo
>    FOR EACH cGrupo IN acGrupos
>       // Cerramos grupos inferiores
>       FOR nGrupo := Len( acGrupos ) TO HB_EnumIndex() STEP -1
>       NEXT nGrupo
>    NEXT
> RETURN
> Generates the next syntax error:
> prg\Senior.prg(60) Warning W0031  Invalid variable 'NGRUPO' for enumerator message

Thanks for the info, fixed.

best regards,
Przemek
From miguelangel at marchuet.net  Wed May 16 05:10:28 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May 16 05:13:23 2007
Subject: [Harbour] 2007-05-16 11:03 UTC+0100 Miguel Angel Marchuet
	(miguelangel/at/marchuet.net)
Message-ID: <464ACA84.7040502@marchuet.net>

2007-05-16 11:03 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * /include/hbclass.h
    ! fixed INLINE, incorrect parameters are passed to.
      reported by Juan Galvez.

Before It can't compile
...
   OPERATOR "==" ARG cArg INLINE ::dFecha == cArg:dFecha .AND. ::cHora == cArg:cHora
...

Best regards,
Miguel Angel Marchuet

From harbour.01 at syenar.hu  Wed May 16 05:16:23 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 05:16:35 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <464AC925.9060100@mweb.co.za>
References: <464AB9C5.4060306@marchuet.net>
	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>
	<464AC925.9060100@mweb.co.za>
Message-ID: <67050AFC-EEA5-40A0-A047-B9D641DB1B67@syenar.hu>

> I really don't like the whitespace requirement for the & bitwise
> operator. I agree that in general the dots are ugly but I'm kind of  
> fond
> of them, that's life in xWhatever.

Well, that's indeed a showstopper. So I'd turn down & and | in
Harbour.

The dotted suggestions might be good syntax-wise. But I think the
best is to use plain and simple functions:

HB_NUMAND( num1, num2, ... )
HB_NUMOR( num1, num2, ... )
HB_NUMXOR( num1, num, ... )

Notice that it could also be used with more than three operands.

(I might be wrong, but I seem to recall that we have these already)

> Also, I would like to see the introduction of a pass by reference
> indicator in function declarations :
>
> procedure main()
> 	local i := 1
> 	fred(@i) /* OK */
> 	fred(i)	 /*Causes compile time error, or maybe runtime error*/
> return
>
> procedure fred(@i)
> 	i := 2
> return nil

I'd like that too. I've even suggest the same syntax years ago, and
it was rejected for some reason I forgot.

It would certainly make the definition clearer. Now I used to
put a comment above the function declaration describing this.

Brgds,
Viktor

From miguelangel at marchuet.net  Wed May 16 05:25:59 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May 16 05:25:21 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <67050AFC-EEA5-40A0-A047-B9D641DB1B67@syenar.hu>
References: <464AB9C5.4060306@marchuet.net>	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>	<464AC925.9060100@mweb.co.za>
	<67050AFC-EEA5-40A0-A047-B9D641DB1B67@syenar.hu>
Message-ID: <464ACE27.2070802@marchuet.net>

Szak?ts Viktor escribi?:
>> I really don't like the whitespace requirement for the & bitwise
>> operator. I agree that in general the dots are ugly but I'm kind of fond
>> of them, that's life in xWhatever.
> 
> Well, that's indeed a showstopper. So I'd turn down & and | in
> Harbour.
> 
> The dotted suggestions might be good syntax-wise. But I think the
> best is to use plain and simple functions:
> 
> HB_NUMAND( num1, num2, ... )
> HB_NUMOR( num1, num2, ... )
> HB_NUMXOR( num1, num, ... )
> 
> Notice that it could also be used with more than three operands.

and, what about operators

>>
<<

&=
|=
^^=

HB_NUMAND, ... I think is more complex to use than

.BITWISEAND.
.BITWISEOR.
.BITWISEXOR.

but then, how to implement this:

&=
|=
^^=

For this reason i think that is more clear to use


>>
<<
&
|
^^

&=
|=
^^=

Any suggest ?

Best regards,
Miguel Angel Marchuet
From harbour.01 at syenar.hu  Wed May 16 06:01:25 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 06:01:32 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <464ACE27.2070802@marchuet.net>
References: <464AB9C5.4060306@marchuet.net>	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>	<464AC925.9060100@mweb.co.za>
	<67050AFC-EEA5-40A0-A047-B9D641DB1B67@syenar.hu>
	<464ACE27.2070802@marchuet.net>
Message-ID: <3A6440B5-C09F-48B6-9D68-6980420A2710@syenar.hu>

>>>
> <<

Bitshift is again something rarely used in a normal app,
and much better and faster be used from C worker functions
for speed.

See also HB_INLINE and #pragma BEGINDUMP/ENDDUMP
as a way to easily include any C/C++ code inside Harbour source.

libct has these implemented as functions I think.

> &=
> |=
> ^^=
>
> HB_NUMAND, ... I think is more complex to use than

It's two brackets more and you gain cross-compatibility,
extensibility and right fit in the language concept.

> .BITWISEAND.
> .BITWISEOR.
> .BITWISEXOR.

Unnecessary base language language extensions IMO.

> but then, how to implement this:
>
> &=
> |=
> ^^=

These are even more rarely used and easy to replace
syntaxes, so my opinion is that we don't need them in Harbour,
to keep the language clean.

Clipper/Harbour is an application language where the
benefits of such low-level syntax is marginal, and those
cases can be well covered using existing techniques.

Brgds,
Viktor

From miguelangel at marchuet.net  Wed May 16 06:17:14 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed May 16 06:16:35 2007
Subject: [Harbour] Its possible add c unary operators ?
In-Reply-To: <3A6440B5-C09F-48B6-9D68-6980420A2710@syenar.hu>
References: <464AB9C5.4060306@marchuet.net>	<F51BADF8-A6B9-4359-9BBB-B3ADEBA68033@syenar.hu>	<464AC925.9060100@mweb.co.za>	<67050AFC-EEA5-40A0-A047-B9D641DB1B67@syenar.hu>	<464ACE27.2070802@marchuet.net>
	<3A6440B5-C09F-48B6-9D68-6980420A2710@syenar.hu>
Message-ID: <464ADA2A.6070806@marchuet.net>

Szak?ts Viktor escribi?:
> 
> Bitshift is again something rarely used in a normal app,
> and much better and faster be used from C worker functions
> 
> These are even more rarely used and easy to replace
> syntaxes, so my opinion is that we don't need them in Harbour,
> to keep the language clean.
> 
> Clipper/Harbour is an application language where the
> benefits of such low-level syntax is marginal, and those
> cases can be well covered using existing techniques.
> 

Its an acceptable opinion.

But also it is possible that the programmers of harbour/Clipper do not have this necessity, simply because do not know his
utility by it never to have had.

Nevertheless those that if they know it, are as basic operators as operator +.

for example i want to use the bits of char to save 8 values .T./.F. in only one char at DBF field.

there are programmers that uses binary operators intensively as possible.

Are basic operator in some code.

It's an important thing that harbour needs to its future as programing language.


Best regards,
Miguel Angel Marchuet
From lorenzo.fiorini at gmail.com  Wed May 16 07:15:40 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 16 07:15:44 2007
Subject: [Harbour] 2007-05-16 11:03 UTC+0100 Miguel Angel Marchuet
	(miguelangel/at/marchuet.net)
In-Reply-To: <464ACA84.7040502@marchuet.net>
References: <464ACA84.7040502@marchuet.net>
Message-ID: <9257026e0705160415h18937cb7qbc183140bb945159@mail.gmail.com>

On 5/16/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:
> 2007-05-16 11:03 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
>   * /include/hbclass.h
>     ! fixed INLINE, incorrect parameters are passed to.
>       reported by Juan Galvez.

Sorry, I don't see it while I see an hbclass.ch change is it correct?

The only difference I see is the remove of __HB_CLS_SYMBOL_UNUSED(Self)

What was wrong?

regards,
Lorenzo
From harbour.01 at syenar.hu  Wed May 16 08:31:16 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 08:31:26 2007
Subject: [Harbour] 2007-05-16 11:03 UTC+0100 Miguel Angel Marchuet
	(miguelangel/at/marchuet.net)
In-Reply-To: <9257026e0705160415h18937cb7qbc183140bb945159@mail.gmail.com>
References: <464ACA84.7040502@marchuet.net>
	<9257026e0705160415h18937cb7qbc183140bb945159@mail.gmail.com>
Message-ID: <0BF9D9E5-0C92-4BBB-A702-151300C59629@syenar.hu>

Miguel,

On 2007.05.16., at 13:15, Lorenzo Fiorini wrote:

> On 5/16/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:
>> 2007-05-16 11:03 UTC+0100 Miguel Angel Marchuet (miguelangel/at/ 
>> marchuet.net)
>>   * /include/hbclass.h
>>     ! fixed INLINE, incorrect parameters are passed to.
>>       reported by Juan Galvez.
>
> Sorry, I don't see it while I see an hbclass.ch change is it correct?
>
> The only difference I see is the remove of __HB_CLS_SYMBOL_UNUSED 
> (Self)
>
> What was wrong?

Can you show a compilable example with the Harbour error reported?

Looks like to me the removed part could not cause any harm, but by  
removing
it, a recently implemented feature is now broken.

Brgds,
Viktor

From niki at synel.co.il  Wed May 16 09:19:03 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed May 16 09:19:09 2007
Subject: [Harbour] Re: SF Project CVS Service
References: <464AAA2F.687D@synel.co.il>
Message-ID: <464B04C7.69A4@synel.co.il>

There is an option to backup the entire CVS using rsync.
( http://sourceforge.net/docs/E04#rsync )

The command supose to be:
$ rsync -av rsync://harbour-project.cvs.sourceforge.net/cvsroot/harbour-project/* .

I try to download rsync for my Windows environment (cwRsync), but
I could not make it to work (might be some firewall settings).

After you download the entire tree, there might be a way to manually
patch the ChangeLog,v file and then sent it to SF so they could
replace the faulty one (we can always later add missing entires).


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From harbour.01 at syenar.hu  Wed May 16 09:39:40 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 09:39:46 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <464B04C7.69A4@synel.co.il>
References: <464AAA2F.687D@synel.co.il> <464B04C7.69A4@synel.co.il>
Message-ID: <D317C3A2-6021-4985-8B79-39E2CA8F7996@syenar.hu>

The command works here under OS X.

I've uploaded the Changelog file here:
http://www.syenar.hu/harbour/ChangeLog,v

4.5MB. It will stay there for a few days.

BTW repository "total size is 93808148" bytes.

Brgds,
Viktor

On 2007.05.16., at 15:19, Chen Kedem wrote:

> rsync -av rsync://harbour-project.cvs.sourceforge.net/cvsroot/ 
> harbour-project/* .

From philb at philb.us  Wed May 16 09:40:47 2007
From: philb at philb.us (Phil Barnett)
Date: Wed May 16 09:40:51 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <464B04C7.69A4@synel.co.il>
References: <464AAA2F.687D@synel.co.il> <464B04C7.69A4@synel.co.il>
Message-ID: <200705160940.47866.philb@philb.us>

On Wednesday 16 May 2007 09:19, Chen Kedem wrote:
> There is an option to backup the entire CVS using rsync.
> ( http://sourceforge.net/docs/E04#rsync )
>
> The command supose to be:
> $ rsync -av
> rsync://harbour-project.cvs.sourceforge.net/cvsroot/harbour-project/* .
>
> I try to download rsync for my Windows environment (cwRsync), but
> I could not make it to work (might be some firewall settings).
>
> After you download the entire tree, there might be a way to manually
> patch the ChangeLog,v file and then sent it to SF so they could
> replace the faulty one (we can always later add missing entires).

Since there is nothing important in the version change history, I'd suggest 
contacting them and telling them to delete the two files and once that is 
done, upload the existing changelog.

I doubt we'll ever need to roll it back.

-- 
Phil Barnett
AI4OF
SKCC #600
From druzus at priv.onet.pl  Wed May 16 09:40:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 16 09:41:11 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <46407630.3468@synel.co.il>
References: <46407630.3468@synel.co.il>
Message-ID: <20070516134035.GA7812@localhost.localdomain>

On Tue, 08 May 2007, Chen Kedem wrote:
> 2007-05-08 16:06 UTC+0300 Chen Kedem <niki@actcom.co.il>
>   * source/rtl/mlctopos.c
>     ! Make the function MLCTOPOS() more compatible.
>       TOFIX note added about existing problems.
>   * utils/hbtest/rt_misc.prg
>     + Add some tests for MLCTOPOS()

Hi All,

I'm attaching new implementation of memo line functions:
MEMOLINE(), MLCOUNT(), MLPOS(), MLCTOPOS(), MPOSTOLC()
Pleas test them - I nver used this functions in Clipper
so I'm not sure I exactly replicate all conditions and
I do not have time now for deep tests but in some basic
ones these functions seems to give much better results
then the ones in CVS.
If you will find any problem with them then please inform
me and send example. If they will work as expected then
I'll replace current CVS code with this version.

best regards,
Przemek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mlcfunc.c.gz
Type: application/x-gzip
Size: 3026 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070516/5844868a/mlcfunc.c.gz
From niki at synel.co.il  Wed May 16 09:52:45 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed May 16 09:52:39 2007
Subject: [Harbour] Re: SF Project CVS Service
References: <464AAA2F.687D@synel.co.il> <464B04C7.69A4@synel.co.il>
Message-ID: <464B0CAD.414D@synel.co.il>

Phil,

> I doubt we'll ever need to roll it back.

No. But this file works as the "status marker" for the given
reposotory. When you just take the HEAD version, you don't
need the history. But if you work on other branch (beta vs devel)
or just download a TAGed version, you can see by the changelog
what this version contains.

As I'd said, I don't have the technical knowledge to deal with this.
If you can contact SF staff and ask them which file should be deleted
you can do it here:
http://sourceforge.net/tracker/index.php?func=detail&aid=1716288&group_id=1&atid=200001

Thanks,

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From soporte at dsgsoftware.com  Wed May 16 10:03:09 2007
From: soporte at dsgsoftware.com (=?iso-8859-1?Q?Juan_G=E1lvez?=)
Date: Wed May 16 10:04:12 2007
Subject: [Harbour] 2007-05-16 11:03 UTC+0100 Miguel Angel
	Marchuet(miguelangel/at/marchuet.net)
References: <464ACA84.7040502@marchuet.net>
	<9257026e0705160415h18937cb7qbc183140bb945159@mail.gmail.com>
Message-ID: <001201c797c2$ffb46310$6c00000a@PcJuanxp>

Lorenzo, Viktor,

__HB_CLS_SYMBOL_UNUSED(Self) was being used as third argument (scope) of 
s_oClass:AddInline() ...

Perharps this would be a better implementation (I haven't tested it) :

#xcommand OPERATOR <op> [<arg: ARG, ARGS> <Args,...>] [LOCAL <Locals,...>] 
INLINE <Code,...> [ <export: EXPORTED, VISIBLE>] [<protect: PROTECTED>] 
[<hidde: HIDDEN>] => ;
   s_oClass:AddInline( <(op)>, {|Self [,<Args>] [,<Locals>]| 
__HB_CLS_SYMBOL_UNUSED(Self) <Code>}, __HB_CLS_SCOPE( <.export.>, 
<.protect.>, <.hidde.> ) )

Best regards
Juan

----- Original Message ----- 
From: "Lorenzo Fiorini" <lorenzo.fiorini@gmail.com>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Wednesday, May 16, 2007 1:15 PM
Subject: Re: [Harbour] 2007-05-16 11:03 UTC+0100 Miguel Angel 
Marchuet(miguelangel/at/marchuet.net)


> On 5/16/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:
>> 2007-05-16 11:03 UTC+0100 Miguel Angel Marchuet 
>> (miguelangel/at/marchuet.net)
>>   * /include/hbclass.h
>>     ! fixed INLINE, incorrect parameters are passed to.
>>       reported by Juan Galvez.
>
> Sorry, I don't see it while I see an hbclass.ch change is it correct?
>
> The only difference I see is the remove of __HB_CLS_SYMBOL_UNUSED(Self)
>
> What was wrong?
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour 

From lorenzo.fiorini at gmail.com  Wed May 16 10:04:20 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 16 10:04:24 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <20070516134035.GA7812@localhost.localdomain>
References: <46407630.3468@synel.co.il>
	<20070516134035.GA7812@localhost.localdomain>
Message-ID: <9257026e0705160704x5b4a0100y9c3ad4d85aab745b@mail.gmail.com>

On 5/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> I'm attaching new implementation of memo line functions:
> MEMOLINE(), MLCOUNT(), MLPOS(), MLCTOPOS(), MPOSTOLC()
> Pleas test them - I nver used this functions in Clipper
> so I'm not sure I exactly replicate all conditions and
> I do not have time now for deep tests but in some basic
> ones these functions seems to give much better results
> then the ones in CVS.
> If you will find any problem with them then please inform
> me and send example. If they will work as expected then
> I'll replace current CVS code with this version.

Many thanks I'll test them asap.

best regards,
Lorenzo
From harbour.01 at syenar.hu  Wed May 16 10:25:36 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 10:25:44 2007
Subject: [Harbour] 2007-05-16 11:03 UTC+0100 Miguel Angel
	Marchuet(miguelangel/at/marchuet.net)
In-Reply-To: <001201c797c2$ffb46310$6c00000a@PcJuanxp>
References: <464ACA84.7040502@marchuet.net>
	<9257026e0705160415h18937cb7qbc183140bb945159@mail.gmail.com>
	<001201c797c2$ffb46310$6c00000a@PcJuanxp>
Message-ID: <B8996F87-9216-4918-9C66-6BD21E4781F9@syenar.hu>

Hi Juan,

You are right, the UNUSED() stuff was misplaced.

I'll commit a fix and pls check if it works right.

Brgds,
Viktor

On 2007.05.16., at 16:03, Juan G?lvez wrote:

> Lorenzo, Viktor,
>
> __HB_CLS_SYMBOL_UNUSED(Self) was being used as third argument  
> (scope) of s_oClass:AddInline() ...
>
> Perharps this would be a better implementation (I haven't tested it) :
>
> #xcommand OPERATOR <op> [<arg: ARG, ARGS> <Args,...>] [LOCAL  
> <Locals,...>] INLINE <Code,...> [ <export: EXPORTED, VISIBLE>]  
> [<protect: PROTECTED>] [<hidde: HIDDEN>] => ;
>   s_oClass:AddInline( <(op)>, {|Self [,<Args>] [,<Locals>]|  
> __HB_CLS_SYMBOL_UNUSED(Self) <Code>}, __HB_CLS_SCOPE( <.export.>,  
> <.protect.>, <.hidde.> ) )
>
> Best regards
> Juan
>
> ----- Original Message ----- From: "Lorenzo Fiorini"  
> <lorenzo.fiorini@gmail.com>
> To: "Harbour Project Main Developer List." <harbour@harbour- 
> project.org>
> Sent: Wednesday, May 16, 2007 1:15 PM
> Subject: Re: [Harbour] 2007-05-16 11:03 UTC+0100 Miguel Angel  
> Marchuet(miguelangel/at/marchuet.net)
>
>
>> On 5/16/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:
>>> 2007-05-16 11:03 UTC+0100 Miguel Angel Marchuet (miguelangel/at/ 
>>> marchuet.net)
>>>   * /include/hbclass.h
>>>     ! fixed INLINE, incorrect parameters are passed to.
>>>       reported by Juan Galvez.
>>
>> Sorry, I don't see it while I see an hbclass.ch change is it correct?
>>
>> The only difference I see is the remove of __HB_CLS_SYMBOL_UNUSED 
>> (Self)
>>
>> What was wrong?
>>
>> regards,
>> Lorenzo
>> _______________________________________________
>> Harbour mailing list
>> Harbour@harbour-project.org
>> http://lists.harbour-project.org/mailman/listinfo/harbour
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Wed May 16 10:28:33 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 10:30:39 2007
Subject: [Harbour] CHANGELOG: 2007-05-16 16:27 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c797c6$Blat.v2.6.1$7b9b95c2$c50b8b385c@127.0.0.1>

2007-05-16 16:27 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/ChangeLog
     + Added one missing entry (2007-05-15 15:40 UTC+0300).

   * harbour/include/hblass.ch
     ! Fix added for misplaced *UNUSED() macro. (Thanks Juan)

   * harbour/include/hbapifs.h
     ! Added HB_EXPORT for hb_fsFind*() functions.

From philb at philb.us  Wed May 16 11:23:00 2007
From: philb at philb.us (Phil Barnett)
Date: Wed May 16 11:23:05 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <464B0CAD.414D@synel.co.il>
References: <464AAA2F.687D@synel.co.il> <464B04C7.69A4@synel.co.il>
	<464B0CAD.414D@synel.co.il>
Message-ID: <200705161123.00842.philb@philb.us>

On Wednesday 16 May 2007 09:52, Chen Kedem wrote:
> Phil,
>
> > I doubt we'll ever need to roll it back.
>
> No. But this file works as the "status marker" for the given
> reposotory. When you just take the HEAD version, you don't
> need the history. But if you work on other branch (beta vs devel)
> or just download a TAGed version, you can see by the changelog
> what this version contains.
>
> As I'd said, I don't have the technical knowledge to deal with this.
> If you can contact SF staff and ask them which file should be deleted
> you can do it here:
> http://sourceforge.net/tracker/index.php?func=detail&aid=1716288&group_id=1
>&atid=200001

The entire repository or the changelog?

> The harbour/ChangeLog file is corrupted, so it will need to be fixed. ?If
> you have an old copy of the ChangeLog,v repository file (from a repository
> backup), you may be able to reconstruct it by comparing the newest file and
> the older version. ?If you don't have it, it is possible to use the "rlog
> -rREVISION ChangeLog,v" command on the corrupted file to find which
> revisions are bad (use a step-size larger than 1, and narrow in on the
> problem values). ?If you create something you want to be put in place of
> the current file, let us know.

ChangeLog,v is just the ChangeLog version file. Not the entire repository.

There is a ,v file for every file in the repository. There is not a global 
change file in CVS.

-- 
Phil Barnett
AI4OF
SKCC #600
From harbour.01 at syenar.hu  Wed May 16 11:56:24 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 11:57:15 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <200705161123.00842.philb@philb.us>
References: <464AAA2F.687D@synel.co.il> <464B04C7.69A4@synel.co.il>
	<464B0CAD.414D@synel.co.il> <200705161123.00842.philb@philb.us>
Message-ID: <842840E1-C7FC-46B2-B438-4B499AF8FD27@syenar.hu>

(I've just checked and the error we're having is not caused
by the large size (or many changes) of the file, so it is in fact
corrupted.)

I don't think any of us users/developers would have a full local
repository. The other choice is manually fixing the file, or find
a tool for it (I didn't manage to find any so far).

Don't sf.net have a recent backup tape, which could be loaded
back?

Brgds,
Viktor

On 2007.05.16., at 17:23, Phil Barnett wrote:

> On Wednesday 16 May 2007 09:52, Chen Kedem wrote:
>> Phil,
>>
>>> I doubt we'll ever need to roll it back.
>>
>> No. But this file works as the "status marker" for the given
>> reposotory. When you just take the HEAD version, you don't
>> need the history. But if you work on other branch (beta vs devel)
>> or just download a TAGed version, you can see by the changelog
>> what this version contains.
>>
>> As I'd said, I don't have the technical knowledge to deal with this.
>> If you can contact SF staff and ask them which file should be deleted
>> you can do it here:
>> http://sourceforge.net/tracker/index.php? 
>> func=detail&aid=1716288&group_id=1
>> &atid=200001
>
> The entire repository or the changelog?
>
>> The harbour/ChangeLog file is corrupted, so it will need to be  
>> fixed.  If
>> you have an old copy of the ChangeLog,v repository file (from a  
>> repository
>> backup), you may be able to reconstruct it by comparing the newest  
>> file and
>> the older version.  If you don't have it, it is possible to use  
>> the "rlog
>> -rREVISION ChangeLog,v" command on the corrupted file to find which
>> revisions are bad (use a step-size larger than 1, and narrow in on  
>> the
>> problem values).  If you create something you want to be put in  
>> place of
>> the current file, let us know.
>
> ChangeLog,v is just the ChangeLog version file. Not the entire  
> repository.
>
> There is a ,v file for every file in the repository. There is not a  
> global
> change file in CVS.
>
> -- 
> Phil Barnett
> AI4OF
> SKCC #600
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From soporte at dsgsoftware.com  Wed May 16 11:57:07 2007
From: soporte at dsgsoftware.com (=?iso-8859-1?Q?Juan_G=E1lvez?=)
Date: Wed May 16 11:58:09 2007
Subject: [Harbour] CHANGELOG: 2007-05-16 16:27 UTC+0100 Viktor
	Szakats(harbour.01 syenar.hu)
References: <01c797c6$Blat.v2.6.1$7b9b95c2$c50b8b385c@127.0.0.1>
Message-ID: <003c01c797d2$dede85c0$6c00000a@PcJuanxp>

Viktor,

It work right.

Many thanks
Juan

----- Original Message ----- 
From: "Szak?ts Viktor" <harbour.01@syenar.hu>
To: <harbour@harbour-project.org>
Sent: Wednesday, May 16, 2007 4:28 PM
Subject: [Harbour] CHANGELOG: 2007-05-16 16:27 UTC+0100 Viktor 
Szakats(harbour.01 syenar.hu)


> 2007-05-16 16:27 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>   * harbour/ChangeLog
>     + Added one missing entry (2007-05-15 15:40 UTC+0300).
>
>   * harbour/include/hblass.ch
>     ! Fix added for misplaced *UNUSED() macro. (Thanks Juan)
>
>   * harbour/include/hbapifs.h
>     ! Added HB_EXPORT for hb_fsFind*() functions.
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour 

From lorenzo.fiorini at gmail.com  Wed May 16 13:12:49 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 16 13:12:55 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <20070516134035.GA7812@localhost.localdomain>
References: <46407630.3468@synel.co.il>
	<20070516134035.GA7812@localhost.localdomain>
Message-ID: <9257026e0705161012r1671835bn7ae489bd92180b64@mail.gmail.com>

On 5/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> If you will find any problem with them then please inform
> me and send example. If they will work as expected then
> I'll replace current CVS code with this version.

With wrap false memoline return exactly what C53b does wrap true it
breaks words.

mlctopos is different but I really don't know much about it.

I used the test below.

best regards,
Lorenzo

#define _CR chr(13)
#define _LF chr(10)
#define _SOFT1 chr( 141 )
#define _CRLF ( _CR + _LF )

procedure main()

   local cString := ""
   local aPos
   local nPos
   local lWrap := .f.

   cString += "first line first line first line first line first line
first line first line" + _SOFT1 + _LF
   cString += "second line second line second line second line second
line second line second line second line"

   ? mlcount( cString, 40,, lWrap )

   ? memoline( cString, 40, 1,, lWrap )
   ? memoline( cString, 40, 2,, lWrap )
   ? memoline( cString, 40, 3,, lWrap )
   ? memoline( cString, 40, 4,, lWrap )
   ? memoline( cString, 40, 5,, lWrap )

   aPos := mpostolc( cString, 5, 10 )

   ? aPos[1], aPos[2]

   nPos := mlctopos( cString, 2, 5 )

   ? nPos

return
From philb at philb.us  Wed May 16 14:53:42 2007
From: philb at philb.us (Phil Barnett)
Date: Wed May 16 14:53:47 2007
Subject: [Harbour] Re: SF Project CVS Service
In-Reply-To: <842840E1-C7FC-46B2-B438-4B499AF8FD27@syenar.hu>
References: <464AAA2F.687D@synel.co.il> <200705161123.00842.philb@philb.us>
	<842840E1-C7FC-46B2-B438-4B499AF8FD27@syenar.hu>
Message-ID: <200705161453.42394.philb@philb.us>

On Wednesday 16 May 2007 11:56, Szak?ts Viktor wrote:
> (I've just checked and the error we're having is not caused
> by the large size (or many changes) of the file, so it is in fact
> corrupted.)
>
> I don't think any of us users/developers would have a full local
> repository. The other choice is manually fixing the file, or find
> a tool for it (I didn't manage to find any so far).
>
> Don't sf.net have a recent backup tape, which could be loaded
> back?

We don't really ever have the need to roll back the ChangeLog file. Someone 
tell them to delete both files and we'll upload a fresh copy. That will 
create the new ChangeLog.v file at the same time.

Someone does have a copy of the ChangeLog file that is not corrupt, so it's 
not a big deal.

-- 
Phil Barnett
AI4OF
SKCC #600
From druzus at priv.onet.pl  Wed May 16 14:58:23 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 16 14:58:59 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <9257026e0705161012r1671835bn7ae489bd92180b64@mail.gmail.com>
References: <46407630.3468@synel.co.il>
	<20070516134035.GA7812@localhost.localdomain>
	<9257026e0705161012r1671835bn7ae489bd92180b64@mail.gmail.com>
Message-ID: <20070516185823.GA26869@localhost.localdomain>

On Wed, 16 May 2007, Lorenzo Fiorini wrote:
> With wrap false memoline return exactly what C53b does wrap true it
> breaks words.
> mlctopos is different but I really don't know much about it.
> I used the test below.

Many thanks for tests. Please try the version from attachment.

best regards,
Przemek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mlcfunc.c.gz
Type: application/x-gzip
Size: 3045 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070516/75277046/mlcfunc.c.gz
From lorenzo.fiorini at gmail.com  Wed May 16 16:04:29 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 16 16:04:35 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <20070516185823.GA26869@localhost.localdomain>
References: <46407630.3468@synel.co.il>
	<20070516134035.GA7812@localhost.localdomain>
	<9257026e0705161012r1671835bn7ae489bd92180b64@mail.gmail.com>
	<20070516185823.GA26869@localhost.localdomain>
Message-ID: <9257026e0705161304w57e5b70at181fb134a3819546@mail.gmail.com>

On 5/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Many thanks for tests. Please try the version from attachment.

Now memoline seems ok also for wrap true.

There is a fm.c log:

Total memory allocated: 34408 bytes (577 block(s))
WARNING! Memory allocated but not released: 12 bytes (1 block(s))
fm.c:622: HB_TR_ERROR Block 1 (size 8) MLCTOPOS(0), "087D)50901000000"

Below there is the test that reports the memory leak.

best regards,
Lorenzo

#define _CR chr(13)
#define _LF chr(10)
#define _SOFT1 chr( 141 )
#define _CRLF ( _CR + _LF )

procedure main()

   local cString := ""
   local aPos
   local nPos
   local lWrap := .f.

   cString += "first line first line first line first line first line
first line first line" + _SOFT1 + _LF
   cString += "second line second line second line second line second
line second line second line second line"

   ? mlcount( cString, 40,, lWrap )

   ? memoline( cString, 40, 1,, lWrap )
   ? memoline( cString, 40, 2,, lWrap )
   ? memoline( cString, 40, 3,, lWrap )
   ? memoline( cString, 40, 4,, lWrap )
   ? memoline( cString, 40, 5,, lWrap )

   aPos := mpostolc( cString, 5, 10 )

   ? aPos[1], aPos[2]

   nPos := mlctopos( cString, 2, 5 )

   ? nPos

   ? "[", MEMOLINE( "A" + CHR(13) + CHR(10) + "B" + CHR(13) + CHR(10),
4, 1 ), "] = A"

   ? "[", LEN( MEMOLINE( "X" + CHR( 13 ) + CHR( 10 ), 10, 1 ) ), "] = 10"

   ? "[", ASC( SUBSTR( MEMOLINE( CHR( 13 ) + CHR( 10 ) + "TEST" + CHR(
13 ) + CHR( 10 ), 20, 1 ), 1, 1 ) ), "] = 32"

   ? "[", MEMOLINE( "A" + CHR( 141 ) + CHR( 10 ) + "B" + CHR( 13 ) +
CHR( 10 ), 200, 1 ), "] = AB"

   wait

return
From randy at palmasdev.com  Wed May 16 16:20:37 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Wed May 16 16:19:57 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <9257026e0705161304w57e5b70at181fb134a3819546@mail.gmail.co
 m>
References: <46407630.3468@synel.co.il>
	<20070516134035.GA7812@localhost.localdomain>
	<9257026e0705161012r1671835bn7ae489bd92180b64@mail.gmail.com>
	<20070516185823.GA26869@localhost.localdomain>
	<9257026e0705161304w57e5b70at181fb134a3819546@mail.gmail.com>
Message-ID: <20070516201954.3988C10167E@smtp.tor.pathcom.com>

I am not sure if you are discussing leaks or Cl*pper compatibility - 
Please note that the following yielded different results in Cl*pper 
and Harbour in an earlier version of this proposed code:

LEN( MEMOLINE( "X" + CHR( 13 ) + CHR( 10 ), 10, 1 ) )

MEMOLINE( CHR( 13 ) + CHR( 10 ) + "TEST" + CHR( 13 ) + CHR( 10 ), 20, 1 )

MEMOLINE( "A" + CHR( 141 ) + CHR( 10 ) + "B" + CHR( 13 ) + CHR( 10 ), 200, 1 )

MEMOLINE( "A" + CHR(13) + CHR(10) + "B" + CHR(13) + CHR(10), 4, 1 )


At 04:04 PM 5/16/2007, you wrote:
>On 5/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
>
>>Many thanks for tests. Please try the version from attachment.
>
>Now memoline seems ok also for wrap true.
>
>There is a fm.c log:
>
>Total memory allocated: 34408 bytes (577 block(s))
>WARNING! Memory allocated but not released: 12 bytes (1 block(s))
>fm.c:622: HB_TR_ERROR Block 1 (size 8) MLCTOPOS(0), "087D)50901000000"
>
>Below there is the test that reports the memory leak.
>
>best regards,
>Lorenzo
>
>#define _CR chr(13)
>#define _LF chr(10)
>#define _SOFT1 chr( 141 )
>#define _CRLF ( _CR + _LF )
>
>procedure main()
>
>   local cString := ""
>   local aPos
>   local nPos
>   local lWrap := .f.
>
>   cString += "first line first line first line first line first line
>first line first line" + _SOFT1 + _LF
>   cString += "second line second line second line second line second
>line second line second line second line"
>
>   ? mlcount( cString, 40,, lWrap )
>
>   ? memoline( cString, 40, 1,, lWrap )
>   ? memoline( cString, 40, 2,, lWrap )
>   ? memoline( cString, 40, 3,, lWrap )
>   ? memoline( cString, 40, 4,, lWrap )
>   ? memoline( cString, 40, 5,, lWrap )
>
>   aPos := mpostolc( cString, 5, 10 )
>
>   ? aPos[1], aPos[2]
>
>   nPos := mlctopos( cString, 2, 5 )
>
>   ? nPos
>
>   ? "[", MEMOLINE( "A" + CHR(13) + CHR(10) + "B" + CHR(13) + CHR(10),
>4, 1 ), "] = A"
>
>   ? "[", LEN( MEMOLINE( "X" + CHR( 13 ) + CHR( 10 ), 10, 1 ) ), "] = 10"
>
>   ? "[", ASC( SUBSTR( MEMOLINE( CHR( 13 ) + CHR( 10 ) + "TEST" + CHR(
>13 ) + CHR( 10 ), 20, 1 ), 1, 1 ) ), "] = 32"
>
>   ? "[", MEMOLINE( "A" + CHR( 141 ) + CHR( 10 ) + "B" + CHR( 13 ) +
>CHR( 10 ), 200, 1 ), "] = AB"
>
>   wait
>
>return
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour
>

From druzus at priv.onet.pl  Wed May 16 16:48:54 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 16 16:49:30 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <9257026e0705161304w57e5b70at181fb134a3819546@mail.gmail.com>
References: <46407630.3468@synel.co.il>
	<20070516134035.GA7812@localhost.localdomain>
	<9257026e0705161012r1671835bn7ae489bd92180b64@mail.gmail.com>
	<20070516185823.GA26869@localhost.localdomain>
	<9257026e0705161304w57e5b70at181fb134a3819546@mail.gmail.com>
Message-ID: <20070516204854.GA29267@localhost.localdomain>

On Wed, 16 May 2007, Lorenzo Fiorini wrote:
> On 5/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
> >Many thanks for tests. Please try the version from attachment.
> Now memoline seems ok also for wrap true.
> Below there is the test that reports the memory leak.

Fixed.

best regards,
Przemek
From druzus at priv.onet.pl  Wed May 16 16:52:38 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 16 16:53:15 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <20070516201954.3988C10167E@smtp.tor.pathcom.com>
References: <46407630.3468@synel.co.il>
	<20070516134035.GA7812@localhost.localdomain>
	<9257026e0705161012r1671835bn7ae489bd92180b64@mail.gmail.com>
	<20070516185823.GA26869@localhost.localdomain>
	<9257026e0705161304w57e5b70at181fb134a3819546@mail.gmail.com>
	<20070516201954.3988C10167E@smtp.tor.pathcom.com>
Message-ID: <20070516205238.GB29267@localhost.localdomain>

On Wed, 16 May 2007, Randy Portnoff wrote:
> I am not sure if you are discussing leaks or Cl*pper compatibility - 
> Please note that the following yielded different results in Cl*pper 
> and Harbour in an earlier version of this proposed code:
> LEN( MEMOLINE( "X" + CHR( 13 ) + CHR( 10 ), 10, 1 ) )
> MEMOLINE( CHR( 13 ) + CHR( 10 ) + "TEST" + CHR( 13 ) + CHR( 10 ), 20, 1 )
> MEMOLINE( "A" + CHR( 141 ) + CHR( 10 ) + "B" + CHR( 13 ) + CHR( 10 ), 200, 1 )
> MEMOLINE( "A" + CHR(13) + CHR(10) + "B" + CHR(13) + CHR(10), 4, 1 )

The version I sent recently gives the same result as CL52.
If you will find any other incompatibilities then please let me know.
I'm attaching the code with fixed memory leak.

best regards,
Przemek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: mlcfunc.c.gz
Type: application/x-gzip
Size: 3052 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070516/03a331be/mlcfunc.c-0001.gz
From druzus at priv.onet.pl  Wed May 16 17:21:27 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 16 17:22:02 2007
Subject: [Harbour] ChangeLog 2007-05-12 10:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070512084959.GB19092@localhost.localdomain>
References: <20070512084959.GB19092@localhost.localdomain>
Message-ID: <20070516212127.GA17316@localhost.localdomain>

On Sat, 12 May 2007, Przemyslaw Czerpak wrote:
> 2007-05-12 12:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>     + added support for extended multiline codeblocks:
>          { |<params,...>| <EOL>
>             <statement1>
>             ...
>             <statementN>
>             return <val>
>          }
>       Please make real tests - your decision will be final for me so
>       if you decide to remove the above from CVS then I'll do that and
>       I will not want to return to this subject.

Hi All,

What is the final group decision?
Should I leave it or remove?

best regards,
Przemek
From harbour.01 at syenar.hu  Wed May 16 17:26:29 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 17:26:37 2007
Subject: [Harbour] ChangeLog 2007-05-12 10:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070516212127.GA17316@localhost.localdomain>
References: <20070512084959.GB19092@localhost.localdomain>
	<20070516212127.GA17316@localhost.localdomain>
Message-ID: <60D9F207-4BAB-4344-BB72-B903798058A4@syenar.hu>

Hi Przemek,

I think you should leave it, it's a nice solution to the problem.

Brgds,
Viktor

On 2007.05.16., at 23:21, Przemyslaw Czerpak wrote:

> On Sat, 12 May 2007, Przemyslaw Czerpak wrote:
>> 2007-05-12 12:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>>     + added support for extended multiline codeblocks:
>>          { |<params,...>| <EOL>
>>             <statement1>
>>             ...
>>             <statementN>
>>             return <val>
>>          }
>>       Please make real tests - your decision will be final for me so
>>       if you decide to remove the above from CVS then I'll do that  
>> and
>>       I will not want to return to this subject.
>
> Hi All,
>
> What is the final group decision?
> Should I leave it or remove?
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Wed May 16 17:50:56 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 16 17:51:01 2007
Subject: [Harbour] ChangeLog 2007-05-12 10:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070516212127.GA17316@localhost.localdomain>
References: <20070512084959.GB19092@localhost.localdomain>
	<20070516212127.GA17316@localhost.localdomain>
Message-ID: <9257026e0705161450r2bdff596xbf88b3714eb45c57@mail.gmail.com>

On 5/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> What is the final group decision?
> Should I leave it or remove?

Please leave it.

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Wed May 16 17:53:44 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 16 17:53:46 2007
Subject: [Harbour] ChangeLog: 2007-05-08 16:06 UTC+0300 Chen Kedem
In-Reply-To: <20070516205238.GB29267@localhost.localdomain>
References: <46407630.3468@synel.co.il>
	<20070516134035.GA7812@localhost.localdomain>
	<9257026e0705161012r1671835bn7ae489bd92180b64@mail.gmail.com>
	<20070516185823.GA26869@localhost.localdomain>
	<9257026e0705161304w57e5b70at181fb134a3819546@mail.gmail.com>
	<20070516201954.3988C10167E@smtp.tor.pathcom.com>
	<20070516205238.GB29267@localhost.localdomain>
Message-ID: <9257026e0705161453p61b2880bg7e42160be4cb2d83@mail.gmail.com>

On 5/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> I'm attaching the code with fixed memory leak.

I've done some test also on "full" apps and it seems ok.

I vote for commit it.

regards,
Lorenzo
From druzus at priv.onet.pl  Wed May 16 18:20:26 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 16 18:21:04 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070516222026.GA20413@localhost.localdomain>

2007-05-17 00:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/TODO
    * removed some not longer necessary TODO/TOFIX

  * harbour/common.mak
  * harbour/source/rtl/Makefile
  - harbour/source/rtl/memoline.c
  - harbour/source/rtl/mlcount.c
  - harbour/source/rtl/mlctopos.c
  - harbour/source/rtl/mlpos.c
  - harbour/source/rtl/mpostolc.c
  + harbour/source/rtl/mlcfunc.c
    * new version of memo line functions:
         MEMOLINE(), MLCOUNT(), MLPOS(), MLCTOPOS(), MPOSTOLC()

  * harbour/include/hbexpra.c
    ! fixed in HB_COMPAT_XHB build hb_enumIndex() used inside internal
      FOR/NEXT loop

  * harbour/include/hbpp.h
  * harbour/source/pp/ppcore.c
    ! removed some not longer necessary hack
    % added some speed optimizations - it's not done in the way I want to
      have in the final version but with some very small modifications it
      should make people using a lot of #[x]translate (Enrico ;-)) happy.

  * harbour/source/rtl/set.c
    * minor cleanup in HB_SET_EOL initialization

  * harbour/source/vm/hvm.c
    * clean MEMO flag in array and hash items created by { MEMOFILED, ... }
      or { "KEY" => MEMOFILED, ... } and optimized results of PLUS operation

  * harbour/utils/hbtest/rt_misc.prg
    * SET EOL to CHR(13) + CHR( 10 ) before MLCTOPOS() tests to avoid false
      alarm on platforms with differ default EOL

best regards,
Przemek
From harbour.01 at syenar.hu  Wed May 16 18:36:20 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 16 18:38:26 2007
Subject: [Harbour] CHANGELOG: 2007-05-17 00:36 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c7980a$Blat.v2.6.1$a04cfe26$ac0469816ba@127.0.0.1>

2007-05-17 00:36 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/utils/hbtest/rt_misc.prg
     ! SET EOLs guarded with __HARBOUR__ to make it compile on 
       other platforms.

From lorenzo.fiorini at gmail.com  Wed May 16 18:43:57 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 16 18:44:00 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070516222026.GA20413@localhost.localdomain>
References: <20070516222026.GA20413@localhost.localdomain>
Message-ID: <9257026e0705161543t4c62a7e4x3c1e62a23bbc6c78@mail.gmail.com>

On 5/17/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> 2007-05-17 00:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/TODO
> ...
>       alarm on platforms with differ default EOL

Many thanks.

best regards,
Lorenzo
From niki at synel.co.il  Thu May 17 03:00:52 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu May 17 03:00:42 2007
Subject: [Harbour] CHANGELOG: 2007-05-17 00:36 UTC+0100 Viktor
	Szakats	(harbour.01 syenar.hu)
Message-ID: <464BFDA3.3ED4@synel.co.il>

After this changelog:
HBPPTest now reports 12 failed results (used to be 16).
HBTest   new reports 30 failed results (used to be 42).

Przemek,
Your MLCTOPOS() implementation is clear and 100% compatible so far.
Thanks!


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From e.m.giordano at emagsoftware.it  Thu May 17 03:03:16 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May 17 03:03:51 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070516222026.GA20413@localhost.localdomain>
Message-ID: <003b01c79851$71383370$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: giovedi 17 maggio 2007 0.20
Oggetto: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200 Przemyslaw 
Czerpak(druzus/at/priv.onet.pl)


>    % added some speed optimizations - it's not done in the way I want to
>      have in the final version but with some very small modifications it
>      should make people using a lot of #[x]translate (Enrico ;-)) happy.

Thank you! But... how do you know that I'm using a good amount of 
#[x]translate? :-)

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From dbtopas at dbtopas.lt  Thu May 17 03:15:47 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Thu May 17 03:12:29 2007
Subject: [Harbour] ChangeLog 2007-05-12 10:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070516212127.GA17316@localhost.localdomain>
References: <20070512084959.GB19092@localhost.localdomain>
	<20070516212127.GA17316@localhost.localdomain>
Message-ID: <464C0123.5090603@dbtopas.lt>

Przemyslaw Czerpak wrote:
>>2007-05-12 12:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>>    + added support for extended multiline codeblocks:
>>         { |<params,...>| <EOL>
>>            <statement1>
>>            ...
>>            <statementN>
>>            return <val>
>>         }
> 
> What is the final group decision?
> Should I leave it or remove?

Hi,


do you see any side effects or drawbacks of this implementation (except 
"it will not recognize properly multiline codeblocks which can appear in 
the code after preprocessing")?


Best regards,
Mindaugas
From druzus at priv.onet.pl  Thu May 17 06:42:58 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 17 06:43:35 2007
Subject: [Harbour] ChangeLog 2007-05-12 10:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <464C0123.5090603@dbtopas.lt>
References: <20070512084959.GB19092@localhost.localdomain>
	<20070516212127.GA17316@localhost.localdomain>
	<464C0123.5090603@dbtopas.lt>
Message-ID: <20070517104258.GA21426@localhost.localdomain>

On Thu, 17 May 2007, Mindaugas Kavaliauskas wrote:
> do you see any side effects or drawbacks of this implementation (except 
> "it will not recognize properly multiline codeblocks which can appear in 
> the code after preprocessing")?

Seems that we address all bad situations we've found so far
and current implementation allows to use any language statements
supported by functions.
I know only two things we may want to change in the future:
1. the above PP issue - I do not know if it's necessary and anyone
   will want to make it
2. add support for using codeblock local parameters and variables in
   nested codeblock - for this we will have to change representation
   of nested codeblocks in PCODE and intorduce some modifications
   in HVM. But the same is for normal codeblock and Clipper also
   not allow to use codeblock local parameters in nested codeblocks
   so I think we can leave it as is now and add such functionality
   in the future as new feature.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May 17 06:51:04 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 17 06:51:40 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
In-Reply-To: <003b01c79851$71383370$0100a8c0@emag>
References: <20070516222026.GA20413@localhost.localdomain>
	<003b01c79851$71383370$0100a8c0@emag>
Message-ID: <20070517105104.GB21426@localhost.localdomain>

On Thu, 17 May 2007, Enrico Maria Giordano wrote:
> >   % added some speed optimizations - it's not done in the way I want to
> >     have in the final version but with some very small modifications it
> >     should make people using a lot of #[x]translate (Enrico ;-)) happy.
> Thank you! But... how do you know that I'm using a good amount of 
> #[x]translate? :-)

Deduction - people usually say much more then we can find explicitly
in their words :-)
Is it fast enough now?

best regards,
Przemek
From maurilio.longo at libero.it  Thu May 17 07:04:52 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Thu May 17 07:05:48 2007
Subject: [Harbour] ChangeLog 2007-05-12 10:45 UTC+0200 Przemyslaw 
	Czerpak(druzus/at/priv.onet.pl)
References: <20070512084959.GB19092@localhost.localdomain>
	<20070516212127.GA17316@localhost.localdomain>
Message-ID: <464C36D4.F53B9FD5@libero.it>

Przemyslaw,

I think its a good thing to leave them and, maybe, add them to xharbour ;)

Maurilio.


Przemyslaw Czerpak ha scritto:
> 
> On Sat, 12 May 2007, Przemyslaw Czerpak wrote:
> > 2007-05-12 12:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> >     + added support for extended multiline codeblocks:
> >          { |<params,...>| <EOL>
> >             <statement1>
> >             ...
> >             <statementN>
> >             return <val>
> >          }
> >       Please make real tests - your decision will be final for me so
> >       if you decide to remove the above from CVS then I'll do that and
> >       I will not want to return to this subject.
> 
> Hi All,
> 
> What is the final group decision?
> Should I leave it or remove?
> 
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From niki at synel.co.il  Thu May 17 07:27:28 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu May 17 07:27:18 2007
Subject: [Harbour] Ambiguos reference warning while using CLP file
Message-ID: <464C3C20.144D@synel.co.il>

Tested with BCB32,
devel ChangeLog 2007-05-17 00:36 UTC+0100 Viktor Szakats

--t1.prg--
proc main
----------

--t2.prg--
static s
func t2f()
return s
----------

--ttt.clp-
t1
t2
----------

..\bin\harbour @ttt /w/a/n

t2.prg(3) Warning W0001  Ambiguous reference: 'S'

If I compile t2.prg alone, there is no warning.
Clipper of course show no warning compiling the CLP file.


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From druzus at priv.onet.pl  Thu May 17 08:05:23 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 17 08:05:58 2007
Subject: [Harbour] Ambiguos reference warning while using CLP file
In-Reply-To: <464C3C20.144D@synel.co.il>
References: <464C3C20.144D@synel.co.il>
Message-ID: <20070517120523.GA32009@localhost.localdomain>

On Thu, 17 May 2007, Chen Kedem wrote:
> Tested with BCB32,
> devel ChangeLog 2007-05-17 00:36 UTC+0100 Viktor Szakats
> --t1.prg--
> proc main
> ----------
> --t2.prg--
> static s
> func t2f()
> return s
> ----------
> --ttt.clp-
> t1
> t2
> ----------
> ..\bin\harbour @ttt /w/a/n
> t2.prg(3) Warning W0001  Ambiguous reference: 'S'
> If I compile t2.prg alone, there is no warning.
> Clipper of course show no warning compiling the CLP file.

It's a known behavior and the above example shows only a part of
much bigger well known (at least for me ;-)) problem.
When Clipper compiles files included by CLP file then it generates
one .obj file but in fact it compiles each of them separately and
only the final result is put into one .obj file. Neither Harbour
nor xHarbour can make sth like that. It strongly interacts with
the output method and we will have to define for all -g* output
actions new formats which will allow to use more then one symbol
table, multiple static functions with the same names, etc. and
then make necessary modifications in compiler.
It's not easy job and needs quite big number of modifications.
To avoid it I intentionally implemented .CLP file support in differ
way then in Clipper so for the example like above Harbour was
generating two separated output files: t1.{c,hrb,...} and t2.{c,hrb,...}
It was not the perfect solution but it was possible to use Clipper
.CLP files and only linking scripts had to be changed. Such behavior
still exists in xHarbour but in Harbour Ryszard change it to generate
single file - Ryszard did you know changing the above all implications?
Now the result is like adding:
    #include "t2.prg"
at the end of t1.prg and compiling only t1.prg - you will have exactly
the same behavior and exactly the same warning messages.
We may revert Ryszard modification but it will not resolve all problems
because exactly the same problem can appear in code which does not use
.CLP files but only
    DO proc

Here is the example:

    --t1.prg--
    proc main
    do t2

    --t2.prg--
    static s:="s2"
    proc t2
    ? "t2()"
    ? s
    return

Compile it with Clipper by:
    cl t1 /n/w/es2

Then try Harbour or xHarbour.
Here we should also generate more then one output file or we will have
to define new formats for .c, .hrb and other output files (see above)
which will support many symbol tables and repeated functions names
(for static functions)
I do not have time for it now - maybe somewhere in the future - now
if no one else will want to work on this problem I suggest to document
it as Clipper incompatible behavior which may change in the future.

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Thu May 17 08:07:43 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May 17 08:08:17 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200
	PrzemyslawCzerpak(druzus/at/priv.onet.pl)
References: <20070516222026.GA20413@localhost.localdomain><003b01c79851$71383370$0100a8c0@emag>
	<20070517105104.GB21426@localhost.localdomain>
Message-ID: <00e301c7987b$f924db10$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: giovedi 17 maggio 2007 12.51
Oggetto: Re: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200 
PrzemyslawCzerpak(druzus/at/priv.onet.pl)


> > Thank you! But... how do you know that I'm using a good amount of
> > #[x]translate? :-)
>
> Deduction - people usually say much more then we can find explicitly
> in their words :-)
> Is it fast enough now?

Oh, now I understood. You were talking about compiler speed. Yes, it seems 
faster now, many thanks. Now, if only Harbour offered a ZIP managements... I 
asked you some time ago what you are using instead of hbzip.lib but the 
question is still unanswered... :-)

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From druzus at priv.onet.pl  Thu May 17 08:22:21 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 17 08:22:58 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200
	PrzemyslawCzerpak(druzus/at/priv.onet.pl)
In-Reply-To: <00e301c7987b$f924db10$0100a8c0@emag>
References: <20070517105104.GB21426@localhost.localdomain>
	<00e301c7987b$f924db10$0100a8c0@emag>
Message-ID: <20070517122221.GA32644@localhost.localdomain>

On Thu, 17 May 2007, Enrico Maria Giordano wrote:
> I asked you some time ago what you are using instead of hbzip.lib but the 
> question is still unanswered... :-)

For such things like creating archive files:
    HB_POPEN() ;-)
for people who used to work with *nixes it's natural form.
If I need some compression functionality for other jobs
then I use ZLIP wrapper - I'm attaching it.

best regards,
Przemek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: hbzlib.c.gz
Type: application/x-gzip
Size: 2875 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070517/0bf35ecd/hbzlib.c.gz
From lorenzo.fiorini at gmail.com  Thu May 17 08:49:54 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 17 08:49:58 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20 UTC+0200
	PrzemyslawCzerpak(druzus/at/priv.onet.pl)
In-Reply-To: <20070517122221.GA32644@localhost.localdomain>
References: <20070517105104.GB21426@localhost.localdomain>
	<00e301c7987b$f924db10$0100a8c0@emag>
	<20070517122221.GA32644@localhost.localdomain>
Message-ID: <9257026e0705170549x597f6c72qa9f514c95c4458f2@mail.gmail.com>

On 5/17/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> For such things like creating archive files:
>     HB_POPEN() ;-)
> for people who used to work with *nixes it's natural form.
> If I need some compression functionality for other jobs
> then I use ZLIP wrapper - I'm attaching it.

I can't believe it, this is telepathy.

Yesterday night I was thinking that my apps would need a zlib wrapper.
Now I use run( 'zip ....' ) in Linux is fast and standard, but in
Windows I have to be sure to have zip.exe in the path and so on.

Many thanks again.

P.S. what about replacing contrib/hbzlib? AFAIK is nobody maintains it.

regards,
Lorenzo
From e.m.giordano at emagsoftware.it  Thu May 17 09:57:24 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May 17 09:58:03 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20
	UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
References: <20070517105104.GB21426@localhost.localdomain><00e301c7987b$f924db10$0100a8c0@emag>
	<20070517122221.GA32644@localhost.localdomain>
Message-ID: <015a01c7988b$4c277980$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: giovedi 17 maggio 2007 14.22
Oggetto: Re: [Harbour] ChangeLog 2007-05-17 00:20 
UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)


> If I need some compression functionality for other jobs
> then I use ZLIP wrapper - I'm attaching it.

Tank you, but it seems to be at a lower level if compared with hbzip.lib, or 
am I wrong?

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From dbtopas at dbtopas.lt  Thu May 17 10:27:08 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Thu May 17 10:23:48 2007
Subject: [Harbour] ChangeLog 2007-05-12 10:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070517104258.GA21426@localhost.localdomain>
References: <20070512084959.GB19092@localhost.localdomain>	<20070516212127.GA17316@localhost.localdomain>	<464C0123.5090603@dbtopas.lt>
	<20070517104258.GA21426@localhost.localdomain>
Message-ID: <464C663C.9010602@dbtopas.lt>

>>do you see any side effects or drawbacks of this implementation (except 
>>"it will not recognize properly multiline codeblocks which can appear in 
>>the code after preprocessing")?
> 
> Seems that we address all bad situations we've found so far
> and current implementation allows to use any language statements
> supported by functions.
> I know only two things we may want to change in the future:
> 1. the above PP issue - I do not know if it's necessary and anyone
>    will want to make it
> 2. add support for using codeblock local parameters and variables in
>    nested codeblock - for this we will have to change representation
>    of nested codeblocks in PCODE and intorduce some modifications
>    in HVM. But the same is for normal codeblock and Clipper also
>    not allow to use codeblock local parameters in nested codeblocks
>    so I think we can leave it as is now and add such functionality
>    in the future as new feature.

Hello,


the second drawback is compatible with Clipper codeblock parameters 
visibility, so it's not a problem.
If it is the only side effects, then I vote for leaving current 
implementation in CVS.


Best regards,
Mindaugas
From druzus at priv.onet.pl  Thu May 17 11:43:06 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 17 11:43:43 2007
Subject: [Harbour] ChangeLog 2007-05-17 00:20
	UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
In-Reply-To: <015a01c7988b$4c277980$0100a8c0@emag>
References: <20070517122221.GA32644@localhost.localdomain>
	<015a01c7988b$4c277980$0100a8c0@emag>
Message-ID: <20070517154306.GA1183@localhost.localdomain>

On Thu, 17 May 2007, Enrico Maria Giordano wrote:
> >If I need some compression functionality for other jobs
> >then I use ZLIP wrapper - I'm attaching it.
> Tank you, but it seems to be at a lower level if compared with hbzip.lib, 
> or am I wrong?

Yes it is. As I wrote I'm using it for "other jobs" f.e. compressing some
data like memo fields or compressing TCP connections streams.
If you want to create library to manage ZIP files then you can look at
minizip in ZLIB contrib directory - if you create Harbour wrappers for
functions defined in zip.h and unzip.h then you will be able to create
/extract ZIP archives.
If you will need some more advance functionality then you can look at
info-zip source code.

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Thu May 17 12:41:32 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May 17 12:42:10 2007
Subject: [Harbour] ChangeLog 2007-05-17
	00:20UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
References: <20070517122221.GA32644@localhost.localdomain><015a01c7988b$4c277980$0100a8c0@emag>
	<20070517154306.GA1183@localhost.localdomain>
Message-ID: <003401c798a2$39fc7a00$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: giovedi 17 maggio 2007 17.43
Oggetto: Re: [Harbour] ChangeLog 2007-05-17 
00:20UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)


> If you want to create library to manage ZIP files then you can look at
> minizip in ZLIB contrib directory - if you create Harbour wrappers for
> functions defined in zip.h and unzip.h then you will be able to create
> /extract ZIP archives.
> If you will need some more advance functionality then you can look at
> info-zip source code.

Thank you for the suggestions.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From fmancera at viaopen.com  Fri May 18 05:31:19 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Fri May 18 05:31:55 2007
Subject: [Harbour] Changelog 2007-05-18 07:24 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
Message-ID: <001901c7992f$4ae6c9a0$3e02a8c0@PORTATIL>

2007-05-18 07:24 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
   * contrib/adordd/adordd.prg
     * ADO_GETFIELDTYPE() Improved
     * ADO_GETFIELDSIZE() Now support MEMO Field
 
Best Regards,
 
Fernando Mancera
www.viaopen.com



From druzus at priv.onet.pl  Fri May 18 10:53:59 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 18 10:54:37 2007
Subject: [Harbour] FERROR()
Message-ID: <20070518145359.GA6430@localhost.localdomain>

Hi All,

I would like to change FERROR() behavior.
In Clipper it's documented that FERROR() is set only by
few F*() functions and tests shows that other functions
does not change FERROR() even if they execute low level
hb_fs*() functions.
Our implementation uses directly hb_fsError() what has one bad
side effect - other code has to save/restore file error code using
hb_fsError()/hb_fsSetError(). I would like to eliminate it and
add separate variable only for FERROR() which will be set by the
same as in Clipper F*() functions, sth like:
    hb_setFError( hb_fsError() );
What do you think about it? Do you see any problems?

best regards,
Przemek
From sscc at mweb.co.za  Fri May 18 11:02:31 2007
From: sscc at mweb.co.za (Alex Strickland)
Date: Fri May 18 11:03:04 2007
Subject: [Harbour] FERROR()
In-Reply-To: <20070518145359.GA6430@localhost.localdomain>
References: <20070518145359.GA6430@localhost.localdomain>
Message-ID: <464DC007.7030205@mweb.co.za>

Przemyslaw Czerpak wrote:

> I would like to change FERROR() behavior.
> What do you think about it? Do you see any problems?

I think it is a good idea.

One thing that bugs me, FCREATE in Clipper creates a shared file, and in 
Harbour an exclusive file (at least under Windows), I think we should be 
compatible. Would you look at it?

Regards
Alex

From randy at palmasdev.com  Fri May 18 11:07:40 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Fri May 18 11:07:07 2007
Subject: [Harbour] FERROR()
In-Reply-To: <464DC007.7030205@mweb.co.za>
References: <20070518145359.GA6430@localhost.localdomain>
	<464DC007.7030205@mweb.co.za>
Message-ID: <20070518150659.3B3BE1046A1@smtp.tor.pathcom.com>

If this is changed, please make sure that FCREATE will not overwrite 
and already open file - That is, if overwriting an existing file 
using FCREATE, it should test for exclusive access to that file 
before overwriting it.

At 11:02 AM 5/18/2007, you wrote:
>Przemyslaw Czerpak wrote:
>
>>I would like to change FERROR() behavior.
>>What do you think about it? Do you see any problems?
>
>I think it is a good idea.
>
>One thing that bugs me, FCREATE in Clipper creates a shared file, 
>and in Harbour an exclusive file (at least under Windows), I think 
>we should be compatible. Would you look at it?
>
>Regards
>Alex
>
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour
>

From harbour.01 at syenar.hu  Fri May 18 11:40:23 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri May 18 11:40:23 2007
Subject: [Harbour] FERROR()
In-Reply-To: <20070518145359.GA6430@localhost.localdomain>
References: <20070518145359.GA6430@localhost.localdomain>
Message-ID: <0D45668F-243E-4D13-8883-87B7A0FCC91E@syenar.hu>

Hi Przemek,

I think it's good to be more compatible in this area
(especially if this means getting rid of a few hacks
at the same time), so it is a good idea.

Brgds,
Viktor

On 2007.05.18., at 16:53, Przemyslaw Czerpak wrote:

> Hi All,
>
> I would like to change FERROR() behavior.
> In Clipper it's documented that FERROR() is set only by
> few F*() functions and tests shows that other functions
> does not change FERROR() even if they execute low level
> hb_fs*() functions.
> Our implementation uses directly hb_fsError() what has one bad
> side effect - other code has to save/restore file error code using
> hb_fsError()/hb_fsSetError(). I would like to eliminate it and
> add separate variable only for FERROR() which will be set by the
> same as in Clipper F*() functions, sth like:
>     hb_setFError( hb_fsError() );
> What do you think about it? Do you see any problems?
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Fri May 18 12:38:57 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 18 12:39:33 2007
Subject: [Harbour] FERROR()
In-Reply-To: <464DC007.7030205@mweb.co.za>
References: <20070518145359.GA6430@localhost.localdomain>
	<464DC007.7030205@mweb.co.za>
Message-ID: <20070518163857.GA9025@localhost.localdomain>

On Fri, 18 May 2007, Alex Strickland wrote:
> One thing that bugs me, FCREATE in Clipper creates a shared file, and in 
> Harbour an exclusive file (at least under Windows), I think we should be 
> compatible. Would you look at it?

FCREATE() in Clipper does not create file in shared mode.
It's a special compatibility mode for old DOS versions which cannot be
emulated well on most of other systems. AFAIR most of DOS/Windows network
was not emulating COMAPT flag too so even pure Clipper programs were not
creating files in shared mode. In summary: any code which needs DOS COMPAT
open/create flag is not portable so I do not think we should try emulate
low level DOS behavior inside Harbour core code.
Below is a small test program which illustrates the problem.

best regards,
Przemek


#include "fileio.ch"
proc main()
local h, h2
h:=fcreate("_tst")
? "create", h, ferror()
h2:=fopen("_tst",FO_READ+FO_SHARED)
? "open in shared mode", h2, ferror()
h2:=fopen("_tst",FO_READ+FO_COMPAT)
? "open in compat mode", h2, ferror()
return
From druzus at priv.onet.pl  Fri May 18 16:44:34 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 18 16:45:10 2007
Subject: [Harbour] ChangeLog 2007-05-18 22:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070518204434.GA2293@localhost.localdomain>

2007-05-18 22:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbapierr.h
  * harbour/source/rtl/errorapi.c
    * changed 'char hb_errFuncName' to 'const char hb_errFuncName'

  * harbour/source/compiler/ppcomp.c
    * added note about Harbour exception in header

  * harbour/include/hbapifs.h
  * harbour/source/rtl/fserror.c
    + added hb_getFError(), hb_setFError()

  * harbour/source/rtl/philes.c
  * harbour/source/rtl/philes53.c
    * use hb_getFError()/hb_setFError() in F*() functions

  * harbour/source/rtl/disksphb.c
  * harbour/source/rtl/fssize.c
    * fixed setting hb_fsError()

  * harbour/source/rtl/console.c
  * harbour/source/rtl/dirdrive.c
  * harbour/source/rtl/diskspac.c
  * harbour/source/rtl/hbgtcore.c
  * harbour/source/rtl/philesx.c
  * harbour/source/rtl/set.c
  * harbour/source/rtl/gtcgi/gtcgi.c
  * harbour/source/rtl/gtpca/gtpca.c
  * harbour/source/rtl/gtstd/gtstd.c
    * removed code to save/restore hb_fsError()

best regards,
Przemek
From randy at palmasdev.com  Fri May 18 16:54:21 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Fri May 18 16:53:43 2007
Subject: [Harbour] Status of Beta 3
In-Reply-To: <20070518204434.GA2293@localhost.localdomain>
References: <20070518204434.GA2293@localhost.localdomain>
Message-ID: <20070518205339.DBA3B10337F@smtp.tor.pathcom.com>

Hi all,

Is there a plan for the Beta 3 release which will include all bug 
fixes since the Beta 2 release?

Regards,
Randy.

From druzus at priv.onet.pl  Fri May 18 17:28:10 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 18 17:28:45 2007
Subject: [Harbour] Status of Beta 3
In-Reply-To: <20070518205339.DBA3B10337F@smtp.tor.pathcom.com>
References: <20070518204434.GA2293@localhost.localdomain>
	<20070518205339.DBA3B10337F@smtp.tor.pathcom.com>
Message-ID: <20070518212810.GA2772@localhost.localdomain>

On Fri, 18 May 2007, Randy Portnoff wrote:
> Is there a plan for the Beta 3 release which will include all bug 
> fixes since the Beta 2 release?

I think we addressed all reported so far problems.
I'll add new memo line functions ASAP and I'm ready for new
release.
Victor do you plan to add some of fixes you made recently in DEVEL
branch also to BETA branch?

best regards,
Przemek
From druzus at priv.onet.pl  Fri May 18 18:45:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 18 18:46:11 2007
Subject: [Harbour] ChangeLog BETA 2007-05-19 00:45 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
Message-ID: <20070518224535.GA32075@localhost.localdomain>

2007-05-19 00:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
  * harbour/include/hbapierr.h
  * harbour/include/hbapifs.h
  * harbour/include/hbclass.ch
  * harbour/include/hbcomp.h
  * harbour/source/compiler/harbour.c
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/compiler/ppcomp.c
  * harbour/source/pp/ppcore.c
  * harbour/source/rtl/Makefile
  * harbour/source/rtl/errorapi.c
  * harbour/source/rtl/hbffind.c
  * harbour/source/vm/hvm.c
  - harbour/source/rtl/memoline.c
  - harbour/source/rtl/mlcount.c
  - harbour/source/rtl/mlctopos.c
  - harbour/source/rtl/mlpos.c
  - harbour/source/rtl/mpostolc.c
  + harbour/source/rtl/mlcfunc.c
    * synced with some important fixes and cleanups in devel branch, f.e.
      - new memo line functions
      - API functions declaration and casting
      - FILE() fixes in *nixes
      - statics in /b (debugger) compilation
      - MEMO flag clearning

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Sat May 19 04:02:56 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 19 04:02:59 2007
Subject: [Harbour] Is there a PP feature that allow to smartly concatenate
	strings?
Message-ID: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>

I'm writing cgi/ajax apps that means many lines like:

      cContent += [<td class="info_btn" onclick="javascript:show_menu(
'] + _ID_ + [', event, '] + cVar + [', 'CODE' );">]

for strings xhtml wants " javascript wants ' and I need to cancatenate
vars and #defines so I need to find the correct mix of ""''[] every
time.

I've seen that #pragma __cstream does it but it needs a LF before and
an ENDTEXT at end which are "bloated" for simple lines like cContent
+= '</td>'

Any suggestion?

regards,
Lorenzo
From druzus at priv.onet.pl  Sat May 19 04:24:51 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 19 04:25:27 2007
Subject: [Harbour] Is there a PP feature that allow to smartly concatenate
	strings?
In-Reply-To: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>
References: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>
Message-ID: <20070519082451.GA21098@localhost.localdomain>

On Sat, 19 May 2007, Lorenzo Fiorini wrote:
> I'm writing cgi/ajax apps that means many lines like:
>      cContent += [<td class="info_btn" onclick="javascript:show_menu(
> '] + _ID_ + [', event, '] + cVar + [', 'CODE' );">]
> for strings xhtml wants " javascript wants ' and I need to cancatenate
> vars and #defines so I need to find the correct mix of ""''[] every
> time.

Use extended strings, you will not have to worry about correct mix
of ""''[] characters - just simply put \ before all internal ", f.e.:

   cContent += e"<td class=\"info_btn\" onclick=\"javascript:show_menu('" + ;
               _ID_ + e"', event, '" + cVar + e"', 'CODE' );\">"

> I've seen that #pragma __cstream does it but it needs a LF before and
> an ENDTEXT at end which are "bloated" for simple lines like cContent
> += '</td>'

text streaming needs some special marker to stop these mode. In out
PP it's 'ENDTEXT' or '#pragma __endtext' at the beginning of new line
so when used internally they will not interrupt text stream mode.
Do you want to add some other marker which can be used in the middle
of line?

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Sat May 19 04:46:52 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 19 04:46:55 2007
Subject: [Harbour] Is there a PP feature that allow to smartly concatenate
	strings?
In-Reply-To: <20070519082451.GA21098@localhost.localdomain>
References: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>
	<20070519082451.GA21098@localhost.localdomain>
Message-ID: <9257026e0705190146q30f1562i2623b760b7fa985f@mail.gmail.com>

On 5/19/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Use extended strings, you will not have to worry about correct mix
> of ""''[] characters - just simply put \ before all internal ", f.e.:
>
>    cContent += e"<td class=\"info_btn\" onclick=\"javascript:show_menu('" + ;
>                _ID_ + e"', event, '" + cVar + e"', 'CODE' );\">"

You're right it seems the better way.

It will also help me to port PHP code.

Just to make things perfect, is there any way to pp .= into += and
define extended strings as the default?

This will really help me to copy and paste from PHP big chunks of code.

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Sat May 19 04:53:16 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 19 04:53:20 2007
Subject: [Harbour] Is there a PP feature that allow to smartly concatenate
	strings?
In-Reply-To: <9257026e0705190146q30f1562i2623b760b7fa985f@mail.gmail.com>
References: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>
	<20070519082451.GA21098@localhost.localdomain>
	<9257026e0705190146q30f1562i2623b760b7fa985f@mail.gmail.com>
Message-ID: <9257026e0705190153p50a7a44fl175b5c73c793373b@mail.gmail.com>

On 5/19/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

> Just to make things perfect, is there any way to pp .= into += and
> define extended strings as the default?

Sorry I was not clear enough.

I've tried to do:

#xtranslate .= => +=e
   cContent .= "<table align=\"center\">"

but PP translate it into:

   cContent += e "<table align=\"center\">"

which gives:

Error E0030  Syntax error: "syntax error at '<table align=\'"
1 error

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Sat May 19 05:05:00 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 19 05:05:02 2007
Subject: [Harbour] Is there a PP feature that allow to smartly concatenate
	strings?
In-Reply-To: <9257026e0705190153p50a7a44fl175b5c73c793373b@mail.gmail.com>
References: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>
	<20070519082451.GA21098@localhost.localdomain>
	<9257026e0705190146q30f1562i2623b760b7fa985f@mail.gmail.com>
	<9257026e0705190153p50a7a44fl175b5c73c793373b@mail.gmail.com>
Message-ID: <9257026e0705190205l6618e577tcd17a5ab5d7d30e2@mail.gmail.com>

On 5/19/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

> Sorry I was not clear enough.

Here is a test:

#xtranslate .= => += e

procedure main()

   local cContent := ""

   cContent += e"<table align=\"center\">"

   cContent .= "<table align=\"center\">"

   ? cContent

return

Clearly replace .= into += e using vim is not a problem but for me it
would be nice to have .= as concatenate extended string operator or
have extended strings as default using #pragma or sth like that.

Not a big issue however don't waste time on it.

regards,
Lorenzo
From harbour.01 at syenar.hu  Sat May 19 05:14:05 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat May 19 05:14:15 2007
Subject: [Harbour] Status of Beta 3
In-Reply-To: <20070518212810.GA2772@localhost.localdomain>
References: <20070518204434.GA2293@localhost.localdomain>
	<20070518205339.DBA3B10337F@smtp.tor.pathcom.com>
	<20070518212810.GA2772@localhost.localdomain>
Message-ID: <11BE2454-4C8C-48BE-A7E8-90E8B9834DDB@syenar.hu>

> Victor do you plan to add some of fixes you made recently in DEVEL
> branch also to BETA branch?

All my changes can go to BETA3.

Isn't it so, that the current DEVEL branch will be tagged as BETA3?

If not, what should I do? (To tell the truth I don't really get the
branching concept)

Brgds,
Viktor



From druzus at priv.onet.pl  Sat May 19 05:14:51 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 19 05:15:27 2007
Subject: [Harbour] Is there a PP feature that allow to smartly concatenate
	strings?
In-Reply-To: <9257026e0705190153p50a7a44fl175b5c73c793373b@mail.gmail.com>
References: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>
	<20070519082451.GA21098@localhost.localdomain>
	<9257026e0705190146q30f1562i2623b760b7fa985f@mail.gmail.com>
	<9257026e0705190153p50a7a44fl175b5c73c793373b@mail.gmail.com>
Message-ID: <20070519091451.GA22457@localhost.localdomain>

On Sat, 19 May 2007, Lorenzo Fiorini wrote:
> >Just to make things perfect, is there any way to pp .= into += and
> >define extended strings as the default?
> Sorry I was not clear enough.
> 
> I've tried to do:
> #xtranslate .= => +=e
>   cContent .= "<table align=\"center\">"
> but PP translate it into:
>   cContent += e "<table align=\"center\">"

This will not work as you want because locating string tokens is the first
operation done by PP before any translations.
But I can think about some new #pragma, f.e.:
   #pragma escapedstrings = on
   #xtranslate .= => +=
   [...]
   cContent := "<table align=\"center\">"
   cContent .= "<table align=\"center\">"
   [...]
   #pragma escapedstrings = off

It will be usable also for people who want to preprocess C code.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Sat May 19 05:24:22 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 19 05:24:25 2007
Subject: [Harbour] Is there a PP feature that allow to smartly concatenate
	strings?
In-Reply-To: <20070519091451.GA22457@localhost.localdomain>
References: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>
	<20070519082451.GA21098@localhost.localdomain>
	<9257026e0705190146q30f1562i2623b760b7fa985f@mail.gmail.com>
	<9257026e0705190153p50a7a44fl175b5c73c793373b@mail.gmail.com>
	<20070519091451.GA22457@localhost.localdomain>
Message-ID: <9257026e0705190224i4c0e1085j4905844fe11da278@mail.gmail.com>

On 5/19/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> But I can think about some new #pragma, f.e.:
>    #pragma escapedstrings = on
>    #xtranslate .= => +=
>    [...]
>    cContent := "<table align=\"center\">"
>    cContent .= "<table align=\"center\">"
>    [...]
>    #pragma escapedstrings = off
>
> It will be usable also for people who want to preprocess C code.

Yes, also for PHP and Python developers is it "normal" to include
\n\r\t in strings.

Many thanks again.

best regards,
Lorenzo
From druzus at priv.onet.pl  Sat May 19 05:24:45 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 19 05:25:21 2007
Subject: [Harbour] Status of Beta 3
In-Reply-To: <11BE2454-4C8C-48BE-A7E8-90E8B9834DDB@syenar.hu>
References: <20070518204434.GA2293@localhost.localdomain>
	<20070518205339.DBA3B10337F@smtp.tor.pathcom.com>
	<20070518212810.GA2772@localhost.localdomain>
	<11BE2454-4C8C-48BE-A7E8-90E8B9834DDB@syenar.hu>
Message-ID: <20070519092445.GB22457@localhost.localdomain>

On Sat, 19 May 2007, Szak?ts Viktor wrote:
> >Victor do you plan to add some of fixes you made recently in DEVEL
> >branch also to BETA branch?
> All my changes can go to BETA3.
> Isn't it so, that the current DEVEL branch will be tagged as BETA3?

No. Current DEVEL branch has a lot of extensions which should not be
in BETA branch - I'm adding to beta branch only fixes and modifications
which change API calls to keep binary compatibility between both branches
for 3-rd party developers.

> If not, what should I do? (To tell the truth I don't really get the
> branching concept)

Just make new copy of CVS repository with BETA branch.
    cvs -z3 co -r beta1 ...

and then use it as you use DEVEL branch now. Please remember that
when you add -A switch to checkout or update command you will clear
all branch tag and you automatically switch to DEVEL so please not
use this switch.

best regards,
Przemek
From sscc at mweb.co.za  Sat May 19 07:42:54 2007
From: sscc at mweb.co.za (Alex Strickland)
Date: Sat May 19 07:43:01 2007
Subject: [Harbour] FERROR()
In-Reply-To: <20070518163857.GA9025@localhost.localdomain>
References: <20070518145359.GA6430@localhost.localdomain>	<464DC007.7030205@mweb.co.za>
	<20070518163857.GA9025@localhost.localdomain>
Message-ID: <464EE2BE.8060201@mweb.co.za>

Przemyslaw Czerpak wrote:

> FCREATE() in Clipper does not create file in shared mode.
> It's a special compatibility mode for old DOS versions which cannot be
> emulated well on most of other systems. AFAIR most of DOS/Windows network
> was not emulating COMAPT flag too so even pure Clipper programs were not
> creating files in shared mode. In summary: any code which needs DOS COMPAT
> open/create flag is not portable so I do not think we should try emulate
> low level DOS behavior inside Harbour core code.
> Below is a small test program which illustrates the problem.

I don't think I completely understand your reply, but your code example 
perfectly illustrates my question :)

This is Clipper under XP:

C:\alex\ecr6>test //info
Clipper (R) 5.3b Intl. (Rev. 338) US - ASCII Collation
DS=2B20:0000  DS avail=48KB  OS avail=401KB  EMM avail=0KB

create          7          0
open in shared mode          8          0
open in compat mode          9          0(Fixed heap=6KB/2)

and xHarbour under XP:

C:\alex\ecr6>test //info
Harbour Terminal: Win32 buffered console
create       1992          0 (SimpLex)
open in shared mode         -1          5 Pack 2
open in compat mode         -1          5
C:\alex\ecr6>72KB  OS avail=2080560KB  EMM avail=0KB  MemStat:Off 
MT:Off  Opt:0

The //info output is interleaved peculiarly, but I did not want to 
change your app in any way. Obviously this is not on DOS, but surely 
Clipper and xHarbour should behave similarly?

Or perhaps to ask the question differently, perhaps if we could specify 
the shared mode when calling FCREATE()?

Best regards
Alex


From druzus at priv.onet.pl  Sat May 19 08:05:22 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 19 08:05:58 2007
Subject: [Harbour] FERROR()
In-Reply-To: <464EE2BE.8060201@mweb.co.za>
References: <20070518145359.GA6430@localhost.localdomain>
	<464DC007.7030205@mweb.co.za>
	<20070518163857.GA9025@localhost.localdomain>
	<464EE2BE.8060201@mweb.co.za>
Message-ID: <20070519120522.GA22925@localhost.localdomain>

On Sat, 19 May 2007, Alex Strickland wrote:
> I don't think I completely understand your reply, but your code example 
> perfectly illustrates my question :)
> This is Clipper under XP:
> C:\alex\ecr6>test //info
> Clipper (R) 5.3b Intl. (Rev. 338) US - ASCII Collation
> DS=2B20:0000  DS avail=48KB  OS avail=401KB  EMM avail=0KB
> 
> create          7          0
> open in shared mode          8          0
> open in compat mode          9          0(Fixed heap=6KB/2)

And here are results from the same code execued in pure DOS with SHARE.EXE:

    create          6          0
    open in shared mode         -1          5
    open in compat mode          7          0

as you can see it's platform dependent behavior not sth hardcoded
inside Clipper internals.
If you will try to execute the same Clipper program on different file
servers then you may have different results depending on used network.

> and xHarbour under XP:
> C:\alex\ecr6>test //info
> Harbour Terminal: Win32 buffered console
> create       1992          0 (SimpLex)
> open in shared mode         -1          5 Pack 2
> open in compat mode         -1          5
> C:\alex\ecr6>72KB  OS avail=2080560KB  EMM avail=0KB  MemStat:Off 
> MT:Off  Opt:0

Just like Clipper programs in some networks.

> The //info output is interleaved peculiarly, but I did not want to 
> change your app in any way. Obviously this is not on DOS, but surely 
> Clipper and xHarbour should behave similarly?

Similary to what?
Using the same Clipper code you can have:

1. open in shared mode         -1          5
   open in compat mode         -1          5

2. open in shared mode         -1          5
   open in compat mode          7          5

3. open in shared mode          7          5
   open in compat mode          8          5

results depend on runtime environment. So which operating system 
or file server behavior you want to emulate inside Harbour core code :-)

I'm not a Windows/DOS user so I cannot help in the best choice.
If most of Harbour users will want to set SHARED flag by default then
we can do that, for me it will be even better - more similar behavior
to POSIX systems.

> Or perhaps to ask the question differently, perhaps if we could specify 
> the shared mode when calling FCREATE()?

    HB_FCREATE( <cFile>, [<nAttr>], [<nMode>] ) -> <hFile>

But please remember that it also depends on OS and API. In some systems
it will be necessary to close the file and reopen it in shared mode what
will introduced race condition in some operations.
POSIX systems do not have EXCLUSIVE mode at all so you cannot set DENY
READ/WRITE flags in open/create operations and everything is open in
shared mode.

best regards,
Przemek
From druzus at priv.onet.pl  Sat May 19 09:41:05 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 19 09:41:41 2007
Subject: [Harbour] ChangeLog 2007-05-19 15:40 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070519134105.GA23219@localhost.localdomain>

2007-05-19 15:40 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbclass.ch
    * formatting

  * harbour/include/hbpp.h
  * harbour/source/pp/ppcore.c
    + added support for:
         #pragma escapedstrings = on
         cStr := "some value with internal \" character"
         #pragma escapedstrings = off
    + added support for multiline strings in escaped strings

  * harbour/source/compiler/gencobj.c
    * minor simplification

  * harbour/source/rtl/hbffind.c
    * always set hb_fsError()

  * harbour/source/rtl/mlcfunc.c
    ! fixed minor typo


if you think that differ name then escapedstrings will be better then
please send your propositions.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Sat May 19 10:45:37 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 19 10:45:40 2007
Subject: [Harbour] ChangeLog 2007-05-19 15:40 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070519134105.GA23219@localhost.localdomain>
References: <20070519134105.GA23219@localhost.localdomain>
Message-ID: <9257026e0705190745o149a475dye33f40cbdc792b64@mail.gmail.com>

On 5/19/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> 2007-05-19 15:40 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>     + added support for:
>          #pragma escapedstrings = on
>          cStr := "some value with internal \" character"
>          #pragma escapedstrings = off
>     + added support for multiline strings in escaped strings

Many thanks, it is PERFECT !!!!!!.

best regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Sat May 19 11:15:48 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat May 19 11:15:51 2007
Subject: [Harbour] Is there a PP feature that allow to smartly concatenate
	strings?
In-Reply-To: <20070519082451.GA21098@localhost.localdomain>
References: <9257026e0705190102h32df2d80xd8fffb896dd709eb@mail.gmail.com>
	<20070519082451.GA21098@localhost.localdomain>
Message-ID: <9257026e0705190815v142e5df1qf1000b86d9f1ad31@mail.gmail.com>

On 5/19/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> text streaming needs some special marker to stop these mode. In out
> PP it's 'ENDTEXT' or '#pragma __endtext' at the beginning of new line
> so when used internally they will not interrupt text stream mode.

__text and __cstream are very useful in scripts where there is a lot
of xhtml code
( see the example below ). A command like:
#xcommand TEXTSTREAM INTO <v> => #pragma __cstream|<v>+=%s
allows to write "clean" escaped xhtml code without composing lines.
But there are always some vars that need to be evaluated at runtime.
The only thing I can think about is to use strtran to replace markers
like I would in a jsp page.

Any smarter idea?

Any way to remove lines trailing spaces in the __cstream result string?

regards,
Lorenzo

procedure outhtml( cApp, cDiv )

   local cContent := ""

   DEFAULT cApp TO "testapp"
   DEFAULT cDiv TO "main"

   TEXTSTREAM INTO cContent
      <table align=\"center\">
         <tr class=\"print_table_row\">
            <td class=\"print_table_cell\"><input type=\"checkbox\"
id=\"cPdf\" name=\"cPdf\" />PDF</td>
            <td width=\"35%\" align=\"center\" rowspan=\"4\">
            <input class=\"btn\" type=\"button\" name=\"prnbtn\"
value=\"Print\" onclick=\"javascript:down_file( '<%cApp%>','<%cDiv%>'
);" />
            </td>
         </tr>
         <tr class=\"print_table_row\">
            <td class=\"print_table_cell\"><input type=\"checkbox\"
id=\"cXls\" name=\"cXls\" />XLS</td>
         </tr>
         <tr class=\"print_table_row\">
            <td class=\"print_table_cell\"><input type=\"checkbox\"
id=\"cRtf\" name=\"cRtf\" />RTF</td>
         </tr>
         <tr class=\"print_table_row\">
            <td class=\"print_table_cell\"><input type=\"checkbox\"
id=\"cCsv\" name=\"cCsv\" />CSV</td>
         </tr>
         <tr />
      </table>
   ENDTEXT

   cContent := strtran( cContent, "<%cApp%>", cApp )
   cContent := strtran( cContent, "<%cDiv%>", cDiv )

   outstd( cContent )

   return
From teo at windtelsoft.com  Sat May 19 19:22:49 2007
From: teo at windtelsoft.com (Teo Fonrouge)
Date: Sat May 19 19:22:55 2007
Subject: [Harbour] Small issues in compile time string parsing
Message-ID: <200705191822.50066.teo@windtelsoft.com>

Hello,

The following sample shows two small issues with last CVS (2007-05-19 15:40 
UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)):

1. The 'E' string operand to extended strings only works with lowercase 
operand ( E"Hello"  -> fails,   e"Hello"  -> is ok )

2. The [] string delimiters not longer works.


best regards

Teo Fonrouge

<prg>
PROCEDURE Main

  CLS

  ? E"Hello\n"

  ? AnyFunc( "Test" )

  WAIT

RETURN

FUNCTION AnyFunc( cVal )
RETURN ["] + cVal + ["]
</prg>
From sscc at mweb.co.za  Sat May 19 20:57:41 2007
From: sscc at mweb.co.za (Alex Strickland)
Date: Sat May 19 20:57:43 2007
Subject: [Harbour] FERROR()
In-Reply-To: <20070519120522.GA22925@localhost.localdomain>
References: <20070518145359.GA6430@localhost.localdomain>	<464DC007.7030205@mweb.co.za>	<20070518163857.GA9025@localhost.localdomain>	<464EE2BE.8060201@mweb.co.za>
	<20070519120522.GA22925@localhost.localdomain>
Message-ID: <464F9D05.30907@mweb.co.za>

Przemyslaw Czerpak wrote:

> And here are results from the same code execued in pure DOS with SHARE.EXE:
> 
>     create          6          0
>     open in shared mode         -1          5
>     open in compat mode          7          0

Yes, I see.

> I'm not a Windows/DOS user so I cannot help in the best choice.
> If most of Harbour users will want to set SHARED flag by default then
> we can do that, for me it will be even better - more similar behavior
> to POSIX systems.

To me the FO_COMPAT sharing flag seems similar in intent to FO_SHARED.

       convert_open_flags( TRUE, uiAttr, FO_EXCLUSIVE, &dwMode, 
&dwShare, &dwCreat, &dwAttr );

Certainly, a "choice" is being made in the line above from hb_fsCreate, 
I think FO_EXCLUSIVE is less correct than FO_SHARED from the point of 
view of compatability.

>     HB_FCREATE( <cFile>, [<nAttr>], [<nMode>] ) -> <hFile>

Ahh.

> But please remember that it also depends on OS and API. In some systems
> it will be necessary to close the file and reopen it in shared mode what
> will introduced race condition in some operations.

I guess it would be pragmatic to have these systems remain with 
FO_EXCLUSIVE.

Thank you, you have supplied a clear explanation of the current 
behaviour and an alternative solution if no one agrees with me.

Best regards
Alex
From harbour.01 at syenar.hu  Sun May 20 07:31:19 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sun May 20 07:33:30 2007
Subject: [Harbour] CHANGELOG: 2007-05-20 13:29 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c79ad2$Blat.v2.6.1$62a5be6c$1d0a4496ce@127.0.0.1>

2007-05-20 13:29 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/hbffind.c
     ! Added HB_EXPORT for hb_fsFind*() functions.
       (missed from prev commit)

From sscc at mweb.co.za  Sun May 20 08:02:50 2007
From: sscc at mweb.co.za (Alex Strickland)
Date: Sun May 20 08:02:55 2007
Subject: [Harbour] FERROR()
In-Reply-To: <464F9D05.30907@mweb.co.za>
References: <20070518145359.GA6430@localhost.localdomain>	<464DC007.7030205@mweb.co.za>	<20070518163857.GA9025@localhost.localdomain>	<464EE2BE.8060201@mweb.co.za>	<20070519120522.GA22925@localhost.localdomain>
	<464F9D05.30907@mweb.co.za>
Message-ID: <465038EA.1000407@mweb.co.za>

Alex Strickland wrote:
> Przemyslaw Czerpak wrote:
>> But please remember that it also depends on OS and API. In some systems
>> it will be necessary to close the file and reopen it in shared mode what
>> will introduced race condition in some operations.
> 
> I guess it would be pragmatic to have these systems remain with 
> FO_EXCLUSIVE.

Sorry, this sounds like I am ignoring your wise words about OS 
independence, but to be honest, the code is full of HB_OS_this and 
HB_OS_that and WIN32_IO etc, so it does not look like we can 100% 
achieve that goal all the time anyway.

Regards
Alex

From dmacias at mail.udg.mx  Mon May 21 06:07:23 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Mon May 21 06:07:26 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <46516F5B.5080700@mail.udg.mx>

Current Harbour devel branch build under OS/2 (gcc 3.3.5):

---------------------------------------------------------
../../bmdbfcdx1.c: In function `HB_FUN_BM_DBSEEKWILD':
../../bmdbfcdx1.c:6855: warning: signed and unsigned type in conditional
expression
---------------------------------------------------------


David Macias





From miguelangel at marchuet.net  Mon May 21 07:02:02 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Mon May 21 07:01:16 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <46516F5B.5080700@mail.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<46516F5B.5080700@mail.udg.mx>
Message-ID: <46517C2A.50203@marchuet.net>

David Arturo Macias Corona escribi?:
> Current Harbour devel branch build under OS/2 (gcc 3.3.5):
> 
> ---------------------------------------------------------
> ../../bmdbfcdx1.c: In function `HB_FUN_BM_DBSEEKWILD':
> ../../bmdbfcdx1.c:6855: warning: signed and unsigned type in conditional
> expression
> ---------------------------------------------------------
> 
> 
> David Macias
> 
> 
> 
> 
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

warning fixed, I upload it in a few minutes.
From druzus at priv.onet.pl  Mon May 21 07:06:56 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 21 07:07:32 2007
Subject: [Harbour] Small issues in compile time string parsing
In-Reply-To: <200705191822.50066.teo@windtelsoft.com>
References: <200705191822.50066.teo@windtelsoft.com>
Message-ID: <20070521110656.GA10380@localhost.localdomain>

On Sat, 19 May 2007, Teo Fonrouge wrote:
> Hello,
> The following sample shows two small issues with last CVS (2007-05-19 15:40 
> UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)):
> 1. The 'E' string operand to extended strings only works with lowercase 
> operand ( E"Hello"  -> fails,   e"Hello"  -> is ok )

Thanks for the info - typo in last modification, fixed.

> 2. The [] string delimiters not longer works.

These is not true. They are working though with recent modifications
I exploited one old problem.
In Clipper quoting string by '[' ']' is buggy and causes that valid
cod cannot be compiled, f.e.:

    FUNC F( cVal )
    LOCAL h:={1.234}
    RETURN h[at(']',cVal)+1]

You can find more examples I sent few months ago to these list which
illustrates the problem. Unfortunately fixing Clipper bug strongly
interacts with code which uses strings inside [] just after some
keywords like IF, RETURN, CASE, WHILE, etc. and your example shows
the problem in such case. I'll add new hack as workaround for it and
probably it will make 99.9% users happy but it will be still possible
to create code which will not work. Just simply we cannot be 100% Clipper
compatible without replicating Clipper bugs here.

best regards,
Przemek
From miguelangel at marchuet.net  Mon May 21 07:12:29 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Mon May 21 07:11:42 2007
Subject: [Harbour] 2007-05-21 13:11 UTC+0100 Miguel Angel Marchuet
	(miguelangel/at/marchuet.net)
Message-ID: <46517E9D.9080703@marchuet.net>

2007-05-21 13:11 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * contrib/bmdbfcdx/bmdbfcdx1.c
    * minor warning fix on os/2 compile.

Best regards,
Miguel Angel Marchuet
From druzus at priv.onet.pl  Mon May 21 07:21:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 21 07:22:17 2007
Subject: [Harbour] ChangeLog 2007-05-21 13:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070521112142.GA24632@localhost.localdomain>

2007-05-21 13:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/pp/ppcore.c
    ! fixed E"..."
    ! added new hack for strings inside []

best regards,
Przemek
From dmacias at mail.udg.mx  Mon May 21 08:03:51 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Mon May 21 08:03:54 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <46518AA7.1090100@mail.udg.mx>

Miguel Angel Marchuet wrote:

 >warning fixed, I upload it in a few minutes.

Re-build with current code show 0 errors/warnings now

David Macias






From teo at windtelsoft.com  Mon May 21 08:43:11 2007
From: teo at windtelsoft.com (Teo Fonrouge)
Date: Mon May 21 08:43:22 2007
Subject: [Harbour] Small issues in compile time string parsing
In-Reply-To: <20070521110656.GA10380@localhost.localdomain>
References: <200705191822.50066.teo@windtelsoft.com>
	<20070521110656.GA10380@localhost.localdomain>
Message-ID: <200705210743.12087.teo@windtelsoft.com>

On Monday 21 May 2007 06:06:56 Przemyslaw Czerpak wrote:
> On Sat, 19 May 2007, Teo Fonrouge wrote:
> > Hello,
> > The following sample shows two small issues with last CVS (2007-05-19
> > 15:40 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)):
> > 1. The 'E' string operand to extended strings only works with lowercase
> > operand ( E"Hello"  -> fails,   e"Hello"  -> is ok )
>
> Thanks for the info - typo in last modification, fixed.
>
> > 2. The [] string delimiters not longer works.
>
> These is not true. They are working though with recent modifications

Sorry, I had to be more specific and avoid generalizing:
2. The [] string delimiters not longer works in the sample. 

It worked just fine with previous Harbour versions. (No Clipper around here 
from a very long time ago).

> I exploited one old problem.
> In Clipper quoting string by '[' ']' is buggy and causes that valid
> cod cannot be compiled, f.e.:
>
>     FUNC F( cVal )
>     LOCAL h:={1.234}
>     RETURN h[at(']',cVal)+1]
>
> You can find more examples I sent few months ago to these list which
> illustrates the problem. Unfortunately fixing Clipper bug strongly
> interacts with code which uses strings inside [] just after some
> keywords like IF, RETURN, CASE, WHILE, etc. and your example shows
> the problem in such case. I'll add new hack as workaround for it and
> probably it will make 99.9% users happy but it will be still possible
> to create code which will not work. Just simply we cannot be 100% Clipper
> compatible without replicating Clipper bugs here.
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

Thank you.


best regards

Teo

From lorenzo.fiorini at gmail.com  Mon May 21 08:59:22 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May 21 08:59:28 2007
Subject: [Harbour] Warnings without -fno-strict-aliasing under gcc 4.1.2
Message-ID: <9257026e0705210559k14b5939ehf95c486f5c511c54@mail.gmail.com>

Is it correct that I use -fno-strict-aliasing in the C_USR?
Without it I get the warnings below.

regards,
Lorenzo

../../genc.c: In function 'hb_compGenCReadable':
../../genc.c:2530: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../gencc.c: In function 'hb_compGenCRealCode':
../../gencc.c:2106: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../gencli.c: In function 'hb_compGenCReadable':
../../gencli.c:1835: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../hbfix.c: In function 'hb_compFixFuncPCode':
../../hbfix.c:411: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../hbdead.c: In function 'hb_compCodeTraceMarkDead':
../../hbdead.c:560: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../hblbl.c: In function 'hb_compGenLabelTable':
../../hblbl.c:383: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../hbopt.c: In function 'hb_compOptimizePCode':
../../hbopt.c:758: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../hbstripl.c: In function 'hb_compStripFuncLines':
../../hbstripl.c:266: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../dbgentry.c: In function 'hb_dbgAddBreak':
../../dbgentry.c:598: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../dbgentry.c: In function 'hb_dbgAddModule':
../../dbgentry.c:647: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../dbgentry.c: In function 'hb_dbgAddStack':
../../dbgentry.c:667: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../dbgentry.c: In function 'hb_dbgAddWatch':
../../dbgentry.c:841: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../dbgentry.c:848: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../dbgentry.c: In function 'hb_dbgEvalMakeBlock':
../../dbgentry.c:1114: warning: dereferencing type-punned pointer will
break strict-aliasing rules
../../dbgentry.c: In function 'hb_dbgSetWatch':
../../dbgentry.c:1588: warning: dereferencing type-punned pointer will
break strict-aliasing rules
From druzus at priv.onet.pl  Mon May 21 09:57:13 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 21 09:57:49 2007
Subject: [Harbour] Warnings without -fno-strict-aliasing under gcc 4.1.2
In-Reply-To: <9257026e0705210559k14b5939ehf95c486f5c511c54@mail.gmail.com>
References: <9257026e0705210559k14b5939ehf95c486f5c511c54@mail.gmail.com>
Message-ID: <20070521135713.GA22154@localhost.localdomain>

On Mon, 21 May 2007, Lorenzo Fiorini wrote:
> Is it correct that I use -fno-strict-aliasing in the C_USR?

No, it disables optimization which can give noticeable speed
improvement in some cases.

> Without it I get the warnings below.

The warnings from dbgentry.c can be easy pacified and I'll do that ASAP.
The rest is not dangerous in the context where dereferencing is used so
you can safely ignore warning messages.
I'll check if I can easy create some work around to make new GCC silent.
In some cases it's not easy.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Mon May 21 10:08:38 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May 21 10:08:41 2007
Subject: [Harbour] Warnings without -fno-strict-aliasing under gcc 4.1.2
In-Reply-To: <20070521135713.GA22154@localhost.localdomain>
References: <9257026e0705210559k14b5939ehf95c486f5c511c54@mail.gmail.com>
	<20070521135713.GA22154@localhost.localdomain>
Message-ID: <9257026e0705210708se3a2d4rb3a06016c123c909@mail.gmail.com>

On 5/21/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> I'll check if I can easy create some work around to make new GCC silent.
> In some cases it's not easy.

Not a big problem, many sources give warnings under gcc 4.1.x.

best regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Mon May 21 12:43:47 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May 21 12:43:50 2007
Subject: [Harbour] What about substr( cStr, x, -y ) = substr( cStr, x,
	len( x ) - y ) or "abcedfg"[ 1, -1]?
Message-ID: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>

It is often useful to cut last char, for example when you create a
list adding values and you need to remove last comma.

PHP has substr( cStr, x, -y ) and python has "abcdef"[x,-y]

harbour has "abcdef"[x] but not abcdef[x,-y] and it has substr(
"abcedf", -x ) but not substr( "abcdef", x, -y)

Your opinion?

regards,
Lorenzo
From harbour.01 at syenar.hu  Mon May 21 12:55:36 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon May 21 12:55:41 2007
Subject: [Harbour] What about substr( cStr, x, -y ) = substr( cStr, x,
	len( x ) - y ) or "abcedfg"[ 1, -1]?
In-Reply-To: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>
References: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>
Message-ID: <2F57F34D-5AB4-4F42-A564-A531EAA831A3@syenar.hu>

Hi Lorenzo,

I think this (or similar) has been debated already and the group came  
against
it. I'm personally not a big fan of this kind of extension either,  
since it's hard
to catch, thus hard to port. In other words you would only know your  
code
is "vulnerable" when your code would crash (or give different results)
under XB*se++ or CA-Cl*pper. Moreover, it would simply make Harbour
not compatible whith CA-Cl*pper for these special cases (speaking of  
SubStr()).

I'd rather favour a new HB_*() function to cover this special case.

HB_STRCUT( <cString> [, <nChar> ] ), where nChar defaults to one
if not specified. (Just a quick idea as far as the details go)

Latter would be quicker too.

Brgds,
Viktor

On 2007.05.21., at 18:43, Lorenzo Fiorini wrote:

> It is often useful to cut last char, for example when you create a
> list adding values and you need to remove last comma.
>
> PHP has substr( cStr, x, -y ) and python has "abcdef"[x,-y]
>
> harbour has "abcdef"[x] but not abcdef[x,-y] and it has substr(
> "abcedf", -x ) but not substr( "abcdef", x, -y)
>
> Your opinion?
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Mon May 21 13:02:00 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 21 13:02:36 2007
Subject: [Harbour] What about substr( cStr, x, -y ) = substr( cStr, x,
	len( x ) - y ) or "abcedfg"[ 1, -1]?
In-Reply-To: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>
References: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>
Message-ID: <20070521170200.GA5448@localhost.localdomain>

On Mon, 21 May 2007, Lorenzo Fiorini wrote:
> It is often useful to cut last char, for example when you create a
> list adding values and you need to remove last comma.
> PHP has substr( cStr, x, -y ) and python has "abcdef"[x,-y]
> harbour has "abcdef"[x] but not abcdef[x,-y] and it has substr(
> "abcedf", -x ) but not substr( "abcdef", x, -y)

I do not know what results you expects.
Can you write HB_SUBSTR() function which will return what you need
and send it here?

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Mon May 21 13:15:59 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May 21 13:16:03 2007
Subject: [Harbour] What about substr( cStr, x, -y ) = substr( cStr, x,
	len( x ) - y ) or "abcedfg"[ 1, -1]?
In-Reply-To: <20070521170200.GA5448@localhost.localdomain>
References: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>
	<20070521170200.GA5448@localhost.localdomain>
Message-ID: <9257026e0705211015tbabb5a3v9771eed74c9b911@mail.gmail.com>

On 5/21/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Can you write HB_SUBSTR() function which will return what you need
> and send it here?

I've simply added to substr.c the lines below:

            if( ISNUM( 3 ) )
            {
               lLen = hb_parnl( 3 );

               if( lLen > lSize - lPos )
                  lLen = lSize - lPos;
----->
               if( lLen < 0 )
                  lLen = lSize + lLen;
----->
            }

best regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Mon May 21 13:39:59 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May 21 13:40:02 2007
Subject: [Harbour] What about substr( cStr, x, -y ) = substr( cStr, x,
	len( x ) - y ) or "abcedfg"[ 1, -1]?
In-Reply-To: <2F57F34D-5AB4-4F42-A564-A531EAA831A3@syenar.hu>
References: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>
	<2F57F34D-5AB4-4F42-A564-A531EAA831A3@syenar.hu>
Message-ID: <9257026e0705211039k7a83ac3cn1fabf4d7ebe321e3@mail.gmail.com>

On 5/21/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> it. I'm personally not a big fan of this kind of extension either,
> since it's hard
> to catch, thus hard to port. In other words you would only know your
> code

I respect your point of view, I want only to share ideas with friends :)
I also use PHP and often I need to move code between PHP and Harbour.
When I see sth that can be useful to the language I ask if the group
is interested.
The group can say  yes or no, it's wrong, it's not so good or whatever
else but I'll be always interested in your opinion.

best regards,
Lorenzo
From druzus at priv.onet.pl  Mon May 21 13:50:05 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 21 13:50:40 2007
Subject: [Harbour] What about substr( cStr, x, -y ) = substr( cStr, x,
	len( x ) - y ) or "abcedfg"[ 1, -1]?
In-Reply-To: <9257026e0705211015tbabb5a3v9771eed74c9b911@mail.gmail.com>
References: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>
	<20070521170200.GA5448@localhost.localdomain>
	<9257026e0705211015tbabb5a3v9771eed74c9b911@mail.gmail.com>
Message-ID: <20070521175005.GA6168@localhost.localdomain>

On Mon, 21 May 2007, Lorenzo Fiorini wrote:
> I've simply added to substr.c the lines below:
>            if( ISNUM( 3 ) )
>            {
>               lLen = hb_parnl( 3 );
>               if( lLen > lSize - lPos )
>                  lLen = lSize - lPos;
> ----->
>               if( lLen < 0 )
>                  lLen = lSize + lLen;
> ----->
>            }

It's a little bit strange for me. 
It means that
    ? substr("1234567890", 6, -2)
should show
    67890
and
    ? substr("1234567890", 2, -2)
should show
    23456789

is it your intention?
or maybe you want to have results like:
    678
and
    2345678

what results you have in PHP for above examples?

Anyhow I agree with Victor that changing the behavior of standard Clipper
functions may wrongly interact with existing code and it's not good idea.
I strongly suggest to create new function and if necessary to use
preprocessor to change standard function calls to the new one.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Mon May 21 16:18:28 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May 21 16:18:31 2007
Subject: [Harbour] What about substr( cStr, x, -y ) = substr( cStr, x,
	len( x ) - y ) or "abcedfg"[ 1, -1]?
In-Reply-To: <20070521175005.GA6168@localhost.localdomain>
References: <9257026e0705210943u76ed26bdl85e4818cca44a04c@mail.gmail.com>
	<20070521170200.GA5448@localhost.localdomain>
	<9257026e0705211015tbabb5a3v9771eed74c9b911@mail.gmail.com>
	<20070521175005.GA6168@localhost.localdomain>
Message-ID: <9257026e0705211318j7bcba9em319400d0f6e60d68@mail.gmail.com>

On 5/21/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> what results you have in PHP for above examples?

This is from the php manual:

<?php
$rest = substr("abcdef", 0, -1);  // returns "abcde"
$rest = substr("abcdef", 2, -1);  // returns "cde"
$rest = substr("abcdef", 4, -4);  // returns ""
$rest = substr("abcdef", -3, -1); // returns "de"
?>

Sometime I mix the syntax ot the languages and I was sure that Clipper
worked in that way like it allows substr( cStr, -1 ) = right( cStr, 1
).
To check it I looked at substr.c and I saw that it already calcs the
lenght of the string so I wonder why I need to use len( cStr ) to say
to substr sth that it already knows.

best regards,
Lorenzo
From druzus at priv.onet.pl  Mon May 21 19:45:47 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 21 19:46:23 2007
Subject: [Harbour] ChangeLog 2007-05-22 01:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070521234547.GA14065@localhost.localdomain>

2007-05-22 01:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbapi.h
  * harbour/include/hbapicls.h
  * harbour/include/hbcomp.h
  * harbour/include/hbvm.h
  * harbour/include/hbvmpub.h
  * harbour/source/compiler/genc.c
  * harbour/source/compiler/gencc.c
  * harbour/source/compiler/gencli.c
  * harbour/source/compiler/hbdead.c
  * harbour/source/compiler/hbfix.c
  * harbour/source/compiler/hblbl.c
  * harbour/source/compiler/hbopt.c
  * harbour/source/compiler/hbpcode.c
  * harbour/source/compiler/hbstripl.c
  * harbour/source/debug/dbgentry.c
  * harbour/source/rdd/wafunc.c
  * harbour/source/rtl/itemseri.c
  * harbour/source/rtl/gtsln/gtsln.c
  * harbour/source/vm/classes.c
  * harbour/source/vm/dynsym.c
  * harbour/source/vm/hvm.c
  * harbour/source/vm/memvars.c
  * harbour/source/vm/runner.c
    * casting: changed some 'char *' to 'const char *', added const to some
      other declarations, added workaround for GCC warnings about
      dereferencing pointer with strict-aliasing optimization, etc.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue May 22 02:27:16 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 22 02:27:19 2007
Subject: [Harbour] ChangeLog 2007-05-22 01:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070521234547.GA14065@localhost.localdomain>
References: <20070521234547.GA14065@localhost.localdomain>
Message-ID: <9257026e0705212327s1f05ba20v74bd3ef00b67d6ee@mail.gmail.com>

On 5/22/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
>     * casting: changed some 'char *' to 'const char *', added const to some
>       other declarations, added workaround for GCC warnings about
>       dereferencing pointer with strict-aliasing optimization, etc.

Many thanks, perfectly clean now.

The only warnings I still get are about pcre.
I still use source/rtl/pcre from xHarbour since I couldn't get
-DHB_PCRE_REGEX working.

I sent a message about it days ago.

To recap I build Harbour with -DHB_PCRE_REGEX but the test below is 5
times slower  than "source" pcre.

How can I be sure I'm using PCRE and not POSIX?

Any idea?

best regards,
Lorenzo

../../pcre_compile.c: In function 'compile_regex':
../../pcre_compile.c:3283: warning: 'negated' may be used
uninitialized in this function
../../pcre_compile.c: In function 'pcre_compile2':
../../pcre_compile.c:3958: warning: 'max' may be used uninitialized in
this function
../../pcre_compile.c:3958: warning: 'min' may be used uninitialized in
this function

external HB_REGEX

procedure main( x, y )

   local cForExpr
   local bForExpr
   local nLoop
   local nBegin

   ? x, y

   ? iif( HB_REGEX( x, y ) != nil, .t., .f. )

   cForExpr := "iif( HB_REGEX( '" + alltrim( x ) + "', '" + y + "' )
!= nil, .t., .f. )"

   ? cForExpr

   cForExpr := "{||"+cForExpr+"}"

   ? cForExpr

   bFoxExpr := &cForExpr

   nBegin := seconds()

   for nLoop := 1 to 10000
     eval( bFoxExpr )
   next

   ? seconds() - nBegin

return
From druzus at priv.onet.pl  Tue May 22 03:16:47 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 03:17:25 2007
Subject: [Harbour] ChangeLog 2007-05-22 01:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705212327s1f05ba20v74bd3ef00b67d6ee@mail.gmail.com>
References: <20070521234547.GA14065@localhost.localdomain>
	<9257026e0705212327s1f05ba20v74bd3ef00b67d6ee@mail.gmail.com>
Message-ID: <20070522071647.GA5216@localhost.localdomain>

On Tue, 22 May 2007, Lorenzo Fiorini wrote:
> The only warnings I still get are about pcre.
> I still use source/rtl/pcre from xHarbour since I couldn't get
> -DHB_PCRE_REGEX working.
> I sent a message about it days ago.

Even for PCRE we are using only POSIX functions. It has one side effect.
When you build Harbour with -DHB_PCRE_REGEX and then you are linking
final application instead of PCRE the POSIX regex build-in into libc
are linked. It causes memory corruption (the memory leak you reported
is an effect of memory corruption) because the POSIX regex_t is much
bigger then the PCRE one.

> To recap I build Harbour with -DHB_PCRE_REGEX but the test below is 5
> times slower  than "source" pcre.

Because it was POSIX regex not PCRE - see above. You can try to force
PCRE regex by adding explicitly libpcre.a to linked list of binaries
objects.

> How can I be sure I'm using PCRE and not POSIX?

I'll look at the code and maybe I'll change it to directly execute PCRE
functions instead of emulated by PCRE POSIX ones - it should resolve the
problem.

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 22 03:33:51 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 03:34:26 2007
Subject: [Harbour] ChangeLog 2007-05-22 01:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070522071647.GA5216@localhost.localdomain>
References: <20070521234547.GA14065@localhost.localdomain>
	<9257026e0705212327s1f05ba20v74bd3ef00b67d6ee@mail.gmail.com>
	<20070522071647.GA5216@localhost.localdomain>
Message-ID: <20070522073351.GB5216@localhost.localdomain>

On Tue, 22 May 2007, Przemyslaw Czerpak wrote:
> > To recap I build Harbour with -DHB_PCRE_REGEX but the test below is 5
> > times slower  than "source" pcre.
> Because it was POSIX regex not PCRE - see above. You can try to force
> PCRE regex by adding explicitly libpcre.a to linked list of binaries
> objects.

If you are using FC then add -lpcreposix to your link script, f.e. for
the code you send:
    hbmk -n -w -es2 -gtstd tst -lpcreposix && ./tst a[bcd]c 012345abcde

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue May 22 04:16:27 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 22 04:16:31 2007
Subject: [Harbour] ChangeLog 2007-05-22 01:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070522073351.GB5216@localhost.localdomain>
References: <20070521234547.GA14065@localhost.localdomain>
	<9257026e0705212327s1f05ba20v74bd3ef00b67d6ee@mail.gmail.com>
	<20070522071647.GA5216@localhost.localdomain>
	<20070522073351.GB5216@localhost.localdomain>
Message-ID: <9257026e0705220116y1f348d32mecdf9d8699b1e639@mail.gmail.com>

On 5/22/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> If you are using FC then add -lpcreposix to your link script, f.e. for
> the code you send:
>     hbmk -n -w -es2 -gtstd tst -lpcreposix && ./tst a[bcd]c 012345abcde

Many thanks it works times are comparable to source pcre.

I've added a HB_PCRE_REGEX_RH to incluse/hbregex.h

#elif defined( HB_PCRE_REGEX_RH )
#  include <pcre.h>
#  include <pcreposix.h>
#  define HB_PCRE_REGEX

is it correct?

Can I add -lpcreposix to SYSTEM_LIBS in bin/hb-func.sh?

best regards,
Lorenzo
From druzus at priv.onet.pl  Tue May 22 05:54:16 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 05:54:51 2007
Subject: [Harbour] ChangeLog 2007-05-22 01:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705220116y1f348d32mecdf9d8699b1e639@mail.gmail.com>
References: <20070521234547.GA14065@localhost.localdomain>
	<9257026e0705212327s1f05ba20v74bd3ef00b67d6ee@mail.gmail.com>
	<20070522071647.GA5216@localhost.localdomain>
	<20070522073351.GB5216@localhost.localdomain>
	<9257026e0705220116y1f348d32mecdf9d8699b1e639@mail.gmail.com>
Message-ID: <20070522095416.GA20128@localhost.localdomain>

On Tue, 22 May 2007, Lorenzo Fiorini wrote:
> >If you are using FC then add -lpcreposix to your link script, f.e. for
> >the code you send:
> >    hbmk -n -w -es2 -gtstd tst -lpcreposix && ./tst a[bcd]c 012345abcde
> Many thanks it works times are comparable to source pcre.
> I've added a HB_PCRE_REGEX_RH to incluse/hbregex.h
>    #elif defined( HB_PCRE_REGEX_RH )
>    #  include <pcre.h>
>    #  include <pcreposix.h>
>    #  define HB_PCRE_REGEX
> is it correct?

Yes, though maybe we should add -Ipcre to CFLAGS in make files
(or even leave it for user in C_USR) and remove pcre/ path from
hbregex.h - for me seems to be better. Users which uses distros
where PCRE header files are in /usr/include/pcre can simply make:
    export C_USR="-DHB_PCRE_REGEX -Ipcre $C_USR"

> Can I add -lpcreposix to SYSTEM_LIBS in bin/hb-func.sh?

I'll do that - it cannot be done by default for all builds because it
will break POSIX regex so we should check if -DHB_PCRE_REGEX is set
in C_USR and only in such case add -lpcreposix to SYSTEM_LIBS.

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 22 06:23:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 06:24:17 2007
Subject: [Harbour] ChangeLog 2007-05-22 12:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070522102342.GA1183@localhost.localdomain>

2007-05-22 12:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/bin/hb-func.sh
    +  added -lpcreposix to system libraries when C_USR has -DHB_PCRE_REGEX
  * harbour/include/hbregex.h
    * removed pcre/ path from PCRE header files - if you want to build
      Harbour with PCRE regex and PCRE header files are not in default\
      path then set valid path in C_USR, f.e.:
         export C_USR="${C_USR} -DHB_PCRE_REGEX -I/usr/include/pcre"

  * harbour/include/hbxvm.h
  * harbour/source/compiler/gencc.c
  * harbour/source/vm/hvm.c
    * minor optimizatin for -gc3 output

best regards,
Przemek
From dmacias at mail.udg.mx  Tue May 22 06:28:49 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Tue May 22 06:28:53 2007
Subject: [Harbour] Error with PARAMETERS
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <4652C5E1.7000102@mail.udg.mx>

Code included below (preproc4.prg) fail with current Harbour devel branch
Tested with Win32, bcc32

output -----------------------
C:\hbbuild\harbour\pruebas>preproc4

          1
Error BASE/1086  Argument error: ++
Called from MAIN(6)
-----------------------

Error is caused by existance of line
    PARA xParam1
Using PARAMETERS instead does not fix error

It work with Clipper 5.3a, either with:
-----------
LOCAL ii
PARA xParam1
-----------
or
-----------
PARA xParam1
LOCAL ii
-----------

Latest form seem to disagree with NG, about "but must follow all 
compile-time variable declarations ...":

  PARAMETERS
  Create private parameter variables
------------------------------------------------------------------------------
...  A PARAMETERS statement is an
      executable statement and, therefore, can occur anywhere in a procedure
      or user-defined function, but must follow all compile-time variable
      declarations, such as FIELD, LOCAL, MEMVAR, and STATIC.



David Macias


FUNC MAIN
LOCAL ii
PARA xParam1

//
FOR ii = 1 TO 21
  qout(ii)
NEXT ii
//

qout( "hello0", xParam1 )

RETU NIL


From dmacias at mail.udg.mx  Tue May 22 06:42:10 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Tue May 22 06:42:12 2007
Subject: [Harbour] Missing HB_MD5, HB_MD5FILE
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <4652C902.30602@mail.udg.mx>

HB_MD5, HB_MD5FILE does not exist in rtl.lib
Tested with Win32, bcc32

$(OBJ_DIR)\hbmd5.obj    \

are not included in common.mak for RTL_LIB_OBJS

David Macias


From dmacias at mail.udg.mx  Tue May 22 06:48:15 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Tue May 22 06:48:18 2007
Subject: [Harbour] To Przemek
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <4652CA6F.6010105@mail.udg.mx>

Przemek:

can you review this message ?
=========================
[Harbour] Re: ChangeLog 2007-04-06 02:32 
UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
David Arturo Macias Corona dmacias at mail.udg.mx
Sat Apr 21 06:27:58 EDT 2007
=========================

It contain some requests for you

David Macias


From druzus at priv.onet.pl  Tue May 22 06:50:19 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 06:50:55 2007
Subject: [Harbour] Error with PARAMETERS
In-Reply-To: <4652C5E1.7000102@mail.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<4652C5E1.7000102@mail.udg.mx>
Message-ID: <20070522105019.GB1183@localhost.localdomain>

On Tue, 22 May 2007, David Arturo Macias Corona wrote:
> Code included below (preproc4.prg) fail with current Harbour devel branch
> Tested with Win32, bcc32
> Error BASE/1086  Argument error: ++
> Called from MAIN(6)

Thanks for the info - fixed.

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 22 07:25:24 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 07:26:00 2007
Subject: [Harbour] To Przemek
In-Reply-To: <4652CA6F.6010105@mail.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<4652CA6F.6010105@mail.udg.mx>
Message-ID: <20070522112524.GC1183@localhost.localdomain>

On Tue, 22 May 2007, David Arturo Macias Corona wrote:
> can you review this message ?
> =========================
> [Harbour] Re: ChangeLog 2007-04-06 02:32 
> UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
> David Arturo Macias Corona dmacias at mail.udg.mx
> Sat Apr 21 06:27:58 EDT 2007
> =========================
> It contain some requests for you

On Sat, 21 Apr 2007, David Arturo Macias Corona wrote:
> >Please do note however that using -DTCPV40HDRS is _not_ enough, you have
> >to change the library path so that the compiler finds V40 libraries
> > _before_ the 32bit ones, it is clearly explained in GCC docs.
> ReleaseNotes.os2 contain:
> ---------------------------------------------------------
> v3.2.2 Alpha 2:
> ---------------
>     A few bugfixes and a couple of new features.
>         o The TCP/IP headers and libraries scheme have been changed.
>           The default is the current OS/2 tcpip toolkit (BSD 4.4 based).
>           To target the older OS/2 tcpip stack (BSD 4.3 based) you must
>           define TCPV40HDRS before including any TCP/IP headers and make
>           sure usr/lib/tcpipv4 is searched before usr/lib (this is to
>           get the right libsocket). It is recommended to use the -D
>           compiler option for the define and either the LIBRARY_PATH or
>           the -L compiler/linker option for the library.
> ---------------------------------------------------------
> Przemek,
> can you add some comment related to this subject in make_gnu.cmd  and/or 
> config\os2\gcc.cf ?

If you can please do it and commit - I'm not OS2 user and it will be hard
for me to catch even stupid typos. I think that things like comments should
be done by real OS2 users.

> > -s is used to strip the symbol table, this way you get smaller .exes
> > and .dlls
> 
> Przemek,
> can you add it (if it is convenient) to config\os2\gcc.cf ?
> LDFLAGS += $(LINKPATHS) -s

This is not good idea. You can always strip debug informatin using
'strip' program so it's not a problem for users and when you will
want to run binaries in GDB debugger you will not have to change
make files to create debug build. GCC is one of very few compilers
which does not generate less efficient/different code for debug and
normal build so it does not causes any performance reduction like
in BCC or MSVC.

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 22 07:26:21 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 07:26:56 2007
Subject: [Harbour] Missing HB_MD5, HB_MD5FILE
In-Reply-To: <4652C902.30602@mail.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<4652C902.30602@mail.udg.mx>
Message-ID: <20070522112621.GD1183@localhost.localdomain>

On Tue, 22 May 2007, David Arturo Macias Corona wrote:
> HB_MD5, HB_MD5FILE does not exist in rtl.lib
> Tested with Win32, bcc32
> $(OBJ_DIR)\hbmd5.obj    \
> are not included in common.mak for RTL_LIB_OBJS

If you have CVS write access then please do it.
If not then please ask Chen or Phil about it.

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 22 07:35:13 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 07:35:48 2007
Subject: [Harbour] ChangeLog 2007-05-22 13:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070522113513.GA4497@localhost.localdomain>

2007-05-22 13:30 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/compiler/hbfix.c
    ! fixed local IND/DED when PARAMETERS is used
    ! fixed local names generated for debugger when PARAMETERS is used

  * harbour/source/debug/dbgentry.c
    ! fixed very bad typo in my previous commit
    % minor optimization

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 22 07:46:43 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 07:47:18 2007
Subject: [Harbour] ChangeLog 2007-05-22 13:47 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070522114643.GA4813@localhost.localdomain>

2007-05-22 13:47 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
  * harbour/source/rtl/Makefile
    * synced RTL files

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue May 22 09:05:15 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 22 09:05:18 2007
Subject: [Harbour] ChangeLog 2007-05-22 12:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070522102342.GA1183@localhost.localdomain>
References: <20070522102342.GA1183@localhost.localdomain>
Message-ID: <9257026e0705220605w5cd63208n84ccfa4ce96b13ff@mail.gmail.com>

On 5/22/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> 2007-05-22 12:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/bin/hb-func.sh
>     +  added -lpcreposix to system libraries when C_USR has -DHB_PCRE_REGEX
>   * harbour/include/hbregex.h
>     * removed pcre/ path from PCRE header files - if you want to build
>       Harbour with PCRE regex and PCRE header files are not in default\
>       path then set valid path in C_USR, f.e.:
>          export C_USR="${C_USR} -DHB_PCRE_REGEX -I/usr/include/pcre"

Many thanks it is perfect now.

best regards,
Lorenzo
From randy at palmasdev.com  Tue May 22 09:28:10 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Tue May 22 09:27:31 2007
Subject: [Harbour] ChangeLog BETA 2007-05-19 00:45 UTC+0200
	Przemyslaw Czerpak (druzus/at/priv.onet.pl)
In-Reply-To: <20070518224535.GA32075@localhost.localdomain>
References: <20070518224535.GA32075@localhost.localdomain>
Message-ID: <20070522132728.302F4661E0@smtp.tor.pathcom.com>

Thanks for making those bug fixes in the Beta version... but the 
download section is still showing a date of March 27 - Where is the 
latest Beta build?

At 06:45 PM 5/18/2007, you wrote:
>2007-05-19 00:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/common.mak
>   * harbour/include/hbapierr.h
>   * harbour/include/hbapifs.h
>   * harbour/include/hbclass.ch
>   * harbour/include/hbcomp.h
>   * harbour/source/compiler/harbour.c
>   * harbour/source/compiler/harbour.y
>   * harbour/source/compiler/harbour.yyc
>   * harbour/source/compiler/ppcomp.c
>   * harbour/source/pp/ppcore.c
>   * harbour/source/rtl/Makefile
>   * harbour/source/rtl/errorapi.c
>   * harbour/source/rtl/hbffind.c
>   * harbour/source/vm/hvm.c
>   - harbour/source/rtl/memoline.c
>   - harbour/source/rtl/mlcount.c
>   - harbour/source/rtl/mlctopos.c
>   - harbour/source/rtl/mlpos.c
>   - harbour/source/rtl/mpostolc.c
>   + harbour/source/rtl/mlcfunc.c
>     * synced with some important fixes and cleanups in devel branch, f.e.
>       - new memo line functions
>       - API functions declaration and casting
>       - FILE() fixes in *nixes
>       - statics in /b (debugger) compilation
>       - MEMO flag clearning
>
>best regards,
>Przemek
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Tue May 22 10:46:16 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 10:46:51 2007
Subject: [Harbour] ChangeLog BETA 2007-05-19 00:45 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
In-Reply-To: <20070522132728.302F4661E0@smtp.tor.pathcom.com>
References: <20070518224535.GA32075@localhost.localdomain>
	<20070522132728.302F4661E0@smtp.tor.pathcom.com>
Message-ID: <20070522144616.GA32375@localhost.localdomain>

On Tue, 22 May 2007, Randy Portnoff wrote:
> Thanks for making those bug fixes in the Beta version... but the 
> download section is still showing a date of March 27 - Where is the 
> latest Beta build?

In the CVS. You have to use -rBETA1 tag to take the latest source.

best regards,
Przemek
From miguelangel at marchuet.net  Tue May 22 11:34:17 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue May 22 11:33:27 2007
Subject: [Harbour] Any information about APPEND GENERAL
Message-ID: <46530D79.2050803@marchuet.net>

I'm implementing APPEND GENERAL, but need some information of format for OLE data.
I Know that the ole class and data are saved into fieldtype G similar to M fieldtype.
In linux has general purposes, but in windows are for sale ole data.

anybody can help me ?

Imports an OLE object from a file and places it into a general field.


APPEND GENERAL GeneralFieldName [FROM FileName]
   [DATA cExpression] [LINK] [CLASS OLEClassName]



Parameters
GeneralFieldName


Specifies the name of the general field in which the OLE object is placed. You can specify a general field in a table open in a
noncurrent work area by including the table alias with the field name.
FROM FileName


Specifies the file containing the OLE object. You must include the entire file name, including its extension. If the file is
located in a directory other than the current default directory, include the path with the file name.
DATA cExpression


Specifies a character expression that is evaluated and passed as a character string to the OLE object in the general field. The
OLE object must be capable of receiving and processing the string. For example, you cannot send a character string to a graphics
object such as one created using Paintbrush.
LINK


Creates a link between the OLE object and the file that contains the object. The OLE object appears in the general field but the
object's definition remains in the file. If you omit LINK, the OLE object is embedded in the general field.
CLASS OLEClassName


Specifies an OLE class for an OLE object other than the default class. You can specify a class name when the file extension for
the file containing the OLE object is different from the default extension and you want to force the behavior for the class. If
the default extension can be used by multiple Automation servers, include the class to specify a particular server.

Miguel Angel Marchuet


From hbco2 at sbcglobal.net  Tue May 22 14:07:52 2007
From: hbco2 at sbcglobal.net (Bill Smith)
Date: Tue May 22 14:08:27 2007
Subject: [Harbour] ChangeLog 2007-05-22 13:47 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070522114643.GA4813@localhost.localdomain>
Message-ID: <004b01c79c9c$1e9bb2a0$0303a8c0@hbco>

>From latest CVS, compile attempt using bcc32 generates the following error:

Fatal: 'obj\b32\hbcrc.c' does not exist - don't know how to make it

Bill

----- Original Message ----- 
From: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Tuesday, May 22, 2007 4:46 AM
Subject: [Harbour] ChangeLog 2007-05-22 13:47 UTC+0200 Przemyslaw
Czerpak(druzus/at/priv.onet.pl)


> 2007-05-22 13:47 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/common.mak
>   * harbour/source/rtl/Makefile
>     * synced RTL files
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From gerinfo at machadoribeiro.com.br  Tue May 22 14:20:23 2007
From: gerinfo at machadoribeiro.com.br (=?ISO-8859-2?Q?Andr=E9_Louis_Dutheil?=)
Date: Tue May 22 14:20:29 2007
Subject: [Harbour] ChangeLog 2007-05-22 13:47 UTC+0200
	Przemyslaw	Czerpak(druzus/at/priv.onet.pl)
In-Reply-To: <004b01c79c9c$1e9bb2a0$0303a8c0@hbco>
References: <20070522114643.GA4813@localhost.localdomain>
	<004b01c79c9c$1e9bb2a0$0303a8c0@hbco>
Message-ID: <46533467.1080708@machadoribeiro.com.br>

Have a look at common.mak line 384 and 385. Change .c to .obj

Rgds,
Andre Dutheil
-- 



Bill Smith escreveu:
> >From latest CVS, compile attempt using bcc32 generates the following error:
>
> Fatal: 'obj\b32\hbcrc.c' does not exist - don't know how to make it
>
> Bill
>
> ----- Original Message ----- 
> From: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
> To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
> Sent: Tuesday, May 22, 2007 4:46 AM
> Subject: [Harbour] ChangeLog 2007-05-22 13:47 UTC+0200 Przemyslaw
> Czerpak(druzus/at/priv.onet.pl)
>
>
>   
>> 2007-05-22 13:47 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>>   * harbour/common.mak
>>   * harbour/source/rtl/Makefile
>>     * synced RTL files
>>
>> best regards,
>> Przemek
>> _______________________________________________
>> Harbour mailing list
>> Harbour@harbour-project.org
>> http://lists.harbour-project.org/mailman/listinfo/harbour
>>     
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
>
> __________ Informa??o do NOD32 IMON 2285 (20070522) __________
>
> Esta mensagem foi verificada pelo NOD32 sistema antiv?rus
> http://www.eset.com.br
>
>
>
>   
From druzus at priv.onet.pl  Tue May 22 17:20:05 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 17:20:41 2007
Subject: [Harbour] ChangeLog 2007-05-22 23:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070522212005.GA809@localhost.localdomain>

2007-05-22 23:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
    ! fixed typo during copy and past in last modification - changing files
      when the modifications cannot be checked is always dangerous, sorry

best regards,
Przemek
From hbco2 at sbcglobal.net  Tue May 22 17:29:14 2007
From: hbco2 at sbcglobal.net (Bill Smith)
Date: Tue May 22 17:29:46 2007
Subject: [Harbour] ChangeLog 2007-05-22 23:20 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070522212005.GA809@localhost.localdomain>
Message-ID: <006601c79cb8$3fc159a0$0303a8c0@hbco>

Hi Przemek

With all the contribution you make, it goes without saying that there is no
need to apologize.

Thank you again for all your work, help and support.

Bill

----- Original Message ----- 
From: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Tuesday, May 22, 2007 2:20 PM
Subject: [Harbour] ChangeLog 2007-05-22 23:20 UTC+0200 Przemyslaw
Czerpak(druzus/at/priv.onet.pl)


> 2007-05-22 23:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/common.mak
>     ! fixed typo during copy and past in last modification - changing
files
>       when the modifications cannot be checked is always dangerous, sorry
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From philb at philb.us  Tue May 22 18:58:20 2007
From: philb at philb.us (Phil Barnett)
Date: Tue May 22 18:58:23 2007
Subject: [Harbour] ChangeLog BETA 2007-05-19 00:45 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
In-Reply-To: <20070522132728.302F4661E0@smtp.tor.pathcom.com>
References: <20070518224535.GA32075@localhost.localdomain>
	<20070522132728.302F4661E0@smtp.tor.pathcom.com>
Message-ID: <200705221858.20245.philb@philb.us>

On Tuesday 22 May 2007 09:28, Randy Portnoff wrote:
> Thanks for making those bug fixes in the Beta version... but the
> download section is still showing a date of March 27 - Where is the
> latest Beta build?

While I am a proponent of release often, we made a decision to make the beta 
cycles at least a month long unless there was good reason to deviate.

With that said, it is about time for another release.

But, we need confirmation that things that were added to the development 
branch that were bugfixes are ported to the beta branch before we retag it.

-- 
Phil Barnett
AI4OF
SKCC #600
From druzus at priv.onet.pl  Tue May 22 21:37:05 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 22 21:37:41 2007
Subject: [Harbour] ChangeLog BETA 2007-05-23 03:35 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
Message-ID: <20070523013705.GA12016@localhost.localdomain>

2007-05-23 03:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbapi.h
  * harbour/include/hbapicls.h
  * harbour/include/hbcomp.h
  * harbour/include/hbvm.h
  * harbour/include/hbvmpub.h
  * harbour/source/compiler/genc.c
  * harbour/source/compiler/gencc.c
  * harbour/source/compiler/gencli.c
  * harbour/source/compiler/hbdead.c
  * harbour/source/compiler/hbfix.c
  * harbour/source/compiler/hblbl.c
  * harbour/source/compiler/hbpcode.c
  * harbour/source/compiler/hbstripl.c
  * harbour/source/rdd/dbcmd.c
  * harbour/source/rtl/Makefile
  * harbour/source/rtl/gtsln/gtsln.c
  * harbour/source/vm/classes.c
  * harbour/source/vm/dynsym.c
  * harbour/source/vm/hvm.c
  * harbour/source/vm/memvars.c
  * harbour/source/vm/runner.c
    * synced with casting and warning cleanup in devel branch

best regards,
Przemek
From harbour.01 at syenar.hu  Wed May 23 02:49:35 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 23 02:49:39 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor Szakats
 (harbour.01 syenar.hu)
Message-ID: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>

2007-05-23 08:35 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/common/hbver.c
   * harbour/source/rtl/diskspac.c
   * harbour/source/rtl/filehb.c
   * harbour/source/rtl/hbrandom.c
   * harbour/source/rtl/strmatch.c
   * harbour/source/rtl/tbcolumn.prg
   * harbour/source/rtl/tbrowse.prg
     * Synced with devel branch.

From harbour.01 at syenar.hu  Wed May 23 03:18:35 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 23 03:18:37 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 09:15 UTC+0100 Viktor Szakats
 (harbour.01 syenar.hu)
Message-ID: <01c79d0a$Blat.v2.6.1$9354bc4a$7eca8b460a4@127.0.0.1>

2007-05-23 09:15 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/strmatch.c
   * harbour/source/rtl/tbrowse.prg
     * Undone part of the previous sync.

From druzus at priv.onet.pl  Wed May 23 05:11:08 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 05:11:44 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
Message-ID: <20070523091108.GA13456@localhost.localdomain>

On Wed, 23 May 2007, Szak?ts Viktor wrote:
> 2007-05-23 08:35 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>    * harbour/source/common/hbver.c
>    * harbour/source/rtl/diskspac.c
>    * harbour/source/rtl/filehb.c
>    * harbour/source/rtl/hbrandom.c
>    * harbour/source/rtl/strmatch.c
>    * harbour/source/rtl/tbcolumn.prg
>    * harbour/source/rtl/tbrowse.prg
>      * Synced with devel branch.

Victor, what do you think about syncing whole RTL tree
without new code like HASH, CRC, INET?
I've already made it for test and it works well.
In summary it seems to be much safer operation then coping
single modifications which are not well tested as standalone
solution and we should not forget about sth.
I also synced all CDP and CT modifications.

best regards,
Przemek
From harbour.01 at syenar.hu  Wed May 23 05:16:54 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 23 05:16:48 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <20070523091108.GA13456@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523091108.GA13456@localhost.localdomain>
Message-ID: <6999739D-64CB-4561-9A30-2C5EEBA9DF88@syenar.hu>

Hi Przemek,

I'm all for it. I was thinking along the same line while
fixing problems after syncing just a few files.

I think the current devel is stable enough to make it as
a new Beta.

Moreover it contains some minor incompatibilities
which are better to be published now while we're still
in Beta.

IMO, even new code can go into the Beta.

Brgds,
Viktor

On 2007.05.23., at 11:11, Przemyslaw Czerpak wrote:

> On Wed, 23 May 2007, Szak?ts Viktor wrote:
>> 2007-05-23 08:35 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>>    * harbour/source/common/hbver.c
>>    * harbour/source/rtl/diskspac.c
>>    * harbour/source/rtl/filehb.c
>>    * harbour/source/rtl/hbrandom.c
>>    * harbour/source/rtl/strmatch.c
>>    * harbour/source/rtl/tbcolumn.prg
>>    * harbour/source/rtl/tbrowse.prg
>>      * Synced with devel branch.
>
> Victor, what do you think about syncing whole RTL tree
> without new code like HASH, CRC, INET?
> I've already made it for test and it works well.
> In summary it seems to be much safer operation then coping
> single modifications which are not well tested as standalone
> solution and we should not forget about sth.
> I also synced all CDP and CT modifications.
>
> best regards,
> Przemek

From druzus at priv.onet.pl  Wed May 23 05:48:14 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 05:48:50 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <6999739D-64CB-4561-9A30-2C5EEBA9DF88@syenar.hu>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523091108.GA13456@localhost.localdomain>
	<6999739D-64CB-4561-9A30-2C5EEBA9DF88@syenar.hu>
Message-ID: <20070523094814.GB13456@localhost.localdomain>

On Wed, 23 May 2007, Szak?ts Viktor wrote:
> Hi Przemek,
> I'm all for it. I was thinking along the same line while
> fixing problems after syncing just a few files.
> I think the current devel is stable enough to make it as
> a new Beta.
> Moreover it contains some minor incompatibilities
> which are better to be published now while we're still
> in Beta.
> IMO, even new code can go into the Beta.

It's not good practice and in normal situation I would vote against
it but in fact current devel branch is probably better tested because
more users (f.e people who also uses xHarbour) use it so maybe it's
not bad idea. In devel branch we also have debugger borrowed from
xHarbour with C HVM interface and many other Phil's extensions.
For people who are using debugger it's very important feature. I can
try to port it but it would be much easier to copy it with other HVM
files. I would like to hear other people opinion. Phil?

best regards,
Przemek
From druzus at priv.onet.pl  Wed May 23 05:55:07 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 05:55:42 2007
Subject: [Harbour] ChangeLog 2007-05-23 11:55 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070523095507.GA17607@localhost.localdomain>

2007-05-23 11:55 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/Makefile
    + added hbapidbg.h

  * harbour/source/vm/classes.c
    - removed one unused debug function

  * harbour/source/vm/debug.c
    * formatting

best regards,
Przemek
From druzus at priv.onet.pl  Wed May 23 06:27:16 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 06:27:52 2007
Subject: [Harbour] ChangeLog 2007-05-23 12:27 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070523102716.GA21659@localhost.localdomain>

2007-05-23 12:27 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/vm/debug.c
    ! fixed access/assign local variables from debugger in functions
      with variable number of parameters

best regards,
Przemek
From dmacias at mail.udg.mx  Wed May 23 06:33:52 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Wed May 23 06:33:55 2007
Subject: [Harbour] Re: Error with PARAMETERS
In-Reply-To: <20070522113608.8711E43E3C3@antivirus2.noc.udg.mx>
References: <20070522113608.8711E43E3C3@antivirus2.noc.udg.mx>
Message-ID: <46541890.4090407@mail.udg.mx>

 >> Subject: Error with PARAMETERS
> Thanks for the info - fixed.
>   

Thanks, it is working fine now

What do you think about my remark for order of (what should be 
right/convenient) and difference with NG ?:

-----------
FUNC MAIN
LOCAL ii
PARA xParam1
-----------
or
-----------
FUNC MAIN
PARA xParam1
LOCAL ii
-----------


 >> Subject:
Re: [Harbour] To Przemek

> If you can please do it and commit - I'm not OS2 user and it will be hard
> for me to catch even stupid typos. I think that things like comments should
> be done by real OS2 users.
>
>   
OK

> This is not good idea. You can always strip debug informatin using
> 'strip' program so it's not a problem for users and when you will
> want to run binaries in GDB debugger you will not have to change
> make files to create debug build. GCC is one of very few compilers
> which does not generate less efficient/different code for debug and
> normal build so it does not causes any performance reduction like
> in BCC or MSVC.
>   
OK
I am confused because xHarbour\config\os2\gcc.cf have note about "libc 
presence" and next line show -s switch:
--------------------------------------------------------------------------------
# statical linking with GCC 3.2.2 libc as not require its presence on 
user system
LDFLAGS += $(LINKPATHS) -s
--------------------------------------------------------------------------------


 >>  Subject:
Re: [Harbour] Missing HB_MD5, HB_MD5FILE

> If you have CVS write access then please do it.
> If not then please ask Chen or Phil about it.
>
>   
As I do not know Harbour structure, I am not sure if change belong only 
to common.mak or are related to other files, so I refer it to experts  :-)
Commit a wrong fix leave two points for fixing

I saw you made proper changes in common.mak and Makefile, and my tests 
show it is correct
Thanks again

David Macias


From dmacias at mail.udg.mx  Wed May 23 06:42:55 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Wed May 23 06:42:57 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
In-Reply-To: <20070522113608.8711E43E3C3@antivirus2.noc.udg.mx>
References: <20070522113608.8711E43E3C3@antivirus2.noc.udg.mx>
Message-ID: <46541AAF.5080106@mail.udg.mx>

On Wed, 23 May 2007, Szak?ts Viktor wrote:
 >> Hi Przemek,
 >> I'm all for it. I was thinking along the same line while
 >> fixing problems after syncing just a few files.
 >> I think the current devel is stable enough to make it as
 >> a new Beta.

 >It's not good practice and in normal situation I would vote against
 >it but in fact current devel branch is probably better tested because
 >more users (f.e people who also uses xHarbour) use it so maybe it's
 >not bad idea. In devel branch we also have debugger borrowed from
 >xHarbour with C HVM interface and many other Phil's extensions.
 >For people who are using debugger it's very important feature. I can
 >try to port it but it would be much easier to copy it with other HVM
 >files. I would like to hear other people opinion. Phil?

I was thinking that "devel" become new beta, so it avoid risks of lack 
of synch between betas, missing, forgets, ... and work for synch

I always test devel branch

David Macias

From druzus at priv.onet.pl  Wed May 23 06:57:10 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 06:57:45 2007
Subject: [Harbour] Re: Error with PARAMETERS
In-Reply-To: <46541890.4090407@mail.udg.mx>
References: <20070522113608.8711E43E3C3@antivirus2.noc.udg.mx>
	<46541890.4090407@mail.udg.mx>
Message-ID: <20070523105710.GA21971@localhost.localdomain>

On Wed, 23 May 2007, David Arturo Macias Corona wrote:
> What do you think about my remark for order of (what should be 
> right/convenient) and difference with NG ?:
> -----------
> FUNC MAIN
> LOCAL ii
> PARA xParam1
> -----------
> or
> -----------
> FUNC MAIN
> PARA xParam1
> LOCAL ii
> -----------

Clipper and Harbour accepts both so it will depend on users' preferences,
used compiler switches (-w/-es2, -a, -v) and scopes of variables used
in code so I do not think we should suggest anything, f.e. I can imagine
such valid Clipper code:

   proc main()
   if pcount()==1
      parameters a
      private b:=2, c:=3
   elseif pcount()>=2
      parameters a, b
      private c:=3
   else
      private a:=1, b:=2, c:=3
   endif
   p()
   return
   proc p()
   ? a, b, c
   return

as a workaround for missing functions/procedures with variable number
of parameters in Clipper. As long as it does not introduce some bad side
effects we must support all valid Clipper code and not force changing
users' preferences.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Wed May 23 07:02:23 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 23 07:02:26 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <20070523094814.GB13456@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523091108.GA13456@localhost.localdomain>
	<6999739D-64CB-4561-9A30-2C5EEBA9DF88@syenar.hu>
	<20070523094814.GB13456@localhost.localdomain>
Message-ID: <9257026e0705230402yfacb08dxe799b95bb5ccff8c@mail.gmail.com>

On 5/23/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> It's not good practice and in normal situation I would vote against
> it but in fact current devel branch is probably better tested because
> more users (f.e people who also uses xHarbour) use it so maybe it's
> not bad idea. In devel branch we also have debugger borrowed from
> xHarbour with C HVM interface and many other Phil's extensions.
> For people who are using debugger it's very important feature. I can
> try to port it but it would be much easier to copy it with other HVM
> files. I would like to hear other people opinion. Phil?

I can say that today I can use both Harbour and xHarbour to run my
linux/gtxwc desktop apps and that I can use only Harbour for cgi/ajax
due to recent enhancements made by Przemek and the fantastic speed in
string management.
My Harbour version is the actual CVS one with some xHarbour/rtl
"ports" like tbrowse, teditor/memoedit, get system, menu system,
checkboxes and so on to support  C53b UI and to use HB_EXT_INKEY.

I'm using Harbour apps since few weeks in a test site and it is "perfect".
Phone is quite and errorlog is empty :)

best regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Wed May 23 07:19:18 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 23 07:19:21 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <9257026e0705230402yfacb08dxe799b95bb5ccff8c@mail.gmail.com>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523091108.GA13456@localhost.localdomain>
	<6999739D-64CB-4561-9A30-2C5EEBA9DF88@syenar.hu>
	<20070523094814.GB13456@localhost.localdomain>
	<9257026e0705230402yfacb08dxe799b95bb5ccff8c@mail.gmail.com>
Message-ID: <9257026e0705230419j5626fe66m393d0d91a0c4e511@mail.gmail.com>

On 5/23/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

> Phone is quite and errorlog is empty :)

Oops I meant  "Phone is quiet...".

regards,
Lorenzo
From philb at philb.us  Wed May 23 08:54:16 2007
From: philb at philb.us (Phil Barnett)
Date: Wed May 23 08:54:20 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <20070523094814.GB13456@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<6999739D-64CB-4561-9A30-2C5EEBA9DF88@syenar.hu>
	<20070523094814.GB13456@localhost.localdomain>
Message-ID: <200705230854.17034.philb@philb.us>

On Wednesday 23 May 2007 05:48, Przemyslaw Czerpak wrote:
> On Wed, 23 May 2007, Szak?ts Viktor wrote:
> > Hi Przemek,
> > I'm all for it. I was thinking along the same line while
> > fixing problems after syncing just a few files.
> > I think the current devel is stable enough to make it as
> > a new Beta.
> > Moreover it contains some minor incompatibilities
> > which are better to be published now while we're still
> > in Beta.
> > IMO, even new code can go into the Beta.
>
> It's not good practice and in normal situation I would vote against
> it but in fact current devel branch is probably better tested because
> more users (f.e people who also uses xHarbour) use it so maybe it's
> not bad idea. In devel branch we also have debugger borrowed from
> xHarbour with C HVM interface and many other Phil's extensions.
> For people who are using debugger it's very important feature. I can
> try to port it but it would be much easier to copy it with other HVM
> files. I would like to hear other people opinion. Phil?

Specifically, what is the new code that would be added?

-- 
Phil Barnett
AI4OF
SKCC #600
From druzus at priv.onet.pl  Wed May 23 09:09:52 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 09:10:28 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <200705230854.17034.philb@philb.us>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<6999739D-64CB-4561-9A30-2C5EEBA9DF88@syenar.hu>
	<20070523094814.GB13456@localhost.localdomain>
	<200705230854.17034.philb@philb.us>
Message-ID: <20070523130952.GA27311@localhost.localdomain>

On Wed, 23 May 2007, Phil Barnett wrote:
> Specifically, what is the new code that would be added?

1. set of extensions covered by HB_COMPAT_XHB
   they are disabled by default so they should not cause problems
2. some other extensions like multi line strings in PP which are disabled
   by default too.
3. some set of separate functions like checksum functions (CRC, MD5,...)
   INET functions, REGEX functions. They are in separated file and can
   be easy excluded if necessary
4. support for HASHes
5. separate compiler library which allow to create compiler binaries
   integrated with HVM and RTL - see new hbrun
6. new debugger code
7. some compile time optimizations
8. some speed improvements
9. some minor fixes which cannot be easy ported separately or we forgot
   about them
10. some minor extensions which should not interact with compatibility, f.e.
    new #pragma in PP with support for escaped strings
11. reorganized and cleaned RDD code - should not cause interactions with
    existing code

best regards,
Przemek
From druzus at priv.onet.pl  Wed May 23 10:00:24 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 10:01:00 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <20070523130952.GA27311@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<6999739D-64CB-4561-9A30-2C5EEBA9DF88@syenar.hu>
	<20070523094814.GB13456@localhost.localdomain>
	<200705230854.17034.philb@philb.us>
	<20070523130952.GA27311@localhost.localdomain>
Message-ID: <20070523140024.GA32038@localhost.localdomain>

On Wed, 23 May 2007, Przemyslaw Czerpak wrote:
> 1. set of extensions covered by HB_COMPAT_XHB
>    they are disabled by default so they should not cause problems
> 2. some other extensions like multi line strings in PP which are disabled
>    by default too.
> 3. some set of separate functions like checksum functions (CRC, MD5,...)
>    INET functions, REGEX functions. They are in separated file and can
>    be easy excluded if necessary
> 4. support for HASHes
> 5. separate compiler library which allow to create compiler binaries
>    integrated with HVM and RTL - see new hbrun
> 6. new debugger code
> 7. some compile time optimizations
> 8. some speed improvements
> 9. some minor fixes which cannot be easy ported separately or we forgot
>    about them
> 10. some minor extensions which should not interact with compatibility, f.e.
>     new #pragma in PP with support for escaped strings
> 11. reorganized and cleaned RDD code - should not cause interactions with
>     existing code

I forgot:
12. Multiline code blocks

IMHO only 3 and 4 and 12 are clear extensions only and if necessary I can
disable them but still it will be much easier to take current DEVEL code
and simply block them then trying to update BETA branch.

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Wed May 23 10:15:16 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May 23 10:15:51 2007
Subject: [Harbour] Bug in DBFCDX OrdKeyNo()
Message-ID: <018801c79d44$c949ea70$0100a8c0@emag>

>From a report on comp.lang.xharbour. This is the sample:

REQUEST DBFCDX


FUNCTION MAIN()

    RDDSETDEFAULT( "DBFCDX" )

    SET DELETED ON

    DBCREATE( "TMPTEST", { { "TEST", "C", 10, 0 } } )

    USE TMPTEST

    INDEX ON FIELD -> test TO TMPTEST

    APPEND BLANK

    REPLACE FIELD -> test WITH "Test 1"

    APPEND BLANK

    REPLACE FIELD -> test WITH "Test 2"

    DELETE

    APPEND BLANK

    REPLACE FIELD -> test WITH "Test 3"

    GO TOP

    ? RECNO(), ORDKEYNO()

    SKIP

    ? RECNO(), ORDKEYNO()

    CLOSE

    RETURN NIL

It should display (at least Clipper displays this)

1 1
3 3

(and it really does if you comment out RDDSETDEFAULT() call)

while it displays

1 1
3 2

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic
From dbtopas at dbtopas.lt  Wed May 23 10:27:39 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Wed May 23 10:24:07 2007
Subject: [Harbour] Hash in beta
In-Reply-To: <20070523091108.GA13456@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523091108.GA13456@localhost.localdomain>
Message-ID: <46544F5B.9040309@dbtopas.lt>

Przemyslaw Czerpak wrote:
> Victor, what do you think about syncing whole RTL tree
> without new code like HASH, CRC, INET?

Hello,


is discusion about HB_HAUTOADD() closed?

Or can we have
   #define HB_HAUTOADD_NEVER  (or _NONE)                    0
   #define HB_HAUTOADD_ASSIGN (or _SET)                     1
   #define HB_HAUTOADD_ALWAYS (or _GETSET, _ASSIGN_ACCESS)  2
?

Current .T./.F. can be synonyms for _ALWAYS/_NEVER.



Best regards,
Mindaugas
From druzus at priv.onet.pl  Wed May 23 10:31:56 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 10:32:33 2007
Subject: [Harbour] Bug in DBFCDX OrdKeyNo()
In-Reply-To: <018801c79d44$c949ea70$0100a8c0@emag>
References: <018801c79d44$c949ea70$0100a8c0@emag>
Message-ID: <20070523143156.GA32277@localhost.localdomain>

On Wed, 23 May 2007, Enrico Maria Giordano wrote:
> >From a report on comp.lang.xharbour. This is the sample:
> REQUEST DBFCDX
> FUNCTION MAIN()
>    RDDSETDEFAULT( "DBFCDX" )
>    SET DELETED ON
>    DBCREATE( "TMPTEST", { { "TEST", "C", 10, 0 } } )
>    USE TMPTEST
>    INDEX ON FIELD -> test TO TMPTEST
>    APPEND BLANK
>    REPLACE FIELD -> test WITH "Test 1"
>    APPEND BLANK
>    REPLACE FIELD -> test WITH "Test 2"
>    DELETE
>    APPEND BLANK
>    REPLACE FIELD -> test WITH "Test 3"
>    GO TOP
>    ? RECNO(), ORDKEYNO()
>    SKIP
>    ? RECNO(), ORDKEYNO()
>    CLOSE
>    RETURN NIL
> It should display (at least Clipper displays this)
> 
> 1 1
> 3 3
> 
> (and it really does if you comment out RDDSETDEFAULT() call)
> while it displays
> 
> 1 1
> 3 2

It's a known issue. In last 2 years I was writing about it 4 or more times.
It's an example which illustrates why we should not have pseudo set filter
optimization inside DBFCDX.
In CL5.3 you will have exactly the same results if you add:
    SET FILTER TO .T.
to the code above so it should not be anything amazing for Clipper users.

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Wed May 23 10:35:45 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May 23 10:36:21 2007
Subject: [Harbour] Bug in DBFCDX OrdKeyNo()
References: <018801c79d44$c949ea70$0100a8c0@emag>
	<20070523143156.GA32277@localhost.localdomain>
Message-ID: <01ed01c79d47$a5fa9490$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoledi 23 maggio 2007 16.31
Oggetto: Re: [Harbour] Bug in DBFCDX OrdKeyNo()


> It's a known issue. In last 2 years I was writing about it 4 or more times.

I'm very sorry.

> It's an example which illustrates why we should not have pseudo set filter
> optimization inside DBFCDX.
> In CL5.3 you will have exactly the same results if you add:
>    SET FILTER TO .T.
> to the code above so it should not be anything amazing for Clipper users.

Ok, thank you.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic
From makis1970 at gmail.com  Wed May 23 10:52:06 2007
From: makis1970 at gmail.com (Mike Evans (Gmail))
Date: Wed May 23 10:55:49 2007
Subject: [Harbour] Is RMDBFCDX and DBFBLOB supported by Harbour ?
Message-ID: <000301c79d49$f03ecf10$d0bc6d30$@com>

As subject.

 

Thanks in advance

Mike Evans

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070523/4e425fe0/attachment.html
From druzus at priv.onet.pl  Wed May 23 12:38:27 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 23 12:39:03 2007
Subject: [Harbour] Hash in beta
In-Reply-To: <46544F5B.9040309@dbtopas.lt>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523091108.GA13456@localhost.localdomain>
	<46544F5B.9040309@dbtopas.lt>
Message-ID: <20070523163827.GA579@localhost.localdomain>

On Wed, 23 May 2007, Mindaugas Kavaliauskas wrote:
> >Victor, what do you think about syncing whole RTL tree
> >without new code like HASH, CRC, INET?
> is discusion about HB_HAUTOADD() closed?

It's not closed.

> Or can we have
>   #define HB_HAUTOADD_NEVER  (or _NONE)                    0
>   #define HB_HAUTOADD_ASSIGN (or _SET)                     1
>   #define HB_HAUTOADD_ALWAYS (or _GETSET, _ASSIGN_ACCESS)  2

remember also about references:
    f( @h["key"] )
Should they be bound with ASSIGN (1), ACCESS (2) or maybe with
both ASSIGN+ACCESS (3) flags?.

> Current .T./.F. can be synonyms for _ALWAYS/_NEVER.

Yes, the question is also what should be default. IMHO NONE for
default build is reasonable.

best regards,
Przemek
From jorgeagiraldo at hotmail.com  Wed May 23 22:45:19 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Wed May 23 22:45:53 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
Message-ID: <BAY136-W2B520A611B0CA1FAF59DAA1340@phx.gbl>


Hi,Given that you are going to release beta 3, I decide to publish some of my test results:- The debugger is working fine except some features, it proves to be very useful.- There is a different method for calling the debugger, for example, in the alpha build 44 for a GUI app to bring up a console debug window you only needed to compile the module with the /b switch.  Now you have to play with the gtwin library, REQUEST HB_GT_NUL_DEFAULT and including Wait commands to make the debugger to read the Alt-D key press.  It took me some time to set up everything but I got it working nicely.  For some reason in alpha build 44 when using Windows XP, the debugger window dissapeared, perhaps there was a fix for this, but the beta 2 solved the problem.- The "Warning W0030  Duplicate variable 'N' in nested FOR loop"  was found in two places  where  I was having random and undesirable behaviors, very nice feature.- The Wrong assignment variable in a typed var detected some wrong use of parameters, very useful too.- I decided to take the challenge and release my new code using Beta 2, with a lot of new features and everything is working stable with a May 15th checkout (After Multi line codeblocks).- I'm aware of the multiple changes made in the code since Build 44 and is amazing everything is working without problems, good quality check.  Thanks to that I can reach my deadlines on time.Thank you all,Jorge A. > Date: Wed, 23 May 2007 16:00:24 +0200> From: druzus@priv.onet.pl> To: harbour@harbour-project.org> Subject: Re: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor	Szakats (harbour.01 syenar.hu)> > On Wed, 23 May 2007, Przemyslaw Czerpak wrote:> > 1. set of extensions covered by HB_COMPAT_XHB> >    they are disabled by default so they should not cause problems> > 2. some other extensions like multi line strings in PP which are disabled> >    by default too.> > 3. some set of separate functions like checksum functions (CRC, MD5,...)> >    INET functions, REGEX functions. They are in separated file and can> >    be easy excluded if necessary> > 4. support for HASHes> > 5. separate compiler library which allow to create compiler binaries> >    integrated with HVM and RTL - see new hbrun> > 6. new debugger code> > 7. some compile time optimizations> > 8. some speed improvements> > 9. some minor fixes which cannot be easy ported separately or we forgot> >    about them> > 10. some minor extensions which should not interact with compatibility, f.e.> >     new #pragma in PP with support for escaped strings> > 11. reorganized and cleaned RDD code - should not cause interactions with> >     existing code> > I forgot:> 12. Multiline code blocks> > IMHO only 3 and 4 and 12 are clear extensions only and if necessary I can> disable them but still it will be much easier to take current DEVEL code> and simply block them then trying to update BETA branch.> > best regards,> Przemek> _______________________________________________> Harbour mailing list> Harbour@harbour-project.org> http://lists.harbour-project.org/mailman/listinfo/harbour
_________________________________________________________________
Explore the seven wonders of the world
http://search.msn.com/results.aspx?q=7+wonders+world&mkt=en-US&form=QBRE
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070524/09216424/attachment.html
From philb at philb.us  Thu May 24 05:20:07 2007
From: philb at philb.us (Phil Barnett)
Date: Thu May 24 05:20:11 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <20070523140024.GA32038@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523130952.GA27311@localhost.localdomain>
	<20070523140024.GA32038@localhost.localdomain>
Message-ID: <200705240520.07382.philb@philb.us>

On Wednesday 23 May 2007 10:00, Przemyslaw Czerpak wrote:
> On Wed, 23 May 2007, Przemyslaw Czerpak wrote:
> > 1. set of extensions covered by HB_COMPAT_XHB
> >    they are disabled by default so they should not cause problems
> > 2. some other extensions like multi line strings in PP which are disabled
> >    by default too.
> > 3. some set of separate functions like checksum functions (CRC, MD5,...)
> >    INET functions, REGEX functions. They are in separated file and can
> >    be easy excluded if necessary
> > 4. support for HASHes
> > 5. separate compiler library which allow to create compiler binaries
> >    integrated with HVM and RTL - see new hbrun
> > 6. new debugger code
> > 7. some compile time optimizations
> > 8. some speed improvements
> > 9. some minor fixes which cannot be easy ported separately or we forgot
> >    about them
> > 10. some minor extensions which should not interact with compatibility,
> > f.e. new #pragma in PP with support for escaped strings
> > 11. reorganized and cleaned RDD code - should not cause interactions with
> >     existing code
>
> I forgot:
> 12. Multiline code blocks
>
> IMHO only 3 and 4 and 12 are clear extensions only and if necessary I can
> disable them but still it will be much easier to take current DEVEL code
> and simply block them then trying to update BETA branch.

Looks ok to me. I'll go for expediency at this time.

Thanks for all the great work you have been doing!

-- 
Phil Barnett
AI4OF
SKCC #600
From lorenzo.fiorini at gmail.com  Thu May 24 07:19:15 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 24 07:19:19 2007
Subject: [Harbour] contrib/pgsql issues, anyone interested?
Message-ID: <9257026e0705240419j6637f90enfd3aa6cb0cf19d1c@mail.gmail.com>

Using extensively contrib/pgsql I've some issues that IMHO need to be fixed.

If I'll not get any objections I'll change them both in Harbour and xHarbour.

best regards,
Lorenzo

1) Bof e Eof are now false when the recordset is empty ( no rows found )
This is a non-sense and bring many "row number z is out of range 0..x".
Instead Bof e Eof should be true in this case like in an empty dbf.

2) ?char colums are padded/trimmed.
In sql there can be "calculated" columns that have variable length.
Now if metadata report size 0 the class get the size of the column of
the 1st row which is wrong.
Also padding varchar columns should not be the default in many cases (
f.e. in html ) spaces are useless so add spaces and remove them is a
waste of resources.

3) Date transform actually is:
...
                tmp := 'yyyy-mm-dd'
                tmp := strtran( tmp, 'dd', substr(result, 9, 2) )
                tmp := strtran( tmp, 'mm', substr(result, 6, 2) )
                tmp := strtran( tmp, 'yyyy', left(result, 4) )
                cDateFmt := Set(_SET_DATEFORMAT, 'yyyy-mm-dd')
                result := CtoD(tmp)
                Set(_SET_DATEFORMAT, cDateFmt)
...
why not simply: result := StoD( strtran( result, "-", "" ) )

4) I'd like to add ::Read() method like Jdbc or Ado.Net. It can be
used to replace:
do while !oquery:eof()
   ...
   oquery:skip()
enddo

with a simpler:

do while oquery:read()
  ...
enddo
From dbtopas at dbtopas.lt  Thu May 24 09:00:07 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Thu May 24 08:56:33 2007
Subject: [Harbour] Hash in beta
In-Reply-To: <20070523163827.GA579@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>	<20070523091108.GA13456@localhost.localdomain>	<46544F5B.9040309@dbtopas.lt>
	<20070523163827.GA579@localhost.localdomain>
Message-ID: <46558C57.1030301@dbtopas.lt>

Hello,


>>Or can we have
>>  #define HB_HAUTOADD_NEVER  (or _NONE)                    0
>>  #define HB_HAUTOADD_ASSIGN (or _SET)                     1
>>  #define HB_HAUTOADD_ALWAYS (or _GETSET, _ASSIGN_ACCESS)  2
> 
> remember also about references:
>     f( @h["key"] )
> Should they be bound with ASSIGN (1), ACCESS (2) or maybe with
> both ASSIGN+ACCESS (3) flags?.

I see you are talking about even more flag choices, i.e., ACCESS without 
ASSIGN. I guess it will be used seldom, but it's good idea to implement 
such possibility and a complete flag list.

About references: if we can do lazy references, i.e.,
   proc donothing(x)
   return
   proc doassign(x)
      x := 1
   return
   proc doaccess(x)
      ? x
   return
   ...
   donothing( @h["key"] )  // do nothing (doesn't create new key)
   doassign( @h["key"] )   // equivalent to the h["key"] := 1
   doaccess( @h["key"] )   // equivalent to the ? h["key"]
then any flag (NEVER, ASSIGN, ACCESS, AWLWAYS) is meaningful to use.

But I guess we need to resolve reference on function call. In this case, 
I think both ASSIGN+ACCESS should be set to avoid RTE if key "key" is 
absent in the hash.

The same is for +=, etc. Both ASSIGN and ACCESS should be set.


> Yes, the question is also what should be default. IMHO NONE for
> default build is reasonable.

I also think it should be NONE for default build. And ASSIGN for 
HB_COMPAT_XHB.


Best regards,
Mindaugas
From dbtopas at dbtopas.lt  Thu May 24 09:08:16 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Thu May 24 09:04:42 2007
Subject: [Harbour] INET
Message-ID: <46558E40.6080703@dbtopas.lt>

Przemyslaw Czerpak wrote:
> Victor, what do you think about syncing whole RTL tree
> without new code like HASH, CRC, INET?


Hello,


I'd like to ask a question about asynchronous INET I/O. My applications
are Win32 GUI non-MT and sometimes I need to handle some UDP, TCP
connections. I'm using WSAAsyncSelect() and I get notification message 
via main message processing loop when some IP data is received.
[x]Harbour INET functions does not support such functionality like 
WSAAsyncSelect() and that is the reason I'm using my own socket library.

Is there a way to get some notification about on data is received? One 
of the ways I see is MT application with a thread waiting for network 
data. This thread can enqueue a notification message, or even do all 
network communication job itself in synchronous way.

What is practice to solve such tasks like in Linux enviroment (there 
WSAAsyncSelect() does not exists)? Is MT the only way?


Best regards,
Mindaugas

P.S. I have the same problem with serial ports. In Win16 I've used 
EnableCommNotification() to send WM_COMMNOTIFY. Win32 does not have this 
functionality, so I use light-weight C thread in "non-MT" [x]Harbour 
application to send notification messages.
From gerrylist at drouillard.ca  Thu May 24 10:05:09 2007
From: gerrylist at drouillard.ca (Gerald Drouillard)
Date: Thu May 24 10:05:04 2007
Subject: [Harbour] INET
In-Reply-To: <46558E40.6080703@dbtopas.lt>
References: <46558E40.6080703@dbtopas.lt>
Message-ID: <46559B95.30400@drouillard.ca>

Mindaugas Kavaliauskas wrote:
> Przemyslaw Czerpak wrote:
>> Victor, what do you think about syncing whole RTL tree
>> without new code like HASH, CRC, INET?
> 
> 
> Hello,
> 
> 
> I'd like to ask a question about asynchronous INET I/O. My applications
> are Win32 GUI non-MT and sometimes I need to handle some UDP, TCP
> connections. I'm using WSAAsyncSelect() and I get notification message 
> via main message processing loop when some IP data is received.
> [x]Harbour INET functions does not support such functionality like 
> WSAAsyncSelect() and that is the reason I'm using my own socket library.
> 
> Is there a way to get some notification about on data is received? One 
> of the ways I see is MT application with a thread waiting for network 
> data. This thread can enqueue a notification message, or even do all 
> network communication job itself in synchronous way.
> 
> What is practice to solve such tasks like in Linux enviroment (there 
> WSAAsyncSelect() does not exists)? Is MT the only way?
> 
> 
> Best regards,
> Mindaugas
Not sure libcurl would help you.  In xharbour there is a .prg/.c wrapper 
for the the .lib.  Curl is available on win and linux platforms.  I use 
curl mostly for "scraping" web sites and posting form data to remote web 
sites. Curl supports ssl.

-- 
Regards
--------------------------------------
Gerald Drouillard
Technology Architect
Drouillard & Associates, Inc.
http://www.Drouillard.ca
From sscc at mweb.co.za  Thu May 24 11:03:04 2007
From: sscc at mweb.co.za (Alex Strickland)
Date: Thu May 24 11:03:58 2007
Subject: [Harbour] INET
In-Reply-To: <46558E40.6080703@dbtopas.lt>
References: <46558E40.6080703@dbtopas.lt>
Message-ID: <4655A928.2010004@mweb.co.za>

Mindaugas Kavaliauskas wrote:

> I'd like to ask a question about asynchronous INET I/O. My applications
> are Win32 GUI non-MT and sometimes I need to handle some UDP, TCP
> connections. I'm using WSAAsyncSelect() and I get notification message 
> via main message processing loop when some IP data is received.
> [x]Harbour INET functions does not support such functionality like 
> WSAAsyncSelect() and that is the reason I'm using my own socket library.

I only added this for Windows :

//-----------------------------------------------------------------------------
//  int  WSAAsyncSelect( IN SOCKET s, IN HWND hWnd, IN u_int wMsg, IN 
long lEvent );

HB_FUNC( WSAASYNCSELECT )
{
    hb_retni( (int ) WSAAsyncSelect( (SOCKET) hb_parnl( 1 ) ,
                                     (HWND) hb_parnl( 2 )   ,
                                     (UINT) hb_parni( 3 )   ,
                                      hb_parnl( 4 )
                                   ) ) ;
}

and use all the rest of the INET library, so you need not use your own 
socket library. For Linux, without MT, I couldn't say.

I have a feeling I am not telling you anything you do not already know!

Alex
From miguelangel at marchuet.net  Thu May 24 12:41:27 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Thu May 24 12:41:36 2007
Subject: [Harbour] Bug in DBFCDX OrdKeyNo()
In-Reply-To: <20070523143156.GA32277@localhost.localdomain>
References: <018801c79d44$c949ea70$0100a8c0@emag>
	<20070523143156.GA32277@localhost.localdomain>
Message-ID: <4655C037.7050109@marchuet.net>

I think it's now fixed in BMDBFCDX from xharbour.

What do you thing about i port this solution to DBFCDX and BMDBFCDX of Harbour ?


/* ( DBENTRYP_L )     hb_cdxSkipFilter */
/*
 * Reposition cursor respecting any filter setting.
 */
ERRCODE hb_cdxSkipFilter( CDXAREAP pArea, LONG lUpDown )
{
   BOOL fBottom, fDeleted;
   ERRCODE uiError;

   HB_TRACE(HB_TR_DEBUG, ("hb_cdxSkipFilter(%p, %ld)", pArea, lUpDown));

   if( !hb_set.HB_SET_DELETED && pArea->dbfi.itmCobExpr == NULL )
      return SUCCESS;

   /* Since lToSkip is passed to SkipRaw, it should never request more than
      a single skip.
      The implied purpose of hb_cdxSkipFilter is to get off of a "bad" record
      after a skip was performed, NOT to skip lToSkip filtered records.
   */
   lUpDown = ( lUpDown < 0  ? -1 : 1 );

   /* remember if we are here after SELF_GOTOP() */
   fBottom = pArea->fBottom;

   while( !pArea->fBof && !pArea->fEof )
   {
      /* SET DELETED */
      if( hb_set.HB_SET_DELETED )
      {
         LPCDXTAG pTag = hb_cdxGetActiveTag( pArea );

         if( SELF_DELETED( (AREAP) pArea, &fDeleted ) != SUCCESS )
            return FAILURE;
         if( fDeleted )
         {
            if( SELF_SKIPRAW( (AREAP) pArea, lUpDown ) != SUCCESS )
               return FAILURE;
            else if ( pTag )
               pTag->logKeyPos += lUpDown; // <------------------------------------here is the correction
            continue;
         }
      }

      /* SET FILTER TO */
      if( pArea->dbfi.fFilter )
      {
         if( ! hb_cdxCheckRecordFilter( pArea, pArea->ulRecNo ) )
         {
            if( SELF_SKIPRAW( (AREAP) pArea, lUpDown ) != SUCCESS )
               return FAILURE;
            continue;
         }
      }

      break;
   }

   /*
    * The only one situation when we should repos is backward skipping
    * if we are at BOTTOM position (it's SKIPFILTER called from GOBOTTOM)
    * then GOEOF() if not then GOTOP()
    */
   if( pArea->fBof && lUpDown < 0 )
   {
      if( fBottom )
      {
         /* GOTO EOF (phantom) record -
            this is the only one place where GOTO is used by xHarbour
            directly and RDD which does not operate on numbers should
            serve this method only as SELF_GOEOF() synonym. If it's a
            problem then we can remove this if and always use SELF_GOTOP()
            but it also means second table scan if all records filtered
            are out of filter so I do not want to do that. I will prefer
            explicit add SELF_GOEOF() method
          */
         uiError = SELF_GOTO( (AREAP) pArea, 0 );
      }
      else
      {
         uiError = SELF_GOTOP( (AREAP) pArea );
         pArea->fBof = TRUE;
      }
   }
   else
   {
      uiError = SUCCESS;
   }

   return uiError;
}



Best regards,
Miguel Angel Marchuet
From druzus at priv.onet.pl  Thu May 24 19:20:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 24 19:21:08 2007
Subject: [Harbour] Hash in beta
In-Reply-To: <46558C57.1030301@dbtopas.lt>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523091108.GA13456@localhost.localdomain>
	<46544F5B.9040309@dbtopas.lt>
	<20070523163827.GA579@localhost.localdomain>
	<46558C57.1030301@dbtopas.lt>
Message-ID: <20070524232032.GA16390@localhost.localdomain>

On Thu, 24 May 2007, Mindaugas Kavaliauskas wrote:
> >> #define HB_HAUTOADD_NEVER  (or _NONE)                    0
> >> #define HB_HAUTOADD_ASSIGN (or _SET)                     1
> >> #define HB_HAUTOADD_ALWAYS (or _GETSET, _ASSIGN_ACCESS)  2
> >remember also about references:
> >    f( @h["key"] )
> >Should they be bound with ASSIGN (1), ACCESS (2) or maybe with
> >both ASSIGN+ACCESS (3) flags?.
> I see you are talking about even more flag choices, i.e., ACCESS without 
> ASSIGN. I guess it will be used seldom, but it's good idea to implement 
> such possibility and a complete flag list.

We do not have to allow all bit combinations.

> About references: if we can do lazy references, i.e.,
>   proc donothing(x)
>   return
>   proc doassign(x)
>      x := 1
>   return
>   proc doaccess(x)
>      ? x
>   return
>   ...
>   donothing( @h["key"] )  // do nothing (doesn't create new key)
>   doassign( @h["key"] )   // equivalent to the h["key"] := 1
>   doaccess( @h["key"] )   // equivalent to the ? h["key"]
> then any flag (NEVER, ASSIGN, ACCESS, AWLWAYS) is meaningful to use.

I will work on lazy references for OOP code but not now and even
when they will be ready I do not think we should use them in such
case due to performance reduction. There are also some situations
like detaching local variables when it will not be such clear.

> But I guess we need to resolve reference on function call.

or when array is created by code like:
    { @h["key"] }

> In this case, I think both ASSIGN+ACCESS should be set to avoid RTE
> if key "key" is absent in the hash.

seems reasonable when we are talking about @ operator,

> The same is for +=, etc. Both ASSIGN and ACCESS should be set.

it's natural but if you disable Harbour extensions in compiler (-kc)
then ACCESS flag will be enough to make <op>= working so it will have
to be documented.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May 24 19:28:27 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 24 19:29:02 2007
Subject: [Harbour] INET
In-Reply-To: <46558E40.6080703@dbtopas.lt>
References: <46558E40.6080703@dbtopas.lt>
Message-ID: <20070524232827.GB16390@localhost.localdomain>

On Thu, 24 May 2007, Mindaugas Kavaliauskas wrote:
> I'd like to ask a question about asynchronous INET I/O. My applications
> are Win32 GUI non-MT and sometimes I need to handle some UDP, TCP
> connections. I'm using WSAAsyncSelect() and I get notification message 
> via main message processing loop when some IP data is received.
> [x]Harbour INET functions does not support such functionality like 
> WSAAsyncSelect() and that is the reason I'm using my own socket library.
> 
> Is there a way to get some notification about on data is received? One 
> of the ways I see is MT application with a thread waiting for network 
> data. This thread can enqueue a notification message, or even do all 
> network communication job itself in synchronous way.
> 
> What is practice to solve such tasks like in Linux enviroment (there 
> WSAAsyncSelect() does not exists)? Is MT the only way?
>
> P.S. I have the same problem with serial ports. In Win16 I've used 
> EnableCommNotification() to send WM_COMMNOTIFY. Win32 does not have this 
> functionality, so I use light-weight C thread in "non-MT" [x]Harbour 
> application to send notification messages.

I know about this problem. In *nixes I use very simple solution:
select() works for all system handles (regular files, pipes, devices,
sockets, etc...) so in my application I use one common select() which
checks for incoming events. If you look at GTCRS code then you will
find that I added to this GT the possibilities to support asynchronously
read/write operations on any devices. I use similar code in my own
applications. If you can create sth like that for Windows then we
can define common for all GTs interface and implement it.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May 24 19:32:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 24 19:33:11 2007
Subject: [Harbour] Bug in DBFCDX OrdKeyNo()
In-Reply-To: <4655C037.7050109@marchuet.net>
References: <018801c79d44$c949ea70$0100a8c0@emag>
	<20070523143156.GA32277@localhost.localdomain>
	<4655C037.7050109@marchuet.net>
Message-ID: <20070524233235.GC16390@localhost.localdomain>

On Thu, 24 May 2007, Miguel Angel Marchuet wrote:
> I think it's now fixed in BMDBFCDX from xharbour.
> What do you thing about i port this solution to DBFCDX and BMDBFCDX of Harbour ?

You can make in BMDBFCDX what you want but please do not change DBFCDX.
This modifications is a work around for some special case (it does
not fixes many other situations) of problem which is caused by pseudo
SET FILTER optimization and will disappear when I'll remove it from
DBFCDX - just like it does not exist in DBFNTX.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May 24 19:35:36 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 24 19:36:12 2007
Subject: [Harbour] ChangeLog 2007-05-25 01:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070524233536.GA18507@localhost.localdomain>

2007-05-25 01:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbapi.h
  * harbour/include/hbexpra.c
  * harbour/source/macro/macro.y
  * harbour/source/macro/macro.yyc
  * harbour/source/macro/macrolex.c
  * harbour/source/vm/macro.c
    - removed hb_macroIsIdent()
    + added hb_macroTextSymbol()
    ! fixed old bug (it exists in all [x]Harbour versions) in macrocompiler
      which caused HVM stack corruption
    * generate from lexer symbols which are well formatted
      (uppercase and size <= HB_SYMBOL_NAME_LEN)
    % use hb_dynsymGetCase() instead of hb_dynsymGet()
    % some minor speed improvement

  * harbour/source/rtl/gtwin/gtwin.c
    % use hb_dynsymFind() instead of hb_dynsymFindName()

  * harbour/source/rdd/dbcmd.c
  * harbour/source/rdd/wafunc.c
    * reenabled by default strict clipper compatible behavior for
      code select(), dbSelectArea() and alias allocating

  * harbour/source/rdd/dbf1.c
    + added DBI_ISENCRYPTED for tables encrypted by SIX3

  * harbour/source/rtl/hbinet.c
    ! added missing break (Ron fix from xHarbour)

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Fri May 25 04:24:59 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri May 25 04:25:02 2007
Subject: [Harbour] HB_PCRE_REGEX and mingw/cross build
Message-ID: <9257026e0705250124of68db74g5a2cf69bf19cd3e4@mail.gmail.com>

I'm trying to get a working pcre for mingw/cross but it's not that
easy and I think that'll be even more complicate for other compilers
like openwatcom.

What about include pcre sources?

best regards,
Lorenzo
From miguelangel at marchuet.net  Fri May 25 04:48:35 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Fri May 25 04:48:42 2007
Subject: [Harbour] ChangeLog 2007-05-25 11:46 UTC+0100 Miguel Angel Marchuet
	(miguelangel/at/marchuet.net)
Message-ID: <4656A2E3.1000108@marchuet.net>

2007-05-25 11:46 UTC+0100 Miguel Angel Marchuet (miguelangel/at/marchuet.net)
  * contrib/bmdbfcdx/bmdbfcdx1.c
    * removed unnecesary code
    ! fixed bug on SKIP with SET DELETED ON when skips a deleted recno, OrdKeyNo was wrong.

Best regards,
Miguel Angel Marchuet
From druzus at priv.onet.pl  Fri May 25 06:55:56 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 25 06:56:32 2007
Subject: [Harbour] Hash in beta
In-Reply-To: <20070524232032.GA16390@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523091108.GA13456@localhost.localdomain>
	<46544F5B.9040309@dbtopas.lt>
	<20070523163827.GA579@localhost.localdomain>
	<46558C57.1030301@dbtopas.lt>
	<20070524232032.GA16390@localhost.localdomain>
Message-ID: <20070525105556.GA22551@localhost.localdomain>

I'm attaching for tests patch for current CVS which allows to control
AUTOADD in hash ACCESS/ASSIGN operation.
The following values are accepted by HB_HAUTOADD()

    #define HB_HASH_AUTOADD_NEVER       0
    #define HB_HASH_AUTOADD_ACCESS      1
    #define HB_HASH_AUTOADD_ASSIGN      2
    #define HB_HASH_AUTOADD_ALWAYS      ( HB_HASH_AUTOADD_ACCESS + HB_HASH_AUTOADD_ASSIGN )
    #define HB_HASH_AUTOADD_REFERENCE   HB_HASH_AUTOADD_ALWAYS

best regards,
Przemek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cvs.diff.gz
Type: application/x-gzip
Size: 2260 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070525/823cbed4/cvs.diff.gz
From harbour at rglab.pl  Fri May 25 07:05:24 2007
From: harbour at rglab.pl (=?iso-8859-2?Q?Ryszard_G=B3=B1b?=)
Date: Fri May 25 07:05:58 2007
Subject: [Harbour] INET
References: <46558E40.6080703@dbtopas.lt>
	<20070524232827.GB16390@localhost.localdomain>
Message-ID: <6610462e56bcad772e11ea7a9ec61d32.qmail@home.pl>

Przemyslaw Czerpak <druzus@priv.onet.pl> napisa?(a):
>> What is practice to solve such tasks like in Linux enviroment (there 
>> WSAAsyncSelect() does not exists)? Is MT the only way?
>> 
>> P.S. I have the same problem with serial ports. In Win16 I've used 
>> EnableCommNotification() to send WM_COMMNOTIFY. Win32 does not have 
>> this 
>> functionality, so I use light-weight C thread in "non-MT" [x]Harbour 
>> application to send notification messages.
> 
> I know about this problem. In *nixes I use very simple solution:
> select() works for all system handles (regular files, pipes, devices,
> sockets, etc...) so in my application I use one common select() which
> checks for incoming events. If you look at GTCRS code then you will
> find that I added to this GT the possibilities to support asynchronously
> read/write operations on any devices. I use similar code in my own
> applications. If you can create sth like that for Windows then we
> can define common for all GTs interface and implement it.

  
I am working now on event notification inside the main pcode loop. One
of event type that I have implemented so far is notification of signals
(on Linux currently). The second step (that I have already started) is
implementation of communication library (serial port first and sockets 
later) which will use event notofication. I plan to add this
communication library to 'contrib' directory because it will be based on
portable 'libevent' which uses select, poll, dev/poll, epoll etc. to
check for incoming events on registered file descriptors. I will commit
the code after the release of beta 3.
  
Current implementation the communication library will be run in
separate thread and sends events to the main thread with pcode loop.

Regards, Ryszard

From druzus at priv.onet.pl  Fri May 25 08:10:51 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 25 08:11:27 2007
Subject: [Harbour] Is RMDBFCDX and DBFBLOB supported by Harbour ?
In-Reply-To: <000301c79d49$f03ecf10$d0bc6d30$@com>
References: <000301c79d49$f03ecf10$d0bc6d30$@com>
Message-ID: <20070525121051.GB22551@localhost.localdomain>

On Wed, 23 May 2007, Mike Evans (Gmail) wrote:
> Subject: [Harbour] Is RMDBFCDX and DBFBLOB supported by Harbour ?

DBFBLOB is part of DBFFPT and is supported by both Harbour and xHarbour.
So far RMDBFCDX and RMDBFNTX is part of xHarbour.com distribution only.

best regards,
Przemek
From toninhofwi at yahoo.com.br  Fri May 25 08:11:17 2007
From: toninhofwi at yahoo.com.br (Toninho@fwi)
Date: Fri May 25 08:11:34 2007
Subject: [Harbour] ChangeLog 2007-05-25 01:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070524233536.GA18507@localhost.localdomain>
References: <20070524233536.GA18507@localhost.localdomain>
Message-ID: <mgkd5315c65lvbn0t7l36i7e62idgn3iav@4ax.com>

>    ! fixed old bug (it exists in all [x]Harbour versions) in macrocompiler
>      which caused HVM stack corruption

Przemek, thanks for the fix. Do you have a sample that show this
problem please?

Regards,

Toninho.


		
_______________________________________________________ 
Yahoo! Mail - Sempre a melhor opo para voc! 
Experimente j e veja as novidades. 
http://br.yahoo.com/mailbeta/tudonovo/
From druzus at priv.onet.pl  Fri May 25 08:59:20 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 25 08:59:56 2007
Subject: [Harbour] ChangeLog 2007-05-25 01:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <mgkd5315c65lvbn0t7l36i7e62idgn3iav@4ax.com>
References: <20070524233536.GA18507@localhost.localdomain>
	<mgkd5315c65lvbn0t7l36i7e62idgn3iav@4ax.com>
Message-ID: <20070525125920.GA29109@localhost.localdomain>

On Fri, 25 May 2007, Toninho@fwi wrote:
> >    ! fixed old bug (it exists in all [x]Harbour versions) in macrocompiler
> >      which caused HVM stack corruption
> Przemek, thanks for the fix. Do you have a sample that show this
> problem please?

This code should still exploit the problem in xHarbour and older
Harbour versions.

    /*** t1.prg ***/
    proc main()
    local s:="&f.y()"
    memvar f, xy
    private f:="X", xy:="ABC"
    ? &s
    return
    func xy()
    return "Helow!!!"

BTW if you plan to fix it in xHarbour then please look also at other
problems. In practice 95% of fixes done in Harbour in last two years
in compiler and macrocompiler should be also done in xHarbour. You
will find below few examples of other problems (memory leaks, GPFs,
HVM stack corruption, RTE, incompatible with Clipper results) but not all,
see the Harbour's ChangeLog notes for more. The last one (t8.prg) should
help you to fix recent dynamic symbol modifications in xHarbour.

best regards,
Przemek



    /*** t2.prg ***/
    proc main()
    memvar V1, V2
    local x
    private V1:="V", V2:="Hello!"
    x:={||&v1.2}
    ? eval( x )
    V1:="X"
    V2:="World!"
    ? eval( x )
    return


    /*** t3.prg ***/
    proc main()
    ? type("@user input")
    return


    /*** t4.prg ***/
    proc main()
    local s
    memvar v, v2
    private v, v2
    s:="&v.2 "
    v:="v"
    v2:="ABC"
    ? "["+s+"]"
    ? "["+&s+"]"
    ? &s(1)
    ? "."
    return
    func v2()
    return "V2()"


    /*** t5.prg ***/
    proc main()
    ? len(eval(&("{|x|IIF(x,'"+repl("1234567890",4000)+"','')}"),.f.))
    return


    /*** t6.prg ***/
    proc main()
    local o:=errorNew(), s:="genCode"
    o:&s++
    return


    /*** t7.prg ***/
    proc main()
    local s:="1,2"
    qout(&s,&s)
    return


    /*** t8.prg ***/
    proc main()
    test1()
    ? "==="
    test2()
    ? "==="
    test3()
    ? "==="
    test4()
    ? "==="
    return
    proc test1()
    local s, l
    l:=repl("q",66)+"2 "
    s:="&"+l
    ? &(l+":='"+l+"'")
    ? type(l), type(left(l,10)),type(left(l,62)),type(left(l,63)),type(left(l,64))
    ? "["+s+"]"
    ? "["+&s+"]"
    ? &s(1)
    return
    proc test2()
    local s, l
    memvar f
    private f:="F-VAR"
    l:=repl("p",66)+"2 "
    s:="&"+l
    ? &(l+":='f'")
    ? type(l), type(left(l,10)),type(left(l,62)),type(left(l,63)),type(left(l,64))
    ? "["+s+"]"
    ? "["+&s+"]"
    ? &s(1)
    return
    proc test3()
    local s
    memvar f
    private f:="xxxxx"
    s:="&f.qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq:='XQ'"
    ? s
    ? "["+&s+"]"
    s:="xxxxx"+repl("q",66)
    ? s
    ? "["+&s+"]"
    s:="&f.qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq()"
    ? s
    ? "["+&s+"]"
    return
    proc test4()
    local s
    memvar f
    private f:="xxxxx"
    s:="f."+repl("q",66)
    s:="&"+s+":='XQ'"
    ? s
    ? "["+&s+"]"
    s:="f."+repl("q",66)
    s:="&"+s
    ? s
    ? "["+&s()+"]"
    s:="f."+repl("q",66)
    s:="&"+s+"()"
    ? "***"
    s:="&"
    s+="f.qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq"
    ? s
    ? &s
    s+="()"
    ? s
    ? &s
    return
    func f()
    return "f(...)"
    func qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq()
    return "qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq(...)"
    func xxxxxqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq()
    return "xxxxxqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq(...)"
From toninhofwi at yahoo.com.br  Fri May 25 09:04:21 2007
From: toninhofwi at yahoo.com.br (Toninho@fwi)
Date: Fri May 25 09:04:36 2007
Subject: [Harbour] ChangeLog 2007-05-25 01:35 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
In-Reply-To: <20070525125920.GA29109@localhost.localdomain>
References: <20070524233536.GA18507@localhost.localdomain>
	<mgkd5315c65lvbn0t7l36i7e62idgn3iav@4ax.com>
	<20070525125920.GA29109@localhost.localdomain>
Message-ID: <0jnd53ppdh1si74sc6jd57a25ac2ifuui1@4ax.com>

>BTW if you plan to fix it in xHarbour then please look also at other
>problems. 

Thanks a lot. I?m only learn by the moment. Fix it is much for me ;)

Best regards,

Toninho.


		
_______________________________________________________ 
Yahoo! Mail - Sempre a melhor op??o para voc?! 
Experimente j? e veja as novidades. 
http://br.yahoo.com/mailbeta/tudonovo/
 

From druzus at priv.onet.pl  Fri May 25 09:06:45 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 25 09:07:20 2007
Subject: [Harbour] INET
In-Reply-To: <6610462e56bcad772e11ea7a9ec61d32.qmail@home.pl>
References: <46558E40.6080703@dbtopas.lt>
	<20070524232827.GB16390@localhost.localdomain>
	<6610462e56bcad772e11ea7a9ec61d32.qmail@home.pl>
Message-ID: <20070525130645.GA30267@localhost.localdomain>

On Fri, 25 May 2007, Ryszard G??b wrote:
> I am working now on event notification inside the main pcode loop. One
> of event type that I have implemented so far is notification of signals
> (on Linux currently). The second step (that I have already started) is
> implementation of communication library (serial port first and sockets 
> later) which will use event notofication. I plan to add this
> communication library to 'contrib' directory because it will be based on
> portable 'libevent' which uses select, poll, dev/poll, epoll etc. to
> check for incoming events on registered file descriptors. I will commit
> the code after the release of beta 3.
> Current implementation the communication library will be run in
> separate thread and sends events to the main thread with pcode loop.

Very good news. Global HVM notification system is something what I wanted
to have for a long time. A separate "inspector" thread can also help in many
other things. We should finally resolve problems like keyboard pooling in
main HVM loop or add xHarbour like background task without performance
reduction. Also GUI based GTs like GTWVT or GTXWC will refresh  screen
asynchronously. Many thanks.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Fri May 25 11:33:38 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri May 25 11:33:41 2007
Subject: [Harbour] Segfault compiling this wrong code
Message-ID: <9257026e0705250833g25c3ab6l9f40e2b6933e58e5@mail.gmail.com>

procedure main()

   local nRow

   @ 1, 1 get nRow picture "@ZE 999.99" valid { |o| o:Meth( "a", func(
a, b ) ) )

return

ChangeLog 2007-05-25 01:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)

F7-test4 gcc 4.1.2

best regards,
Lorenzo

Program received signal SIGSEGV, Segmentation fault.
0x080814bc in hb_pp_tokenSkipExp ()
(gdb) bt
#0  0x080814bc in hb_pp_tokenSkipExp ()
#1  0x08081cc6 in hb_pp_matchResultAdd ()
#2  0x0808324b in hb_pp_patternReplace ()
#3  0x0808400a in hb_pp_processCommand ()
#4  0x0808723b in hb_pp_preprocessToken ()
#5  0x0808826f in hb_pp_tokenGet ()
#6  0x08078065 in hb_complex ()
#7  0x08051bc8 in hb_compparse ()
#8  0x0804ee43 in hb_compCompile ()
#9  0x0804f455 in hb_compMain ()
#10 0x080497a7 in main ()
From druzus at priv.onet.pl  Fri May 25 17:49:47 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri May 25 17:50:25 2007
Subject: [Harbour] Segfault compiling this wrong code
In-Reply-To: <9257026e0705250833g25c3ab6l9f40e2b6933e58e5@mail.gmail.com>
References: <9257026e0705250833g25c3ab6l9f40e2b6933e58e5@mail.gmail.com>
Message-ID: <20070525214947.GA32685@localhost.localdomain>

On Fri, 25 May 2007, Lorenzo Fiorini wrote:
> procedure main()
>   local nRow
>   @ 1, 1 get nRow picture "@ZE 999.99" valid { |o| o:Meth( "a", func(
> a, b ) ) )
> return
> ChangeLog 2007-05-25 01:35 UTC+0200 Przemyslaw Czerpak 
> (druzus/at/priv.onet.pl)

> Program received signal SIGSEGV, Segmentation fault.

many thanks for info - mistake in one of recent modification, fixed.

best regards,
Przemek
From dbtopas at dbtopas.lt  Fri May 25 19:04:33 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Fri May 25 19:00:57 2007
Subject: [Harbour] INET
In-Reply-To: <20070524232827.GB16390@localhost.localdomain>
References: <46558E40.6080703@dbtopas.lt>
	<20070524232827.GB16390@localhost.localdomain>
Message-ID: <46576B81.8080701@dbtopas.lt>

Przemyslaw Czerpak wrote:
> On Thu, 24 May 2007, Mindaugas Kavaliauskas wrote:
>>I'd like to ask a question about asynchronous INET I/O. My applications
>>are Win32 GUI non-MT and sometimes I need to handle some UDP, TCP
>>connections. I'm using WSAAsyncSelect() and I get notification message 
>>via main message processing loop when some IP data is received.
>>[x]Harbour INET functions does not support such functionality like 
>>WSAAsyncSelect() and that is the reason I'm using my own socket library.
>>
>>Is there a way to get some notification about on data is received? One 
>>of the ways I see is MT application with a thread waiting for network 
>>data. This thread can enqueue a notification message, or even do all 
>>network communication job itself in synchronous way.
>>
>>What is practice to solve such tasks like in Linux enviroment (there 
>>WSAAsyncSelect() does not exists)? Is MT the only way?
>>
>>P.S. I have the same problem with serial ports. In Win16 I've used 
>>EnableCommNotification() to send WM_COMMNOTIFY. Win32 does not have this 
>>functionality, so I use light-weight C thread in "non-MT" [x]Harbour 
>>application to send notification messages.
> 
> 
> I know about this problem. In *nixes I use very simple solution:
> select() works for all system handles (regular files, pipes, devices,
> sockets, etc...) so in my application I use one common select() which
> checks for incoming events. If you look at GTCRS code then you will
> find that I added to this GT the possibilities to support asynchronously
> read/write operations on any devices. I use similar code in my own
> applications. If you can create sth like that for Windows then we
> can define common for all GTs interface and implement it.


Hello,


I've looked to GTCRS source, to Win32 docs, to Winsock docs and I can 
say majority of things I do not understand... :(

Let's start from GTCRS. If I've understood correctly, terminal 
communication is done via file handles (ex. mouse uses gpm_fd). 
Additional handles (like socket) and its events can be registred using 
gt_AddEventHandler.

In Win32 the similar could be done using ReadFile(), WriteFile() with 
OVERLAPPED structure. We must create event handler using CreateEvent(), 
put it into OVERLAPPED structure, call ReadFile()/WriteFile(, these 
functions will fail. Then call WaitForMultipleObject() with array of 
event handlers. After WaitForMultipleObjects() returns and we can see 
which event was triggered, i.e., which handle can be read/written.
ReadFile/WriteFile can socket handle, so I guess we can use 
WaitForMultipleObjects() to wait for both terminal io handles and socket 
handles, and do things like unix select() do.
There are a lot of open questions left, ex., how can I wait for connect 
or accept event. These functions does not have OVERLAPPED parameter. I 
also remember time I was writing a simple thread waiting for serial port 
event, and not everything was so simple, and examples from the net was 
not working as expected... I've put a lot of efforts to make this code work.

But what about GUI message loop. Messages do not arrive via "file" 
handle (or, does it on the unix?). So, how to wait for GUI app message 
and socket handle at the same time? I found MsgWaitForMultipleObjects() 
in Win32 which (I guess...) do this thing. But how can select() and 
gtk_main() be mixed on linux?


Best regards,
Mindaugas
From dbtopas at dbtopas.lt  Fri May 25 19:30:48 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Fri May 25 19:27:11 2007
Subject: [Harbour] INET
In-Reply-To: <46576B81.8080701@dbtopas.lt>
References: <46558E40.6080703@dbtopas.lt>	<20070524232827.GB16390@localhost.localdomain>
	<46576B81.8080701@dbtopas.lt>
Message-ID: <465771A8.4010405@dbtopas.lt>

Mindaugas Kavaliauskas wrote:
> But what about GUI message loop. Messages do not arrive via "file" 
> handle (or, does it on the unix?). So, how to wait for GUI app message 
> and socket handle at the same time? I found MsgWaitForMultipleObjects() 
> in Win32 which (I guess...) do this thing. But how can select() and 
> gtk_main() be mixed on linux?

Hi again,


google query "select gtk_main" was a good idea. Everything is clear now. 
If anyone is interested also, you can find good description at 
http://developer.gnome.org/doc/GGAD/sec-mainloop.html

I must think how this could be done on Windows before I drop it... :)

CreateEvent() + ReadFile() + MsgWaitForMultipleObject() + 
GetOverlappedResult() logic seems to be much more compilcated than 
select() + read().


Good night,
Mindaugas
From druzus at priv.onet.pl  Sat May 26 03:06:07 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 26 03:06:43 2007
Subject: [Harbour] ChangeLog 2007-05-26 09:05 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070526070607.GA13453@localhost.localdomain>

2007-05-26 09:05 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/pp/ppcore.c
    ! fixed bug reported by Lorenzo

  * harbour/contrib/rdd_ads/ads1.c
    * changed static variable name from iSetListenerHandle to
      s_iSetListenerHandle to keep common naming convention

  * harbour/include/hbapi.h
  * harbour/source/vm/hashes.c
  * harbour/source/vm/hashfunc.c
  * harbour/source/vm/hvm.c
    + added new 3-rd parameter to hb_hashGetItemPtr() to control
      independently hash autoadd behavior in access/assign operation

  * harbour/include/hbrdddbf.h
  * harbour/include/hbrddntx.h
  * harbour/source/rdd/dbfntx/dbfntx1.c
    * moved static variables holding RDDI_* settings to RDDNODE data so
      they can be set separately for each RDD which inherits from DBFNTX

  * harbour/source/vm/classes.c
    + added disabled code to access hash items using messages

  * harbour/source/vm/garbage.c
    * comment

best regards,
Przemek
From druzus at priv.onet.pl  Sat May 26 04:06:37 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 26 04:07:15 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <200705240520.07382.philb@philb.us>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523130952.GA27311@localhost.localdomain>
	<20070523140024.GA32038@localhost.localdomain>
	<200705240520.07382.philb@philb.us>
Message-ID: <20070526080637.GA1769@localhost.localdomain>

On Thu, 24 May 2007, Phil Barnett wrote:
> Looks ok to me. I'll go for expediency at this time.

The final question.
Should I remove current BETA1 branch and create new one from current
DEVEL code I should rather use existing BETA1 and simply update it.

best regards,
Przemek
From druzus at priv.onet.pl  Sat May 26 04:10:00 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat May 26 04:10:34 2007
Subject: [Harbour] ChangeLog 2007-05-26 09:05 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070526070607.GA13453@localhost.localdomain>
References: <20070526070607.GA13453@localhost.localdomain>
Message-ID: <20070526081000.GB1769@localhost.localdomain>

On Sat, 26 May 2007, Przemyslaw Czerpak wrote:
>   * harbour/include/hbapi.h
>   * harbour/source/vm/hashes.c
>   * harbour/source/vm/hashfunc.c
>   * harbour/source/vm/hvm.c
>     + added new 3-rd parameter to hb_hashGetItemPtr() to control
>       independently hash autoadd behavior in access/assign operation

    #define HB_HASH_AUTOADD_NEVER       0x00
    #define HB_HASH_AUTOADD_ACCESS      0x01
    #define HB_HASH_AUTOADD_ASSIGN      0x02
    #define HB_HASH_AUTOADD_ALWAYS      ( HB_HASH_AUTOADD_ACCESS + HB_HASH_AUTOADD_ASSIGN )
    #define HB_HASH_AUTOADD_REFERENCE   HB_HASH_AUTOADD_ALWAYS

Two question:
1. where should I add above .prg constant definitions?
2. are the above names correct for you?
   maybe you prefer different names, f.e. HB_HAUTOADD_*

best regards,
Przemek
From antonioharbour at gmail.com  Sat May 26 04:27:35 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sat May 26 04:28:00 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 ViktorSzakats
	(harbour.01 syenar.hu)
In-Reply-To: <20070526080637.GA1769@localhost.localdomain>
Message-ID: <4657ef8a.33ede7f2.071f.ffffb91f@mx.google.com>

> Should I remove current BETA1 branch and create new one from current DEVEL
code

Yes, please

Regards,

Antonio

From esgici at gmail.com  Sun May 27 08:56:04 2007
From: esgici at gmail.com (Bicahi Esgici)
Date: Sun May 27 08:56:09 2007
Subject: [Harbour] Viva Clipper
Message-ID: <d4ce00e70705270556g469626b9r20ec8895bc405131@mail.gmail.com>

Hi to all

You are invited to my internet site / pages :

  http://vivaclipper.googlepages.com

I hope that it will be usefull for testing Harbour new releases and/or
changes in Win32 environement.

Best Regards.


Bicahi Esgici

-- 
esgici
From druzus at priv.onet.pl  Mon May 28 03:54:08 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 03:54:45 2007
Subject: [Harbour] ChangeLog 2007-05-28 09:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070528075408.GA19652@localhost.localdomain>

2007-05-28 09:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/make_xmingw.sh
  * harbour/source/pp/Makefile
    * recent xHarbour fixes for MinGW Linux->W32 cross build by Phil Krylow
      with small modifications

  * harbour/config/rules.cf
    + added rules for C++ files

  * harbour/include/hbapi.h
  * harbour/source/vm/arrays.c
    + added hb_arraySetForward()

  * harbour/include/hbapi.h
  * harbour/source/rtl/strmatch.c
    + added hb_strMatchFile() - compare two strings using platform dependent
      rules for file matching, respects platform dependent wildcards
    + added hb_strMatchCaseWildExact() - compare two strings using pattern
      with wildcard (?*) ignoring the case of the characters - patern have
      to cover whole string
    * changed hb_strMatchRegExp() to use real reguar expresions, if build
      does not support regex then redirected to hb_strMatchWildExact()
    - removed not longer used hb_strMatchDOS() - in fact it was neither DOS
      nor classic wildcards (?*) compatible

  * harbour/source/common/hbstr.c
    ! casting to avoid possible problem on platforms where toupper does not
      accept negative char value

  * harbour/include/hbcomp.h
  * harbour/source/compiler/hbcomp.c
  * harbour/source/compiler/hbmain.c
    * minor modifications in cleanup functions

  * harbour/source/rtl/hbffind.c
    * use hb_strMatchFile()

  * harbour/source/vm/memvars.c
    * use hb_strMatchCaseWildExact() instead of hb_strMatchRegExp()
      I still keep the hack which translates any mask starting with '*'
      to "*" but if you think that we should fully respect wildcards
      patterns then we should remove it from function hb_memvarGetMask()
      Opinions?


Hi All,

Please make tests - I would like to make from the current code BETA3
release ASAP.

best regards,
Przemek
From m.renzi at maticasrl.it  Mon May 28 04:03:38 2007
From: m.renzi at maticasrl.it (Massimo Renzi (MaticaSrl))
Date: Mon May 28 04:06:29 2007
Subject: R: [Harbour] Viva Clipper
In-Reply-To: <d4ce00e70705270556g469626b9r20ec8895bc405131@mail.gmail.com>
References: <d4ce00e70705270556g469626b9r20ec8895bc405131@mail.gmail.com>
Message-ID: <005101c7a0fe$b31eb560$6cb96305@maxsoft>

Thank you very very much,
It's a great job.

Max


-----Messaggio originale-----
Da: harbour-bounces@harbour-project.org
[mailto:harbour-bounces@harbour-project.org] Per conto di Bicahi Esgici
Inviato: domenica 27 maggio 2007 14.56
A: harbour@harbour-project.org
Oggetto: [Harbour] Viva Clipper

Hi to all

You are invited to my internet site / pages :

  http://vivaclipper.googlepages.com

I hope that it will be usefull for testing Harbour new releases and/or
changes in Win32 environement.

Best Regards.


Bicahi Esgici

-- 
esgici
_______________________________________________
Harbour mailing list
Harbour@harbour-project.org
http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Mon May 28 04:23:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 04:24:08 2007
Subject: [Harbour] Viva Clipper
In-Reply-To: <d4ce00e70705270556g469626b9r20ec8895bc405131@mail.gmail.com>
References: <d4ce00e70705270556g469626b9r20ec8895bc405131@mail.gmail.com>
Message-ID: <20070528082332.GA21191@localhost.localdomain>

On Sun, 27 May 2007, Bicahi Esgici wrote:
> Hi to all
> You are invited to my internet site / pages :
>  http://vivaclipper.googlepages.com
> I hope that it will be usefull for testing Harbour new releases and/or
> changes in Win32 environement.

The platform list is much wider then the one you presented, in practice
Harbour can be build on most *nixes, for sure on Solaris and HPUX but I
do not see any reason why it should not work on SCO or AIX though
personally I haven't tested such builds - maybe someone here?
The Harbour code is machine independent so Harbour should work on little
and big endian machines (PDP endian is not supported yet but it's very
hard to find such machines in current days) with any memory address size
(f.e. 32 or 64 bit). On all this platform Harbour can share the same
PCODE files and database files which are binary compatible.
Current limitations are:
  1. missing support for machines with differ then 8 bit character size.
  2. some code cannot work with non ASCII based machines
In both cases I can quite easy adopt Harbour for such machines but it
will be necessary to drop some binary compatibility so I haven't try
to eliminate these limitations so far.

best regards,
Przemek
From druzus at priv.onet.pl  Mon May 28 08:02:00 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 08:02:36 2007
Subject: [Harbour] ChangeLog 2007-05-28 14:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070528120200.GA14943@localhost.localdomain>

2007-05-28 14:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/debug/Makefile
  - harbour/source/debug/dbgaltd.prg
    - removed repeated ALTD() implementation

best regards,
Przemek
From druzus at priv.onet.pl  Mon May 28 08:09:39 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 08:10:17 2007
Subject: [Harbour] ChangeLog BETA 2007-05-28 14:03 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
Message-ID: <20070528120939.GB14943@localhost.localdomain>

2007-05-28 14:03 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/ChangeLog.017
  * harbour/doc/en/lang.txt
    * Synced with devel branch.

2007-05-28 13:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/TODO
  * harbour/common.mak
  * harbour/harbour.spec
  * harbour/hbgtmk.sh
  * harbour/make_gnu.cmd
  * harbour/make_xmingw.sh
  * harbour/makefile.bc
  * harbour/makefile.vc
  * harbour/bin/bld.bat
  * harbour/bin/hb-func.sh
  * harbour/bin/pack_src.sh
  * harbour/config/global.cf
  * harbour/config/rules.cf
  * harbour/config/os2/gcc.cf
  * harbour/config/w32/mingw32.cf
  * harbour/config/w32/watcom.cf
  * harbour/config/w32/xcc.cf
  * harbour/contrib/Makefile
  + harbour/contrib/adordd/access1.prg
  + harbour/contrib/adordd/access2.prg
  + harbour/contrib/adordd/adordd.ch
  + harbour/contrib/adordd/adordd.prg
  + harbour/contrib/adordd/make_b32.bat
  + harbour/contrib/adordd/makefile.bc
  + harbour/contrib/adordd/mysql1.prg
  + harbour/contrib/adordd/mysql3.prg
  + harbour/contrib/bmdbfcdx/Makefile
  + harbour/contrib/bmdbfcdx/bmdbfcdx1.c
  + harbour/contrib/bmdbfcdx/bmsixcdx1.c
  + harbour/contrib/bmdbfcdx/hbrddbmcdx.h
  + harbour/contrib/bmdbfcdx/make_b32.bat
  + harbour/contrib/bmdbfcdx/makefile.bc
  + harbour/contrib/bmdbfcdx/readme.txt
  * harbour/contrib/btree/makefile.bc
  + harbour/contrib/gd/ChangeLog
  + harbour/contrib/gd/Makefile
  + harbour/contrib/gd/README
  + harbour/contrib/gd/gd.ch
  + harbour/contrib/gd/gd.prg
  + harbour/contrib/gd/gdbar.prg
  + harbour/contrib/gd/gdbarcod.prg
  + harbour/contrib/gd/gdchart.prg
  + harbour/contrib/gd/gdexternal.ch
  + harbour/contrib/gd/gdimage.prg
  + harbour/contrib/gd/gdwrp.c
  + harbour/contrib/gd/make_b32.bat
  + harbour/contrib/gd/makefile.bc
  + harbour/contrib/gd/doc/COPYING
  + harbour/contrib/gd/doc/hbgd.txt
  + harbour/contrib/gd/include/entities.h
  + harbour/contrib/gd/include/gd.h
  + harbour/contrib/gd/include/gd_io.h
  + harbour/contrib/gd/include/gdcache.h
  + harbour/contrib/gd/include/gdfontg.h
  + harbour/contrib/gd/include/gdfontl.h
  + harbour/contrib/gd/include/gdfontmb.h
  + harbour/contrib/gd/include/gdfonts.h
  + harbour/contrib/gd/include/gdfontt.h
  + harbour/contrib/gd/include/gdfx.h
  + harbour/contrib/gd/include/gdhelpers.h
  + harbour/contrib/gd/include/jisx0208.h
  + harbour/contrib/gd/include/wbmp.h
  + harbour/contrib/gd/tests/animgif.prg
  + harbour/contrib/gd/tests/antialiased.prg
  + harbour/contrib/gd/tests/barms.prg
  + harbour/contrib/gd/tests/bartest.prg
  + harbour/contrib/gd/tests/bldtest.bat
  + harbour/contrib/gd/tests/bldtest.sh
  + harbour/contrib/gd/tests/counter.prg
  + harbour/contrib/gd/tests/gdtest.prg
  + harbour/contrib/gd/tests/gdtestcls.prg
  + harbour/contrib/gd/tests/test_out.prg
  + harbour/contrib/gd/tests/testdpi.prg
  + harbour/contrib/gd/tests/tostring.prg
  + harbour/contrib/gd/tests/digits/57chevy.gif
  + harbour/contrib/gd/tests/digits/7seg.gif
  + harbour/contrib/gd/tests/digits/brsd.gif
  + harbour/contrib/gd/tests/digits/digib.gif
  + harbour/contrib/gd/tests/digits/fdb.gif
  + harbour/contrib/gd/tests/digits/jelly.gif
  + harbour/contrib/gd/tests/digits/odb.gif
  + harbour/contrib/gd/tests/digits/odw.gif
  + harbour/contrib/gd/tests/digits/pdg.gif
  + harbour/contrib/gd/tests/digits/pdw.gif
  + harbour/contrib/gd/tests/images_in/conv_test.jpeg
  + harbour/contrib/gd/tests/images_in/gdlogobig.png
  + harbour/contrib/gd/tests/images_in/theclipper.gif
  + harbour/contrib/gd/tests/images_out/EMPTY
  * harbour/contrib/hgf/os2pm/tform.prg
  * harbour/contrib/htmllib/Makefile.bc
  * harbour/contrib/htmllib/counter.prg
  * harbour/contrib/htmllib/htmbrows.prg
  * harbour/contrib/htmllib/jwindow.prg
  * harbour/contrib/htmllib/makefile.vc
  * harbour/contrib/htmllib/ocgi.prg
  * harbour/contrib/htmllib/oedit.prg
  * harbour/contrib/htmllib/ofile.prg
  * harbour/contrib/htmllib/ohtm.prg
  * harbour/contrib/htmllib/oini.prg
  * harbour/contrib/libct/Makefile
  * harbour/contrib/libct/addascii.c
  - harbour/contrib/libct/bit1.c
  - harbour/contrib/libct/bit2.c
  - harbour/contrib/libct/bit3.c
  + harbour/contrib/libct/bitnum.c
  + harbour/contrib/libct/ctextern.ch
  + harbour/contrib/libct/ctmath2.c
  + harbour/contrib/libct/ctnet.c
  * harbour/contrib/libct/ctwfunc.c
  * harbour/contrib/libct/ctwin.c
  * harbour/contrib/libct/ctwin.h
  * harbour/contrib/libct/makefile.bc
  * harbour/contrib/libct/makefile.vc
  - harbour/contrib/libct/math.c
  * harbour/contrib/libgt/makefile.bc
  * harbour/contrib/libgt/makefile.vc
  * harbour/contrib/libmisc/hb_f.c
  * harbour/contrib/libmisc/makefile.bc
  * harbour/contrib/libmisc/makefile.vc
  * harbour/contrib/libnf/aading.prg
  * harbour/contrib/libnf/aredit.prg
  * harbour/contrib/libnf/clrsel.prg
  * harbour/contrib/libnf/dispmsg.prg
  * harbour/contrib/libnf/eltime.prg
  * harbour/contrib/libnf/floptst.prg
  * harbour/contrib/libnf/makefile.vc
  * harbour/contrib/libnf/menu1.prg
  * harbour/contrib/libnf/mouse1.prg
  * harbour/contrib/libnf/nanfor.bc
  * harbour/contrib/libnf/pegs.prg
  * harbour/contrib/libnf/popadder.prg
  * harbour/contrib/libnf/savesets.prg
  * harbour/contrib/libnf/tbwhile.prg
  * harbour/contrib/libnf/xbox.prg
  * harbour/contrib/odbc/todbc.prg
  * harbour/contrib/ole/oleauto.prg
  + harbour/contrib/ole2/Makefile
  + harbour/contrib/ole2/make_b32.bat
  + harbour/contrib/ole2/makefile.bc
  + harbour/contrib/ole2/w32ole.c
  + harbour/contrib/ole2/win32ole.prg
  + harbour/contrib/pgsql/Changelog
  + harbour/contrib/pgsql/Makefile
  + harbour/contrib/pgsql/README
  + harbour/contrib/pgsql/make_b32.bat
  + harbour/contrib/pgsql/makefile.bc
  + harbour/contrib/pgsql/pgrdd.prg
  + harbour/contrib/pgsql/postgres.c
  + harbour/contrib/pgsql/postgres.ch
  + harbour/contrib/pgsql/tpostgre.prg
  + harbour/contrib/pgsql/tstpgrdd.prg
  + harbour/contrib/pgsql/tests/Makefile
  + harbour/contrib/pgsql/tests/async.prg
  + harbour/contrib/pgsql/tests/cache.prg
  + harbour/contrib/pgsql/tests/dbf2pg.prg
  + harbour/contrib/pgsql/tests/simple.prg
  + harbour/contrib/pgsql/tests/stress.prg
  + harbour/contrib/pgsql/tests/test.prg
  * harbour/contrib/rdd_ads/Makefile
  * harbour/contrib/rdd_ads/ads1.c
  * harbour/contrib/rdd_ads/adsfunc.c
  * harbour/contrib/rdd_ads/makefile.bc
  * harbour/contrib/samples/dbf.c
  + harbour/contrib/samples/make_b32.bat
  + harbour/contrib/samples/make_vc.bat
  * harbour/contrib/samples/makefile.bc
  * harbour/contrib/samples/makefile.vc
  - harbour/contrib/samples/makevc.bat
  * harbour/contrib/samples/time.c
  + harbour/contrib/tip/Changelog
  + harbour/contrib/tip/Makefile
  + harbour/contrib/tip/base64x.c
  + harbour/contrib/tip/cgi.prg
  + harbour/contrib/tip/client.prg
  + harbour/contrib/tip/credent.prg
  + harbour/contrib/tip/cstr.prg
  + harbour/contrib/tip/encb64.prg
  + harbour/contrib/tip/encmthd.c
  + harbour/contrib/tip/encoder.prg
  + harbour/contrib/tip/encqp.prg
  + harbour/contrib/tip/encurl.prg
  + harbour/contrib/tip/ftpcln.prg
  + harbour/contrib/tip/hbhex2n.c
  + harbour/contrib/tip/httpcln.prg
  + harbour/contrib/tip/mail.prg
  + harbour/contrib/tip/popcln.prg
  + harbour/contrib/tip/smtpcln.prg
  + harbour/contrib/tip/tip.ch
  + harbour/contrib/tip/url.prg
  + harbour/contrib/tip/utils.c
  * harbour/doc/dirstruc.txt
  * harbour/doc/es/hb_apiln.txt
  * harbour/include/Makefile
  * harbour/include/box.ch
  * harbour/include/common.ch
  * harbour/include/error.ch
  * harbour/include/hbapi.h
  * harbour/include/hbapicdp.h
  * harbour/include/hbapicls.h
  + harbour/include/hbapidbg.h
  * harbour/include/hbapifs.h
  * harbour/include/hbapigt.h
  * harbour/include/hbapiitm.h
  * harbour/include/hbapilng.h
  * harbour/include/hbapirdd.h
  + harbour/include/hbchksum.h
  * harbour/include/hbclass.ch
  * harbour/include/hbcommon.ch
  * harbour/include/hbcomp.h
  + harbour/include/hbcompat.ch
  * harbour/include/hbcompdf.h
  * harbour/include/hbdebug.ch
  * harbour/include/hbdefs.h
  * harbour/include/hbexpra.c
  * harbour/include/hbexprb.c
  - harbour/include/hbexprc.c
  * harbour/include/hbexprop.h
  * harbour/include/hbextern.ch
  * harbour/include/hbgetcmt.ch
  * harbour/include/hbgtcore.h
  * harbour/include/hbgtinfo.ch
  * harbour/include/hbmacro.h
  * harbour/include/hboo.ch
  * harbour/include/hbpcode.h
  * harbour/include/hbpp.h
  * harbour/include/hbrdddbf.h
  * harbour/include/hbrddntx.h
  - harbour/include/hbrddwrk.h
  + harbour/include/hbregex.h
  * harbour/include/hbset.h
  * harbour/include/hbsetup.ch
  * harbour/include/hbsetup.h
  * harbour/include/hbstack.h
  * harbour/include/hbstdgen.ch
  * harbour/include/hbtypes.h
  * harbour/include/hbvmpub.h
  * harbour/include/hbxvm.h
  * harbour/include/ord.ch
  * harbour/include/set.ch
  * harbour/include/std.ch
  * harbour/source/Makefile
  * harbour/source/codepage/Makefile
  * harbour/source/codepage/cp_tpl.c
  * harbour/source/codepage/cpbg866.c
  * harbour/source/codepage/cpbgiso.c
  * harbour/source/codepage/cpbgwin.c
  * harbour/source/codepage/cpcs852.c
  * harbour/source/codepage/cpcsiso.c
  * harbour/source/codepage/cpcskam.c
  * harbour/source/codepage/cpcswin.c
  * harbour/source/codepage/cpeldos.c
  * harbour/source/codepage/cpelwin.c
  * harbour/source/codepage/cpesdos.c
  * harbour/source/codepage/cpesmwi.c
  * harbour/source/codepage/cpeswin.c
  * harbour/source/codepage/cpfrdos.c
  * harbour/source/codepage/cpgedos.c
  * harbour/source/codepage/cpgewin.c
  * harbour/source/codepage/cphr1250.c
  * harbour/source/codepage/cphr437.c
  * harbour/source/codepage/cphr852.c
  * harbour/source/codepage/cphu852.c
  + harbour/source/codepage/cphu852s.c
  * harbour/source/codepage/cphuiso.c
  + harbour/source/codepage/cphuisos.c
  * harbour/source/codepage/cphuwin.c
  + harbour/source/codepage/cphuwins.c
  * harbour/source/codepage/cpit437.c
  * harbour/source/codepage/cpit850.c
  * harbour/source/codepage/cpitisb.c
  * harbour/source/codepage/cpitiso.c
  * harbour/source/codepage/cpltwin.c
  * harbour/source/codepage/cppl852.c
  * harbour/source/codepage/cppliso.c
  * harbour/source/codepage/cpplmaz.c
  * harbour/source/codepage/cpplwin.c
  * harbour/source/codepage/cppt850.c
  * harbour/source/codepage/cpptiso.c
  * harbour/source/codepage/cpru866.c
  * harbour/source/codepage/cprukoi.c
  * harbour/source/codepage/cpruwin.c
  * harbour/source/codepage/cpsl437.c
  * harbour/source/codepage/cpsl852.c
  * harbour/source/codepage/cpsliso.c
  * harbour/source/codepage/cpslwin.c
  * harbour/source/codepage/cpsrwin.c
  * harbour/source/codepage/cptrdos.c
  * harbour/source/codepage/cptrwin.c
  * harbour/source/codepage/cpua866.c
  * harbour/source/codepage/cpuakoi.c
  * harbour/source/codepage/cpuawin.c
  * harbour/source/codepage/uc1250.c
  * harbour/source/codepage/uc1251.c
  * harbour/source/codepage/uc1253.c
  * harbour/source/codepage/uc1254.c
  * harbour/source/codepage/uc1257.c
  * harbour/source/codepage/uc737.c
  * harbour/source/codepage/uc850.c
  * harbour/source/codepage/uc852.c
  * harbour/source/codepage/uc857.c
  * harbour/source/codepage/uc866.c
  * harbour/source/codepage/uc88591b.c
  * harbour/source/codepage/uc8859_1.c
  * harbour/source/codepage/uc8859_2.c
  * harbour/source/codepage/uc8859_5.c
  * harbour/source/codepage/uckam.c
  * harbour/source/codepage/uckoi8.c
  * harbour/source/codepage/uckoi8u.c
  * harbour/source/codepage/ucmaz.c
  * harbour/source/common/expropt1.c
  * harbour/source/common/expropt2.c
  * harbour/source/common/hbdate.c
  * harbour/source/common/hbhash.c
  * harbour/source/common/hbstr.c
  * harbour/source/compiler/Makefile
  * harbour/source/compiler/cmdcheck.c
  * harbour/source/compiler/complex.c
  - harbour/source/compiler/exproptc.c
  * harbour/source/compiler/genc.c
  * harbour/source/compiler/gencc.c
  * harbour/source/compiler/gencli.c
  * harbour/source/compiler/gencobj.c
  * harbour/source/compiler/genhrb.c
  * harbour/source/compiler/genobj32.c
  - harbour/source/compiler/harbour.c
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/compiler/harbour.yyh
  + harbour/source/compiler/hbcmplib.c
  * harbour/source/compiler/hbcomp.c
  + harbour/source/compiler/hbdbginf.c
  * harbour/source/compiler/hbdead.c
  * harbour/source/compiler/hbfix.c
  * harbour/source/compiler/hbgenerr.c
  * harbour/source/compiler/hbident.c
  * harbour/source/compiler/hblbl.c
  + harbour/source/compiler/hbmain.c
  + harbour/source/compiler/hbopt.c
  * harbour/source/compiler/hbpcode.c
  * harbour/source/compiler/hbstripl.c
  * harbour/source/compiler/hbusage.c
  * harbour/source/compiler/ppcomp.c
  * harbour/source/debug/Makefile
  * harbour/source/debug/dbgbrwsr.prg
  + harbour/source/debug/dbgentry.c
  * harbour/source/debug/dbghelp.prg
  * harbour/source/debug/dbgmenu.prg
  * harbour/source/debug/dbgtarr.prg
  + harbour/source/debug/dbgthsh.prg
  * harbour/source/debug/dbgtmenu.prg
  * harbour/source/debug/dbgtmitm.prg
  * harbour/source/debug/dbgtobj.prg
  * harbour/source/debug/dbgtwin.prg
  * harbour/source/debug/dbgwa.prg
  * harbour/source/debug/debugger.prg
  * harbour/source/lang/Makefile
  + harbour/source/lang/msgnl.c
  * harbour/source/lang/msgtrdos.c
  * harbour/source/lang/msgtrwin.c
  * harbour/source/macro/Makefile
  * harbour/source/macro/macro.y
  * harbour/source/macro/macro.yyc
  * harbour/source/macro/macro.yyh
  - harbour/source/macro/macroc.c
  * harbour/source/macro/macrolex.c
  + harbour/source/main/Makefile
  + harbour/source/main/harbour.c
  * harbour/source/pp/Makefile
  * harbour/source/pp/ppcore.c
  * harbour/source/pp/pplib.c
  * harbour/source/pp/pplib2.c
  * harbour/source/rdd/Makefile
  * harbour/source/rdd/dbcmd.c
  * harbour/source/rdd/dbdelim.prg
  * harbour/source/rdd/dbf1.c
  * harbour/source/rdd/dbfuncs.prg
  * harbour/source/rdd/dbjoin.prg
  * harbour/source/rdd/dblist.prg
  * harbour/source/rdd/dbnubs.c
  * harbour/source/rdd/dbsort.prg
  + harbour/source/rdd/dbsql.c
  * harbour/source/rdd/dbstrux.prg
  * harbour/source/rdd/dbtotal.prg
  * harbour/source/rdd/dbupdat.prg
  * harbour/source/rdd/delim1.c
  * harbour/source/rdd/rddord.prg
  * harbour/source/rdd/sdf1.c
  + harbour/source/rdd/wacore.c
  + harbour/source/rdd/wafunc.c
  * harbour/source/rdd/workarea.c
  * harbour/source/rdd/dbfcdx/dbfcdx1.c
  * harbour/source/rdd/dbfdbt/dbfdbt1.c
  * harbour/source/rdd/dbffpt/dbffpt1.c
  * harbour/source/rdd/dbfntx/dbfntx1.c
  * harbour/source/rdd/hbsix/sxcompr.c
  * harbour/source/rdd/hsx/cftsfunc.c
  * harbour/source/rdd/usrrdd/usrrdd.c
  * harbour/source/rdd/usrrdd/rdds/dbtcdx.prg
  * harbour/source/rdd/usrrdd/rdds/fcomma.prg
  * harbour/source/rdd/usrrdd/rdds/fptcdx.prg
  * harbour/source/rdd/usrrdd/rdds/hscdx.prg
  * harbour/source/rdd/usrrdd/rdds/rlcdx.prg
  * harbour/source/rdd/usrrdd/rdds/smtcdx.prg
  * harbour/source/rtl/Makefile
  * harbour/source/rtl/abs.c
  * harbour/source/rtl/accept.c
  * harbour/source/rtl/alert.prg
  * harbour/source/rtl/altd.prg
  * harbour/source/rtl/at.c
  * harbour/source/rtl/binnumx.c
  * harbour/source/rtl/browdb.prg
  * harbour/source/rtl/browdbx.prg
  * harbour/source/rtl/cdpapi.c
  * harbour/source/rtl/checkbox.prg
  * harbour/source/rtl/chrasc.c
  * harbour/source/rtl/console.c
  * harbour/source/rtl/datec.c
  * harbour/source/rtl/dates.c
  * harbour/source/rtl/dateshb.c
  * harbour/source/rtl/defpath.c
  * harbour/source/rtl/dircmd.prg
  * harbour/source/rtl/dirdrive.c
  * harbour/source/rtl/diskspac.c
  * harbour/source/rtl/disksphb.c
  * harbour/source/rtl/empty.c
  * harbour/source/rtl/errorapi.c
  * harbour/source/rtl/errorsys.prg
  * harbour/source/rtl/filehb.c
  * harbour/source/rtl/filesys.c
  * harbour/source/rtl/fserror.c
  * harbour/source/rtl/fssize.c
  * harbour/source/rtl/fstemp.c
  * harbour/source/rtl/gete.c
  * harbour/source/rtl/getsys.prg
  * harbour/source/rtl/gtapi.c
  * harbour/source/rtl/gtfunc.c
  + harbour/source/rtl/hbadler.c
  + harbour/source/rtl/hbcrc.c
  * harbour/source/rtl/hbffind.c
  * harbour/source/rtl/hbgtcore.c
  + harbour/source/rtl/hbinet.c
  + harbour/source/rtl/hbmd5.c
  * harbour/source/rtl/hbrandom.c
  + harbour/source/rtl/hbregex.c
  + harbour/source/rtl/hbtoken.c
  * harbour/source/rtl/idle.c
  * harbour/source/rtl/input.prg
  * harbour/source/rtl/isprint.c
  + harbour/source/rtl/itemseri.c
  * harbour/source/rtl/left.c
  * harbour/source/rtl/len.c
  * harbour/source/rtl/math.c
  * harbour/source/rtl/memoedit.prg
  * harbour/source/rtl/minmax.c
  * harbour/source/rtl/mlcfunc.c
  * harbour/source/rtl/mod.c
  * harbour/source/rtl/mssgline.prg
  * harbour/source/rtl/net.c
  * harbour/source/rtl/oemansi.c
  * harbour/source/rtl/pad.c
  * harbour/source/rtl/persist.prg
  * harbour/source/rtl/philes.c
  * harbour/source/rtl/philes53.c
  * harbour/source/rtl/philesx.c
  * harbour/source/rtl/pushbtn.prg
  * harbour/source/rtl/radiobtn.prg
  * harbour/source/rtl/radiogrp.prg
  * harbour/source/rtl/replic.c
  * harbour/source/rtl/round.c
  * harbour/source/rtl/set.c
  * harbour/source/rtl/setcolor.c
  * harbour/source/rtl/setfunc.prg
  * harbour/source/rtl/setta.prg
  * harbour/source/rtl/shadow.c
  * harbour/source/rtl/space.c
  * harbour/source/rtl/strcase.c
  * harbour/source/rtl/strmatch.c
  * harbour/source/rtl/strpeek.c
  * harbour/source/rtl/tbcolumn.prg
  * harbour/source/rtl/tbrowse.prg
  * harbour/source/rtl/tclass.prg
  * harbour/source/rtl/teditor.prg
  - harbour/source/rtl/teditorl.c
  * harbour/source/rtl/terror.prg
  * harbour/source/rtl/tget.prg
  * harbour/source/rtl/tgetint.prg
  * harbour/source/rtl/tgetlist.prg
  * harbour/source/rtl/tmenuitm.prg
  * harbour/source/rtl/tobject.prg
  * harbour/source/rtl/tpopup.prg
  * harbour/source/rtl/transfrm.c
  * harbour/source/rtl/trim.c
  * harbour/source/rtl/ttopbar.prg
  * harbour/source/rtl/type.c
  * harbour/source/rtl/typefile.prg
  * harbour/source/rtl/val.c
  + harbour/source/rtl/valtoexp.prg
  * harbour/source/rtl/valtype.c
  * harbour/source/rtl/word.c
  * harbour/source/rtl/gtcgi/gtcgi.c
  * harbour/source/rtl/gtcrs/chrmap.c
  * harbour/source/rtl/gtpca/gtpca.c
  * harbour/source/rtl/gtstd/gtstd.c
  * harbour/source/rtl/gtwin/gtwin.c
  * harbour/source/rtl/gtxwc/gtxwc.c
  * harbour/source/vm/Makefile
  * harbour/source/vm/arrays.c
  * harbour/source/vm/arrayshb.c
  * harbour/source/vm/asort.c
  * harbour/source/vm/classes.c
  * harbour/source/vm/cmdarg.c
  * harbour/source/vm/debug.c
  * harbour/source/vm/dynsym.c
  * harbour/source/vm/estack.c
  * harbour/source/vm/eval.c
  * harbour/source/vm/extend.c
  * harbour/source/vm/fm.c
  * harbour/source/vm/garbage.c
  * harbour/source/vm/harbinit.prg
  + harbour/source/vm/hashes.c
  + harbour/source/vm/hashfunc.c
  * harbour/source/vm/hvm.c
  * harbour/source/vm/itemapi.c
  * harbour/source/vm/macro.c
  * harbour/source/vm/memvars.c
  * harbour/source/vm/runner.c
  * harbour/tests/Makefile
  * harbour/tests/mousetst.prg
  + harbour/tests/rto_get.prg
  + harbour/tests/tstuse.prg
  * harbour/utils/hbdoc/genchm.prg
  * harbour/utils/hbdoc/genhtm.prg
  * harbour/utils/hbdoc/genng.prg
  * harbour/utils/hbdoc/genos2.prg
  * harbour/utils/hbdoc/genpdf1.prg
  * harbour/utils/hbdoc/genrtf.prg
  * harbour/utils/hbdoc/os2.prg
  * harbour/utils/hbmake/hbmake.prg
  * harbour/utils/hbmake/radios.prg
  * harbour/utils/hbpp/hbpp.c
  * harbour/utils/hbpp/hbppcore.c
  * harbour/utils/hbpp/hbppdef.h
  * harbour/utils/hbpptest/pretest.prg
  * harbour/utils/hbrun/Makefile
  * harbour/utils/hbrun/external.prg
  * harbour/utils/hbrun/hbrun.prg
  * harbour/utils/hbtest/rt_main.ch
  * harbour/utils/hbtest/rt_math.prg
  * harbour/utils/hbtest/rt_misc.prg
    * Synced with devel branch.

It was full synchronization between both branches - now we are ready
for BETA3 - today I'll plan to set BETA3 tag.

best regards,
Przemek
From dbtopas at dbtopas.lt  Mon May 28 09:19:25 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Mon May 28 09:19:23 2007
Subject: [Harbour] ChangeLog 2007-05-26 09:05 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070526081000.GB1769@localhost.localdomain>
References: <20070526070607.GA13453@localhost.localdomain>
	<20070526081000.GB1769@localhost.localdomain>
Message-ID: <465AD6DD.70901@dbtopas.lt>

Przemyslaw Czerpak wrote:
>     #define HB_HASH_AUTOADD_NEVER       0x00
>     #define HB_HASH_AUTOADD_ACCESS      0x01
>     #define HB_HASH_AUTOADD_ASSIGN      0x02
>     #define HB_HASH_AUTOADD_ALWAYS      ( HB_HASH_AUTOADD_ACCESS + HB_HASH_AUTOADD_ASSIGN )
>     #define HB_HASH_AUTOADD_REFERENCE   HB_HASH_AUTOADD_ALWAYS
> 
> Two question:
> 1. where should I add above .prg constant definitions?

common.ch


> 2. are the above names correct for you?
>    maybe you prefer different names, f.e. HB_HAUTOADD_*

HB_HAUTOADD_* is shorter and prefix is the same as function name. 
HB_HASH_AUTOADD_* is longer, but more clear if you are not familiar with 
hash functions. Both are OK.


Best regards,
Mindaugas
From e.m.giordano at emagsoftware.it  Mon May 28 09:30:04 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Mon May 28 09:30:42 2007
Subject: [Harbour] Error in latest CVS
Message-ID: <008b01c7a12c$4cdec7d0$0100a8c0@emag>

Fatal: 'obj\b32\dbgaltd.obj' does not exist - don't know how to make it

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic
From esgici at gmail.com  Mon May 28 09:55:56 2007
From: esgici at gmail.com (Bicahi Esgici)
Date: Mon May 28 09:55:58 2007
Subject: [Harbour] RE: Viva Clipper
Message-ID: <d4ce00e70705280655s625cba72j176b4cfa3388b54c@mail.gmail.com>

On Mon, 28 May 2000, Massimo Renzi wrote:

> Thank you very very much,
> It's a great job.

Thanks Massimo. The great is Harbour and endeavours that made real it.

On Mon, 28 May 2007, Przemyslaw Czerpak wrote:

> The platform list is much wider then the one you presented

Hi Przemek

You are right, but my intention was not building a complete platform
list and I can't make this. I sad in the Introduction page : "Not only
for DOS, now for almost all platforms including Windows and Linux,
even Mac!". IMHO the important clause is "almost all platforms".

Also, the sentence "Harbour is a cross platform compiler and is known
to compile and run on MS-DOS, MS-Windows, OS/2, GNU/Linux and Mac
OSX." in the my Harbour page, is exactly borrowed from offical Harbour
site's main page. If this presentation will be expanded, I will
reflect it immediately to my page.

Sincerely

Bicahi Esgici
From druzus at priv.onet.pl  Mon May 28 09:55:52 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 09:56:27 2007
Subject: [Harbour] ChangeLog 2007-05-28 15:55 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070528135552.GA20377@localhost.localdomain>

2007-05-28 15:55 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/TODO
    - removed some not longer valid notes
  * harbour/common.mak
    - removed dbgaltd.obj
  * harbour/include/common.ch
    + added HB_HASH_AUTOADD_* definitions

best regards,
Przemek
From jfl at mafact.com  Mon May 28 10:15:00 2007
From: jfl at mafact.com (J. Lefebvre)
Date: Mon May 28 10:16:48 2007
Subject: [Harbour] Oups ... Another error ... (HBRUN)
Message-ID: <b63f982a.1c7a132.47fd226.6952@mafact.com>

Hi Przemek,

A small error ....

Regards,

Microsoft (R) Library Manager Version 6.00.8447
Copyright (C) Microsoft Corp 1992-1998. All rights reserved.

hbrun.c
external.c
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__WSAStartup@8
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__WSACleanup@0
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__closesocket@4
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__shutdown@8
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__inet_ntoa@4
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__ntohs@4
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__WSASetLastError@4
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__WSAGetLastError@0
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__recv@16
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol ___WSAFDIsSet@8
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__select@20
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__send@16
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__gethostbyname@4
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__gethostbyaddr@12
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__inet_addr@4
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__listen@8
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__bind@12
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__htons@4
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__setsockopt@20
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__socket@12
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__accept@12
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__connect@12
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__ioctlsocket@12
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__htonl@4
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__sendto@24
rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__recvfrom@24
rtl.lib(net.obj) : error LNK2001: unresolved external symbol __imp__GetUserNameA@8
bin\vc\hbrun.exe : fatal error LNK1120: 27 unresolved externals

-----Original Message-----
From: harbour-bounces@harbour-project.org [mailto:harbour-bounces@harbour-project.org] On Behalf Of Przemyslaw Czerpak
Sent: Monday, May 28, 2007 3:56 PM
To: Harbour Project Main Developer List.
Subject: [Harbour] ChangeLog 2007-05-28 15:55 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)

2007-05-28 15:55 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/TODO
    - removed some not longer valid notes
  * harbour/common.mak
    - removed dbgaltd.obj
  * harbour/include/common.ch
    + added HB_HASH_AUTOADD_* definitions

best regards,
Przemek
_______________________________________________
Harbour mailing list
Harbour@harbour-project.org
http://lists.harbour-project.org/mailman/listinfo/harbour


From druzus at priv.onet.pl  Mon May 28 11:05:25 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 11:06:00 2007
Subject: [Harbour] Oups ... Another error ... (HBRUN)
In-Reply-To: <b63f982a.1c7a132.47fd226.6952@mafact.com>
References: <b63f982a.1c7a132.47fd226.6952@mafact.com>
Message-ID: <20070528150525.GA20999@localhost.localdomain>

On Mon, 28 May 2007, J. Lefebvre wrote:
> Hi Przemek,
> A small error ....
> Microsoft (R) Library Manager Version 6.00.8447
> Copyright (C) Microsoft Corp 1992-1998. All rights reserved.
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__WSAStartup@8
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__WSACleanup@0
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__closesocket@4
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__shutdown@8
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__inet_ntoa@4
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol __imp__ntohs@4
[...]
> bin\vc\hbrun.exe : fatal error LNK1120: 27 unresolved externals

You have to add winsock library to linked library list in makefile.vc
for hbrun linking.
I do not know how these library is called in MSVC so if you can check
it and update makefile.vc then I'll be thankful.

best regards,
Przemek
From philb at philb.us  Mon May 28 11:46:22 2007
From: philb at philb.us (Phil Barnett)
Date: Mon May 28 11:46:26 2007
Subject: [Harbour] ChangeLog BETA 2007-05-28 14:03 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
In-Reply-To: <20070528120939.GB14943@localhost.localdomain>
References: <20070528120939.GB14943@localhost.localdomain>
Message-ID: <200705281146.23071.philb@philb.us>

On Monday 28 May 2007 08:09, Przemyslaw Czerpak wrote:
> It was full synchronization between both branches - now we are ready
> for BETA3 - today I'll plan to set BETA3 tag.

An even better solution! Like usual with you. Thank you!

-- 
Phil Barnett
AI4OF
SKCC #600
From druzus at priv.onet.pl  Mon May 28 12:53:01 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 12:53:38 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070528165301.GA395@localhost.localdomain>

2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/config/bsd/gcc.cf
  * harbour/config/darwin/gcc.cf
  * harbour/config/hpux/gcc.cf
  * harbour/config/linux/gcc.cf
  * harbour/config/sunos/gcc.cf
    + added -lpcreposix -lpcre to linked system libraries when
      C_USR contains -DHB_PCRE_REGEX

  * harbour/source/compiler/hbmain.c
    * clear HB_COMP_PARAM->functions.pLast in hb_compCompileEnd()
      to avoid accessing freed memory

best regards,
Przemek
From harbour.01 at syenar.hu  Mon May 28 13:01:28 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon May 28 13:01:18 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <20070526080637.GA1769@localhost.localdomain>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523130952.GA27311@localhost.localdomain>
	<20070523140024.GA32038@localhost.localdomain>
	<200705240520.07382.philb@philb.us>
	<20070526080637.GA1769@localhost.localdomain>
Message-ID: <A79B1DA8-E9E0-431B-ADFF-9435172516DE@syenar.hu>

My vote is to tag the current devel as BETA3 and
leave BETA1 as it is (if that makes sense; if not, the
BETA1 tag should be readded as you've suggested).

(Sorry for dropping in late)

Brgds,
Viktor

On 2007.05.26., at 10:06, Przemyslaw Czerpak wrote:

> On Thu, 24 May 2007, Phil Barnett wrote:
>> Looks ok to me. I'll go for expediency at this time.
>
> The final question.
> Should I remove current BETA1 branch and create new one from current
> DEVEL code I should rather use existing BETA1 and simply update it.
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Mon May 28 13:04:08 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon May 28 13:04:00 2007
Subject: [Harbour] ChangeLog 2007-05-26 09:05 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070526081000.GB1769@localhost.localdomain>
References: <20070526070607.GA13453@localhost.localdomain>
	<20070526081000.GB1769@localhost.localdomain>
Message-ID: <E65369F7-82F2-415E-9EDE-B98FF8121E3D@syenar.hu>

> On Sat, 26 May 2007, Przemyslaw Czerpak wrote:
>>   * harbour/include/hbapi.h
>>   * harbour/source/vm/hashes.c
>>   * harbour/source/vm/hashfunc.c
>>   * harbour/source/vm/hvm.c
>>     + added new 3-rd parameter to hb_hashGetItemPtr() to control
>>       independently hash autoadd behavior in access/assign operation
>
>     #define HB_HASH_AUTOADD_NEVER       0x00
>     #define HB_HASH_AUTOADD_ACCESS      0x01
>     #define HB_HASH_AUTOADD_ASSIGN      0x02
>     #define HB_HASH_AUTOADD_ALWAYS      ( HB_HASH_AUTOADD_ACCESS +  
> HB_HASH_AUTOADD_ASSIGN )
>     #define HB_HASH_AUTOADD_REFERENCE   HB_HASH_AUTOADD_ALWAYS
>
> Two question:
> 1. where should I add above .prg constant definitions?

hbhash.ch comes to mind, or common.ch.

> 2. are the above names correct for you?
>    maybe you prefer different names, f.e. HB_HAUTOADD_*

I'd prefer HB_HAUTOADD. It's shorter and contains
the function which it belongs to.

Brgds,
Viktor



From randy at palmasdev.com  Mon May 28 13:05:43 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Mon May 28 13:05:05 2007
Subject: [Harbour] CHANGELOG BETA: 2007-05-23 08:35 UTC+0100 Viktor
	Szakats (harbour.01 syenar.hu)
In-Reply-To: <A79B1DA8-E9E0-431B-ADFF-9435172516DE@syenar.hu>
References: <01c79d06$Blat.v2.6.1$86a37a76$efc75f7d500@127.0.0.1>
	<20070523130952.GA27311@localhost.localdomain>
	<20070523140024.GA32038@localhost.localdomain>
	<200705240520.07382.philb@philb.us>
	<20070526080637.GA1769@localhost.localdomain>
	<A79B1DA8-E9E0-431B-ADFF-9435172516DE@syenar.hu>
Message-ID: <20070528170503.0BFBB667CA@smtp.tor.pathcom.com>

IMHO, while I understand the need for Harbour to continue to move 
forward, I feel there is an equal importance to have a rock-solid 
build that we can rely on. Therefore, I feel that only bug fixes 
should be applied to the beta build so as not to destabilize it.

At 01:01 PM 5/28/2007, you wrote:
>My vote is to tag the current devel as BETA3 and
>leave BETA1 as it is (if that makes sense; if not, the
>BETA1 tag should be readded as you've suggested).
>
>(Sorry for dropping in late)
>
>Brgds,
>Viktor
>
>On 2007.05.26., at 10:06, Przemyslaw Czerpak wrote:
>
>>On Thu, 24 May 2007, Phil Barnett wrote:
>>>Looks ok to me. I'll go for expediency at this time.
>>
>>The final question.
>>Should I remove current BETA1 branch and create new one from current
>>DEVEL code I should rather use existing BETA1 and simply update it.
>>
>>best regards,
>>Przemek
>>_______________________________________________
>>Harbour mailing list
>>Harbour@harbour-project.org
>>http://lists.harbour-project.org/mailman/listinfo/harbour
>
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour
>

From druzus at priv.onet.pl  Mon May 28 14:15:46 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 14:16:24 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070528181546.GA13938@localhost.localdomain>

2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/config/bsd/gcc.cf
  * harbour/config/darwin/gcc.cf
  * harbour/config/hpux/gcc.cf
  * harbour/config/linux/gcc.cf
  * harbour/config/sunos/gcc.cf
    + added -lpcreposix -lpcre to linked system libraries when
      C_USR contains -DHB_PCRE_REGEX

  * harbour/source/compiler/hbmain.c
    * clear HB_COMP_PARAM->functions.pLast in hb_compCompileEnd()
      to avoid accessing freed memory

modifications synced with BETA branch

best regards,
Przemek
From druzus at priv.onet.pl  Mon May 28 14:16:15 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 14:16:52 2007
Subject: [Harbour] ChangeLog 2007-05-28 20:05 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070528181615.GB13938@localhost.localdomain>

2007-05-28 20:05 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/contrib/Makefile
  + harbour/contrib/adordd/Makefile
    + added ADORDD to default windows GNU make builds
  * harbour/contrib/adordd/makefile.bc
    + added -w2 to harbour compoiler switches
  * harbour/contrib/adordd/adordd.prg
    + added HB_SYMBOL_UNUSED() for some methods
  + harbour/contrib/ole2/Makefile
    + added GNU make file
  * harbour/include/common.ch
    * changed HB_HASH_AUTOADD_* to HB_HAUTOADD_*

modifications synced with BETA branch

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Mon May 28 16:16:45 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon May 28 16:16:51 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070528165301.GA395@localhost.localdomain>
References: <20070528165301.GA395@localhost.localdomain>
Message-ID: <9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>

On 5/28/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
> 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/config/bsd/gcc.cf
>   * harbour/config/darwin/gcc.cf
>   * harbour/config/hpux/gcc.cf
>   * harbour/config/linux/gcc.cf
>   * harbour/config/sunos/gcc.cf
>     + added -lpcreposix -lpcre to linked system libraries when
>       C_USR contains -DHB_PCRE_REGEX

Many thanks, what can I do for mingw?

Or better could you explain me a bit?

What I've found so far is that Harbour without HB_PCRE_REGEX takes
5.22s under Harbour and 0.72s under xHarbour. Mingw cross built using
make_mingw.sh takes only 0.21 under wine but HB_REGEX always returns
.f.

I've tried to use PCRE 7.0 from www.gnuwin32.org as suggested in
www.pcre.org and also build it directly from 7.1 sources but what I
get are only gpfs.

regards,
Lorenzo

external HB_REGEX

procedure main( x, y )

   local cForExpr
   local bForExpr
   local nLoop
   local nBegin
   local nCount1 := 0
   local nCount2 := 0

   if x == nil
      x := "......125...."
   endif

   if y == nil
      y := "0012401252356"
   endif

   public y1

   y1 := y

   ? x, y

   ? iif( HB_REGEX( x, y ) != nil, .t., .f. )

   cForExpr := "iif( HB_REGEX( '" + alltrim( x ) + "', y1 ) != nil, .t., .f. )"

   ? cForExpr

   cForExpr := "{||"+cForExpr+"}"

   ? cForExpr

   bFoxExpr := &cForExpr

   nBegin := seconds()

   for nLoop := 1 to 100000
     if nLoop % 2 == 0
        y1 := "0012401252356"
     else
        y1 := "0012401262356"
     endif
     if eval( bFoxExpr )
        nCount1++
     else
        nCount2++
     endif
   next

   ? nCount1, nCount2

   ? seconds() - nBegin

   wait

return
From jfl at mafact.com  Mon May 28 17:05:00 2007
From: jfl at mafact.com (J. Lefebvre)
Date: Mon May 28 17:06:59 2007
Subject: [Harbour] 2007-05-28 23:01 UTC+0100 JF Lefebvre (Mafact)
	(jfl/at/mafact.com)
Message-ID: <ee503a1a.1c7a16b.5f6cfb5.5f90@mafact.com>

 2007-05-28 23:01 UTC+0100 JF Lefebvre (Mafact) (jfl/at/mafact.com)
  + harbour/Makefile.vc
    Adding 2 missing libs to HBRUN for msvc compiler

From jfl at mafact.com  Mon May 28 17:07:00 2007
From: jfl at mafact.com (J. Lefebvre)
Date: Mon May 28 17:10:02 2007
Subject: [Harbour] Oups ... Another error ... (HBRUN)
Message-ID: <4012fe78.1c7a16c.5f8e789.1649@mafact.com>

Hi Przemek,

Done,

Regards,

JF, 

-----Original Message-----
From: harbour-bounces@harbour-project.org [mailto:harbour-bounces@harbour-project.org] On Behalf Of Przemyslaw Czerpak
Sent: Monday, May 28, 2007 5:05 PM
To: Harbour Project Main Developer List.
Subject: Re: [Harbour] Oups ... Another error ... (HBRUN)

On Mon, 28 May 2007, J. Lefebvre wrote:
> Hi Przemek,
> A small error ....
> Microsoft (R) Library Manager Version 6.00.8447 Copyright (C) 
> Microsoft Corp 1992-1998. All rights reserved.
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol 
> __imp__WSAStartup@8
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol 
> __imp__WSACleanup@0
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol 
> __imp__closesocket@4
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol 
> __imp__shutdown@8
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol 
> __imp__inet_ntoa@4
> rtl.lib(hbinet.obj) : error LNK2001: unresolved external symbol 
> __imp__ntohs@4
[...]
> bin\vc\hbrun.exe : fatal error LNK1120: 27 unresolved externals

You have to add winsock library to linked library list in makefile.vc for hbrun linking.
I do not know how these library is called in MSVC so if you can check it and update makefile.vc then I'll be thankful.

best regards,
Przemek
_______________________________________________
Harbour mailing list
Harbour@harbour-project.org
http://lists.harbour-project.org/mailman/listinfo/harbour


From druzus at priv.onet.pl  Mon May 28 18:06:18 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 18:06:55 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
Message-ID: <20070528220618.GA14966@localhost.localdomain>

On Mon, 28 May 2007, Lorenzo Fiorini wrote:
> Many thanks, what can I do for mingw?
> Or better could you explain me a bit?
> What I've found so far is that Harbour without HB_PCRE_REGEX takes
> 5.22s under Harbour and 0.72s under xHarbour.

First I think you should begin to use HB_REGEXCOMP().
The PCRE is probably the fastest regular expression
library but most of speed difference is in compilation.
Try to replace in your code:
   bFoxExpr := &cForExpr
by:
   x := HB_REGEXCOMP( x )
   bForExpr := {|| IIF( HB_REGEX( x, y1 ) != NIL, .T., .F. ) }

and compare results. You will find that everything can be executed
faster and the speed difference between build in into libc POSIX
regular expressions and PCRE is not such big though still noticeable.

> Mingw cross built using
> make_mingw.sh takes only 0.21 under wine but HB_REGEX always returns
> .f.

Because MinGW does not support regex in default build so HB_REGEX() is
dummy function executed really fast.
If you want to use regular expressions with MinGW Harbour build then you
will need some regexc library (f.e. PCRE) compiled for this compiler with
valid header files.

> I've tried to use PCRE 7.0 from www.gnuwin32.org as suggested in
> www.pcre.org and also build it directly from 7.1 sources but what I
> get are only gpfs.

Just take the pcrepos library from xHarbour.

best regards,
Przemek
From druzus at priv.onet.pl  Mon May 28 18:06:51 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon May 28 18:07:45 2007
Subject: [Harbour] Oups ... Another error ... (HBRUN)
In-Reply-To: <4012fe78.1c7a16c.5f8e789.1649@mafact.com>
References: <4012fe78.1c7a16c.5f8e789.1649@mafact.com>
Message-ID: <20070528220651.GB14966@localhost.localdomain>

On Mon, 28 May 2007, J. Lefebvre wrote:
> Hi Przemek,
> Done,

Thank you very much.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue May 29 02:19:42 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 02:19:47 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070528220618.GA14966@localhost.localdomain>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
Message-ID: <9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>

On 5/29/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> First I think you should begin to use HB_REGEXCOMP().
> ...
> regular expressions and PCRE is not such big though still noticeable.

You're right with HB_REGXCOMP times are almost the same. I didn't use
it because in pcre there is no such difference and regex is only one
of the operators.

> Just take the pcrepos library from xHarbour.

I did it but this means remove all the -lpcreposix -lpcre references
in hb-func.sh and add pcre under source/rtl since it needs to be found
by the install rule.

This means that regex functions will not be available to mingw/windows
users of Harbour "out of the box".

best regards,
Lorenzo
From druzus at priv.onet.pl  Tue May 29 04:32:47 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 29 04:33:23 2007
Subject: [Harbour] ChangeLog 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070529083247.GA22711@localhost.localdomain>

2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/makefile.vc
    * synced with BETA branch
  * harbour/contrib/Makefile
    * disable BMDBFCDX for DOS builds due to long names which do not
      pass 8.3 convention
    * use OLE2 instead of OLE 
  * harbour/contrib/ole2/w32ole.c
    * warning fixes
  * harbour/include/hbregex.h
    + added REGEX support for DJGPP build
  * harbour/source/rtl/net.c
    * warning cleanup

modifications synced with BETA branch.

I would like to ask everybody who has some spare time to make
tests builds on used platforms so we can catch some possible
problems before I'll set BETA3 tag.

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 29 04:49:39 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 29 04:50:15 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
Message-ID: <20070529084939.GB22711@localhost.localdomain>

On Tue, 29 May 2007, Lorenzo Fiorini wrote:
> >Just take the pcrepos library from xHarbour.
> I did it but this means remove all the -lpcreposix -lpcre references
> in hb-func.sh and add pcre under source/rtl since it needs to be found
> by the install rule.

That right but this can be easy resolved.

> This means that regex functions will not be available to mingw/windows
> users of Harbour "out of the box".

Like for other non *nix based platforms. I agree it's a problem but
I do not have time to create clean multi platform PCRE library from
it's source code. It uses autoconf to create optimal for given platform
build and we will have to drop it and chose some widely working
configuration. Possible but I do not have time to make it now - if
some else can help then it will be nice - we can add it to Harbour
source code.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue May 29 05:04:29 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 05:06:10 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070529084939.GB22711@localhost.localdomain>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
	<20070529084939.GB22711@localhost.localdomain>
Message-ID: <9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>

On 5/29/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Possible but I do not have time to make it now - if
> some else can help then it will be nice - we can add it to Harbour
> source code.

I've copied xHarbour/source/rtl/pcre from my stable xHarbour tree.
PCRE_MAJOR/MINOR state 6.3. I'm using it mainly under Linux and I've
tested it under mingw.

If the group agree I can upload it.

P.S. I took official 7.1 sources and I got them working under Linux
but there is an internal error in mingw that prevent to build.
Probably this is why gnuwin32 still uses 7.0.

best regards,
Lorenzo
From miguelangel at marchuet.net  Tue May 29 05:09:35 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue May 29 05:10:26 2007
Subject: [Harbour] ChangeLog 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070529083247.GA22711@localhost.localdomain>
References: <20070529083247.GA22711@localhost.localdomain>
Message-ID: <465BEDCF.30104@marchuet.net>

Przemyslaw Czerpak escribi?:
> 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/contrib/Makefile
>     * disable BMDBFCDX for DOS builds due to long names which do not
>       pass 8.3 convention


Sorry, but What this it mean?

DBFCDX and BMDBFCDX works at the same way, and I hope too in the future.

Why don support [BM]DBFCDX in DOS builds if actual DOS supports long names.

Long names are supported in DOS since Windows 95 command and cmd.


Best regards,
Miguel Angel Marchuet
From lorenzo.fiorini at gmail.com  Tue May 29 06:00:24 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 06:00:31 2007
Subject: [Harbour] ChangeLog 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <465BEDCF.30104@marchuet.net>
References: <20070529083247.GA22711@localhost.localdomain>
	<465BEDCF.30104@marchuet.net>
Message-ID: <9257026e0705290300s1562f35as72e3f0075ba8e18c@mail.gmail.com>

On 5/29/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:
> Sorry, but What this it mean?
>
> DBFCDX and BMDBFCDX works at the same way, and I hope too in the future.
>
> Why don support [BM]DBFCDX in DOS builds if actual DOS supports long names.

Probably you are confusing DOS and Windows console applications.

Windows is Windows and DOS is DOS.

Windows > 9X needs a virtual machine to run DOS apps, but for example
many barcode readers and many appliances still use "real DOS".

Look at www.freedos.org.

best regards,
Lorenzo
From miguelangel at marchuet.net  Tue May 29 06:14:28 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue May 29 06:14:34 2007
Subject: [Harbour] ChangeLog 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705290300s1562f35as72e3f0075ba8e18c@mail.gmail.com>
References: <20070529083247.GA22711@localhost.localdomain>	<465BEDCF.30104@marchuet.net>
	<9257026e0705290300s1562f35as72e3f0075ba8e18c@mail.gmail.com>
Message-ID: <465BFD04.4080305@marchuet.net>

cmd and command are 2 different things

command is a DOS console over windows that accepts long names

Its documented at MSDN of microsoft.

Long names are supported in all DOS versions since windows 95

Always we are speaking about DOS console.

For example if you execute "command" in Windows 2000 instead of "cmd" arise the next text:

	Microsoft(R) Windows DOS
	(C)Copyright Microsoft Corp 1990-1999.

Why is not possible to use [BM]DBFCDX in this console ?

Or I'm confused ?

or this change only affects to freeDOS and not affect to MSDOS ?

Best regards,
Miguel Angel Marchuet

Lorenzo Fiorini escribi?:
> On 5/29/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:
>> Sorry, but What this it mean?
>>
>> DBFCDX and BMDBFCDX works at the same way, and I hope too in the future.
>>
>> Why don support [BM]DBFCDX in DOS builds if actual DOS supports long
>> names.
> 
> Probably you are confusing DOS and Windows console applications.
> 
> Windows is Windows and DOS is DOS.
> 
> Windows > 9X needs a virtual machine to run DOS apps, but for example
> many barcode readers and many appliances still use "real DOS".
> 
> Look at www.freedos.org.
> 
> best regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From harbour.01 at syenar.hu  Tue May 29 06:26:01 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue May 29 06:25:51 2007
Subject: [Harbour] ChangeLog 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <465BEDCF.30104@marchuet.net>
References: <20070529083247.GA22711@localhost.localdomain>
	<465BEDCF.30104@marchuet.net>
Message-ID: <8DBA2716-4773-48AE-A46A-6786FEA60A14@syenar.hu>

DOS is not just DOS under W95, but plain also plain DOS with no windows
above it. Long filenames are not supported at all under plain DOS.  
Also notice
that long filenames are not supported under any DOS either, unless  
someone
uses the special long-filename DOS API (interrupts), which are  
unfortunately
only supported under W95/W98/WME (and not NT/2K/XP/etc).

So for DOS support, the rule is _always_ to use 8.3 filenames.

As far as I can see, the only porblem with BMDBFCDX is the filename
of the header hbrddbmcdx.h, which is long and makes it impossible
even to compile under any DOS based compiler on any DOS compatible
platforms. (It's pretty easy to fix this specific problem)

(This is why we have the rule to use 8.3 filenames only in the CVS.)

Brgds,
Viktor

On 2007.05.29., at 11:09, Miguel Angel Marchuet wrote:

> Przemyslaw Czerpak escribi?:
>> 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>>   * harbour/contrib/Makefile
>>     * disable BMDBFCDX for DOS builds due to long names which do not
>>       pass 8.3 convention
>
>
> Sorry, but What this it mean?
>
> DBFCDX and BMDBFCDX works at the same way, and I hope too in the  
> future.
>
> Why don support [BM]DBFCDX in DOS builds if actual DOS supports  
> long names.
>
> Long names are supported in DOS since Windows 95 command and cmd.
>
>
> Best regards,
> Miguel Angel Marchuet
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Tue May 29 06:34:01 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 06:34:07 2007
Subject: [Harbour] ChangeLog 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <465BFD04.4080305@marchuet.net>
References: <20070529083247.GA22711@localhost.localdomain>
	<465BEDCF.30104@marchuet.net>
	<9257026e0705290300s1562f35as72e3f0075ba8e18c@mail.gmail.com>
	<465BFD04.4080305@marchuet.net>
Message-ID: <9257026e0705290334u24ef9d25m9f37ddd7c66e509b@mail.gmail.com>

On 5/29/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:

> Long names are supported in all DOS versions since windows 95

That's the point, it is "Windows DOS" not DOS.

P.S. I've started to program with CP/M in 1980 and I clearly remember
the PC-DOS 1.0 born. I still have a 8088 PC with PC-DOS 3.3 and
Windows 2.0 and it doesn't support long file names, but it runs
Clipper 5.3B "real" apps :)

best regards,
Lorenzo
From miguelangel at marchuet.net  Tue May 29 06:34:41 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue May 29 06:34:51 2007
Subject: [Harbour] ChangeLog 2007-05-29 10:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <8DBA2716-4773-48AE-A46A-6786FEA60A14@syenar.hu>
References: <20070529083247.GA22711@localhost.localdomain>	<465BEDCF.30104@marchuet.net>
	<8DBA2716-4773-48AE-A46A-6786FEA60A14@syenar.hu>
Message-ID: <465C01C1.2010207@marchuet.net>

> 
> So for DOS support, the rule is _always_ to use 8.3 filenames.
> 
> As far as I can see, the only porblem with BMDBFCDX is the filename
> of the header hbrddbmcdx.h, which is long and makes it impossible
> even to compile under any DOS based compiler on any DOS compatible
> platforms. (It's pretty easy to fix this specific problem)
> 
> (This is why we have the rule to use 8.3 filenames only in the CVS.)
> 

I understand, i correct it inmeditaly.

I rename it to hbrddbmc.h

any inconvenient ?


Best regards,
Miguel Angel Marchuet
From lorenzo.fiorini at gmail.com  Tue May 29 07:01:48 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 07:01:51 2007
Subject: [Harbour] mingw strings performance
Message-ID: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>

I'm testing actual CVS with mingw and I've found that the test below
that takes 0.11s under Linux takes 4.23s on the same hardware using
wine, while other tests give comparable results. On a real XP notebook
it takes 5.4s.

Can it be an allocation issue of mingw?

best regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Tue May 29 07:11:48 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 07:11:52 2007
Subject: [Harbour] Re: mingw strings performance
In-Reply-To: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
Message-ID: <9257026e0705290411p7a156fcbgdbf02c682ef6570d@mail.gmail.com>

On 5/29/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

> I'm testing actual CVS with mingw and I've found that the test below

Oops I forgot the test.

procedure main()

   local nI
   local cBuffer := ""
   local nBeg

   ? "Running..."

   nBeg := seconds()

   for nI := 1 to 3000
      cBuffer += replicate( iif( nI % 2 == 0, "A", "B" ), nI )
   next nI

   ? seconds() - nBeg
   ? len( cBuffer )
   ? hb_md5( cBuffer )
   wait

   return
From e.m.giordano at emagsoftware.it  Tue May 29 07:32:16 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Tue May 29 07:32:52 2007
Subject: [Harbour] Re: mingw strings performance
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
	<9257026e0705290411p7a156fcbgdbf02c682ef6570d@mail.gmail.com>
Message-ID: <013501c7a1e5$02910670$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Lorenzo Fiorini" <lorenzo.fiorini@gmail.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: marted? 29 maggio 2007 13.11
Oggetto: [Harbour] Re: mingw strings performance


> procedure main()
>
>   local nI
>   local cBuffer := ""
>   local nBeg
>
>   ? "Running..."
>
>   nBeg := seconds()
>
>   for nI := 1 to 3000
>      cBuffer += replicate( iif( nI % 2 == 0, "A", "B" ), nI )
>   next nI
>
>   ? seconds() - nBeg
>   ? len( cBuffer )
>   ? hb_md5( cBuffer )
>   wait
>
>   return

This is the result on my PC (BCC55):

Running...
         0.14
   4501500
59bbe8c368221e74a379bfb7bb64008a

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From dbtopas at dbtopas.lt  Tue May 29 07:59:53 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Tue May 29 07:56:16 2007
Subject: [Harbour] mingw strings performance
In-Reply-To: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
Message-ID: <465C15B9.2030409@dbtopas.lt>

Lorenzo Fiorini wrote:
> I'm testing actual CVS with mingw and I've found that the test below
> that takes 0.11s under Linux takes 4.23s on the same hardware using
> wine, while other tests give comparable results. On a real XP notebook
> it takes 5.4s.
> Can it be an allocation issue of mingw?

Hello,


after hbrun was created, I used it to do a simple speed test for BCC55 
and MinGW. I've build hbrun.exe using standard (i.e., no C_USR, etc.) 
make_b32.bat and make_gnu.bat with MinGW.

Here is results for speedtst.prg under hbrun.exe. I've marked lines with 
stars if speed ratio is larger than 1.5.


Harbour devel build 1.1-0 Intl., Windows XP 5.1.2600 Service Pack 2
ARR_LEN =         16
N_LOOPS =    1000000
empty loops overhead =          0.16
CPU usage -> secondsCPU()

                                          bcc     mgw
c:=L_C ->                                0.25    0.27
n:=L_N ->                                0.22    0.17
d:=L_D ->                                0.27    0.16 *
c:=M_C ->                                0.50    0.27 *
n:=M_N ->                                0.31    0.22
d:=M_D ->                                0.23    0.19
(sh) c:=F_C ->                           0.64    1.20 *
(sh) n:=F_N ->                           0.63    0.63
(sh) d:=F_D ->                           0.38    0.41
(ex) c:=F_C ->                           0.63    1.20
(ex) n:=F_N ->                           0.64    0.61
(ex) d:=F_D ->                           0.38    0.42
n:=o:GenCode ->                          0.59    0.58
round(i/1000,2) ->                       0.70    1.03
str(i/1000) ->                           1.83    4.80 *
val(a3[i%ARR_LEN+1]) ->                  1.53    1.23
dtos(j+i%10000-5000) ->                  1.72    2.42
eval({||i%ARR_LEN}) ->                   0.77    0.78
eval({|x|x%ARR_LEN}) ->                  0.80    0.83
eval({|x|f1(x)}) ->                      1.22    1.20
&('f1('+str(i)+')') ->                  10.48   31.08 *
eval([&('{|x|f1(x)}')]) ->               1.23    1.17
j := valtype(a)+valtype(i) ->            1.41    1.89
j := str(i%100,2) $ a2[i%ARR_LEN+1] ->   2.63    4.45 *
j := val(a2[i%ARR_LEN+1]) ->             1.67    1.47
j := a2[i%ARR_LEN+1] == s ->             1.11    1.02
j := a2[i%ARR_LEN+1] = s ->              1.17    1.03
j := a2[i%ARR_LEN+1] >= s ->             1.28    1.06
j := a2[i%ARR_LEN+1] < s ->              1.17    1.05
aadd(aa,{i,j,s,a,a2,t,bc}) ->            7.30    8.70
f0() ->                                  0.33    0.42
f1(i) ->                                 0.64    0.67
f2(c[8]) ->                              0.47    0.52
f2(c[40000]) ->                          0.45    0.50
f2(@c[40000]) ->                         0.39    0.47
f2(c[40000]); c2:=c ->                   0.73    0.73
f2(@c[40000]); c2:=c ->                  0.66    0.67
f3(a,a2,c,i,j,t,bc) ->                   1.22    1.09
f2(a2) ->                                0.44    0.48
s:=f4() ->                              84.33  134.03 *
ascan(a,i%ARR_LEN) ->                    0.86    1.02
ascan(a2,c+chr(i%64+64)) ->              2.88    3.91
ascan(a,{|x|x==i%ARR_LEN}) ->            9.06   11.38
=======================================================
total application time:                153.03  235.11
total real time:                       156.09  239.34


I haven't made more detail analysis, but f4() is memory allocation 
function ( return space(50000) ). Perhaps memory manager of BCC is 
better than MinGW?...


Best regards,
Mindaugas
From dbtopas at dbtopas.lt  Tue May 29 08:06:19 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Tue May 29 08:02:37 2007
Subject: [Harbour] mingw strings performance
In-Reply-To: <465C15B9.2030409@dbtopas.lt>
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
	<465C15B9.2030409@dbtopas.lt>
Message-ID: <465C173B.406@dbtopas.lt>

Sorry,
forgot to include results for presented string performance test (I've 
commented HB_MD5(), because it is not linked into hbrun.exe):

C:\harbourcvs\bin\b32>hbrun.exe aa.prg

Error BASE/9999  Unknown or unregistered symbol: HB_MD5
Called from __HRBRUN(0)
Called from _APPMAIN(106)
C:\harbourcvs\bin\b32>hbrun.exe aa.prg

Running...
         10.69
    4501500
C:\harbourcvs\utils\hbrun\w32\mingw32>hbrun.exe aa.prg

Running...
          9.70
    4501500


Best regards,
Mindaugas
From alex at belacy.belgorod.su  Tue May 29 08:23:54 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Tue May 29 08:23:28 2007
Subject: [Harbour] C question
Message-ID: <10627577317.20070529162354@belacy.belgorod.su>

Sorry for possible offtopic, but I'm mad of this simple problem
today...

How can I change the number format - the delimiter for a decimal in
gcc ?

if I write:

float fval;
char *s = "100.56";
  sscanf( s,"%f",&fval );
  printf( "%f", fval );

  I get 100.56, as expected - but if I insert this snippet to the
  Harbour's ads1.c code, I get the 100,000 because there ',' must be a
  delimiter. Which option makes the trick ?

-- 
Regards,
 Alexander
http://kresin.belgorod.su


From alex at belacy.belgorod.su  Tue May 29 08:44:42 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Tue May 29 08:43:07 2007
Subject: [Harbour] Re: C question
In-Reply-To: <10627577317.20070529162354@belacy.belgorod.su>
References: <10627577317.20070529162354@belacy.belgorod.su>
Message-ID: <828825823.20070529164442@belacy.belgorod.su>

Tuesday, May 29, 2007, 4:23:54 PM, Alexander S.Kresin <alex@belacy.belgorod.su> wrote:

ASK> Sorry for possible offtopic, but I'm mad of this simple problem
ASK> today...

ASK> How can I change the number format - the delimiter for a decimal in
ASK> gcc ?

ASK> if I write:

ASK> float fval;
ASK> char *s = "100.56";
ASK>   sscanf( s,"%f",&fval );
ASK>   printf( "%f", fval );

ASK>   I get 100.56, as expected - but if I insert this snippet to the
ASK>   Harbour's ads1.c code, I get the 100,000 because there ',' must be a
ASK>   delimiter. Which option makes the trick ?

Just to make it more clear. Such code, compiled with Harbour under
Linux, prints 100.000:

Function Main
  sss()
Return Nil

#pragma BEGINDUMP
#include <stdio.h>
HB_FUNC( SSS )
{
   float fval;
   char *s = "100.56";
   sscanf( s,"%f",&fval );
   printf("\r\n %s - %f\r\n",s,fval );
}
                     
#pragma ENDDUMP

This code, compiled with gcc under Linux, prints 100.559998:

#include <stdio.h>
int main(void)
{
   float fval;
   char *s = "100.56";
   sscanf( s,"%f",&fval );
   printf("\r\n %s - %f\r\n",s,fval );
}


-- 
Regards,
 Alexander
http://kresin.belgorod.su


From niki at synel.co.il  Tue May 29 09:09:10 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue May 29 09:08:42 2007
Subject: [Harbour] Re: C question
Message-ID: <465C25F6.3F43@synel.co.il>

Alexander,

Maybe there are some locate differences?
something with LC_NUMERIC and setlocale()

Are you using the same gcc to build harbour itself,
at the same environment?

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From lorenzo.fiorini at gmail.com  Tue May 29 09:13:08 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 09:13:12 2007
Subject: [Harbour] Re: mingw strings performance
In-Reply-To: <013501c7a1e5$02910670$0100a8c0@emag>
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
	<9257026e0705290411p7a156fcbgdbf02c682ef6570d@mail.gmail.com>
	<013501c7a1e5$02910670$0100a8c0@emag>
Message-ID: <9257026e0705290613i3a80dc17m41169d5922d9a642@mail.gmail.com>

On 5/29/07, Enrico Maria Giordano <e.m.giordano@emagsoftware.it> wrote:
>
> This is the result on my PC (BCC55):
>
> Running...
>          0.14
>    4501500
> 59bbe8c368221e74a379bfb7bb64008a

Many thanks for your test. It confirms that the problem is mingw specific.

best regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Tue May 29 09:26:52 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 09:26:56 2007
Subject: [Harbour] mingw strings performance
In-Reply-To: <465C15B9.2030409@dbtopas.lt>
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
	<465C15B9.2030409@dbtopas.lt>
Message-ID: <9257026e0705290626v7f8b1a8q31f5ec723eefcc23@mail.gmail.com>

On 5/29/07, Mindaugas Kavaliauskas <dbtopas@dbtopas.lt> wrote:

> Here is results for speedtst.prg under hbrun.exe. I've marked lines with
> stars if speed ratio is larger than 1.5.

Many thanks for your tests.

> I haven't made more detail analysis, but f4() is memory allocation
> function ( return space(50000) ). Perhaps memory manager of BCC is
> better than MinGW?...

Maybe, I'll Google for hints.

best regards,
Lorenzo
From e.m.giordano at emagsoftware.it  Tue May 29 09:34:16 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Tue May 29 09:41:30 2007
Subject: [Harbour] Re: C question
References: <10627577317.20070529162354@belacy.belgorod.su>
	<828825823.20070529164442@belacy.belgorod.su>
Message-ID: <01e301c7a1f6$0d9231a0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Alexander S.Kresin" <alex@belacy.belgorod.su>
A: <harbour@harbour-project.org>
Data invio: marted? 29 maggio 2007 14.44
Oggetto: [Harbour] Re: C question


> Just to make it more clear. Such code, compiled with Harbour under
> Linux, prints 100.000:

It prints

100.56 - 100.559998

here (Windows, BCC55).

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From mbelgrano at deltain.it  Tue May 29 09:47:16 2007
From: mbelgrano at deltain.it (Massimo Belgrano)
Date: Tue May 29 09:47:55 2007
Subject: [Harbour] I: Wich future for hbmake?
Message-ID: <AFB948164110ED43B5EB849E8DEEF03809A57D@SRV02.deltain.net>

 

IMO hbmake is a component of x/harbour who is missing of same compoment
for made x/harbour more attractive:

Indipendent from C++ compiler (same new user can't compile sample)

More easy wizard (hbmake without parameter must start wizard for create
project file and Capability to go Next or previosus step)

Capable to Editing source 

 

An interesting model can be http://www.andywos.ih.co.za/xmate/ (very
good freeware project) 

Will start a cross open source project
withhttp://sourceforge.net/projects/sharpdevelop/ .or.
http://www.codeblocks.org/ .or. http://sourceforge.net/projects/dev-cpp/
?

 

Most user (born with vb) want know only the make interface of compiler
so with a good standard make also more user will be appreciate x/harbour

 

 

Massimo Belgrano <mailto:mbelgrano@deltain.com> 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070529/58fbe86a/attachment.html
From alex at belacy.belgorod.su  Tue May 29 10:08:36 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Tue May 29 10:09:06 2007
Subject: [Harbour] Re: C question
In-Reply-To: <465C25F6.3F43@synel.co.il>
References: <465C25F6.3F43@synel.co.il>
Message-ID: <43712057.20070529180836@belacy.belgorod.su>

On  Tuesday, May 29, 2007, 17:09 Chen Kedem <niki@synel.co.il> wrote:

CK> Alexander,

CK> Maybe there are some locate differences?
CK> something with LC_NUMERIC and setlocale()

 Yes, I've finally find it - that was because of setlocale( LC_ALL,""
 ), which I inserted in my own reimplementation of gtcrs driver.
 The result is that,using the Linux ADS client, I read numbers without
 decimals from existing databases.
 The only thing, which I need to find is how to use the setlocale()
 without touching the numbers format.

Regards,
 Alexander
http://kresin.belgorod.su

From mbelgrano at deltain.it  Tue May 29 11:13:15 2007
From: mbelgrano at deltain.it (Massimo Belgrano)
Date: Tue May 29 11:13:56 2007
Subject: R: [Harbour] I: Wich future for hbmake?
In-Reply-To: <AFB948164110ED43B5EB849E8DEEF03809A57D@SRV02.deltain.net>
References: <AFB948164110ED43B5EB849E8DEEF03809A57D@SRV02.deltain.net>
Message-ID: <AFB948164110ED43B5EB849E8DEEF03809A57F@SRV02.deltain.net>

Is possible  read this section from a config.hbmake  in path of hbmake.exe instead that from a .bc?

Will help in having hbmake project file independent from c++compiler?

 

CFLAG1 =  -OS $(CFLAGS) -d -L$(HB_DIR)\lib;$(FWH)\lib -c -I

CFLAG2 =  -I$(HB_DIR)\include;$(CC_DIR)\include

RFLAGS =

LFLAGS = -L$(CC_DIR)\lib\obj;$(CC_DIR)\lib;$(HB_DIR)\lib -Gn -M -m -s -Tpe -aa

IFLAGS =

LINKER = ilink32

 

ALLOBJ = c0w32.obj $(OBJFILES) $(OBJCFILES)

ALLRES = $(RESDEPEN)

ALLLIB = $(LIBFILES) import32.lib cw32.lib

.autodepend

 

#COMMANDS

.cpp.obj:

$(CC_DIR)\BIN\CC_DIR32 $(CFLAG1) $(CFLAG2) -o$* $**

 

.c.obj:

$(CC_DIR)\BIN\CC_DIR32 -I$(HB_DIR)\include $(CFLAG1) $(CFLAG2) -o$* $**

 

.prg.obj:

$(HB_DIR)\bin\harbour -D__EXPORT__ -n -go -I$(HB_DIR)\include $(HARBOURFLAGS) -o$* $**

 

.rc.res:

$(CC_DIR)\BIN\brcc32 $(RFLAGS) $<

 

#BUILD

 

$(PROJECT): $(CFILES) $(OBJFILES) $(RESDEPEN) $(DEFFILE)

    $(CC_DIR)\BIN\$(LINKER) @&&!

    $(LFLAGS) +

    $(ALLOBJ), +

    $(PROJECT),, +

    $(ALLLIB), +

    $(DEFFILE), +

    $(ALLRES)

 

 

 

Da: harbour-bounces@harbour-project.org [mailto:harbour-bounces@harbour-project.org] Per conto di Massimo Belgrano
Inviato: marted? 29 maggio 2007 15.47
A: harbour@harbour-project.org
Oggetto: [Harbour] I: Wich future for hbmake?

 

 

IMO hbmake is a component of x/harbour who is missing of same compoment for made x/harbour more attractive:

Indipendent from C++ compiler (same new user can't compile sample)

More easy wizard (hbmake without parameter must start wizard for create project file and Capability to go Next or previosus step)

Capable to Editing source 

 

An interesting model can be http://www.andywos.ih.co.za/xmate/ (very good freeware project) 

Will start a cross open source project withhttp://sourceforge.net/projects/sharpdevelop/ .or.  http://www.codeblocks.org/ .or. http://sourceforge.net/projects/dev-cpp/ ?

 

Most user (born with vb) want know only the make interface of compiler so with a good standard make also more user will be appreciate x/harbour

 

 

Massimo Belgrano <mailto:mbelgrano@deltain.com> 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070529/75d06332/attachment.html
From druzus at priv.onet.pl  Tue May 29 16:17:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 29 16:18:19 2007
Subject: [Harbour] mingw strings performance
In-Reply-To: <465C15B9.2030409@dbtopas.lt>
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
	<465C15B9.2030409@dbtopas.lt>
Message-ID: <20070529201742.GA32022@localhost.localdomain>

On Tue, 29 May 2007, Mindaugas Kavaliauskas wrote:
[...]
> s:=f4() ->                              84.33  134.03 *
> I haven't made more detail analysis, but f4() is memory allocation 
> function ( return space(50000) ). Perhaps memory manager of BCC is 
> better than MinGW?...

MinGW does not use own memory manager but redirects malloc/realloc/free
to WIN32 API functions LocalAlloc()/LocalReAlloc()/LocalFree() so you
should have similar results also in BCC when you build [x]Harbour with
HB_FM_WIN32_ALLOC macro. Similar but probably not well repeatable and
differ even on the same machine. I do not know why by the same sequence
of calls to Windows memory function as above gives strongly differ results.
When CRTL uses its own memory manager then it can hide this problem depending
on algorithm use to allocate/free memory from system. F.e. OpwnWatcom in
practice has always repeatable results because it very seldom returns memory
to system. In this test probably BCC also keeps the memory allocated and
it causes that results are better and the same on next calls. Probably if
you make some experiments with size of allocated block then you will find
the limit when BCC will free the memory immediately - if it uses one some
simple algorithm.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue May 29 18:10:22 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue May 29 18:10:25 2007
Subject: [Harbour] mingw strings performance
In-Reply-To: <20070529201742.GA32022@localhost.localdomain>
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
	<465C15B9.2030409@dbtopas.lt>
	<20070529201742.GA32022@localhost.localdomain>
Message-ID: <9257026e0705291510o774a318bk7bd5583432a9ce40@mail.gmail.com>

On 5/29/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> MinGW does not use own memory manager but redirects malloc/realloc/free
> ...
> the limit when BCC will free the memory immediately - if it uses one some
> simple algorithm.

Thanks for the info.

BTW looking for a workaround I've tried to build using
-DHB_PARANOID_MEM_CHECK and I got this error:

harbour.o:harbour.c:(.text+0x347): undefined reference to `_HB_MEM_PTR'

it seems that HB_MEM_PTR is missed in harbour.c

I've copied the one in fm.c:

#define HB_MEM_PTR( p )       ( ( void * ) ( ( BYTE * ) ( p ) +
HB_MEMINFO_SIZE ) )

Not very important the result is 10 times slower.

I'll check OW build.

best regards,
Lorenzo
From druzus at priv.onet.pl  Tue May 29 19:03:55 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 29 19:04:31 2007
Subject: [Harbour] ChangeLog 2007-05-30 01:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070529230355.GA25460@localhost.localdomain>

2007-05-30 01:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbcompdf.h
  * harbour/include/hbexprb.c
  * harbour/source/common/expropt1.c
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/macro/macro.y
  * harbour/source/macro/macro.yyc
    ! fixed bug in operator precedence - seems that it existed from
      beginning and partially were fixed in xHarbour. This code exploits
      the problem:
            #define EOL chr(13)+chr(10)
            #command ? [<x,...>] => [outstd( <x> );]outstd(EOL)
            #command TEST <exp> => BEGIN SEQUENCE     ;
                                 ;   ? <exp>          ;
                                 ; RECOVER USING oErr ;
                                 ;   ? "Error:", oErr:subCode, ;
                                       oErr:description, oErr:operation ;
                                 ; END
            proc main()
            local oErr, s1:="X", s2:="Y", t:=.T.
            errorBlock({|oErr|break(oErr)})
            TEST t != s1 $ s2
            TEST t == s1 $ s2
            TEST t =  s1 $ s2
            TEST t <  s1 $ s2
            TEST t <= s1 $ s2
            TEST t >  s1 $ s2
            TEST t >= s1 $ s2
            TEST s1 $ s2 != t
            TEST s1 $ s2 == t
            TEST s1 $ s2 =  t
            TEST s1 $ s2 >  t
            TEST s1 $ s2 <  t
            TEST s1 $ s2 >= t
            TEST s1 $ s2 <= t
            return

modifications done in both branches.

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 29 19:22:51 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 29 19:23:26 2007
Subject: [Harbour] mingw strings performance
In-Reply-To: <9257026e0705291510o774a318bk7bd5583432a9ce40@mail.gmail.com>
References: <9257026e0705290401x45408e3eh1a7da44f095f939a@mail.gmail.com>
	<465C15B9.2030409@dbtopas.lt>
	<20070529201742.GA32022@localhost.localdomain>
	<9257026e0705291510o774a318bk7bd5583432a9ce40@mail.gmail.com>
Message-ID: <20070529232251.GA19740@localhost.localdomain>

On Wed, 30 May 2007, Lorenzo Fiorini wrote:
> BTW looking for a workaround I've tried to build using
> -DHB_PARANOID_MEM_CHECK and I got this error:
> harbour.o:harbour.c:(.text+0x347): undefined reference to `_HB_MEM_PTR'
> it seems that HB_MEM_PTR is missed in harbour.c
> I've copied the one in fm.c:
> #define HB_MEM_PTR( p )       ( ( void * ) ( ( BYTE * ) ( p ) +
> HB_MEMINFO_SIZE ) )

HB_PARANOID_MEM_CHECK should be simple removed from compiler FM.
I'll do that ASAP - thanks for the info.

best regards,
Przemek
From druzus at priv.onet.pl  Tue May 29 19:35:10 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue May 29 19:35:46 2007
Subject: [Harbour] ChangeLog 2007-05-30 01:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070529233510.GA11646@localhost.localdomain>

2007-05-30 01:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/main/harbour.c
    - removed unnecessary code for HB_PARANOID_MEM_CHECK macro

best regards,
Przemek
From filip_stoklosa at op.pl  Wed May 30 03:04:18 2007
From: filip_stoklosa at op.pl (fs)
Date: Wed May 30 03:08:58 2007
Subject: [Harbour] hb_ntxSortWritePage: Can't create temporary file.
Message-ID: <200705300904.18888.filip_stoklosa@op.pl>

Hi,

To prevent linux users from entering the bash
I write in in /etc/passwd

	myuser:x:501:501::/home/myuser:/usr/bin/myapp

so after login the only thing they can do is using "myapp"
I also set TMPDIR=/tmp

While indexing large files (ntx) I have an error:

hb_ntxSortWritePage: Can't create temporary file.

I think it could be bug in /harbour/source/rtl/fstemp.c
function hb_fsCreateTemp

Regards,
Filip Stoklosa

From druzus at priv.onet.pl  Wed May 30 05:41:08 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 30 05:41:43 2007
Subject: [Harbour] hb_ntxSortWritePage: Can't create temporary file.
In-Reply-To: <200705300904.18888.filip_stoklosa@op.pl>
References: <200705300904.18888.filip_stoklosa@op.pl>
Message-ID: <20070530094108.GA17115@localhost.localdomain>

On Wed, 30 May 2007, fs wrote:
> To prevent linux users from entering the bash
> I write in in /etc/passwd
> 	myuser:x:501:501::/home/myuser:/usr/bin/myapp

It's not good idea - there are better ways to reach such effect.
Now many things may not be well configured.

> so after login the only thing they can do is using "myapp"
> I also set TMPDIR=/tmp

It may not be enough.

> While indexing large files (ntx) I have an error:
> hb_ntxSortWritePage: Can't create temporary file.
> I think it could be bug in /harbour/source/rtl/fstemp.c
> function hb_fsCreateTemp

I do not think so. hb_fsCreateTemp() is probably OK. You have .prg
interface to this function:
    HB_FTEMPCREATE( [cDir], [cPrefix], [nAttr], [@cTempFile] ) -> <nHandle>

Use it to check what is wrong in your configuration.

best regards,
Przemek
From druzus at priv.onet.pl  Wed May 30 05:59:40 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 30 06:00:18 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
	<20070529084939.GB22711@localhost.localdomain>
	<9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
Message-ID: <20070530095940.GA22272@localhost.localdomain>

On Tue, 29 May 2007, Lorenzo Fiorini wrote:
> I've copied xHarbour/source/rtl/pcre from my stable xHarbour tree.
> PCRE_MAJOR/MINOR state 6.3. I'm using it mainly under Linux and I've
> tested it under mingw.
> If the group agree I can upload it.

I'm not a fun of replicating code which I have in my system inside
Harbour but I have to accept that regular expressions are not standard
part of non *nix based platforms so probably we should have it.
I want to hear other developers opinions - but please do it fast so
we can decide if we should include PCRE in BETA3.

> P.S. I took official 7.1 sources and I got them working under Linux
> but there is an internal error in mingw that prevent to build.
> Probably this is why gnuwin32 still uses 7.0.

Lorenzo sorry, as I said I do not have time now to check carefully what has
been changed in the above versions. I know that version 6.3 from xHarbour
was working so probably is good choice. Now I'll only change used interface
from POSIX to native PCRE one when HB_PCRE_REGEX is set so it will be much
easier to use platform default build of PCRE instead the one included by us
for people who want to make sth like that.

best regards,
Przemek
From dbtopas at dbtopas.lt  Wed May 30 07:06:08 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Wed May 30 07:02:26 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070530095940.GA22272@localhost.localdomain>
References: <20070528165301.GA395@localhost.localdomain>	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>	<20070528220618.GA14966@localhost.localdomain>	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>	<20070529084939.GB22711@localhost.localdomain>	<9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
	<20070530095940.GA22272@localhost.localdomain>
Message-ID: <465D5AA0.1010700@dbtopas.lt>

Przemyslaw Czerpak wrote:
>>I've copied xHarbour/source/rtl/pcre from my stable xHarbour tree.
>>PCRE_MAJOR/MINOR state 6.3. I'm using it mainly under Linux and I've
>>tested it under mingw.
>>If the group agree I can upload it.
> 
> I'm not a fun of replicating code which I have in my system inside
> Harbour but I have to accept that regular expressions are not standard
> part of non *nix based platforms so probably we should have it.
> I want to hear other developers opinions - but please do it fast so
> we can decide if we should include PCRE in BETA3.

Hello,


I do not use regex very often. Usually only in small data import/parsing 
script, so my opinion is more "view from the side", but not opinion of 
the programmer who use it often.

I see here two problems. The first is POSIX vs. PCRE. The second is 
system regex library vs. replicated staticaly linked code.

If we want to make Harbour platform idependent, we must decide which 
regex syntax to use: POSIX or PCRE. This problem will become bigger if 
we have POSIX by default on Linux and PCRE by default on Windows. The 
prg code using regex will be not platform independent, and we will have:
   #ifdef __WINDOWS__
      IF HB_REGEXLIKE(..pcre_regex.., cString)
   #else
      IF HB_REGEXLIKE(..posix_regex.., cString)
   #endif
   ...

We can have both POSIX and PCRE, but we must use diffrent function names 
for it, ex., HB_REGEXLIKE() and HB_PCRELIKE(). Such situation is in PHP. 
PCRE functions has preg_* prefix, and ereg_* prefix is used for POSIX 
("e" for posix-Extended).


The second question is system library vs. replicated staticaly linked code.
The best solution is to use system library if it is available on the 
system, and to use replicated staticaly linked code if it is not 
available on the system. We can also use pcre.dll and pcreposix.dll on 
windows. But I'm not sure if it's good solution, because these .dll are 
not often installed on Windows, and without it, Harbour's .exe file 
could not be executed. Of cause, we can use dynamic .dll function 
binding via LoadLibrary, GetProcAddress to make .exe file "independent".

Is pcre system library available on linux by default? If yes, we can to 
use system pcre library on linux, and compile pcre code for windows 
builds, and this way avoid replicating system code.



Best regards,
Mindaugas
From lorenzo.fiorini at gmail.com  Wed May 30 07:03:08 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 30 07:03:11 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070530095940.GA22272@localhost.localdomain>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
	<20070529084939.GB22711@localhost.localdomain>
	<9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
	<20070530095940.GA22272@localhost.localdomain>
Message-ID: <9257026e0705300403n793cb770i442be6ba6c115ae0@mail.gmail.com>

On 5/30/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> but please do it fast so
> we can decide if we should include PCRE in BETA3.

I'm waiting for a go/nogo :)

I'm testing it under Linux and under mingw since days and it seems to work well.
There are only few warnings that surely C developers know how to properly fix.

best regards,
Lorenzo
From harbour.01 at syenar.hu  Wed May 30 07:10:47 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 30 07:10:54 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <465D5AA0.1010700@dbtopas.lt>
References: <20070528165301.GA395@localhost.localdomain>	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>	<20070528220618.GA14966@localhost.localdomain>	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>	<20070529084939.GB22711@localhost.localdomain>	<9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
	<20070530095940.GA22272@localhost.localdomain>
	<465D5AA0.1010700@dbtopas.lt>
Message-ID: <156F1DB3-4BD7-40F0-9950-A1FED6EEB305@syenar.hu>

> I do not use regex very often. Usually only in small data import/ 
> parsing script, so my opinion is more "view from the side", but not  
> opinion of the programmer who use it often.
>
> I see here two problems. The first is POSIX vs. PCRE. The second is  
> system regex library vs. replicated staticaly linked code.
>
> If we want to make Harbour platform idependent, we must decide  
> which regex syntax to use: POSIX or PCRE. This problem will become  
> bigger if we have POSIX by default on Linux and PCRE by default on  
> Windows. The prg code using regex will be not platform independent,  
> and we will have:
>   #ifdef __WINDOWS__
>      IF HB_REGEXLIKE(..pcre_regex.., cString)
>   #else
>      IF HB_REGEXLIKE(..posix_regex.., cString)
>   #endif
>   ...

This is definitely not an option for a feature in core Harbour.

> We can have both POSIX and PCRE, but we must use diffrent function  
> names for it, ex., HB_REGEXLIKE() and HB_PCRELIKE(). Such situation  
> is in PHP. PCRE functions has preg_* prefix, and ereg_* prefix is  
> used for POSIX ("e" for posix-Extended).

Good solution if we can have both statically linked and be
made multiplatform. (see below)

> The second question is system library vs. replicated staticaly  
> linked code.
> The best solution is to use system library if it is available on  
> the system, and to use replicated staticaly linked code if it is  
> not available on the system. We can also use pcre.dll and  
> pcreposix.dll on windows. But I'm not sure if it's good solution,  
> because these .dll are not often installed on Windows, and without  
> it, Harbour's .exe file could not be executed. Of cause, we can use  
> dynamic .dll function binding via LoadLibrary, GetProcAddress to  
> make .exe file "independent".
>
> Is pcre system library available on linux by default? If yes, we  
> can to use system pcre library on linux, and compile pcre code for  
> windows builds, and this way avoid replicating system code.

I didn't follow the discussion very closely (so I dunno the technical
implications of either choices), but my opinion is that
we _have to_ statically link everything which is needed for core
Harbour. If this cannot be done the feature should go to contrib.
We simply cannot expect users to distribute 3rd party .dlls as a
must, if they want to use some core features.

I would vote for whichever regex flavour which can be supported
on multiple platforms and statically linked at the same time. The
other flavour can be moved to contrib, so that users who need
it can still use it.

(looks like the fitting one is PCRE, right?)

My 2 cents.

Brgds,
Viktor

From lorenzo.fiorini at gmail.com  Wed May 30 07:12:04 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 30 07:12:07 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <465D5AA0.1010700@dbtopas.lt>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
	<20070529084939.GB22711@localhost.localdomain>
	<9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
	<20070530095940.GA22272@localhost.localdomain>
	<465D5AA0.1010700@dbtopas.lt>
Message-ID: <9257026e0705300412l6461e57dkf835e79c45f18db9@mail.gmail.com>

On 5/30/07, Mindaugas Kavaliauskas <dbtopas@dbtopas.lt> wrote:

> Is pcre system library available on linux by default? If yes, we can to
> use system pcre library on linux, and compile pcre code for windows
> builds, and this way avoid replicating system code.

I agree but I found difficult to address different C compilers.
A dll for msvc is different from bcc and mingw.

best regards,
Lorenzo
From e.m.giordano at emagsoftware.it  Wed May 30 08:32:35 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May 30 08:33:09 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070528165301.GA395@localhost.localdomain><9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com><20070528220618.GA14966@localhost.localdomain><9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com><20070529084939.GB22711@localhost.localdomain><9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com><20070530095940.GA22272@localhost.localdomain><465D5AA0.1010700@dbtopas.lt>
	<9257026e0705300412l6461e57dkf835e79c45f18db9@mail.gmail.com>
Message-ID: <001201c7a2b6$99edbaf0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Lorenzo Fiorini" <lorenzo.fiorini@gmail.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 30 maggio 2007 13.12
Oggetto: Re: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw 
Czerpak(druzus/at/priv.onet.pl)


> A dll for msvc is different from bcc and mingw.

If you are talking about standard Windows DLLs then this is not true. Or am I 
missing something?

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From lorenzo.fiorini at gmail.com  Wed May 30 09:04:54 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed May 30 09:04:57 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
In-Reply-To: <001201c7a2b6$99edbaf0$0100a8c0@emag>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
	<20070529084939.GB22711@localhost.localdomain>
	<9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
	<20070530095940.GA22272@localhost.localdomain>
	<465D5AA0.1010700@dbtopas.lt>
	<9257026e0705300412l6461e57dkf835e79c45f18db9@mail.gmail.com>
	<001201c7a2b6$99edbaf0$0100a8c0@emag>
Message-ID: <9257026e0705300604m5bd8f55ew11357d91db3e1ddc@mail.gmail.com>

On 5/30/07, Enrico Maria Giordano <e.m.giordano@emagsoftware.it> wrote:

> If you are talking about standard Windows DLLs then this is not true. Or am I
> missing something?

Sorry I've been too generic. I was talking about dll creation.

You can find some references at http://wyw.dcweb.cn/stdcall.htm

regards,
Lorenzo
From e.m.giordano at emagsoftware.it  Wed May 30 09:07:40 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed May 30 09:08:14 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200
	PrzemyslawCzerpak(druzus/at/priv.onet.pl)
References: <20070528165301.GA395@localhost.localdomain><9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com><20070528220618.GA14966@localhost.localdomain><9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com><20070529084939.GB22711@localhost.localdomain><9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com><20070530095940.GA22272@localhost.localdomain><465D5AA0.1010700@dbtopas.lt><9257026e0705300412l6461e57dkf835e79c45f18db9@mail.gmail.com><001201c7a2b6$99edbaf0$0100a8c0@emag>
	<9257026e0705300604m5bd8f55ew11357d91db3e1ddc@mail.gmail.com>
Message-ID: <004301c7a2bb$8098cc70$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Lorenzo Fiorini" <lorenzo.fiorini@gmail.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 30 maggio 2007 15.04
Oggetto: Re: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 
PrzemyslawCzerpak(druzus/at/priv.onet.pl)


> Sorry I've been too generic. I was talking about dll creation.

Ah, ok.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From druzus at priv.onet.pl  Wed May 30 10:48:45 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed May 30 10:49:23 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <156F1DB3-4BD7-40F0-9950-A1FED6EEB305@syenar.hu>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
	<20070529084939.GB22711@localhost.localdomain>
	<9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
	<20070530095940.GA22272@localhost.localdomain>
	<465D5AA0.1010700@dbtopas.lt>
	<156F1DB3-4BD7-40F0-9950-A1FED6EEB305@syenar.hu>
Message-ID: <20070530144845.GA26245@localhost.localdomain>

On Wed, 30 May 2007, Szak?ts Viktor wrote:
> >If we want to make Harbour platform idependent, we must decide  
> >which regex syntax to use: POSIX or PCRE. This problem will become  
> >bigger if we have POSIX by default on Linux and PCRE by default on  
> >Windows. The prg code using regex will be not platform independent,  
> >and we will have:
> >  #ifdef __WINDOWS__
> >     IF HB_REGEXLIKE(..pcre_regex.., cString)
> >  #else
> >     IF HB_REGEXLIKE(..posix_regex.., cString)
> >  #endif

I think you haven't used extensively regex on differ *nix platforms ;-)

> This is definitely not an option for a feature in core Harbour.

Please note that even in pure POSIX regex there are some differences
in implementation and if you do not use PCRE extensions then difference
between PCRE and POSIX regex will be at the same level.

Now NTX and CDX can use regular expression patterns for SEEK operations
(just like ordWildSeek()) - if we remove basic regex function from core
code we will have to also remove this extension.

If we want to keep regex support and you want exactly the same syntax
on all platforms then we to add PCRE to our code or create our own small
regex library with support only for basic construction.

> >We can have both POSIX and PCRE, but we must use diffrent function  
> >names for it, ex., HB_REGEXLIKE() and HB_PCRELIKE(). Such situation  
> >is in PHP. PCRE functions has preg_* prefix, and ereg_* prefix is  
> >used for POSIX ("e" for posix-Extended).
> Good solution if we can have both statically linked and be
> made multiplatform. (see below)

I will prefer to keep one regex format in core code and others can
be added as contrib libraries. If we will chose PCRE as core regex
library then I suggest to add some mechanism based on REQUEST to not
force linking it by default.

> >Is pcre system library available on linux by default? If yes, we  
> >can to use system pcre library on linux, and compile pcre code for  
> >windows builds, and this way avoid replicating system code.

Now PCRE is available in most of Linux distribution.
We can add simple build macro to control which library should be used
or we can call our own hbpcre so user can chose the one he needs at
linking time.

> I didn't follow the discussion very closely (so I dunno the technical
> implications of either choices), but my opinion is that
> we _have to_ statically link everything which is needed for core
> Harbour. If this cannot be done the feature should go to contrib.
> We simply cannot expect users to distribute 3rd party .dlls as a
> must, if they want to use some core features.
> I would vote for whichever regex flavour which can be supported
> on multiple platforms and statically linked at the same time. The
> other flavour can be moved to contrib, so that users who need
> it can still use it.
> (looks like the fitting one is PCRE, right?)

I'll made some basic modifications in core code to make it ready for
using our own PCRE library and the system one. Alternatively it will
be possible to use POSIX regex if user will want. I'll to that today.
Then if noone will protest I'll add some of PCRE versions to Harbour
core code.

best regards,
Przemek
From harbour.01 at syenar.hu  Wed May 30 10:57:27 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed May 30 10:57:38 2007
Subject: [Harbour] ChangeLog 2007-05-28 18:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070530144845.GA26245@localhost.localdomain>
References: <20070528165301.GA395@localhost.localdomain>
	<9257026e0705281316x4e89de4ds8cec1a6868e7d68@mail.gmail.com>
	<20070528220618.GA14966@localhost.localdomain>
	<9257026e0705282319j4fa93f81tf034d1dc1ee488dc@mail.gmail.com>
	<20070529084939.GB22711@localhost.localdomain>
	<9257026e0705290204o33f49685u58a7255153b0022b@mail.gmail.com>
	<20070530095940.GA22272@localhost.localdomain>
	<465D5AA0.1010700@dbtopas.lt>
	<156F1DB3-4BD7-40F0-9950-A1FED6EEB305@syenar.hu>
	<20070530144845.GA26245@localhost.localdomain>
Message-ID: <2CC1DA9A-2AA6-46F8-9112-8897776EB5FF@syenar.hu>

>>>  #ifdef __WINDOWS__
>>>     IF HB_REGEXLIKE(..pcre_regex.., cString)
>>>  #else
>>>     IF HB_REGEXLIKE(..posix_regex.., cString)
>>>  #endif
>
> I think you haven't used extensively regex on differ *nix  
> platforms ;-)

That's perfectly true, but I didn't write the above :)

>> This is definitely not an option for a feature in core Harbour.
>
> Please note that even in pure POSIX regex there are some differences
> in implementation and if you do not use PCRE extensions then  
> difference
> between PCRE and POSIX regex will be at the same level.
>
> Now NTX and CDX can use regular expression patterns for SEEK  
> operations
> (just like ordWildSeek()) - if we remove basic regex function from  
> core
> code we will have to also remove this extension.
>
> If we want to keep regex support and you want exactly the same syntax
> on all platforms then we to add PCRE to our code or create our own  
> small
> regex library with support only for basic construction.
>
>>> We can have both POSIX and PCRE, but we must use diffrent function
>>> names for it, ex., HB_REGEXLIKE() and HB_PCRELIKE(). Such situation
>>> is in PHP. PCRE functions has preg_* prefix, and ereg_* prefix is
>>> used for POSIX ("e" for posix-Extended).
>> Good solution if we can have both statically linked and be
>> made multiplatform. (see below)
>
> I will prefer to keep one regex format in core code and others can
> be added as contrib libraries. If we will chose PCRE as core regex
> library then I suggest to add some mechanism based on REQUEST to not
> force linking it by default.

Can't we make the sources which are using regex to be granular
enough to not link in PCRE unless any of the functions are actually
used on app level? (like ordWildSeek())

>>> Is pcre system library available on linux by default? If yes, we
>>> can to use system pcre library on linux, and compile pcre code for
>>> windows builds, and this way avoid replicating system code.
>
> Now PCRE is available in most of Linux distribution.
> We can add simple build macro to control which library should be used
> or we can call our own hbpcre so user can chose the one he needs at
> linking time.
>
>> I didn't follow the discussion very closely (so I dunno the technical
>> implications of either choices), but my opinion is that
>> we _have to_ statically link everything which is needed for core
>> Harbour. If this cannot be done the feature should go to contrib.
>> We simply cannot expect users to distribute 3rd party .dlls as a
>> must, if they want to use some core features.
>> I would vote for whichever regex flavour which can be supported
>> on multiple platforms and statically linked at the same time. The
>> other flavour can be moved to contrib, so that users who need
>> it can still use it.
>> (looks like the fitting one is PCRE, right?)
>
> I'll made some basic modifications in core code to make it ready for
> using our own PCRE library and the system one. Alternatively it will
> be possible to use POSIX regex if user will want. I'll to that today.
> Then if noone will protest I'll add some of PCRE versions to Harbour
> core code.

Very good, thank you.

Brgds,
Viktor



From miguelangel at marchuet.net  Thu May 31 06:09:45 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Thu May 31 06:09:52 2007
Subject: [Harbour] Suggest on TRY CATCH
Message-ID: <465E9EE9.5030108@marchuet.net>

Some times I only need that TRY catches ignore some errors
and this error I want to be resolved as error without TRY

for example

   // by default, division by zero yields zero
   if ( e:genCode == EG_ZERODIV )
      return 0
   endif


I propouse the next change:

TRY
 <statements>
 [THROW( <oErrorObject> )]
 CATCH [<thrownError>] [EXCEPTION <exception>]
   <errorHandling>
 [CATCH [<thrownError>] [EXCEPTION <exception>] [EXCLUDE <exception>]]
   <errorHandling>
   [RESOLVE <uReturnValue>]
 [FINALLY
  <guaranteed> ]
END [TRY]


RESOLVE clause will cause the same effect as RETURN in ErrorHandler.


Example:

TRY
 ...
CATCH oErr EXCEPTION EG_APPENDLOCK
END TRY


Only  EG_APPENDLOCK are cached all other error will be resolved by
errorhandler.

OR

TRY
 ...
CATCH oErr EXCEPTION ALL EXCLUDE EG_ZERODIV
END TRY


Best regards,
Miguel Angel Marchuet
From druzus at priv.onet.pl  Thu May 31 09:20:25 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 09:21:01 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070531132025.GA25947@localhost.localdomain>

2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
  * harbour/makefile.bc
  * harbour/makefile.vc
  * harbour/bin/hb-func.sh
  * harbour/config/bsd/gcc.cf
  * harbour/config/darwin/gcc.cf
  * harbour/config/hpux/gcc.cf
  * harbour/config/linux/gcc.cf
  * harbour/config/sunos/gcc.cf
  * harbour/source/Makefile
  + harbour/source/hbpcre/ChangeLog
  + harbour/source/hbpcre/Makefile
  + harbour/source/hbpcre/chartabs.c
  + harbour/source/hbpcre/config.h
  + harbour/source/hbpcre/dftables.c
  + harbour/source/hbpcre/pcre.h
  + harbour/source/hbpcre/pcrecomp.c
  + harbour/source/hbpcre/pcreconf.c
  + harbour/source/hbpcre/pcredfa.c
  + harbour/source/hbpcre/pcreexec.c
  + harbour/source/hbpcre/pcrefind.c
  + harbour/source/hbpcre/pcrefinf.c
  + harbour/source/hbpcre/pcreget.c
  + harbour/source/hbpcre/pcreglob.c
  + harbour/source/hbpcre/pcreinal.h
  + harbour/source/hbpcre/pcreinfo.c
  + harbour/source/hbpcre/pcremktb.c
  + harbour/source/hbpcre/pcreoutf.c
  + harbour/source/hbpcre/pcreprni.c
  + harbour/source/hbpcre/pcrerefc.c
  + harbour/source/hbpcre/pcrestud.c
  + harbour/source/hbpcre/pcretabs.c
  + harbour/source/hbpcre/pcretryf.c
  + harbour/source/hbpcre/pcrever.c
  + harbour/source/hbpcre/pcrevutf.c
  + harbour/source/hbpcre/pcrexcls.c
  + harbour/source/hbpcre/ucp.h
  + harbour/source/hbpcre/ucpinter.h
  + harbour/source/hbpcre/ucptable.c
    + added HBPCRE library - based on older xHarbour 6.3 version
      filenames changed to 8.3 DOS format

  * harbour/include/hbregex.h
  * harbour/source/rtl/Makefile
  * harbour/source/rtl/hbregex.c
  + harbour/source/rtl/hbregexc.c
    * divided harbour regular expression functions into two files
      Now regular expression low level library is not linked with
      application until user will not use or REQUEST for one of HB_REGEX*
      functions. It also means that also DBOI_SKIPREGEX will not work when
      regex module is not linked.
    + added support for build-in regular expression library
    + added ulLen parameter to hb_regexMatch() to support strings with
      embedded 0

  * harbour/contrib/bmdbfcdx/bmdbfcdx1.c
  * harbour/source/rdd/dbfcdx/dbfcdx1.c
  * harbour/source/rdd/dbfntx/dbfntx1.c
  * harbour/source/rtl/strmatch.c
    * use new hb_regexMatch() format

  * harbour/utils/hbrun/Makefile
    + added hbpcre to linked library list

modifications synced in both branches

best regards,
Przemek
From harbour.01 at syenar.hu  Thu May 31 09:35:14 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu May 31 09:35:23 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531132025.GA25947@localhost.localdomain>
References: <20070531132025.GA25947@localhost.localdomain>
Message-ID: <7719FD1C-D882-48FD-8B31-EBD43070EE25@syenar.hu>

Hi Przemek,

> 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)

Shouldn't we split strmatch.c so that a simple hb_strMatch*Wild*() call
doesn't make the final app require the whole PCRE lib to be linked?

Basically hb_strMatchRegExp() should be moved to a separate .c
file I think to avoid the above.

Brgds,
Viktor

From druzus at priv.onet.pl  Thu May 31 09:53:24 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 09:54:01 2007
Subject: [Harbour] Suggest on TRY CATCH
In-Reply-To: <465E9EE9.5030108@marchuet.net>
References: <465E9EE9.5030108@marchuet.net>
Message-ID: <20070531135324.GB25947@localhost.localdomain>

On Thu, 31 May 2007, Miguel Angel Marchuet wrote:
> Some times I only need that TRY catches ignore some errors
> and this error I want to be resolved as error without TRY
> for example
>    // by default, division by zero yields zero
>    if ( e:genCode == EG_ZERODIV )
>       return 0
>    endif

This is the reason why I do not like TRY/CATCH and why I haven't added
it to Harbour. It's only limited version of BEGIN SEQUENCE / RECOVER.

> I propouse the next change:
> TRY
>  <statements>
>  [THROW( <oErrorObject> )]
>  CATCH [<thrownError>] [EXCEPTION <exception>]
>    <errorHandling>
>  [CATCH [<thrownError>] [EXCEPTION <exception>] [EXCLUDE <exception>]]
>    <errorHandling>
>    [RESOLVE <uReturnValue>]
>  [FINALLY
>   <guaranteed> ]
> END [TRY]
> RESOLVE clause will cause the same effect as RETURN in ErrorHandler.

This cannot be implemented because RESOLVE will be executed in differ
context then the one where substitution can be done. The excpetion can
appear in some nested functions and then we have to clean the stack to
return to the code inside CATCH to execute it properly in local context.
At this moment any substitution is not possible because code where
exception apeared was interrupted and HVM stack restored. This can be
done only by some codeblock executed before stack cleanup. Just like
it's done for BEGIN SEQUENCE / RECOVER. So you can simply stop using
TRY / CATCH and begin to use BEGIN SEQUENCE / RECOVER with your own
error block which will filter exception as you like. You can use
preprocessor if you do not want to change your source code.
Or you can add to xHarbour support for TryBlock() similar to ErrorBlock()
which will be set when TRY / CATCH is executed. This block is inside
hb_vm_BreakBlock and by default it's initialized to:
    { |oErr| break( oErr ) }
You can replace it with your own code which will not execute break() for
some exceptions.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May 31 09:57:11 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 09:57:47 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <7719FD1C-D882-48FD-8B31-EBD43070EE25@syenar.hu>
References: <20070531132025.GA25947@localhost.localdomain>
	<7719FD1C-D882-48FD-8B31-EBD43070EE25@syenar.hu>
Message-ID: <20070531135711.GC25947@localhost.localdomain>

On Thu, 31 May 2007, Szak?ts Viktor wrote:
> Hi Przemek,
> >2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> Shouldn't we split strmatch.c so that a simple hb_strMatch*Wild*() call
> doesn't make the final app require the whole PCRE lib to be linked?

Have you checked if the above is true? Please try.

> Basically hb_strMatchRegExp() should be moved to a separate .c
> file I think to avoid the above.

It executes only hbregexc.c functions and in this file there is no
direct reference to low level regex functions.
Such references exists only in hbregex.c and as long as this file
is not linked low level regex library is not necessary.

best regards,
Przemek
From harbour.01 at syenar.hu  Thu May 31 10:05:57 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu May 31 10:06:03 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531135711.GC25947@localhost.localdomain>
References: <20070531132025.GA25947@localhost.localdomain>
	<7719FD1C-D882-48FD-8B31-EBD43070EE25@syenar.hu>
	<20070531135711.GC25947@localhost.localdomain>
Message-ID: <5B7C5311-131D-44F9-A0D2-E9DC1F0A89B7@syenar.hu>

No, I've just followed the call chain for short while, but
if it is so, it's perfectly okey and thanks for this implementation.

(I started to understand the logic too :)

What happens exactly if someone happens to use
DBOI_SKIPREGEX without REQUEST HB_REGEX?

Brgds,
Viktor

On 2007.05.31., at 15:57, Przemyslaw Czerpak wrote:

> On Thu, 31 May 2007, Szak?ts Viktor wrote:
>> Hi Przemek,
>>> 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak (druzus/at/ 
>>> priv.onet.pl)
>> Shouldn't we split strmatch.c so that a simple hb_strMatch*Wild*()  
>> call
>> doesn't make the final app require the whole PCRE lib to be linked?
>
> Have you checked if the above is true? Please try.
>
>> Basically hb_strMatchRegExp() should be moved to a separate .c
>> file I think to avoid the above.
>
> It executes only hbregexc.c functions and in this file there is no
> direct reference to low level regex functions.
> Such references exists only in hbregex.c and as long as this file
> is not linked low level regex library is not necessary.
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From e.m.giordano at emagsoftware.it  Thu May 31 10:12:44 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May 31 10:13:19 2007
Subject: [Harbour] Error in latest CVS using BCC
Message-ID: <004301c7a38d$c1fcb9b0$0100a8c0@emag>

MAKE Version 5.2  Copyright (c) 1987, 2000 Borland
Error makefile.bc 359: Command syntax error
Error makefile.bc 360: Command syntax error
Error makefile.bc 362: Command syntax error
*** 3 errors during make ***

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic
From druzus at priv.onet.pl  Thu May 31 10:23:09 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 10:23:46 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <5B7C5311-131D-44F9-A0D2-E9DC1F0A89B7@syenar.hu>
References: <20070531132025.GA25947@localhost.localdomain>
	<7719FD1C-D882-48FD-8B31-EBD43070EE25@syenar.hu>
	<20070531135711.GC25947@localhost.localdomain>
	<5B7C5311-131D-44F9-A0D2-E9DC1F0A89B7@syenar.hu>
Message-ID: <20070531142309.GA6376@localhost.localdomain>

On Thu, 31 May 2007, Szak?ts Viktor wrote:
> What happens exactly if someone happens to use
> DBOI_SKIPREGEX without REQUEST HB_REGEX?

Error BASE/3012  Invalid Regular expression: DBORDERINFO

best regards,
Przemek
From harbour.01 at syenar.hu  Thu May 31 10:28:29 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu May 31 10:28:47 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531142309.GA6376@localhost.localdomain>
References: <20070531132025.GA25947@localhost.localdomain>
	<7719FD1C-D882-48FD-8B31-EBD43070EE25@syenar.hu>
	<20070531135711.GC25947@localhost.localdomain>
	<5B7C5311-131D-44F9-A0D2-E9DC1F0A89B7@syenar.hu>
	<20070531142309.GA6376@localhost.localdomain>
Message-ID: <16A66AB5-761D-4765-ADDF-F4BFBFD8EDE7@syenar.hu>

Perfect. Many thanks again!

Brgds,
Viktor

On 2007.05.31., at 16:23, Przemyslaw Czerpak wrote:

> On Thu, 31 May 2007, Szak?ts Viktor wrote:
>> What happens exactly if someone happens to use
>> DBOI_SKIPREGEX without REQUEST HB_REGEX?
>
> Error BASE/3012  Invalid Regular expression: DBORDERINFO
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From miguelangel at marchuet.net  Thu May 31 10:30:56 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Thu May 31 10:30:53 2007
Subject: [Harbour] Suggest on TRY CATCH
In-Reply-To: <20070531135324.GB25947@localhost.localdomain>
References: <465E9EE9.5030108@marchuet.net>
	<20070531135324.GB25947@localhost.localdomain>
Message-ID: <465EDC20.2060002@marchuet.net>

many thk's, I will try it.


Przemyslaw Czerpak escribi?:
> On Thu, 31 May 2007, Miguel Angel Marchuet wrote:
>> Some times I only need that TRY catches ignore some errors
>> and this error I want to be resolved as error without TRY
>> for example
>>    // by default, division by zero yields zero
>>    if ( e:genCode == EG_ZERODIV )
>>       return 0
>>    endif
> 
> This is the reason why I do not like TRY/CATCH and why I haven't added
> it to Harbour. It's only limited version of BEGIN SEQUENCE / RECOVER.
> 
>> I propouse the next change:
>> TRY
>>  <statements>
>>  [THROW( <oErrorObject> )]
>>  CATCH [<thrownError>] [EXCEPTION <exception>]
>>    <errorHandling>
>>  [CATCH [<thrownError>] [EXCEPTION <exception>] [EXCLUDE <exception>]]
>>    <errorHandling>
>>    [RESOLVE <uReturnValue>]
>>  [FINALLY
>>   <guaranteed> ]
>> END [TRY]
>> RESOLVE clause will cause the same effect as RETURN in ErrorHandler.
> 
> This cannot be implemented because RESOLVE will be executed in differ
> context then the one where substitution can be done. The excpetion can
> appear in some nested functions and then we have to clean the stack to
> return to the code inside CATCH to execute it properly in local context.
> At this moment any substitution is not possible because code where
> exception apeared was interrupted and HVM stack restored. This can be
> done only by some codeblock executed before stack cleanup. Just like
> it's done for BEGIN SEQUENCE / RECOVER. So you can simply stop using
> TRY / CATCH and begin to use BEGIN SEQUENCE / RECOVER with your own
> error block which will filter exception as you like. You can use
> preprocessor if you do not want to change your source code.
> Or you can add to xHarbour support for TryBlock() similar to ErrorBlock()
> which will be set when TRY / CATCH is executed. This block is inside
> hb_vm_BreakBlock and by default it's initialized to:
>     { |oErr| break( oErr ) }
> You can replace it with your own code which will not execute break() for
> some exceptions.
> 
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From lorenzo.fiorini at gmail.com  Thu May 31 11:33:39 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 31 11:33:42 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531132025.GA25947@localhost.localdomain>
References: <20070531132025.GA25947@localhost.localdomain>
Message-ID: <9257026e0705310833lbb3495eo49b1f2c1a16327c2@mail.gmail.com>

On 5/31/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
> 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/common.mak
> ...
>   * harbour/bin/hb-func.sh
>   * harbour/utils/hbrun/Makefile
>     + added hbpcre to linked library list
>
> modifications synced in both branches

Really many thanks, the best solution as usual.

My apps are ok since I link hbpcre in the makefiles but hbmk doesn't
find hbpcre.

In hb-func-sh there is:

...

if [ "${C_USR//-DHB_PCRE_REGEX/}" != "${C_USR}" ]; then
        HB_SYS_LIBS="-lpcre ${HB_SYS_LIBS}"
        hb_libs="${hb_libs//hbpcre/}"
    elif [ "${C_USR//-DHB_POSIX_REGEX/}" = "${C_USR}" ]; then
        hb_libs="${hb_libs//hbpcre/}"
    fi

...

but I'm not sure I understand it correctly.

What should I have in C_USR to use only hbpcre?

best regards,
Lorenzo
From druzus at priv.onet.pl  Thu May 31 11:35:07 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 11:35:43 2007
Subject: [Harbour] ChangeLog 2007-05-31 17:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070531153507.GA11794@localhost.localdomain>

2007-05-31 17:30 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
    ! added PCRE_LIB

  * harbour/bin/hb-func.sh
    ! fixed typo in last commit

  * harbour/source/hbpcre/pcredfa.c
  * harbour/source/hbpcre/pcreexec.c
  * harbour/source/hbpcre/pcrefind.c
  * harbour/source/hbpcre/pcreprni.c
  * harbour/source/hbpcre/pcrestud.c
  * harbour/source/hbpcre/pcretryf.c
    * cleaned some warnings

modifications synced in both branches.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May 31 11:39:11 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 11:39:48 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705310833lbb3495eo49b1f2c1a16327c2@mail.gmail.com>
References: <20070531132025.GA25947@localhost.localdomain>
	<9257026e0705310833lbb3495eo49b1f2c1a16327c2@mail.gmail.com>
Message-ID: <20070531153911.GB11794@localhost.localdomain>

On Thu, 31 May 2007, Lorenzo Fiorini wrote:
> My apps are ok since I link hbpcre in the makefiles but hbmk doesn't
> find hbpcre.
> In hb-func-sh there is:
> ...
> if [ "${C_USR//-DHB_PCRE_REGEX/}" != "${C_USR}" ]; then
>        HB_SYS_LIBS="-lpcre ${HB_SYS_LIBS}"
>        hb_libs="${hb_libs//hbpcre/}"
>    elif [ "${C_USR//-DHB_POSIX_REGEX/}" = "${C_USR}" ]; then
>        hb_libs="${hb_libs//hbpcre/}"
>    fi
> ...
> but I'm not sure I understand it correctly.
> What should I have in C_USR to use only hbpcre?

Nothing. Above is typo I fixed and committed few minutes ago.
instead of:
    elif [ "${C_USR//-DHB_POSIX_REGEX/}" = "${C_USR}" ]; then
should be:
    elif [ "${C_USR//-DHB_POSIX_REGEX/}" != "${C_USR}" ]; then

best regards,
Przemek
From ari.ody at japinfo.com.br  Thu May 31 11:42:01 2007
From: ari.ody at japinfo.com.br (=?iso-8859-1?Q?Ar=ED?= Ricardo Ody)
Date: Thu May 31 11:42:55 2007
Subject: [Harbour] Fwd: Tilt?
Message-ID: <mailman.0.1180626175.3477.harbour@harbour-project.org>


>May someone give me some help?
>
>
>I build the program:
>
>proc teste
>loca xxx := spac (3),getlist
>clea scre
>@ 1,0 say 'xxx -> ' get xxx pict '@!'
>read
>? xxx
>retu
>
>============================================================================
>
>Look below and see the build execution:
>
>c:\xharbour\bin>build teste
>xHarbour Compiler build 0.99.50 (SimpLex)
>Copyright 1999-2005, http://www.xharbour.org http://www.harbour-project.org/
>Borland C++ 5.5.1 for Win32 Copyright (c) 1993, 2000 Borland
>teste.c:
>Turbo Incremental Link 5.00 Copyright (c) 1997, 2000 Borland
>
>c:\xharbour\bin>
>
>Running the program....
>
>============================================================================
>
>c:\xharbour\bin>teste
>
>============================================================================
>
>
>xxx ->
>
>============================================================================
>
>I type 'aaa' (without quotes) and <enter>
>
>============================================================================
>And receive...
>
>
>xxx ->
>Error BASE/1123  Argument error: AADD Arguments: ( [ 1] = Type: U [ 
>2] = Type: O
>  Val: { GET Object })
>
>Error at ...: AADD(0) in Module:
>Called from : TESTE(0) in Module: teste.prg
>
>c:\xharbour\bin>


From lorenzo.fiorini at gmail.com  Thu May 31 11:46:28 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 31 11:46:32 2007
Subject: [Harbour] ChangeLog 2007-05-31 15:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531153911.GB11794@localhost.localdomain>
References: <20070531132025.GA25947@localhost.localdomain>
	<9257026e0705310833lbb3495eo49b1f2c1a16327c2@mail.gmail.com>
	<20070531153911.GB11794@localhost.localdomain>
Message-ID: <9257026e0705310846v2b2092b4x4ea496ef2e825f99@mail.gmail.com>

On 5/31/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Nothing. Above is typo I fixed and committed few minutes ago.
> instead of:
>     elif [ "${C_USR//-DHB_POSIX_REGEX/}" = "${C_USR}" ]; then
> should be:
>     elif [ "${C_USR//-DHB_POSIX_REGEX/}" != "${C_USR}" ]; then

Many thanks it's ok now.

best regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Thu May 31 12:35:39 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 31 12:35:47 2007
Subject: [Harbour] ChangeLog 2007-05-31 17:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531153507.GA11794@localhost.localdomain>
References: <20070531153507.GA11794@localhost.localdomain>
Message-ID: <9257026e0705310935i2075e1e0yb391786e33660d58@mail.gmail.com>

On 5/31/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

I'm trying to get a cross mingw32 build but I get this:

./make_xmingw.sh -s
../../../../source/rtl/w32/mingw32/librtl.a(hbregex.o):hbregex.c:(.text+0xd):
undefined reference to `__imp__pcre_free'
.....
../../../../source/rtl/w32/mingw32/librtl.a(hbregex.o):hbregex.c:(.text+0xa91):
undefined reference to `__imp__pcre_exec'
../../../../source/rtl/w32/mingw32/librtl.a(hbregex.o):hbregex.c:(.text+0xf0d):
undefined reference to `__imp__pcre_malloc'
...

in config/* there is no reference to hbpcre.

What I'm missing?

best regards,
Lorenzo
From e.m.giordano at emagsoftware.it  Thu May 31 13:10:34 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May 31 13:11:10 2007
Subject: [Harbour] Still error in latest CVS
Message-ID: <002a01c7a3a6$9a367fb0$0100a8c0@emag>

Fatal: 'obj\b32\chartabs.obj' does not exist - don't know how to make it

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic
From carlos.mora at cpcipc.org  Thu May 31 14:21:36 2007
From: carlos.mora at cpcipc.org (Carlos Mora)
Date: Thu May 31 14:22:13 2007
Subject: [Harbour] Fwd: Tilt?
In-Reply-To: <20070531154301.1F773CEF24@mailserver.cpcipc.org>
References: <20070531154301.1F773CEF24@mailserver.cpcipc.org>
Message-ID: <465F1230.4030407@cpcipc.org>

Ar? Ricardo Ody escribi?:
> 
>> May someone give me some help?
>>
>>
>> I build the program:
>>
>> proc teste
>> loca xxx := spac (3),getlist
>> clea scre
>> @ 1,0 say 'xxx -> ' get xxx pict '@!'
>> read
>> ? xxx
>> retu
>>
Try to no declare getlist, or initialize it properly

Local getList:= {}

Regards,

Carlos
From druzus at priv.onet.pl  Thu May 31 15:28:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 15:29:09 2007
Subject: [Harbour] ChangeLog 2007-05-31 21:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070531192832.GA1760@localhost.localdomain>

2007-05-31 21:25 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
  * harbour/makefile.vc
    * added some missing declaration for PCRE library

  * harbour/include/hbregex.h
    * added PCRE_STATIC - it fixes problem with MinGW build

  * harbour/utils/hbrun/Makefile
    * removed one redundant hbpcre from library list

Modifications synced in both branches.

best regards,
Przemek
From ari.ody at japinfo.com.br  Thu May 31 15:42:39 2007
From: ari.ody at japinfo.com.br (=?iso-8859-1?Q?Ar=ED?= Ricardo Ody)
Date: Thu May 31 15:43:31 2007
Subject: [Harbour] Fwd: Tilt?
In-Reply-To: <465F1230.4030407@cpcipc.org>
References: <20070531154301.1F773CEF24@mailserver.cpcipc.org>
	<465F1230.4030407@cpcipc.org>
Message-ID: <mailman.1.1180640611.3477.harbour@harbour-project.org>

At 15:21 31/5/2007, you wrote:

>>>(deleted text)



>Try to no declare getlist, or initialize it properly
>
>Local getList:= {}
>
>Regards,
>
>Carlos

It solves the problem, thank you. But in this case Harbour differs 
from Clipper, no?

[ ]

Ricardo

From lorenzo.fiorini at gmail.com  Thu May 31 16:41:52 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 31 16:41:55 2007
Subject: [Harbour] ChangeLog 2007-05-31 21:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531192832.GA1760@localhost.localdomain>
References: <20070531192832.GA1760@localhost.localdomain>
Message-ID: <9257026e0705311341r1844ae63na9dc1c949d1c091d@mail.gmail.com>

On 5/31/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

>   * harbour/include/hbregex.h
>     * added PCRE_STATIC - it fixes problem with MinGW build

Many thanks, now mingw builds without any error or warning.

gcc 4.1.2 while under Fedora 7 ( born today ) gives:

../../pcrecomp.c: In function 'compile_regex':
../../pcrecomp.c:3283: warning: 'negated' may be used uninitialized in
this function
../../pcrecomp.c: In function 'pcre_compile2':
../../pcrecomp.c:3958: warning: 'max' may be used uninitialized in this function
../../pcrecomp.c:3958: warning: 'min' may be used uninitialized in this function

best regards,
Lorenzo
From druzus at priv.onet.pl  Thu May 31 17:36:29 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 17:37:04 2007
Subject: [Harbour] ChangeLog 2007-05-31 23:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070531213629.GA20120@localhost.localdomain>

2007-05-31 23:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/compiler/harbour.yyc
    * synced with recent modifications in harbour.y - I missed it.
  * harbour/source/hbpcre/pcrecomp.c
    * cleaned some waning reported by Lorenzo

best regards,
Przemek
From druzus at priv.onet.pl  Thu May 31 17:38:01 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 17:38:39 2007
Subject: [Harbour] Still error in latest CVS
In-Reply-To: <002a01c7a3a6$9a367fb0$0100a8c0@emag>
References: <002a01c7a3a6$9a367fb0$0100a8c0@emag>
Message-ID: <20070531213801.GB20120@localhost.localdomain>

On Thu, 31 May 2007, Enrico Maria Giordano wrote:
> Fatal: 'obj\b32\chartabs.obj' does not exist - don't know how to make it

Please try after:
    2007-05-31 21:25 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)

should be fixed - sorry but I cannot test non GNU make files on Linux
when I'm updating them.

best regards,
Przemek
From druzus at priv.onet.pl  Thu May 31 17:41:33 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 17:42:09 2007
Subject: [Harbour] ChangeLog 2007-05-31 21:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705311341r1844ae63na9dc1c949d1c091d@mail.gmail.com>
References: <20070531192832.GA1760@localhost.localdomain>
	<9257026e0705311341r1844ae63na9dc1c949d1c091d@mail.gmail.com>
Message-ID: <20070531214133.GC20120@localhost.localdomain>

On Thu, 31 May 2007, Lorenzo Fiorini wrote:
> On 5/31/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
> >  * harbour/include/hbregex.h
> >    * added PCRE_STATIC - it fixes problem with MinGW build
> Many thanks, now mingw builds without any error or warning.
> gcc 4.1.2 while under Fedora 7 ( born today ) gives:
> ../../pcrecomp.c: In function 'compile_regex':
> ../../pcrecomp.c:3283: warning: 'negated' may be used uninitialized in
> this function
> ../../pcrecomp.c: In function 'pcre_compile2':
> ../../pcrecomp.c:3958: warning: 'max' may be used uninitialized in this 
> function
> ../../pcrecomp.c:3958: warning: 'min' may be used uninitialized in this 
> function

Try it after:
    2007-05-31 23:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)

The last two warnings will be fixed for sure but I'm not sure if the
first one too - if new GCC is clever enough then yes ;-) - it should
analyze the body of autoinlined function. If not then I'll make it in
differ way.

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Thu May 31 17:43:27 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Thu May 31 17:44:04 2007
Subject: [Harbour] Still error in latest CVS
References: <002a01c7a3a6$9a367fb0$0100a8c0@emag>
	<20070531213801.GB20120@localhost.localdomain>
Message-ID: <00e801c7a3cc$b8cc2170$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: giovedi 31 maggio 2007 23.38
Oggetto: Re: [Harbour] Still error in latest CVS


> Please try after:
>    2007-05-31 21:25 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> 
> should be fixed

Yes, thank you!

> - sorry but I cannot test non GNU make files on Linux
> when I'm updating them.

I know, no problem.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic
From druzus at priv.onet.pl  Thu May 31 18:28:54 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 18:29:31 2007
Subject: [Harbour] ChangeLog 2007-06-01 00:15 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070531222854.GA9605@localhost.localdomain>

2007-06-01 00:15 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/harbour.spec
  * harbour/bin/pack_src.sh
    + added hbpcre library

Please make build test on different platforms and report any problems.
I would like to set BETA3 tag soon.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Thu May 31 18:35:33 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 31 18:35:37 2007
Subject: [Harbour] ChangeLog 2007-05-31 21:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531214133.GC20120@localhost.localdomain>
References: <20070531192832.GA1760@localhost.localdomain>
	<9257026e0705311341r1844ae63na9dc1c949d1c091d@mail.gmail.com>
	<20070531214133.GC20120@localhost.localdomain>
Message-ID: <9257026e0705311535o5dde5c75x284d37877c3a4360@mail.gmail.com>

On 5/31/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> The last two warnings will be fixed for sure but I'm not sure if the
> first one too - if new GCC is clever enough then yes ;-) - it should
> analyze the body of autoinlined function. If not then I'll make it in
> differ way.

gcc seems clever enough :) no more warnings.

IMHO in this moment CVS is stable and clean:

- I have clean builds in Linux and mingw cross compiled in Linux
- hb* scripts work and even harbour.dll is correctly managed using -shared :)
- my apps are built and work without any error and no trace.log is generated

Since I still maintain Fivewin 16bit versions I keep the code of my
desktop apps compatible with C53b so I can build the same sources with
it.
I have the same results ( using some prg from xHarbour rtl ) in term
of UI and dbfcdx with much better performance and many more features.

In cgi/ajax apps I use extensively contrib/tip, contrib/gd and
contrib/pgsql and I use
escaped strings as default. I have HB_COMPAT_XHB and HB_PP_MULTILINE_STRING
Tomorrow I'll commit some changes to tip/cgi.prg and
pgsql/tpostgre.prg and I'll do more tests.

Many thanks for your help.

best regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Thu May 31 18:40:09 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu May 31 18:40:14 2007
Subject: [Harbour] ChangeLog 2007-06-01 00:15 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070531222854.GA9605@localhost.localdomain>
References: <20070531222854.GA9605@localhost.localdomain>
Message-ID: <9257026e0705311540t2b038127h78cc159f46474588@mail.gmail.com>

On 6/1/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

>   * harbour/harbour.spec
>   * harbour/bin/pack_src.sh
>     + added hbpcre library

I've done some changes to pack_src.sh, make_rpm.sh and harbour.spec to
add tip, gd and pgsql.

Are you interested?

best regards,
Lorenzo
From druzus at priv.onet.pl  Thu May 31 18:52:39 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 18:53:15 2007
Subject: [Harbour] ChangeLog 2007-06-01 00:15 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0705311540t2b038127h78cc159f46474588@mail.gmail.com>
References: <20070531222854.GA9605@localhost.localdomain>
	<9257026e0705311540t2b038127h78cc159f46474588@mail.gmail.com>
Message-ID: <20070531225239.GA9774@localhost.localdomain>

On Fri, 01 Jun 2007, Lorenzo Fiorini wrote:
> On 6/1/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
> >  * harbour/harbour.spec
> >  * harbour/bin/pack_src.sh
> >    + added hbpcre library
> I've done some changes to pack_src.sh, make_rpm.sh and harbour.spec to
> add tip, gd and pgsql.
> Are you interested?

Yes, sure. Please commit but AFAIR TIP can work only when Harbour
is compiled with HB_COMPAT_XHB so it should be enabled optionally,
f.e. when RPM is created with:
    --with xhb
switch.

best regards,
Przemek
From harbour.01 at syenar.hu  Thu May 31 20:09:37 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu May 31 20:09:38 2007
Subject: [Harbour] CHANGELOG: 2007-06-01 02:08 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c7a3e1$Blat.v2.6.1$2480a72e$1518a123f61a@127.0.0.1>

2007-06-01 02:08 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/bin/bld.sh
     ! Updated list of libs for linux/gcc.

   * harbour/bin/bld.bat
     * Minor.

From druzus at priv.onet.pl  Thu May 31 20:35:38 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu May 31 20:36:13 2007
Subject: [Harbour] CHANGELOG: 2007-06-01 02:08 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
In-Reply-To: <01c7a3e1$Blat.v2.6.1$2480a72e$1518a123f61a@127.0.0.1>
References: <01c7a3e1$Blat.v2.6.1$2480a72e$1518a123f61a@127.0.0.1>
Message-ID: <20070601003538.GA19171@localhost.localdomain>

On Fri, 01 Jun 2007, Szak?ts Viktor wrote:
> 2007-06-01 02:08 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>    * harbour/bin/bld.sh
>      ! Updated list of libs for linux/gcc.

Victor have you ever tried to use hb* scripts?
bld.sh will not work in many cases and is a static file
which does not respect some build time switches.
hb* scripts are created dynamically in 'make install'
and contain all build time settings so later you do not
have to set any environment variables - just simply use.
They should work on all systems with working bash. I used
in Linux, *BSD, MacOSX, SunOS, Windows+MSYS, DOS+DJGPP.
Many people trying Harbour in *nixes uses bld.sh because
they do not know about hb* scripts and later reports
problems. I really suggest to use hbmk instead and maybe
even add some not about it in bld.sh file.
Below I'm attaching description for hb* scripts.
And one additional note. If you want to create Harbour binaries
in some *nix system then try to use make_tgz.sh - it will create
self installing package with compressed Harbour binaries (you can
extract .tar.gz archive using --extract parameter) Build it and
check which files and were located it has (f.e.
/etc/harbour/hb-charmap.def). I know that you were testing packages
for MacOSX created by Antonio. Please check if they have all files
included in these archive.

best regards,
Przemek





==========================================================================
This RPM distribution of Harbour includes extra commands to make compiling
and linking with Harbour a little easier. There are compiler and linker
wrappers called "hbcc", "hbcmp", "hblnk" and "hbmk".

"hbcc" is a wrapper to the C compiler only. It sets all flags
and paths necessary to compile .c files which include Harbour header
files. The result of its work is an object file.

Use "hbcmp" exactly as you would use the harbour compiler itself.
The main difference with hbcmp is that it results in an object file,
not a C file that needs compiling down to an object. hbcmp also
ensures that the harbour include directory is seen by the harbour compiler.

"hblnk" simply takes a list of object files and links them together
with the harbour virtual machine and run-time library to produce an
executable. The executable will be given the basename of the first object
file if not directly set by the "-o" command line switch.

"hbmk" tries to produce an executable from your .prg file. It's a simple
equivalent of cl.bat from the CA-Clipper distribution.

All these scripts accept command line switches:
-o<outputfilename>      # output file name
-static                 # link with static Harbour libs
-fullstatic             # link with all static libs
-shared                 # link with shared libs (default)
-mt                     # link with multi-thread libs
-gt<hbgt>               # link with <hbgt> GT driver, can be repeated to
                        # link with more GTs. The first one will be
                        #      the default at runtime
-xbgtk                  # link with xbgtk library (xBase GTK+ interface)
-hwgui                  # link with HWGUI library (GTK+ interface)
-l<libname>             # link with <libname> library
-fmstat                 # link with the memory statistics lib
-nofmstat               # do not link with the memory statistics lib (default)
-[no]strip              # strip (no strip) binaries
-main=<main_func>       # set the name of main program function/procedure.
                        # if not set then 'MAIN' is used or if it doesn't
                        # exist the name of first public function/procedure
                        # in first linked object module (link)

Link options work only with "hblnk" and "hbmk" and have no effect
in "hbcc" and "hbcmp".
Other options are passed to Harbour/C compiler/linker.
To save compatibility with older rpm distributions, "gharbour" can be used
as a synonym of "hbcmp", and "harbour-link" as synonym of "hblnk"

An example compile/link session looks like:
----------------------------------------------------------------------
druzus@uran:~/tmp$ cat foo.prg
function main()
? "Hello, World!"
return nil

druzus@uran:~/tmp$ hbcmp foo
Harbour Compiler Alpha build 46.2 (Flex)
Copyright 1999-2006, http://www.harbour-project.org/
Compiling 'foo.prg'...
Lines 5, Functions/Procedures 2
Generating C source output to 'foo.c'... Done.

druzus@uran:~/tmp$ hblnk foo.o

druzus@uran:~/tmp$ strip foo

druzus@uran:~/tmp$ ls -l foo
-rwxrwxr-x    1 druzus   druzus       3824 maj 17 02:46 foo
----------------------------------------------------------------------

or using hbmk only:
----------------------------------------------------------------------
druzus@uran:~/tmp$ cat foo.prg
function main()
? "Hello, World!"
return nil

druzus@uran:~/tmp$ hbmk foo
Harbour Compiler Alpha build 46.2 (Flex)
Copyright 1999-2006, http://www.harbour-project.org/
Compiling 'foo.prg'...
Lines 5, Functions/Procedures 2
Generating C source output to 'foo.c'... Done.

druzus@uran:~/tmp$ ls -l foo
-rwxrwxr-x    1 druzus   druzus       3824 maj 17 02:46 foo
----------------------------------------------------------------------


In this RPM you will find additional wonderful tools: /usr/bin/hbrun
You can run clipper/xbase compatible source files with it if you only
put in their first line:
#!/usr/bin/hbrun

For example:
----------------------------------------------------------------------
druzus@uran:~/tmp$ cat foo.prg
#!/usr/bin/hbrun
function main()
? "Hello, World!, This is a script !!! :-)"
?
return nil

druzus@uran:~/tmp$ chmod +x foo.prg

druzus@uran:~/tmp$ ./foo.prg

Hello, World!, This is a script !!! :-)

I hope this RPM is useful. Have fun with Harbour.

Many thanks to Dave Pearson <davep@davep.org>

Przemyslaw Czerpak <druzus@polbox.com>
