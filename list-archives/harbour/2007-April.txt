From antonioharbour at gmail.com  Sun Apr  1 01:22:54 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun Apr  1 01:23:03 2007
Subject: [Harbour] a Harbour view :)
Message-ID: <CEB28CA4-FB89-44BC-944D-262FD3C2DDD9@gmail.com>

http://img244.imageshack.us/img244/4475/picture2yw8.png
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070401/6e470eb0/attachment.html
From antonioharbour at gmail.com  Sun Apr  1 01:30:00 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun Apr  1 01:30:12 2007
Subject: [Harbour] another view
Message-ID: <9866F9D4-CADB-4CB5-8310-6788D5B30793@gmail.com>

http://img225.imageshack.us/img225/7594/picture4rp2.png


-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070401/6f0c692e/attachment.html
From tomaz.zupan at orpo.si  Sun Apr  1 02:43:57 2007
From: tomaz.zupan at orpo.si (Tomaz Zupan)
Date: Sun Apr  1 02:44:33 2007
Subject: [Harbour] Download link on homepage
Message-ID: <200704010843.57529.tomaz.zupan@orpo.si>

Download link on homepage points to build 45 files. 

LP, Toma?
From java.net.ardo at gmail.com  Sun Apr  1 03:46:27 2007
From: java.net.ardo at gmail.com (ardo septama)
Date: Sun Apr  1 03:46:29 2007
Subject: [harbour] Maximum database file size
Message-ID: <f306932a0704010046t7d084b9di8064d6c0aaa6a47d@mail.gmail.com>

What's the maximum size of .dbf file ? is it depend on record amount? or
disk size?

TIA,
Ardo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070401/9dbc01e1/attachment.html
From harbour.01 at syenar.hu  Sun Apr  1 09:05:22 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sun Apr  1 08:05:46 2007
Subject: [Harbour] CHANGELOG: 2007-04-01 13:47 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c7745e$Blat.v2.6.1$67d000c2$eb07fff6faa@127.0.0.1>

2007-04-01 13:47 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/makefile.bc
   * harbour/makefile.vc
   * harbour/config/rules.cf
   * harbour/contrib/btree/makefile.bc
   * harbour/contrib/htmllib/Makefile.bc
   * harbour/contrib/htmllib/makefile.vc
   * harbour/contrib/libct/makefile.bc
   * harbour/contrib/libct/makefile.vc
   * harbour/contrib/libgt/makefile.bc
   * harbour/contrib/libgt/makefile.vc
   * harbour/contrib/libmisc/makefile.bc
   * harbour/contrib/libmisc/makefile.vc
   * harbour/contrib/libnf/makefile.vc
   * harbour/contrib/libnf/nanfor.bc
   * harbour/contrib/samples/makefile.bc
   * harbour/contrib/samples/makefile.vc
   + harbour/contrib/samples/make_b32.bat
   + harbour/contrib/samples/make_vc.bat
   - harbour/contrib/samples/makevc.bat
     + -w default Harbour build switch changed to -w2, 
       to further maintain code quality.
     ; Notice that CONTRIB might need some fixing here.
     + Added proper BC/VC make batch files for "samples".

   * harbour/include/hbclass.ch
   * harbour/source/debug/dbgmenu.prg
   * harbour/source/debug/debugger.prg
   * harbour/source/rtl/teditor.prg
   * harbour/utils/hbdoc/genchm.prg
   * harbour/utils/hbdoc/genhtm.prg
   * harbour/utils/hbdoc/genng.prg
   * harbour/utils/hbdoc/genos2.prg
   * harbour/utils/hbdoc/genpdf1.prg
   * harbour/utils/hbdoc/genrtf.prg
   * harbour/utils/hbdoc/os2.prg
   * harbour/utils/hbmake/hbmake.prg
   * harbour/utils/hbmake/radios.prg
   * harbour/utils/hbpptest/pretest.prg
   * harbour/utils/hbtest/rt_misc.prg
     + Added HB_SYMBOL_UNUSED() inside codeblocks.
     ! Removed a few uneeded codeblock parameters.
     + Added HB_SYMBOL_UNUSED() to some class syntax generated 
       code to avoid unused "Self" var warnings.

   * harbour/ChangeLog.017
     ! Typos.

From niki at synel.co.il  Sun Apr  1 09:33:10 2007
From: niki at synel.co.il (Chen Kedem)
Date: Sun Apr  1 09:34:30 2007
Subject: [Harbour] SF bugtracker#1692268: when in get causes error
Message-ID: <460FB496.389E@synel.co.il>

The following was posted on the Harbour SF bug tracker:

http://sourceforge.net/tracker/index.php?func=detail&aid=1692268&group_id=681&atid=100681

--tt30.prg--
procedure Start()
local GetList:={}, a:=1, b:=2
local s1:=space(10), s2:=space(10)

@ 04,06 say "Data 1 : " get s1 // when a=1
@ 05,06 say "Data 2 : " get s2 when b=2
read

@ 04,30 say s1
@ 05,30 say s2
inkey(0)

return
------------

bld_b32 tt30 /w/a/n
tt30

when moving from one get field to the other you get the following:

Error BASE/1005  Message not found: GET:_TYPE
Called from __ERRRT_SBASE(0)
Called from GET:ERROR(171)
Called from (b)HBOBJECT(105)
Called from GET:MSGNOTFOUND(0)
Called from GET:_TYPE(164)
Called from HBGETLIST:GETPREVALIDATE(367)
Called from HBGETLIST:READER(160)
Called from READMODAL(151)
Called from START(7)

Tested with BCC32 devel ChangeLog: 2007-04-01 13:47 UTC+0100 Viktor Szakats.
It is reported that it worked in beta-1 but not in beta-2


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From niki at synel.co.il  Sun Apr  1 09:57:24 2007
From: niki at synel.co.il (Chen Kedem)
Date: Sun Apr  1 09:58:42 2007
Subject: [Harbour] SF bugtracker#1672233: GET ... READ skipping Logical Vars
Message-ID: <460FBA44.C07@synel.co.il>

The following was posted on the Harbour SF bug tracker:
http://sourceforge.net/tracker/index.php?func=detail&aid=1672233&group_id=681&atid=100681

--tt31.prg--
PROCEDURE MAIN
public GetList, lVar1 := .T., lVar2 := .T.
CLS
@ 10, 10 GET lVar1                // Can edit
@ 12, 10 GET lVar2 PICTURE "L"    // Can not edit
READ
RETURN
------------

bld_b32 tt31 /w/a/n

The logic GET with the PICTURE does not allow to edit the value.
Work with Clipper 5.2, does not work with BCC32 devel ChangeLog: 2007-04-01 13:47 UTC+0100 Viktor Szakats

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From harbour.01 at syenar.hu  Sun Apr  1 10:53:26 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sun Apr  1 10:53:34 2007
Subject: [Harbour] SF bugtracker#1692268: when in get causes error
In-Reply-To: <460FB496.389E@synel.co.il>
References: <460FB496.389E@synel.co.il>
Message-ID: <CF845DD1-E7A6-4A1F-9DD6-D43F2E2A1616@syenar.hu>

Thx Chen, I'll commit a fix.

Brgds,
Viktor

On 2007.04.01., at 15:33, Chen Kedem wrote:

> The following was posted on the Harbour SF bug tracker:
>
> http://sourceforge.net/tracker/index.php? 
> func=detail&aid=1692268&group_id=681&atid=100681
>
> --tt30.prg--
> procedure Start()
> local GetList:={}, a:=1, b:=2
> local s1:=space(10), s2:=space(10)
>
> @ 04,06 say "Data 1 : " get s1 // when a=1
> @ 05,06 say "Data 2 : " get s2 when b=2
> read
>
> @ 04,30 say s1
> @ 05,30 say s2
> inkey(0)
>
> return
> ------------
>
> bld_b32 tt30 /w/a/n
> tt30
>
> when moving from one get field to the other you get the following:
>
> Error BASE/1005  Message not found: GET:_TYPE
> Called from __ERRRT_SBASE(0)
> Called from GET:ERROR(171)
> Called from (b)HBOBJECT(105)
> Called from GET:MSGNOTFOUND(0)
> Called from GET:_TYPE(164)
> Called from HBGETLIST:GETPREVALIDATE(367)
> Called from HBGETLIST:READER(160)
> Called from READMODAL(151)
> Called from START(7)
>
> Tested with BCC32 devel ChangeLog: 2007-04-01 13:47 UTC+0100 Viktor  
> Szakats.
> It is reported that it worked in beta-1 but not in beta-2
>
>
>   Chen.
> ********************************************************************** 
> ************************
> IMPORTANT: The contents of this email and any attachments are  
> confidential. They are intended for the
> named recipient(s) only.
> If you have received this email in error, please notify the system  
> manager or the sender immediately and do
> not disclose the contents to anyone or make copies thereof.
> *** eSafe scanned this email for viruses, vandals, and malicious  
> content. ***
> ********************************************************************** 
> ************************
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Sun Apr  1 12:02:41 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sun Apr  1 11:03:25 2007
Subject: [Harbour] CHANGELOG: 2007-04-01 16:56 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77477$Blat.v2.6.1$2d838df8$c4cc303899e@127.0.0.1>

2007-04-01 16:56 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/tgetlist.prg
     ! Fixed bug #1692268. The fix simply removes two strange lines 
       of code which tried to modify the internal TGet() var "Type",
       after it read the value contained in the TGet(). Since this would 
       be the job of TGet() alone, and Type() is not an assignable 
       var in CA-Cl*pper, it very much looks like a workaround 
       for something (maybe a shortcoming of an earlier version of 
       TGet()). If anyone knows what was to be achieved with that, 
       pls shout.

From antonioharbour at gmail.com  Sun Apr  1 11:06:39 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun Apr  1 11:06:44 2007
Subject: [Harbour] Harbour website
Message-ID: <2B77A499-7CD0-44BF-906D-7AFDFC8F1E50@gmail.com>

Alexander,

This Harbour website page looks outdated:

http://www.harbour-project.org/download.htm

Thanks,

regards,

Antonio
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070401/35845dd1/attachment-0001.html
From lorenzo.fiorini at gmail.com  Sun Apr  1 12:53:47 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr  1 12:53:53 2007
Subject: [Harbour] rdd way to export dbf to SQL
Message-ID: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>

I use a function called __dbSql that export dbfs to text files "ready"
to be imported by SQL servers like PostgreSQL, FireBird or Mysql.

The function still uses HB_ITEM so I have to fix it but I wonder if
there is a better way to get the same result and/or there is any
interest to have it as standard rdd function.
IMHO a command like copy to sql could be useful to many developers.

The function is a like "copy to delimited" but it needs options to:

- export data as INSERT INTO <table> VALUES ( x,... ) statement
- accept tab as field delimiter
- export dates using yyyy-mm-dd format that seems the most accepted
- escape delimiters in strings with a defined escape char
- add recno value as first field ( to create pk )

and it should be as fast as possible since it normally export large
amount of data.

The use is like:

if nSqltype == __POSTGRESQL__
   nRecs := __dbSql( .t., cDatFile, cTable,, bFor, bWhile, nNext,
nRecord, lRest, .f., .f., lRecno, chr(9), "", "\" )
elseif nSqltype == __FIREBIRDSQL__
   __dbSql( .t., cSqlFile, '"' + cTable + '"',, bFor, bWhile, nNext,
nRecord, lRest, .t., .t., lRecno, ",", "'", "'" )
elseif nSqltype == __MYSQL__
   __dbSql( .t., cSqlFile, cTable,, bFor, bWhile, nNext, nRecord,
lRest, .t., .t., lRecno, ",", "'", "'" )
endif

Any comment?

regards,
Lorenzo Fiorini
From antonioharbour at gmail.com  Sun Apr  1 12:57:55 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun Apr  1 12:58:00 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
Message-ID: <8395EDEC-7A03-4851-B933-CBD5B580D941@gmail.com>

Lorenzo,

It sounds _very_ interesting,

> The use is like:

Surely we can implement an easier to use xbase command instead of the  
function call, on top of it

regards,

Antonio


From harbour.01 at syenar.hu  Sun Apr  1 13:37:08 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sun Apr  1 13:37:16 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
Message-ID: <6F1B5CB3-FEF4-4B57-91A3-AAECC358C625@syenar.hu>

This could be a nice addon indeed. But, all SQLs have
a slightly different import format, do they? So how can we create
a solution which is "generic"? (meaning it could directly work
with most major SQLs without any special SQL vendor specific tricks)

If we could come up with a generic solution, I think it could be
part of core Harbour, but if not it's better to add it to the contribs.

Brgds,
Viktor

On 2007.04.01., at 18:53, Lorenzo Fiorini wrote:

> I use a function called __dbSql that export dbfs to text files "ready"
> to be imported by SQL servers like PostgreSQL, FireBird or Mysql.
>
> The function still uses HB_ITEM so I have to fix it but I wonder if
> there is a better way to get the same result and/or there is any
> interest to have it as standard rdd function.
> IMHO a command like copy to sql could be useful to many developers.
>
> The function is a like "copy to delimited" but it needs options to:
>
> - export data as INSERT INTO <table> VALUES ( x,... ) statement
> - accept tab as field delimiter
> - export dates using yyyy-mm-dd format that seems the most accepted
> - escape delimiters in strings with a defined escape char
> - add recno value as first field ( to create pk )
>
> and it should be as fast as possible since it normally export large
> amount of data.
>
> The use is like:
>
> if nSqltype == __POSTGRESQL__
>   nRecs := __dbSql( .t., cDatFile, cTable,, bFor, bWhile, nNext,
> nRecord, lRest, .f., .f., lRecno, chr(9), "", "\" )
> elseif nSqltype == __FIREBIRDSQL__
>   __dbSql( .t., cSqlFile, '"' + cTable + '"',, bFor, bWhile, nNext,
> nRecord, lRest, .t., .t., lRecno, ",", "'", "'" )
> elseif nSqltype == __MYSQL__
>   __dbSql( .t., cSqlFile, cTable,, bFor, bWhile, nNext, nRecord,
> lRest, .t., .t., lRecno, ",", "'", "'" )
> endif
>
> Any comment?
>
> regards,
> Lorenzo Fiorini
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Sun Apr  1 14:33:41 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr  1 14:33:45 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <6F1B5CB3-FEF4-4B57-91A3-AAECC358C625@syenar.hu>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
	<6F1B5CB3-FEF4-4B57-91A3-AAECC358C625@syenar.hu>
Message-ID: <9257026e0704011133o4fe5ef87n7c6572f03731bf8b@mail.gmail.com>

On 4/1/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> This could be a nice addon indeed. But, all SQLs have
> a slightly different import format, do they? So how can we create
> a solution which is "generic"? (meaning it could directly work
> with most major SQLs without any special SQL vendor specific tricks)

You're right, every SQL has it own import format but the mix of
options is probably not so high.

For example INSERT INTO <x> VALUES ( <y,..> ) is quite standard, the
only difference can be in the names quotation and in the escape char.
The func itself doesn't know the type of SQL it only uses different parameters.
The cmd could be sth like:

copy to ... sql with insert names quoted delimited by "'" escape "'"
// for Firebird & MySql
copy to ... sql fields separated by chr(9) escape "\" // for PostgreSQL

> If we could come up with a generic solution, I think it could be
> part of core Harbour, but if not it's better to add it to the contribs.

It is a so small piece of code that it doesn't worth a dir in contrib,
I usually "#include" it at the end of dbcmd.c. If anyone else is
interested I can send it to the list.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Sun Apr  1 14:47:53 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr  1 14:47:56 2007
Subject: [Harbour] hb_gt_ProcessMessages in Harbour
Message-ID: <9257026e0704011147p5df1ca32ra0b8ff2f0448453c@mail.gmail.com>

Is there any eq of hb_gt_ProcessMessages in Harbour?

I use it to update UI under gtxwc and gtwvt during C only SQL exports.

I found that gtxwc and gtwvt have a "local" hb_gt_xxx_ProcessMessages().

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Sun Apr  1 17:14:51 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr  1 17:14:54 2007
Subject: [Harbour] Issues porting gtxwc apps from xHarbour to Harbour
In-Reply-To: <20070331083123.GA29957@localhost.localdomain>
References: <9257026e0703310105n78346b65r99e1fad6d46af292@mail.gmail.com>
	<20070331083123.GA29957@localhost.localdomain>
Message-ID: <9257026e0704011414y66cbe847n5c7dafb31ef62e07@mail.gmail.com>

On 3/31/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Mouse perfectly works with GTXWC for me.

I can't see the problem.
With the same exe If I set HB_GT=crs mouse works while if I use
HB_GT=xwc it doesn't.

I use:

C_USR=-O3 -march=i686 -fno-strict-aliasing -DHB_NO_READDBG
-DHB_EXT_INKEY -DNODLL -DHB_COMPAT_XHB -DHB_PP_MULTILINE_STRING

( some defines have meaning only for xHarbour )

regards,
Lorenzo Fiorini
From philb at philb.us  Sun Apr  1 17:08:21 2007
From: philb at philb.us (Phil Barnett)
Date: Sun Apr  1 17:15:40 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <6F1B5CB3-FEF4-4B57-91A3-AAECC358C625@syenar.hu>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
	<6F1B5CB3-FEF4-4B57-91A3-AAECC358C625@syenar.hu>
Message-ID: <200704011708.21366.philb@philb.us>

On Sunday 01 April 2007 13:37, Szak?ts Viktor wrote:
> This could be a nice addon indeed. But, all SQLs have
> a slightly different import format, do they? So how can we create
> a solution which is "generic"? (meaning it could directly work
> with most major SQLs without any special SQL vendor specific tricks)
>
> If we could come up with a generic solution, I think it could be
> part of core Harbour, but if not it's better to add it to the contribs.

I would think coding to SQL92 standards would pretty much cover it.

http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt

At the very least, it would cover the majority of them and would expose what 
needs to be enhanced further.

It's a great idea.

-- 
Ballmer is basically saying: We know there's a problem but we're not going to 
tell you what it is because we want to ambush you in the future. 
http://blogs.zdnet.com/hardware/?p=154
From wangshuming01 at gmail.com  Sun Apr  1 21:53:02 2007
From: wangshuming01 at gmail.com (wang shuming)
Date: Sun Apr  1 21:53:07 2007
Subject: [Harbour] rdd way to export dbf to SQL
Message-ID: <c26b21640704011853y17ce8111ud255cd703f5f693d@mail.gmail.com>

WWhlIGJlc3QgZXhjdXRlIFNRTCB3YXkgaXMgbGlrZSBvc2VydmVyOnF1ZXJ5KGNTUUwpLgoKU2h1
bWluZ6GhV2FuZwo=
From lorenzo.fiorini at gmail.com  Mon Apr  2 02:11:13 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon Apr  2 02:11:17 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <c26b21640704011853y17ce8111ud255cd703f5f693d@mail.gmail.com>
References: <c26b21640704011853y17ce8111ud255cd703f5f693d@mail.gmail.com>
Message-ID: <9257026e0704012311t3f62937bka2acf0ce21f8b252@mail.gmail.com>

On 4/2/07, wang shuming <wangshuming01@gmail.com> wrote:

> Yhe best excute SQL way is like oserver:query(cSQL).

You're right, the msg subject is misleading.

I'm talking about exporting dbfs to text files for later import into SQL server.

In theory every text format like SDF or delimited can be imported in
SQL server but "preparing" text files will greatly easy the import and
since we already have __dbSDF and __dbDelim in rdd I think it is easy
to extend them or add a specific small function like __dbSql.

regards,
Lorenzo Fiorini
From alex at belacy.belgorod.su  Mon Apr  2 03:26:25 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Mon Apr  2 03:27:52 2007
Subject: [Harbour] Re: Harbour website
In-Reply-To: <2B77A499-7CD0-44BF-906D-7AFDFC8F1E50@gmail.com>
References: <2B77A499-7CD0-44BF-906D-7AFDFC8F1E50@gmail.com>
Message-ID: <1549211234.20070402112625@belacy.belgorod.su>

Sunday, April 01, 2007, 7:06:39 PM, Antonio Linares <antonioharbour@gmail.com> wrote:

AL> Alexander,

AL> This Harbour website page looks outdated:

AL> http://www.harbour-project.org/download.htm

 It is a wrong link from a main page. Now fixed.

-- 
Regards,
 Alexander
http://kresin.belgorod.su


From antonioharbour at gmail.com  Mon Apr  2 01:31:22 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr  2 03:31:32 2007
Subject: [Harbour] Re: Harbour website
In-Reply-To: <1549211234.20070402112625@belacy.belgorod.su>
Message-ID: <4610b14d.24652b5f.4018.1c4a@mx.google.com>

Alexander, 

AL> This Harbour website page looks outdated:
AL> http://www.harbour-project.org/download.htm

> It is a wrong link from a main page. Now fixed.

Thanks,

Regards,

Antonio

From alex at belacy.belgorod.su  Mon Apr  2 07:39:57 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Mon Apr  2 07:42:31 2007
Subject: [Harbour] Error in tgetlist or oop subsystem
Message-ID: <13624425223.20070402153957@belacy.belgorod.su>

Hello,

 I get an error ( tested with current beta2 ) in a following sample:

Function Main()
Local x1 := 1, x2 := 2

   CLEAR SCREEN
   @ 1,0 SAY "Input x1:" GET x1
   @ 2,0 SAY "Input x2:" GET x2 WHEN x1>0
   READ

return
 
 The error message appears while selecting the second get item:

Error BASE/1005  Message not found: GET:_TYPE
Called from __ERRRT_SBASE(0)  
Called from GET:ERROR(171)  
Called from (b)HBOBJECT(105)  
Called from GET:MSGNOTFOUND(0)  
Called from GET:_TYPE(164)  
Called from HBGETLIST:GETPREVALIDATE(367)  
Called from HBGETLIST:READER(160)  
Called from READMODAL(151)  
Called from MAIN(7)  
 
The line 367 in tgetlist.prg is:

  oGet:type := ValType( xValue )

 but the :type is a method of GET class, not the data.
 Does the OOP implementation allow such kind of assignment ?

-- 
Regards,
 Alexander
http://kresin.belgorod.su


From harbour.01 at syenar.hu  Mon Apr  2 07:49:11 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr  2 07:49:21 2007
Subject: [Harbour] Error in tgetlist or oop subsystem
In-Reply-To: <13624425223.20070402153957@belacy.belgorod.su>
References: <13624425223.20070402153957@belacy.belgorod.su>
Message-ID: <F8D23DAA-1ACA-4DE3-B087-FB500AC9C7F3@syenar.hu>

Hi Alexander,

This was fixed yesterday.

On 2007.04.02., at 13:39, Alexander S.Kresin wrote:

> Hello,
>
>  I get an error ( tested with current beta2 ) in a following sample:
>
> Function Main()
> Local x1 := 1, x2 := 2
>
>    CLEAR SCREEN
>    @ 1,0 SAY "Input x1:" GET x1
>    @ 2,0 SAY "Input x2:" GET x2 WHEN x1>0
>    READ
>
> return
>
>  The error message appears while selecting the second get item:
>
> Error BASE/1005  Message not found: GET:_TYPE
> Called from __ERRRT_SBASE(0)
> Called from GET:ERROR(171)
> Called from (b)HBOBJECT(105)
> Called from GET:MSGNOTFOUND(0)
> Called from GET:_TYPE(164)
> Called from HBGETLIST:GETPREVALIDATE(367)
> Called from HBGETLIST:READER(160)
> Called from READMODAL(151)
> Called from MAIN(7)
>
> The line 367 in tgetlist.prg is:
>
>   oGet:type := ValType( xValue )
>
>  but the :type is a method of GET class, not the data.
>  Does the OOP implementation allow such kind of assignment ?

Nope, I suspect it was a kind of workaround in the TGetList code.

If anyone has any idea, what was the reason for this line pls
speak up. Setting :Type is the sole job of the TGet class, not
external class should modify it.

(In previous versions Type was a var (not a method), so this
code worked, but Type got fixed later on to be more CA-Clipper
compatible, so it became a method, like it is in CA-Clipper).

Brgds,
Viktor

From alex at belacy.belgorod.su  Mon Apr  2 09:01:30 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Mon Apr  2 09:02:51 2007
Subject: [Harbour] Re: Error in tgetlist or oop subsystem
In-Reply-To: <F8D23DAA-1ACA-4DE3-B087-FB500AC9C7F3@syenar.hu>
References: <13624425223.20070402153957@belacy.belgorod.su>
	<F8D23DAA-1ACA-4DE3-B087-FB500AC9C7F3@syenar.hu>
Message-ID: <5629319585.20070402170130@belacy.belgorod.su>

Monday, April 02, 2007, 3:49:11 PM, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

SV> Hi Alexander,

SV> This was fixed yesterday.

 Really. I missed this ...

2007-04-02 17:00 UTC+0300 Alexander Kresin <alex@belacy.belgorod.su>
  * source/rtl/tgetlist.prg
     ! synced with a fix in devel branch
 

-- 
Regards,
 Alexander
http://kresin.belgorod.su


From druzus at priv.onet.pl  Mon Apr  2 13:03:07 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr  2 13:03:43 2007
Subject: [Harbour] ChangeLog 2007-04-02 19:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070402170307.GA2357@localhost.localdomain>

2007-04-02 19:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rtl/hbregex.c
    + added HB_REGEXHAS() and HB_REGEXLIKE()
  * harbour/source/rtl/net.c
    * added support for <nType> parameter in NETNAME() like in xHarbour
      when nType == 1 NETNAME() returns user name instead of host name.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Mon Apr  2 13:22:44 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon Apr  2 13:22:47 2007
Subject: [Harbour] ChangeLog 2007-04-02 19:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070402170307.GA2357@localhost.localdomain>
References: <20070402170307.GA2357@localhost.localdomain>
Message-ID: <9257026e0704021022i3775e60bpa9bd578876e8e12@mail.gmail.com>

On 4/2/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> 2007-04-02 19:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/source/rtl/hbregex.c
>     + added HB_REGEXHAS() and HB_REGEXLIKE()
>   * harbour/source/rtl/net.c
>     * added support for <nType> parameter in NETNAME() like in xHarbour
>       when nType == 1 NETNAME() returns user name instead of host name.

Many thanks.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Mon Apr  2 13:25:45 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr  2 13:26:20 2007
Subject: [Harbour] ChangeLog 2007-04-02 19:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070402172544.GA24213@localhost.localdomain>

2007-04-02 19:25 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/contrib/ole/oleauto.prg
    * removed unused local variable
  * harbour/source/rtl/net.c
    ! fixed typo in variable name

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr  3 04:10:24 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 04:10:28 2007
Subject: [Harbour] Unreachable code warnings with -w2
Message-ID: <9257026e0704030110p447e43d6i77295bf19d9bc7e3@mail.gmail.com>

I'm still trying to port some code from xHarbour rtl but I get errors
like these:
../../memoedit.prg(335) Warning W0028  Unreachable code
...
../../memoedit.prg(375) Warning W0028  Unreachable code

in code like:
...
   SWITCH nUdfReturn

      CASE ME_DEFAULT

         if !lEdited .AND.;
            ( ( nKey $ ::aAsciiKeys ) .OR.;
              ( nKey $ { K_ALT_W, K_CTRL_W } ) .OR.;
              ( nKey $ ::aExtKeys ) .OR.;
              ( nKey == K_ESC ) .OR.;
              ( nKey == K_INS ) .OR.;
              ( nKey $ ::aMouseKeys ) )

            ::Super:Edit( nKey )

         endif
         exit

      CASE ME_IGNORE // <------ lin 335 Warning W0028  Unreachable code

         ::DisplayInsert( ::lInsert() )
         exit
...

I've looked at testes/switch and tried to create small test code but
it works as expected.

I've simply copied memoedit.prg from xHarbour to Harbour, changed IN
with $ and DEFAULT with OTHERWISE and cleaned unused var.

Any idea?

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Tue Apr  3 05:13:28 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 05:13:32 2007
Subject: [Harbour] Re: Unreachable code warnings with -w2
In-Reply-To: <9257026e0704030110p447e43d6i77295bf19d9bc7e3@mail.gmail.com>
References: <9257026e0704030110p447e43d6i77295bf19d9bc7e3@mail.gmail.com>
Message-ID: <9257026e0704030213k2da45449u98cec66fc1d30118@mail.gmail.com>

On 4/3/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:
> I'm still trying to port some code from xHarbour rtl but I get errors
> like these:
> ../../memoedit.prg(335) Warning W0028  Unreachable code

I've found a test code:

procedure main()

   local a

   a = 2

   switch a
      case 1
         ? "1"
      exit
      case 2 <-- testin2.prg(14) Warning W0028  Unreachable code
      case 3
      case 4
         ? "!1"
   end

return

built using hbmk -static -w2 -gtstd test.prg

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Tue Apr  3 06:00:29 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 06:00:32 2007
Subject: [Harbour] Are there Harbour equivalentes for throw() and rascan()?
Message-ID: <9257026e0704030300gfabd648r2c6274c24e27eaaa@mail.gmail.com>

Some xHarbour prg need also __strTokenCount and ScrollFixed but they
can be easily copied.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Tue Apr  3 06:47:53 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 06:48:28 2007
Subject: [Harbour] Re: Unreachable code warnings with -w2
In-Reply-To: <9257026e0704030213k2da45449u98cec66fc1d30118@mail.gmail.com>
References: <9257026e0704030110p447e43d6i77295bf19d9bc7e3@mail.gmail.com>
	<9257026e0704030213k2da45449u98cec66fc1d30118@mail.gmail.com>
Message-ID: <20070403104753.GA9813@localhost.localdomain>

On Tue, 03 Apr 2007, Lorenzo Fiorini wrote:
> On 4/3/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:
> >I'm still trying to port some code from xHarbour rtl but I get errors
> >like these:
> >../../memoedit.prg(335) Warning W0028  Unreachable code
> I've found a test code:

Thanks for the info - fixed.

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr  3 07:00:57 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 07:01:33 2007
Subject: [Harbour] ChangeLog 2007-04-03 13:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070403110057.GB9813@localhost.localdomain>

2007-04-03 13:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
    ! fixed false warning about unreachable code in
         switch ...; case ...; exit; case ...
      statement
    * disabled some error messages about illegal pass by reference
      now HVM should not allow to create cyclic reference chain

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr  3 08:01:49 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 08:02:24 2007
Subject: [Harbour] Are there Harbour equivalentes for throw() and rascan()?
In-Reply-To: <9257026e0704030300gfabd648r2c6274c24e27eaaa@mail.gmail.com>
References: <9257026e0704030300gfabd648r2c6274c24e27eaaa@mail.gmail.com>
Message-ID: <20070403120149.GA11447@localhost.localdomain>

On Tue, 03 Apr 2007, Lorenzo Fiorini wrote:
> Some xHarbour prg need also __strTokenCount and ScrollFixed but they
> can be easily copied.

THROW( oError ) in most cases can be replaced by:

    PROCEDURE THROW( oError )
        LOCAL lError := Eval( ErrorBlock(), oError )
        IF !ISLOGICAL( lError ) .OR. lError
            __ErrInHandler()
        ENDIF
        Break( oError )
    RETURN

RASCAN() can be created using current ASCAN() code. I'll add
C function hb_arrayRevScan() which can be used to implement
RASCAN()

__strTokenCount() can be copied from xHarbour as is.
I think that in some cases using HB_ATOKENS() I added to
contrib/tip library in Harbour can be good replacement.

I have no idea why exactly SCROLLFIXED was added to xHarbour.
This xHarbour code will work also in Harbour though I do not know
if the behavior for some wrong coordinates will be exactly the same.
In ChangeLog.020 I've found these note:

2004-04-12 01:55 UTC+0530 Pritpal Bedi <pritpal@vouchcac.com>
  * xharbour/source/rtl/scroll.c
    + ScrollFixed()
      Introduced this new function for internal use of xHarbour classes which
      supply all the parameters already in range. This function does not
      verify the supplied parameters. To speedup TBrowse(), this function is used
      instead of Scroll().

but I cannot believe that it was possible to measure the speed overhead
caused by very simple validation of passed parameters by quite fast C code
when the whole function is executed from .prg code which is hundreds time
slower and the body of these function has to make such expensive operation
like scrolling screen area.
This code which in practice gives unrealistic results:

    #define N_LOOP 10000000
    procedure main()
    local i, t
    t:=secondsCPU()
    for i:=1 to N_LOOP
        SCROLL(0,0,0,0,1)
    next
    ? secondsCPU()-t, "sec."
    t:=secondsCPU()
    for i:=1 to N_LOOP
        SCROLLFIXED(0,0,0,0,1)
    next
    ? secondsCPU()-t, "sec."
    return

because access only one single character cell and does not make anything
more shows maximum difference which cannot be accessed in real code:
         6.32 sec.
         6.29 sec.
When I'll change scroll parameters to: 5,1,25,40,1
and number of loops to: 100000 (I do not want to wait too long for results)
I have:
         7.20 sec.
         7.20 sec.
Tested with GTCRS.
So if the above ChangeLog note is the only one reason to have SCROLLFIXED()
you can safely remove "FIXED" from the function name because it does not
improve anything what you can notice in your programs.

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr  3 08:09:28 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 08:10:05 2007
Subject: [Harbour] ChangeLog 2007-04-03 14:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070403120928.GB11447@localhost.localdomain>

2007-04-03 14:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbapi.h
  * harbour/source/vm/arrays.c
    + added hb_arrayRevScan()

  * harbour/source/vm/arrayshb.c
    + added RASCAN() covered by HB_COMPAT_XHB macro

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr  3 08:17:08 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 08:17:43 2007
Subject: [Harbour] hb_gt_ProcessMessages in Harbour
In-Reply-To: <9257026e0704011147p5df1ca32ra0b8ff2f0448453c@mail.gmail.com>
References: <9257026e0704011147p5df1ca32ra0b8ff2f0448453c@mail.gmail.com>
Message-ID: <20070403121708.GA15958@localhost.localdomain>

On Sun, 01 Apr 2007, Lorenzo Fiorini wrote:
> Is there any eq of hb_gt_ProcessMessages in Harbour?
> I use it to update UI under gtxwc and gtwvt during C only SQL exports.
> I found that gtxwc and gtwvt have a "local" hb_gt_xxx_ProcessMessages().

To force screen and internal GT structures updating it's enough to call
from .prg code:
    NEXTKEY()
and from .c code:
    hb_inkeyPoll();

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr  3 08:23:48 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 08:24:23 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
Message-ID: <20070403122348.GB15958@localhost.localdomain>

On Sun, 01 Apr 2007, Lorenzo Fiorini wrote:
> I use a function called __dbSql that export dbfs to text files "ready"
> to be imported by SQL servers like PostgreSQL, FireBird or Mysql.
> The function still uses HB_ITEM so I have to fix it but I wonder if
> there is a better way to get the same result and/or there is any
> interest to have it as standard rdd function.
> IMHO a command like copy to sql could be useful to many developers.
> The function is a like "copy to delimited" but it needs options to:
> - export data as INSERT INTO <table> VALUES ( x,... ) statement
> - accept tab as field delimiter
> - export dates using yyyy-mm-dd format that seems the most accepted
> - escape delimiters in strings with a defined escape char
> - add recno value as first field ( to create pk )
> and it should be as fast as possible since it normally export large
> amount of data.
> The use is like:
> 
> if nSqltype == __POSTGRESQL__
>   nRecs := __dbSql( .t., cDatFile, cTable,, bFor, bWhile, nNext,
> nRecord, lRest, .f., .f., lRecno, chr(9), "", "\" )
> elseif nSqltype == __FIREBIRDSQL__
>   __dbSql( .t., cSqlFile, '"' + cTable + '"',, bFor, bWhile, nNext,
> nRecord, lRest, .t., .t., lRecno, ",", "'", "'" )
> elseif nSqltype == __MYSQL__
>   __dbSql( .t., cSqlFile, cTable,, bFor, bWhile, nNext, nRecord,
> lRest, .t., .t., lRecno, ",", "'", "'" )
> endif
> Any comment?

Let's add it to CVS.
BTW AFAIR I was working on such function for you some years ago and
sth like that even existed in xHarbour dbcmd.c for some time but was
removed later - I do not remember the reasons and in the changelog
I can see only:
  2004-11-23 18:05 UTC+0100 Lorenzo Fiorini <lorenzo_fiorini/at/teamwork.it>
    * source/rdd/dbcmd.c
      * removed __dbSqlXXX code

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr  3 08:49:20 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 08:49:56 2007
Subject: [Harbour] ChangeLog 2007-04-03 14:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070403124920.GA16418@localhost.localdomain>

2007-04-03 14:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rtl/hbinet.c
    ! fixed possible process locking when undefined select() result is used

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr  3 10:01:12 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 10:01:15 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <20070403122348.GB15958@localhost.localdomain>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
	<20070403122348.GB15958@localhost.localdomain>
Message-ID: <9257026e0704030701v6f3b1758u1669575423ca28d7@mail.gmail.com>

On 4/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> BTW AFAIR I was working on such function for you some years ago and
> sth like that even existed in xHarbour dbcmd.c for some time but was
> removed later - I do not remember the reasons and in the changelog

Yes, it is always the same code.

I can't remember exactly why I removed it.

Here is the code attached. I've converted to Harbour api but it
reports a memory leak :(

regards,
Lorenzo Fiorini
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dbsql.c
Type: text/x-csrc
Size: 11706 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070403/1001a8e2/dbsql.bin
From lorenzo.fiorini at gmail.com  Tue Apr  3 10:02:38 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 10:02:47 2007
Subject: [Harbour] hb_gt_ProcessMessages in Harbour
In-Reply-To: <20070403121708.GA15958@localhost.localdomain>
References: <9257026e0704011147p5df1ca32ra0b8ff2f0448453c@mail.gmail.com>
	<20070403121708.GA15958@localhost.localdomain>
Message-ID: <9257026e0704030702kde8736ej355c1500561f4dd3@mail.gmail.com>

On 4/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> To force screen and internal GT structures updating it's enough to call
> from .prg code:
>     NEXTKEY()
> and from .c code:
>     hb_inkeyPoll();

Many thanks.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Tue Apr  3 10:53:07 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 10:53:12 2007
Subject: [Harbour] Are there Harbour equivalentes for throw() and rascan()?
In-Reply-To: <20070403120149.GA11447@localhost.localdomain>
References: <9257026e0704030300gfabd648r2c6274c24e27eaaa@mail.gmail.com>
	<20070403120149.GA11447@localhost.localdomain>
Message-ID: <9257026e0704030753j20681057v96efda30b80936d4@mail.gmail.com>

On 4/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> THROW( oError ) in most cases can be replaced by:
> ...

Added.

> RASCAN() can be created using current ASCAN() code. I'll add
> C function hb_arrayRevScan() which can be used to implement
> RASCAN()

Many thanks.

> I have no idea why exactly SCROLLFIXED was added to xHarbour.
> This xHarbour code will work also in Harbour though I do not know
> if the behavior for some wrong coordinates will be exactly the same.
> ...
> So if the above ChangeLog note is the only one reason to have SCROLLFIXED()
> you can safely remove "FIXED" from the function name because it does not
> improve anything what you can notice in your programs.

Ok, deleted.

regards,
Lorenzo Fiorini
From alex at belacy.belgorod.su  Tue Apr  3 11:05:57 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Tue Apr  3 11:07:51 2007
Subject: [Harbour] gtwvt
Message-ID: <992961137.20070403190557@belacy.belgorod.su>

Hello All,

I try to build and execute a small program  ( tests/hello.prg ) with the gtwvt
driver without any success.

I added a line ANNOUNCE HB_GTSYS in the prg file and replaced
gtwin.lib with gtwvt.lib in my common bat file:

@echo off
set HB_BIN_INSTALL=..\bin\
set HB_LIB_INSTALL=..\lib\
set HB_INC_INSTALL=..\include\
%HB_BIN_INSTALL%\harbour %1.prg -n -q0 -w -es2 -gc0 -i%HB_INC_INSTALL%
bcc32 -O2 -d -I%HB_INC_INSTALL% -L%HB_LIB_INSTALL% %1.c debug.lib
 vm.lib rtl.lib gtwvt.lib lang.lib rdd.lib macro.lib pp.lib dbfntx.lib dbfcdx.lib dbffpt.lib common.lib codepage.lib hbsix.lib


 The hello.exe is built successfully, but when I run it, I get:

 Unrecoverable error 9998: Internal error: screendriver initialization
 failure

 Could someone point me in a right direction ?
 Is this right that gtwvt screen operations are faster than gtwin ?

Regards,
 Alexander
http://kresin.belgorod.su

From lorenzo.fiorini at gmail.com  Tue Apr  3 11:37:59 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 11:38:03 2007
Subject: [Harbour] xharbour pcrepos seems faster
Message-ID: <9257026e0704030837n62994ac9qb92f55ecab624bfe@mail.gmail.com>

I've copied source/rtl/pcre to Harbour and I've noticed that tbrowses
filtered with HB_REGEX expressions are much faster ( using simple
seconds() test .10 vs .23 ).

Can this be possible?

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Tue Apr  3 12:15:42 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 12:15:45 2007
Subject: [Harbour] gtwvt
In-Reply-To: <992961137.20070403190557@belacy.belgorod.su>
References: <992961137.20070403190557@belacy.belgorod.su>
Message-ID: <9257026e0704030915q596fdb7bg1db036708694ecfa@mail.gmail.com>

On 4/3/07, Alexander S.Kresin <alex@belacy.belgorod.su> wrote:

>  Is this right that gtwvt screen operations are faster than gtwin ?

I've found that under W9x gtwvt is much faster than gtwin, however
I've used it seldom so I've not recent tests.

regards,
Lorenzo Fiorini
From alex at belacy.belgorod.su  Tue Apr  3 12:35:38 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Tue Apr  3 12:37:23 2007
Subject: [Harbour] Re: gtwvt
In-Reply-To: <992961137.20070403190557@belacy.belgorod.su>
References: <992961137.20070403190557@belacy.belgorod.su>
Message-ID: <1948341804.20070403203538@belacy.belgorod.su>

On  Tuesday, April 03, 2007, 19:05 Alexander S.Kresin <alex@belacy.belgorod.su> wrote:

ASK> [ ... ]
ASK> bcc32 -O2 -d -I%HB_INC_INSTALL% -L%HB_LIB_INSTALL% %1.c debug.lib
ASK>  vm.lib rtl.lib gtwvt.lib lang.lib rdd.lib macro.lib pp.lib dbfntx.lib dbfcdx.lib dbffpt.lib common.lib codepage.lib hbsix.lib


ASK>  The hello.exe is built successfully, but when I run it, I get:

ASK>  Unrecoverable error 9998: Internal error: screendriver initialization
ASK>  failure

ASK>  Could someone point me in a right direction ?

 Now I got it - it works when I compile it in GUI mode.
 There still is one thing, which seems strange to me - if I add
 ANNOUNCE HB_GTSYS to prg and replace gtwin with gtwvt in a link
 script, supposing, that gtwvt will be the only and default gt driver,
 I get that error ( Unrecoverable error 9998 ... ). And only if I
 include
     proc HB_GTSYS()
       request HB_GT_WIN
       request HB_GT_WVT
     return
 in prg, both gtwin and gtwvt in a link script and run the exe with a
 //gtwvt switch, the program executes normally. Why should I include
 gtwin and use the run-time switch //gtwvt if I don't suppose to use
 gtwin mode ?


Regards,
 Alexander
http://kresin.belgorod.su

From lorenzo.fiorini at gmail.com  Tue Apr  3 12:49:47 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 12:50:01 2007
Subject: [Harbour] Re: gtwvt
In-Reply-To: <1948341804.20070403203538@belacy.belgorod.su>
References: <992961137.20070403190557@belacy.belgorod.su>
	<1948341804.20070403203538@belacy.belgorod.su>
Message-ID: <9257026e0704030949u350e39e6k8ff9fa0cdefe4418@mail.gmail.com>

On 4/3/07, Alexander S.Kresin <alex@belacy.belgorod.su> wrote:

>  Why should I include
>  gtwin and use the run-time switch //gtwvt if I don't suppose to use
>  gtwin mode ?

Because gtwin is the default gt driver for Win32 platform so it'll be
always linked unless you'll rebuild Harbour using HB_GT_DEFAULT=<sth
else>.

To choose gtwvt as the default driver I thnk you can use REQUEST
HB_GT_WVT_DEFAULT.

Look in ChangeLog.015 and ChangeLog.016 Przemyslaw's entries.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Tue Apr  3 13:03:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 13:04:39 2007
Subject: [Harbour] Re: gtwvt
In-Reply-To: <1948341804.20070403203538@belacy.belgorod.su>
References: <992961137.20070403190557@belacy.belgorod.su>
	<1948341804.20070403203538@belacy.belgorod.su>
Message-ID: <20070403170342.GA5509@localhost.localdomain>

On Tue, 03 Apr 2007, Alexander S.Kresin wrote:
> ASK>  The hello.exe is built successfully, but when I run it, I get:
> ASK>  Unrecoverable error 9998: Internal error: screendriver initialization
> ASK>  failure
> ASK>  Could someone point me in a right direction ?

You haven't linked any GT driver with your application.

>  Now I got it - it works when I compile it in GUI mode.

I do not understand what the above means. I guess you are talking about
some linker switches so your application starts by WinMain() not main().
Such things depends on used C compiler. GTWVT needs valid HINSTANCE
handler to work just like amu other GUI programs. If you know other
method which allows to access this handler in binaries created by your
C compiler and you want to add it to use with GTWVT then please look at
hb_winmainArgGet() function and update it to properly set phInstance
variable.

>  There still is one thing, which seems strange to me - if I add
>  ANNOUNCE HB_GTSYS to prg and replace gtwin with gtwvt in a link
>  script, supposing, that gtwvt will be the only and default gt driver,

There are no hardcoded bindings between GTWVT and core code so if you
make sth like above then your linker simply ignore GTWVT library just
like it ignores DBFCDX if you do not add to your code REQUEST DBFCDX.
So make the same for GTWVT and add:
    REQUEST HB_GT_WVT
hb* scripts have automatic support for GT dirvers so if you link your
application using them you do not have to add any explicit REQUEST HB_GT_*
to your code.

>  I get that error ( Unrecoverable error 9998 ... ). And only if I
>  include
>      proc HB_GTSYS()
>        request HB_GT_WIN
>        request HB_GT_WVT
>      return
>  in prg, both gtwin and gtwvt in a link script and run the exe with a
>  //gtwvt switch, the program executes normally. Why should I include
>  gtwin and use the run-time switch //gtwvt if I don't suppose to use
>  gtwin mode ?

Because you added:
    REQUEST HB_GT_WIN
to your code so your binaries contain both GT drivers. If you will use
harbour.dll then your binaries will have all GT drivers by default and
you will not have to explicitly REQUEST any GT driver.
If you want to use only GTWVT then add to your code:
    ANNOUNCE HB_GTSYS
    REQUEST HB_GT_WVT
or like above:
    PROC HB_GTSYS
    REQUEST HB_GT_WVT
    RETURN

If you link with your application more then one GT driver you can
request and set the default one by:
    REQUEST HB_GT_<name>_DEFAULT
F.e.:
    ANNOUNCE HB_GTSYS
    REQUEST HB_GT_STD
    REQUEST HB_GT_CGI
    REQUEST HB_GT_WVT_DEFAULT
    REQUEST HB_GT_WIN

HTH,

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr  3 13:32:47 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 13:33:22 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <9257026e0704030701v6f3b1758u1669575423ca28d7@mail.gmail.com>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
	<20070403122348.GB15958@localhost.localdomain>
	<9257026e0704030701v6f3b1758u1669575423ca28d7@mail.gmail.com>
Message-ID: <20070403173247.GA10389@localhost.localdomain>

On Tue, 03 Apr 2007, Lorenzo Fiorini wrote:
> Yes, it is always the same code.
> I can't remember exactly why I removed it.
> Here is the code attached. I've converted to Harbour api but it
> reports a memory leak :(

Updated version in attachment - not tested but I think it will work.

best regards,
Przemek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dbsql.c.gz
Type: application/x-gzip
Size: 3959 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070403/1fbbb7d3/dbsql.c.gz
From lorenzo.fiorini at gmail.com  Tue Apr  3 13:33:28 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 13:33:31 2007
Subject: [Harbour] Report of the port from xHarbour to Harbour
Message-ID: <9257026e0704031033v26d0f923y168e20f742366e90@mail.gmail.com>

Thanks to the great work made by Przemyslaw in the last days I could
get my gtxwc apps working under Harbour.

For other interested, here are the steps I took:

- harbour built with -DHB_COMPAT_XHB and HB_PP_MULTILINE_STRING
- added hbcompat.ch to include ( see below )
- commented out tracelog
- comment out set eol to x

to have my apps working like I need I've copied some code from xH ( optional ):
- copied inkey.ch to have HB_EXT_INKEY support
- changed gtcrs.h and gtxwc.c to enable HB_EXT_INKEY
- copied source/rtl/pcre
- copied contrib/gd
- copied hbini.prg
- copied teditorl.c to have __StrTokenCount
- copied memoedit.prg and teditor.prg to have text selection and copy/cut/paste
- copied tbrowse.prg, tbcolumn.prg to have "datacached" tbrowse
- changed scrollfixed with scroll

prg modifications have been:
- replace IN operator with $
- replace default with otherwise in switch statements
- clean the code for -w2 warnings

I'll do better runtime tests in the next days.

Mouse still doesn't work correctly using gtxwc but mouse wheel works
in tbrowses.
Any idea?

Many thanks to all the Harbour team for the great support.

regards,
Lorenzo Fiorini

/*** hbcompat.ch ***/

#ifdef __HARBOUR__

#ifdef __XHARBOUR__
  #include "gtinfo.ch"
  #include "gfx.ch"
#else
  #include "hbgtinfo.ch"
  #include "hbgfx.ch"
#endif


#ifdef __XHARBOUR__
  #xtranslate hb_gtSys                => gtSys
  #xtranslate hb_gtInfo([<xx,...>])   => gtInfo([<xx>])
  #xtranslate hb_gtVersion([<xx>])    => hb_gt_Version([<xx>])
#else
  #xtranslate gtSys                   => hb_gtSys
  #xtranslate gtInfo([<xx,...>])      => hb_gtInfo([<xx>])
  #xtranslate hb_gt_Version([<xx>])   => hb_gtVersion([<xx>])
  #xtranslate gtSetClipboard(<xx>)    => hb_gtInfo( GTI_CLIPBOARDDATA, <xx> )
  #xtranslate gtGetClipboard()        => hb_gtInfo( GTI_CLIPBOARDDATA )
  #xtranslate gtGetClipBoardSize()    => len( hb_gtInfo( GTI_CLIPBOARDDATA ) )
  #xtranslate gtPasteClipBoard([<n>]) => hb_gtInfo( GTI_CLIPBOARDPAST )
  #xtranslate gfxPrimitive([<xx,...>])=> hb_gfxPrimitive([<xx>])
  #xtranslate gfxText([<xx,...>])     => hb_gfxText([<xx>])
#endif

#endif /* __HARBOUR__ */
From lorenzo.fiorini at gmail.com  Tue Apr  3 13:34:15 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 13:34:18 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <20070403173247.GA10389@localhost.localdomain>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
	<20070403122348.GB15958@localhost.localdomain>
	<9257026e0704030701v6f3b1758u1669575423ca28d7@mail.gmail.com>
	<20070403173247.GA10389@localhost.localdomain>
Message-ID: <9257026e0704031034k2e51b0d0t7c512883e17efc04@mail.gmail.com>

On 4/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Updated version in attachment - not tested but I think it will work.

Many thanks I'll try tomorrow.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Tue Apr  3 13:59:16 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 13:59:52 2007
Subject: [Harbour] Report of the port from xHarbour to Harbour
In-Reply-To: <9257026e0704031033v26d0f923y168e20f742366e90@mail.gmail.com>
References: <9257026e0704031033v26d0f923y168e20f742366e90@mail.gmail.com>
Message-ID: <20070403175916.GA10659@localhost.localdomain>

On Tue, 03 Apr 2007, Lorenzo Fiorini wrote:
> Mouse still doesn't work correctly using gtxwc but mouse wheel works
> in tbrowses.
> Any idea?

Usually small information more precise then "Mouse doesn't work" helps
if you want to resolve the problem ;-)
I've just made some deeper test and I guess you have problem with
MCOL()/MROW() which always return -1 in GTXWC due to my stupid typo.
I do not use these functions so I was not able to locate it.
I'll commit fix in a while.

best regards,
Przemek
From alex at belacy.belgorod.su  Tue Apr  3 14:00:53 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Tue Apr  3 14:04:43 2007
Subject: [Harbour] Re: gtwvt
In-Reply-To: <20070403170342.GA5509@localhost.localdomain>
References: <992961137.20070403190557@belacy.belgorod.su>
	<1948341804.20070403203538@belacy.belgorod.su>
	<20070403170342.GA5509@localhost.localdomain>
Message-ID: <6213457621.20070403220053@belacy.belgorod.su>

On  Tuesday, April 03, 2007, 21:03 Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

>>  Now I got it - it works when I compile it in GUI mode.

PC> I do not understand what the above means. I guess you are talking about
PC> some linker switches so your application starts by WinMain() not main().

 Yes, exactly. In case of bcc32 it is -tW.
 
PC> If you link with your application more then one GT driver you can
PC> request and set the default one by:
PC>     REQUEST HB_GT_<name>_DEFAULT

 Yes, this is what I missed.
 Now these three lines:

   ANNOUNCE HB_GTSYS
   request HB_GT_WVT
   REQUEST HB_GT_WVT_DEFAULT
 
 does the work Ok.
 Thanks.

Regards,
 Alexander
http://kresin.belgorod.su

From alex at belacy.belgorod.su  Tue Apr  3 14:03:24 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Tue Apr  3 14:04:43 2007
Subject: [Harbour] Re: gtwvt
In-Reply-To: <9257026e0704030949u350e39e6k8ff9fa0cdefe4418@mail.gmail.com>
References: <992961137.20070403190557@belacy.belgorod.su>
	<1948341804.20070403203538@belacy.belgorod.su>
	<9257026e0704030949u350e39e6k8ff9fa0cdefe4418@mail.gmail.com>
Message-ID: <17413608598.20070403220324@belacy.belgorod.su>

On  Tuesday, April 03, 2007, 20:49 Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

LF> To choose gtwvt as the default driver I thnk you can use REQUEST
LF> HB_GT_WVT_DEFAULT.

 Thanks. This really helps.

Regards,
 Alexander
http://kresin.belgorod.su

From druzus at priv.onet.pl  Tue Apr  3 14:04:54 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 14:05:29 2007
Subject: [Harbour] ChangeLog 2007-04-03 20:05 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070403180454.GA11556@localhost.localdomain>

2007-04-03 20:05 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rdd/dbf1.c
    ! fixed OS code in error message
  * harbour/source/rtl/gtxwc/gtxwc.c
    ! fixed MCOL()/MROW()

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr  3 17:12:22 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 17:12:58 2007
Subject: [Harbour] Report of the port from xHarbour to Harbour
In-Reply-To: <20070403175916.GA10659@localhost.localdomain>
References: <9257026e0704031033v26d0f923y168e20f742366e90@mail.gmail.com>
	<20070403175916.GA10659@localhost.localdomain>
Message-ID: <9257026e0704031412v33c9281q195d75df25f3f21a@mail.gmail.com>

On 4/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Usually small information more precise then "Mouse doesn't work" helps
> if you want to resolve the problem ;-)

You're right, sorry.

I had reported previously that test/mousetst worked with gtcrs and not
with gtxwc but probably it was not so clear.

As usual many thanks for the fix.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Tue Apr  3 17:26:58 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 17:27:08 2007
Subject: [Harbour] ChangeLog 2007-04-03 20:05 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070403180454.GA11556@localhost.localdomain>
References: <20070403180454.GA11556@localhost.localdomain>
Message-ID: <9257026e0704031426s1e783e9an4e20ab123306aa70@mail.gmail.com>

On 4/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> 2007-04-03 20:05 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/source/rdd/dbf1.c
>     ! fixed OS code in error message
>   * harbour/source/rtl/gtxwc/gtxwc.c
>     ! fixed MCOL()/MROW()

My apps are ok now.

Just to report that test/mousetst.prg still says "Mouse not present !".

It seems that MPRESENT() returns .f.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Tue Apr  3 18:23:08 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr  3 18:23:11 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <20070403173247.GA10389@localhost.localdomain>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
	<20070403122348.GB15958@localhost.localdomain>
	<9257026e0704030701v6f3b1758u1669575423ca28d7@mail.gmail.com>
	<20070403173247.GA10389@localhost.localdomain>
Message-ID: <9257026e0704031523x6eb118edvaf1baad8da7ce5e1@mail.gmail.com>

On 4/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Updated version in attachment - not tested but I think it will work.

It works but there are some problems with fRecno ( first field ):

- all the record start with 09 <tab> while they shouldn't
- values are wrong:
1st and 2nd record have 0930 30 hex
from third to 99th have 0930 31 hex
from 100th to 999 090231 3030 hex progressive
from 999 and up only 09 hex

I hope I've been clear enough. I can send you a result file if you need it.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Tue Apr  3 19:39:17 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 19:39:52 2007
Subject: [Harbour] rdd way to export dbf to SQL
In-Reply-To: <9257026e0704031523x6eb118edvaf1baad8da7ce5e1@mail.gmail.com>
References: <9257026e0704010953k2cdfa4a6vd73fe05fafca8816@mail.gmail.com>
	<20070403122348.GB15958@localhost.localdomain>
	<9257026e0704030701v6f3b1758u1669575423ca28d7@mail.gmail.com>
	<20070403173247.GA10389@localhost.localdomain>
	<9257026e0704031523x6eb118edvaf1baad8da7ce5e1@mail.gmail.com>
Message-ID: <20070403233917.GA13230@localhost.localdomain>

On Wed, 04 Apr 2007, Lorenzo Fiorini wrote:
> On 4/3/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
> >Updated version in attachment - not tested but I think it will work.
> It works but there are some problems with fRecno ( first field ):


Thank for the info. This code:
            szVal = szRecno + sizeof( szRecno ) - 1;
            *szVal-- = 0;
            do
            {
               *szVal-- = ( char ) ( ulRec % 10 ) + '0';
               ulRec /= 10;
            }
            while( ulRec );
should be changed to:
            szVal = szRecno + sizeof( szRecno );
            *--szVal = 0;
            do
            {
               *--szVal = ( char ) ( ulRec % 10 ) + '0';
               ulRec /= 10;
            }
            while( ulRec );

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr  3 19:52:56 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr  3 19:53:30 2007
Subject: [Harbour] ChangeLog 2007-04-03 20:05 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <9257026e0704031426s1e783e9an4e20ab123306aa70@mail.gmail.com>
References: <20070403180454.GA11556@localhost.localdomain>
	<9257026e0704031426s1e783e9an4e20ab123306aa70@mail.gmail.com>
Message-ID: <20070403235256.GA15681@localhost.localdomain>

On Tue, 03 Apr 2007, Lorenzo Fiorini wrote:
> >2007-04-03 20:05 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> >  * harbour/source/rdd/dbf1.c
> >    ! fixed OS code in error message
> >  * harbour/source/rtl/gtxwc/gtxwc.c
> >    ! fixed MCOL()/MROW()
> My apps are ok now.
> Just to report that test/mousetst.prg still says "Mouse not present !".
> It seems that MPRESENT() returns .f.

It's OK. GTXWC intentionally connects to XServer later when you try to
display sth on the screen and as long as connection to XServer is not
established MPRESENT() returns .f.
Such late initialization allows to create programs with GTXWC as
default driver which will work without XServer, f.e. using only
some STDOUT() output.
It's enough to add sth like:
    ? "."
at the begining of mousetst.prg to make it working with GTXWC.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Wed Apr  4 04:16:20 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr  4 04:16:23 2007
Subject: [Harbour] HB_COMPAT_XHB and std.ch
Message-ID: <9257026e0704040116u2ae12a2j5a57ed3161b58350@mail.gmail.com>

I've added to the std.ch:

#ifdef HB_COMPAT_XHB
   #command TEXT INTO <v> => #pragma
__text|<v>+=%s+HB_OSNEWLINE();<v>:=""
#endif

and rebuilt Harbour but the command does not work.

Without #ifdef HB_COMPAT_XHB it works.

Any suggestion?

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Wed Apr  4 04:35:28 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr  4 04:36:03 2007
Subject: [Harbour] ChangeLog 2007-04-04 10:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070404083528.GA24578@localhost.localdomain>

2007-04-04 10:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/contrib/tip/Makefile
  - harbour/contrib/tip/atokens.c
    * removed HB_ATOKENS()

  - harbour/source/rtl/teditorl.c
    - removed __STRTOKEN(), __STRTKPTR()

  * harbour/common.mak
  * harbour/source/rtl/Makefile
  * harbour/include/hbextern.ch
  + harbour/source/rtl/hbtoken.c
    + added set of functions to manipulate string tokens:
         HB_TOKENCOUNT( <cString>, [ <cDelim> ], [ <lSkipStrings> ],
                        [ <lDoubleQuoteOnly> ] ) -> <nTokens>
         HB_TOKENGET( <cString>, <nToken>, [ <cDelim> ], [ <lSkipStrings> ],
                      [ <lDoubleQuoteOnly> ] ) -> <cToken>
         HB_TOKENPTR( <cString>, @<nSkip>, [ <cDelim> ], [ <lSkipStrings> ],
                      [ <lDoubleQuoteOnly> ] ) -> <cToken>
         HB_ATOKENS( <cString>, [ <cDelim> ], [ <lSkipStrings> ],
                     [ <lDoubleQuoteOnly> ] ) -> <aTokens>
      All these functions use the same method of tokenization. They can
      accept as delimiters string longer then one character. By default
      they are using " " as delimiter. " " delimiter has special mening
      Unlike other delimiters repeted ' ' characters does not create empty
      tokens, f.e.: HB_ATOKENS( "    1     2 3  " ) returns array { "1", "2" }
      Any other delimiters are restrictly counted, f.e. HB_ATOKENS( ",,1,,2,")
      return array: { "", "", "1", "", "2", "" }.

    + added emulation for old __STRTOKEN(), __STRTKPTR() and xHarbour's
      __STRTOKENCOUNT() by HB_TOKEN*() functions. They do not return
      exactly the same result as __STRT*() functions which in some cases
      ignored some delimiters and return wrong results.

  * harbour/source/rdd/Makefile
  + harbour/source/rdd/dbsql.c
    + added __DBSQL() function

  * harbour/include/hbsetup.h
  * harbour/source/vm/fm.c
    + added support for native Windows memory allocation functions
      It can be enabled by HB_FM_WIN32_ALLOC macro and disable C-RTL
      memory manager.

  * harbour/tests/mousetst.prg
    * touch screen output before MPRESENT() to work with GTXWC

best regards,
Przemek
From druzus at priv.onet.pl  Wed Apr  4 04:38:09 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr  4 04:38:45 2007
Subject: [Harbour] HB_COMPAT_XHB and std.ch
In-Reply-To: <9257026e0704040116u2ae12a2j5a57ed3161b58350@mail.gmail.com>
References: <9257026e0704040116u2ae12a2j5a57ed3161b58350@mail.gmail.com>
Message-ID: <20070404083809.GB24578@localhost.localdomain>

On Wed, 04 Apr 2007, Lorenzo Fiorini wrote:
> I've added to the std.ch:
> #ifdef HB_COMPAT_XHB
>   #command TEXT INTO <v> => #pragma
> __text|<v>+=%s+HB_OSNEWLINE();<v>:=""
> #endif
> and rebuilt Harbour but the command does not work.
> Without #ifdef HB_COMPAT_XHB it works.
> Any suggestion?

std.ch has the same status as .prg code so .c level definitions are
not visible. Uncomment HB_COMPAT_XHB in hbsetup.ch.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Wed Apr  4 04:55:36 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr  4 04:55:41 2007
Subject: [Harbour] HB_COMPAT_XHB and std.ch
In-Reply-To: <20070404083809.GB24578@localhost.localdomain>
References: <9257026e0704040116u2ae12a2j5a57ed3161b58350@mail.gmail.com>
	<20070404083809.GB24578@localhost.localdomain>
Message-ID: <9257026e0704040155l6f824214p511e8a530048279f@mail.gmail.com>

On 4/4/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> std.ch has the same status as .prg code so .c level definitions are
> not visible. Uncomment HB_COMPAT_XHB in hbsetup.ch.

Thanks, just for information: isn't enough to have HB_COMPAT_XHB also
in PRG_USR?

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Wed Apr  4 04:59:50 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr  4 04:59:53 2007
Subject: [Harbour] ChangeLog 2007-04-04 10:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070404083528.GA24578@localhost.localdomain>
References: <20070404083528.GA24578@localhost.localdomain>
Message-ID: <9257026e0704040159h19d5a51bn6f763b5415445f56@mail.gmail.com>

On 4/4/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
> 2007-04-04 10:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/contrib/tip/Makefile
>   - harbour/contrib/tip/atokens.c
>     * removed HB_ATOKENS()
> ...
>   * harbour/tests/mousetst.prg
>     * touch screen output before MPRESENT() to work with GTXWC

Many thanks.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Wed Apr  4 05:09:20 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr  4 05:09:56 2007
Subject: [Harbour] HB_COMPAT_XHB and std.ch
In-Reply-To: <9257026e0704040155l6f824214p511e8a530048279f@mail.gmail.com>
References: <9257026e0704040116u2ae12a2j5a57ed3161b58350@mail.gmail.com>
	<20070404083809.GB24578@localhost.localdomain>
	<9257026e0704040155l6f824214p511e8a530048279f@mail.gmail.com>
Message-ID: <20070404090920.GA25442@localhost.localdomain>

On Wed, 04 Apr 2007, Lorenzo Fiorini wrote:
> >std.ch has the same status as .prg code so .c level definitions are
> >not visible. Uncomment HB_COMPAT_XHB in hbsetup.ch.
> Thanks, just for information: isn't enough to have HB_COMPAT_XHB also
> in PRG_USR?

In this case not because std.ch is parsed by 'ppgen' program to generate
build in PP tables not by 'harbour' compiler. Neither make passes PRG_USR
to ppgen nor ppgen recognizes -D switch.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Wed Apr  4 05:13:25 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr  4 05:13:31 2007
Subject: [Harbour] HB_COMPAT_XHB and std.ch
In-Reply-To: <20070404090920.GA25442@localhost.localdomain>
References: <9257026e0704040116u2ae12a2j5a57ed3161b58350@mail.gmail.com>
	<20070404083809.GB24578@localhost.localdomain>
	<9257026e0704040155l6f824214p511e8a530048279f@mail.gmail.com>
	<20070404090920.GA25442@localhost.localdomain>
Message-ID: <9257026e0704040213j48b6atb3ebfc98d2ae9a37@mail.gmail.com>

On 4/4/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> In this case not because std.ch is parsed by 'ppgen' program to generate
> build in PP tables not by 'harbour' compiler. Neither make passes PRG_USR
> to ppgen nor ppgen recognizes -D switch.

Ok, now it is clear.

regards,
Lorenzo
From druzus at priv.onet.pl  Wed Apr  4 09:25:19 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr  4 09:25:55 2007
Subject: [Harbour] xharbour pcrepos seems faster
In-Reply-To: <9257026e0704030837n62994ac9qb92f55ecab624bfe@mail.gmail.com>
References: <9257026e0704030837n62994ac9qb92f55ecab624bfe@mail.gmail.com>
Message-ID: <20070404132519.GA29277@localhost.localdomain>

On Tue, 03 Apr 2007, Lorenzo Fiorini wrote:
> I've copied source/rtl/pcre to Harbour and I've noticed that tbrowses
> filtered with HB_REGEX expressions are much faster ( using simple
> seconds() test .10 vs .23 ).
> Can this be possible?

It's possible. By default Harbour uses POSIX regular expressions and
maybe the implementation of perl-compatible regular expressions
(PCRE) from University of Cambridge is faster.I've never made any
deeper tests.
If PCRE is faster then you can check it without coping PCRE source code
from xHarbour. Just simply check if you have pcre installed and which
version by:
    rpm -q pcre
xHarbour uses version 6.3 (15-Aug-2005).
If you have comparable version then please also check if pcre-devel
RPM exists and it does then rebuild Harbour with HB_PCRE_REGEX macro.
And please remember about adding pcre to linked library list.
Then make some speed tests and you will have an answer if PCRE
implementation is noticeable faster then POSIX regular expressions.
I suggest to compare separately cost of regex compilation and cost
of comparison.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Wed Apr  4 09:32:09 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr  4 09:32:27 2007
Subject: [Harbour] ChangeLog 2007-04-04 15:30 UTC+0200 Lorenzo Fiorini
Message-ID: <9257026e0704040632g41dbbaeaj742dbb5138f24220@mail.gmail.com>

2007-04-04 15:30 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
  * harbour/contrib/pgsql/tpostgre.prg
    * removed unused vars
  * harbour/contrib/tip/cgi.prg
    * used new hb_serialize/hb_deserialize
    * removed unused vars
  * harbour/contrib/tip/ftpcln.prg
  * harbour/contrib/tip/httpcln.prg
  * harbour/contrib/tip/mail.prg
  * harbour/contrib/tip/popcln.prg
    * removed unused vars

regards,
Lorenzo Fiorini
From toninhofwi at yahoo.com.br  Wed Apr  4 09:40:37 2007
From: toninhofwi at yahoo.com.br (Toninho@fwi)
Date: Wed Apr  4 09:41:01 2007
Subject: [Harbour] HBZLIB is not working ?
Message-ID: <tka713d0ecmdui3io8g84hfirj4n3i2hvk@4ax.com>

Hi ppl.

I try to build HBZLIB from contrib but it is not working. This is
right ?

Regards,

Toninho.

		
_______________________________________________________ 
Yahoo! Mail - Sempre a melhor opo para voc! 
Experimente j e veja as novidades. 
http://br.yahoo.com/mailbeta/tudonovo/
 

From labitas at gmail.com  Wed Apr  4 10:04:00 2007
From: labitas at gmail.com (Saulius Zrelskis)
Date: Wed Apr  4 10:04:05 2007
Subject: [Harbour] xharbour pcrepos seems faster
In-Reply-To: <20070404132519.GA29277@localhost.localdomain>
References: <9257026e0704030837n62994ac9qb92f55ecab624bfe@mail.gmail.com>
	<20070404132519.GA29277@localhost.localdomain>
Message-ID: <2386af1b0704040704n7f8ddcack1c8169e645d9ca87@mail.gmail.com>

Latest release of the PCRE library from University of Cambridge is 7.0 from
2006.12.19

Regards,
Saulius
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070404/a90c19e7/attachment.html
From lorenzo.fiorini at gmail.com  Wed Apr  4 17:18:22 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr  4 17:18:25 2007
Subject: [Harbour] std.ch and pp "strange" issue
Message-ID: <9257026e0704041418l3f095a65n3ec898351e6931a6@mail.gmail.com>

To test different results I've added these lines to std.ch:

#command TEXT INTO <v> => #pragma __text|<v>+=%s+HB_OSNEWLINE();<v>:=""
#command TEXT1 INTO <v> => #pragma __text|<v>+=%s;<v>:=""
#command TEXT2 INTO <v> => #pragma __cstream|<v>:=%s

but even before I changed a single line of my code I've noticed that
the size of the exes where smaller than usual.

It seems that TEXT INTO cJs command get preprocessed like "TEXT2 INTO ...".

To see it try to build Harbour with those lines in std.ch and the
build the test below.

The result of the ppo change commenting out TEXT1 and TEXT2 even if
those commands are never used and in fact I never get PP errors.

Am I doing some stupid error I can't see now?

Do I need some more sleep?

regards,
Lorenzo Fiorini

#command TEXT INTO <v> => #pragma __text|<v>+=%s;<v>:=""
#command TEXT1 INTO <v> => #pragma __cstream|<v>:=%s
#command TEXT2 INTO <v> => #pragma __text|<v>+=%s+HB_OSNEWLINE();<v>:=""

procedure main

   local cJs

   TEXT INTO cJs

      var dummy="myvarisdummy[" + 'parameter' + "];"

      var dummy2=alert();

   ENDTEXT

   ?? cJs

return
From druzus at priv.onet.pl  Wed Apr  4 18:38:26 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr  4 18:39:02 2007
Subject: [Harbour] std.ch and pp "strange" issue
In-Reply-To: <9257026e0704041418l3f095a65n3ec898351e6931a6@mail.gmail.com>
References: <9257026e0704041418l3f095a65n3ec898351e6931a6@mail.gmail.com>
Message-ID: <20070404223826.GA2259@localhost.localdomain>

On Wed, 04 Apr 2007, Lorenzo Fiorini wrote:
> Am I doing some stupid error I can't see now?
> Do I need some more sleep?

HINT: #command vs #xcommand

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Thu Apr  5 01:59:25 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr  5 01:59:29 2007
Subject: [Harbour] std.ch and pp "strange" issue
In-Reply-To: <20070404223826.GA2259@localhost.localdomain>
References: <9257026e0704041418l3f095a65n3ec898351e6931a6@mail.gmail.com>
	<20070404223826.GA2259@localhost.localdomain>
Message-ID: <9257026e0704042259l52afa0f6t9341902c799c60ab@mail.gmail.com>

On 4/5/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> HINT: #command vs #xcommand

Yes, I need more sleep :(

I was so concentrated on the right side of the command that I've never
looked at the left side.

Sorry again.

regards,
Lorenzo Fiorini
From dmacias at mail.udg.mx  Thu Apr  5 05:26:59 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Thu Apr  5 05:27:01 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <4614C0E3.3040904@mail.udg.mx>

Przemek:

These are results of current Harbour devel branch build under OS/2:
---------------------------------------------------------
[E:\hbbuild\harbour]make -r           1>make_gnu.log
../../net.c: In function `HB_FUN_NETNAME':
../../net.c:119: warning: implicit declaration of function `getpwuid'
../../net.c:119: warning: assignment makes pointer from integer without 
a cast
../../net.c:121: error: dereferencing pointer to incomplete type
make[3]: *** [net.o] Error 1
make[2]: *** [descend] Error 2
E:/usr/i386-pc-os2-emx/bin/ld.exe: No such file or directory for rtl

....

---------------------------------------------------------



Gracias,
David Macias


From antonioharbour at gmail.com  Thu Apr  5 05:31:03 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 05:31:13 2007
Subject: [Harbour] Unresolved external '_HB_FUN_HB_SYMBOL_UNUSED'
Message-ID: <4614c1dd.6e31dd43.74a5.1014@mx.google.com>

We are testing the most recent Harbour build with FWH and we get this error:

Unresolved external '_HB_FUN_HB_SYMBOL_UNUSED'

Any hints ? Thanks,

Regards,

Antonio

From antonioharbour at gmail.com  Thu Apr  5 05:31:33 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 05:31:44 2007
Subject: [Harbour] Unresolved external '_HB_FUN_HB_SYMBOL_UNUSED'
Message-ID: <4614c1fb.0a92f84b.7a53.fffffe20@mx.google.com>

> Any hints ? Thanks,

It looks as it is defined inside common.ch

So from now on, Harbour will always require common.ch.

It looks as a non-sense

Regards,

Antonio

From harbour.01 at syenar.hu  Thu Apr  5 05:34:10 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr  5 05:34:14 2007
Subject: [Harbour] Unresolved external '_HB_FUN_HB_SYMBOL_UNUSED'
In-Reply-To: <4614c1fb.0a92f84b.7a53.fffffe20@mx.google.com>
References: <4614c1fb.0a92f84b.7a53.fffffe20@mx.google.com>
Message-ID: <20B43F35-D999-4EDE-AB0E-DEE0620AAD45@syenar.hu>

Yeah, I propably missed to include common.ch into hbclass.hb.

We could move this one declaration to std.ch to solve that.
What do you guys think?

Brgds,
Viktor

On 2007.04.05., at 11:31, Antonio Linares wrote:

>> Any hints ? Thanks,
>
> It looks as it is defined inside common.ch
>
> So from now on, Harbour will always require common.ch.
>
> It looks as a non-sense
>
> Regards,
>
> Antonio
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From antonioharbour at gmail.com  Thu Apr  5 05:41:11 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 05:41:21 2007
Subject: [Harbour] Unresolved external '_HB_FUN_HB_SYMBOL_UNUSED'
In-Reply-To: <20B43F35-D999-4EDE-AB0E-DEE0620AAD45@syenar.hu>
Message-ID: <4614c43c.6bdb2b00.4ffe.1062@mx.google.com>

Viktor, 

>
Yeah, I propably missed to include common.ch into hbclass.hb.

We could move this one declaration to std.ch to solve that.
What do you guys think?
>

IMO it has non sense that a compiler requires a header file to properly
work.

Regarding std.ch, please remember that a user may use a different std.ch
one, so it is not a valid solution too.

Regards,

Antonio

From druzus at priv.onet.pl  Thu Apr  5 05:45:57 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr  5 05:46:31 2007
Subject: [Harbour] Unresolved external '_HB_FUN_HB_SYMBOL_UNUSED'
In-Reply-To: <20B43F35-D999-4EDE-AB0E-DEE0620AAD45@syenar.hu>
References: <4614c1fb.0a92f84b.7a53.fffffe20@mx.google.com>
	<20B43F35-D999-4EDE-AB0E-DEE0620AAD45@syenar.hu>
Message-ID: <20070405094557.GA13306@localhost.localdomain>

On Thu, 05 Apr 2007, Szak?ts Viktor wrote:
> Yeah, I propably missed to include common.ch into hbclass.hb.
> We could move this one declaration to std.ch to solve that.
> What do you guys think?

I agree but in hbclass.ch we can also add our own:

    #define __HB_CLS_SYMBOL_UNUSED( symbol )  ( symbol := ( symbol ) )

and use it in class definition rules.

best regards,
Przemek
From antonioharbour at gmail.com  Thu Apr  5 05:47:24 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 05:47:44 2007
Subject: [Harbour] Class Tget Method Type
Message-ID: <4614c5b2.1a0551fb.763f.fffff47f@mx.google.com>

Class TGet Method Type() should be SETGET as on some circunstances it is
required to change the type.

Actual code it is not Clipper backwards compatible.

Thanks,

Regards,

Antonio

From harbour.01 at syenar.hu  Thu Apr  5 05:49:04 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr  5 05:49:09 2007
Subject: [Harbour] Unresolved external '_HB_FUN_HB_SYMBOL_UNUSED'
In-Reply-To: <4614c43c.6bdb2b00.4ffe.1062@mx.google.com>
References: <4614c43c.6bdb2b00.4ffe.1062@mx.google.com>
Message-ID: <13DD282A-6EE6-4DC7-B3F6-1B94F21B4C2B@syenar.hu>


On 2007.04.05., at 11:41, Antonio Linares wrote:

> Viktor,
>
>>
> Yeah, I propably missed to include common.ch into hbclass.hb.
>
> We could move this one declaration to std.ch to solve that.
> What do you guys think?
>>
>
> IMO it has non sense that a compiler requires a header file to  
> properly
> work.

How about hbclass.ch, std.ch and all the rest then?

> Regarding std.ch, please remember that a user may use a different  
> std.ch
> one, so it is not a valid solution too.

I don't see your point sorry Antonio.

We could as well include HB_SYMBOL_UNUSED() directly in hbclass.ch
if you think this is best (I don't).

Also we could directly use the HB_SYMBOL_UNUSED() "hack" inside
the hbclass.ch code. I don't it would be any better than the above,  
but it's
an option.

Brgds,
Viktor

>
> Regards,
>
> Antonio
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From antonioharbour at gmail.com  Thu Apr  5 05:51:13 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 05:51:28 2007
Subject: [Harbour] Class Tget Method Type
Message-ID: <4614c69b.1e1e54c6.3351.1396@mx.google.com>

METHOD Type( cType ) CLASS Get

   if PCount() > 0
      ::cType = cType
   else   
      if ::cType == NIL
         ::Original := ::VarGet()
         ::cType    := ValType( ::Original )
      endif
   endif   

return ::cType

From antonioharbour at gmail.com  Thu Apr  5 05:52:31 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 05:52:41 2007
Subject: [Harbour] Unresolved external '_HB_FUN_HB_SYMBOL_UNUSED'
In-Reply-To: <13DD282A-6EE6-4DC7-B3F6-1B94F21B4C2B@syenar.hu>
Message-ID: <4614c6e4.319e602f.2993.fffff67d@mx.google.com>

Viktor, 

> We could as well include HB_SYMBOL_UNUSED() directly in hbclass.ch

It has much more sense that to have it in common.ch, thanks

Regards,

Antonio

From harbour.01 at syenar.hu  Thu Apr  5 05:57:43 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr  5 05:57:47 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <4614c5b2.1a0551fb.763f.fffff47f@mx.google.com>
References: <4614c5b2.1a0551fb.763f.fffff47f@mx.google.com>
Message-ID: <8ACF716C-E799-44C7-B688-90B374E3DD8C@syenar.hu>

Is this an undocumented feature of Type?

Can you show a Clipper example?

Brgds,
Viktor

On 2007.04.05., at 11:47, Antonio Linares wrote:

> Class TGet Method Type() should be SETGET as on some circunstances  
> it is
> required to change the type.
>
> Actual code it is not Clipper backwards compatible.
>
> Thanks,
>
> Regards,
>
> Antonio
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From antonioharbour at gmail.com  Thu Apr  5 06:00:48 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 06:01:01 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <8ACF716C-E799-44C7-B688-90B374E3DD8C@syenar.hu>
Message-ID: <4614c8d6.52e0d81d.4f8a.018c@mx.google.com>

Viktor, 

>
Is this an undocumented feature of Type?

Can you show a Clipper example?
>

oGet:Type := ValType( u )

We have been using it in FiveWin for years,

Regards,

Antonio

From druzus at priv.onet.pl  Thu Apr  5 06:00:43 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr  5 06:01:18 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <4614C0E3.3040904@mail.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<4614C0E3.3040904@mail.udg.mx>
Message-ID: <20070405100043.GB13306@localhost.localdomain>

On Thu, 05 Apr 2007, David Arturo Macias Corona wrote:
> These are results of current Harbour devel branch build under OS/2:
> ---------------------------------------------------------
> [E:\hbbuild\harbour]make -r           1>make_gnu.log
> ../../net.c: In function `HB_FUN_NETNAME':
> ../../net.c:119: warning: implicit declaration of function `getpwuid'
> ../../net.c:119: warning: assignment makes pointer from integer without 
> a cast
> ../../net.c:121: error: dereferencing pointer to incomplete type

Please add line 75 of net.c:

   #include <pwd.h>
   #include <sys/types.h>

and check if you can compile harbour.

best regards,
Przemek
From harbour.01 at syenar.hu  Thu Apr  5 06:07:03 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr  5 06:07:09 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <4614c8d6.52e0d81d.4f8a.018c@mx.google.com>
References: <4614c8d6.52e0d81d.4f8a.018c@mx.google.com>
Message-ID: <31118F6F-550B-447B-9B72-0A98466EE0B3@syenar.hu>

> Can you show a Clipper example?
>>
>
> oGet:Type := ValType( u )

> We have been using it in FiveWin for years,

Thanks for your kind help, now I can test it........

Brgds,
Viktor

>
> Regards,
>
> Antonio
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Thu Apr  5 06:09:56 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr  5 06:10:31 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <4614c8d6.52e0d81d.4f8a.018c@mx.google.com>
References: <8ACF716C-E799-44C7-B688-90B374E3DD8C@syenar.hu>
	<4614c8d6.52e0d81d.4f8a.018c@mx.google.com>
Message-ID: <20070405100956.GC13306@localhost.localdomain>

On Thu, 05 Apr 2007, Antonio Linares wrote:
> Is this an undocumented feature of Type?
> Can you show a Clipper example?
> oGet:Type := ValType( u )
> We have been using it in FiveWin for years,

proc main()
local o:=getnew()
? o:type()
? o:type("Q")
? o:type()
? "."
return

does not work with Clipper. Can you show _REAL_ example?

best regards,
Przemek
From antonioharbour at gmail.com  Thu Apr  5 06:15:35 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 06:15:46 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <20070405100956.GC13306@localhost.localdomain>
Message-ID: <4614cc4d.235a3f1f.1856.0c34@mx.google.com>

Przemek,

This is a portion of FiveWin Class TGet that has been working since back
1993:

      METHOD VarPut( uVal ) INLINE  If( ValType( ::bSetGet ) == "B",;
                       ( Eval( ::bSetGet, uVal ), ::oGet:Type := ValType(
uVal ) ),)

Do as you like,

Regards,

Antonio

From druzus at priv.onet.pl  Thu Apr  5 06:22:36 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr  5 06:23:12 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <4614cc4d.235a3f1f.1856.0c34@mx.google.com>
References: <20070405100956.GC13306@localhost.localdomain>
	<4614cc4d.235a3f1f.1856.0c34@mx.google.com>
Message-ID: <20070405102236.GA13763@localhost.localdomain>

On Thu, 05 Apr 2007, Antonio Linares wrote:
> Przemek,
> This is a portion of FiveWin Class TGet that has been working since back
> 1993:
>       METHOD VarPut( uVal ) INLINE  If( ValType( ::bSetGet ) == "B",;
>                        ( Eval( ::bSetGet, uVal ), ::oGet:Type := ValType(
> uVal ) ),)
> Do as you like,

FiveWin Class TGet is not part of Clipper code. You set it's a Clipper
extension. When in fact Clipper does not have _TYPE method at all and
simple:
    getnew():type:="C"
in Clipper generate:
    Error BASE/1005  No exported variable: TYPE

please think about other developers time. I and probably Victor wasted
time on tests with Clipper believing that you are talking true.

best regards,
Przemek
From labitas at gmail.com  Thu Apr  5 07:08:53 2007
From: labitas at gmail.com (Saulius Zrelskis)
Date: Thu Apr  5 07:08:56 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <20070405102236.GA13763@localhost.localdomain>
References: <20070405100956.GC13306@localhost.localdomain>
	<4614cc4d.235a3f1f.1856.0c34@mx.google.com>
	<20070405102236.GA13763@localhost.localdomain>
Message-ID: <2386af1b0704050408t6d277a2u37b87b9cc95b81bb@mail.gmail.com>

Proc Main()
  Local xVal := 'BUCKET'
  Local o := getnew(,, {|x| if(x == Nil, xVal, xVal := x)})

? o:type()
? o:type("Q")
xVal := 12345
? o:type()
? "."
Return

Clipper:
C
C
N
.

Best regards,
Saulius
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070405/7d373586/attachment.html
From dmacias at mail.udg.mx  Thu Apr  5 07:12:22 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Thu Apr  5 07:12:25 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <4614D996.1030409@mail.udg.mx>

Przemek:

 >Please add line 75 of net.c:
 >
 >   #include <pwd.h>
 >   #include <sys/types.h>
 >
 >and check if you can compile harbour.

Yes, it work
Harbour build entirely, except error below


These are results of current Harbour devel branch build under OS/2:
---------------------------------------------------------
make[3]: *** [tform.c] Error 1
make[2]: *** [descend] Error 2
make[1]: *** [first] Error 2
make: *** [first] Error 2
---------------------------------------------------------

and this error belong to (from make_gnu.log):
---------------------------------------------------------
make[3]: Entering directory `/hbbuild/harbour/contrib/hgf/os2pm/os2/gcc'
gcc -I. -I../../include -I../../../../../include -W -Wall -DHB_OS_OS2 
-O2 -DHB_LONG_LONG_OFF -c ../../os2pm.c -oos2pm.o
../../../../../source/main/os2/gcc/harbour.exe ../../tform.prg  -n -q0 
-w2 -es2 -gc0 -I../../ -I../../../../../include

../../tform.prg(150) Warning W0003  Variable: 'HWNDCTL' declared but not 
used in function: 'HBFORM_COMMAND(121)'

../../tform.prg(169) Warning W0003  Variable: 'NKEYFLAGS' declared but 
not used in function: 'HBFORM_LBUTTONDOWN(160)'

No code generated.
---------------------------------------------------------


Seem to be due recent change:
---------------------------------------------------------
2007-04-01 13:47 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
...
      + -w default Harbour build switch changed to -w2,
        to further maintain code quality.
      ; Notice that CONTRIB might need some fixing here.
---------------------------------------------------------


Please do not forget to apply this change too:
---------------------------------------------------------
 > BTW I've just checked that OpenWatcom uses only (*tcp_h_errno1()) as 
h_errno
 > so probably by default we should not set TCPV40HDRS. If it will not be
 > possible to detect OS2 version using environment variables then I'll 
remove
 > this definition from config\os2\gcc.cf and users with older OS2 version
 > will have to set it using C_USR envvar, f.e.: SET C_USR=-DTCPV40HDRS
 >
 >
I am agree,
but, "users with older OS2 version" (4.0 and below) will be agree ?   :-)
---------------------------------------------------------


David Macias

From harbour.01 at syenar.hu  Thu Apr  5 08:21:28 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr  5 07:21:45 2007
Subject: [Harbour] CHANGELOG: 2007-04-05 13:31 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c7777c$Blat.v2.6.1$eff67a0a$f00975bb3b0@127.0.0.1>

2007-04-05 13:31 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/include/hbclass.ch
   * harbour/include/common.ch
     ! Using locally declared __HB_SYMBOL_UNUSED() instead of HB_SYMBOL_UNUSED()

   * harbour/contrib/hgf/os2pm/tform.prg
     ! Fixed unused symbol.

From antonioharbour at gmail.com  Thu Apr  5 08:09:07 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 08:09:17 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <20070405102236.GA13763@localhost.localdomain>
Message-ID: <4614e6e8.26688606.3e33.2e82@mx.google.com>

Przemek, 

> please think about other developers time. I and probably Victor wasted
time on tests with Clipper believing that you are talking true.

The code that I have shown was working with previous Harbour builds. Now it
is no longer working.

We are still researching to know whats the reason for it, but changing Class
Get Method Type() as we have shown, fixes the problem.

Antonio

From druzus at priv.onet.pl  Thu Apr  5 08:14:40 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr  5 08:15:15 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <2386af1b0704050408t6d277a2u37b87b9cc95b81bb@mail.gmail.com>
References: <20070405100956.GC13306@localhost.localdomain>
	<4614cc4d.235a3f1f.1856.0c34@mx.google.com>
	<20070405102236.GA13763@localhost.localdomain>
	<2386af1b0704050408t6d277a2u37b87b9cc95b81bb@mail.gmail.com>
Message-ID: <20070405121440.GA15491@localhost.localdomain>

On Thu, 05 Apr 2007, Saulius Zrelskis wrote:
> Proc Main()
>  Local xVal := 'BUCKET'
>  Local o := getnew(,, {|x| if(x == Nil, xVal, xVal := x)})
> ? o:type()
> ? o:type("Q")
> xVal := 12345
> ? o:type()
> ? "."
> Return
> Clipper:
> C
> C
> N

EXACTLY. Clipper does not allow to assign TYPE and Harbour is
Clipper compatible.

best regards,
Przemek
From druzus at priv.onet.pl  Thu Apr  5 08:53:25 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr  5 08:54:00 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <4614e6e8.26688606.3e33.2e82@mx.google.com>
References: <20070405102236.GA13763@localhost.localdomain>
	<4614e6e8.26688606.3e33.2e82@mx.google.com>
Message-ID: <20070405125325.GA15572@localhost.localdomain>

On Thu, 05 Apr 2007, Antonio Linares wrote:
> The code that I have shown was working with previous Harbour builds. Now it
> is no longer working.
> We are still researching to know whats the reason for it, but changing Class
> Get Method Type() as we have shown, fixes the problem.

Thank you for the above. Such message is OK and can help us to resolve
the problem unlike the first one:
    "Actual code it is not Clipper backwards compatible."
what is not true because now we are Clipper compatible so someone
fixed some incompatibilities.
The final question is: what should we do with GET() object? - keep it
Clipper compatible as close to original as possible or add some
extensions. My personal opinion is that adding extensions when the
base is not fully compatible is asking for a troubles because sooner
or later someone discover some code which does not work with Harbour
and the problem cannot be fixed because fix badly interacts with some
extensions. Such situation is in xHarbour with big classes like TBROWSE()
- never ending fixes, fixes and fixes for fixes for last years and we
are still far from being Clipper compatible. But now touching xHarbour
TBROWSE() implementation is a nightmare because people already have some
code which expects current often wrong behavior. It's a very serious problem
which needs group decision. Personally I think that as long as we do not
replicate original Clipper behavior (or at least we do not document it)
we should not add any extensions to existing code because it may badly
interacts with some unknown features but I do not see anything wrong in
adding some alternative implementations not in a core code.

best regards,
Przemek
From harbour.01 at syenar.hu  Thu Apr  5 09:04:08 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr  5 09:04:17 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <20070405125325.GA15572@localhost.localdomain>
References: <20070405102236.GA13763@localhost.localdomain>
	<4614e6e8.26688606.3e33.2e82@mx.google.com>
	<20070405125325.GA15572@localhost.localdomain>
Message-ID: <F8AF7F5E-A164-4C88-8B1E-A468ECC16F92@syenar.hu>

> Thank you for the above. Such message is OK and can help us to resolve
> the problem unlike the first one:
>     "Actual code it is not Clipper backwards compatible."
> what is not true because now we are Clipper compatible so someone
> fixed some incompatibilities.
> The final question is: what should we do with GET() object? - keep it
> Clipper compatible as close to original as possible or add some
> extensions. My personal opinion is that adding extensions when the
> base is not fully compatible is asking for a troubles because sooner
> or later someone discover some code which does not work with Harbour
> and the problem cannot be fixed because fix badly interacts with some
> extensions. Such situation is in xHarbour with big classes like  
> TBROWSE()
> - never ending fixes, fixes and fixes for fixes for last years and we
> are still far from being Clipper compatible. But now touching xHarbour
> TBROWSE() implementation is a nightmare because people already have  
> some
> code which expects current often wrong behavior. It's a very  
> serious problem
> which needs group decision. Personally I think that as long as we  
> do not
> replicate original Clipper behavior (or at least we do not document  
> it)
> we should not add any extensions to existing code because it may badly
> interacts with some unknown features but I do not see anything  
> wrong in
> adding some alternative implementations not in a core code.

In this case I would opt against adding an extension, as this would
also harm the encapsulation of internal Get object data. Type is not
something to be set by itself, it must alway follow the content of the
variable held by the Get object. This is clearly the job of the Get
object itself, and not the user of the object. Original CA-Clipper
developers had done this way for a reason in this case.

I also agree that we need to avoid any such mess described regarding
the xhb TBrowse. (or we could cite MS Windows development as
a very good example for that)

Brgds,
Viktor



From antonioharbour at gmail.com  Thu Apr  5 09:12:29 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr  5 09:12:40 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <F8AF7F5E-A164-4C88-8B1E-A468ECC16F92@syenar.hu>
Message-ID: <4614f5c4.10656024.4097.3a42@mx.google.com>

Viktor,

> Type is not something to be set by itself

I fully agree with you, but previous Harbour builds were allowing it. So the
new build is breaking backwards compatibility. Which its the side effect of
a bug fixing and its ok.

It not a big issue for us, we have modified Harbour and we will distribute
our modified build.

Regards,

Antonio

From harbour.01 at syenar.hu  Thu Apr  5 09:13:58 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr  5 09:14:23 2007
Subject: [Harbour] Class Tget Method Type
In-Reply-To: <4614f5c4.10656024.4097.3a42@mx.google.com>
References: <4614f5c4.10656024.4097.3a42@mx.google.com>
Message-ID: <4A1DF381-CEBB-4033-BDFD-AA904FEAD0F6@syenar.hu>

Thanks Antonio.

Brgds,
Viktor

On 2007.04.05., at 15:12, Antonio Linares wrote:

> Viktor,
>
>> Type is not something to be set by itself
>
> I fully agree with you, but previous Harbour builds were allowing  
> it. So the
> new build is breaking backwards compatibility. Which its the side  
> effect of
> a bug fixing and its ok.
>
> It not a big issue for us, we have modified Harbour and we will  
> distribute
> our modified build.
>
> Regards,
>
> Antonio
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Thu Apr  5 09:34:52 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr  5 09:34:56 2007
Subject: [Harbour] Help for api C code
Message-ID: <9257026e0704050634g381659f5t2689a3ee69e3c614@mail.gmail.com>

I'm testing contrib/gd that I've ported from xHarbour. This test is
true under xHarbour but is false under Harbour:

// contrig/gd/source/gdwrp.c

HB_FUNC( GDIMAGECOLORALLOCATE ) // int gdImageColorAllocate(gdImagePtr
im, int r, int g, int b)
{
   if ( hb_pcount() == 4 &&
        hb_parinfo( 1 ) & HB_IT_POINTER &&
        hb_parinfo( 2 ) & HB_IT_NUMERIC &&
        hb_parinfo( 3 ) & HB_IT_NUMERIC &&
        hb_parinfo( 4 ) & HB_IT_NUMERIC
      )

the problem rise here calling oImage:SetColor( ... ) and here his the code:

   METHOD SetColor( r, g, b )              INLINE IIF( PCount() == 2,
::pColor := r, ::pColor := gdImageColorAllocate( ::pImage, r, g, b ) )

the problem seems about HB_IT_POINTER since the other are r,g,b numbers.

pImage is create using:

...

      /* Create the image */
      im = gdImageCreate( sx, sy );

      /* Return image pointer */
      hb_retptr( im );

...

Any hint?

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Thu Apr  5 16:45:49 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr  5 16:45:54 2007
Subject: [Harbour] Re: Help for api C code
In-Reply-To: <9257026e0704050634g381659f5t2689a3ee69e3c614@mail.gmail.com>
References: <9257026e0704050634g381659f5t2689a3ee69e3c614@mail.gmail.com>
Message-ID: <9257026e0704051345s4513c5f0w9de8736eb27cf51a@mail.gmail.com>

On 4/5/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

> I'm testing contrib/gd that I've ported from xHarbour. This test is
> true under xHarbour but is false under Harbour:

Please ignore it. I've found that the problem is at prg level.

xHarbour allow to call GDImage( 200, 200 ) to call the constructor of
the class GDImage() while Harbour not.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Thu Apr  5 20:33:57 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr  5 20:34:33 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070406003357.GA21364@localhost.localdomain>

2007-04-06 02:32 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
  * harbour/source/lang/Makefile
  + harbour/source/lang/msgnl.c
    + added Dutch language module by Rene Koot

  * harbour/config/os2/gcc.cf
    * commented out -DTCPV40HDRS in CFLAGS
  * harbour/make_gnu.cmd
    * added commented by default: set C_USR=-DTCPV40HDRS %C_USR%

  * harbour/contrib/libnf/menu1.prg
  * harbour/contrib/libnf/pegs.prg
  * harbour/contrib/libnf/popadder.prg
  * harbour/contrib/libnf/savesets.prg
  * harbour/source/debug/dbgmenu.prg
    + added missing #include "common.ch" for HB_SYMBOL_UNUSED()

  * harbour/include/hbclass.ch
    * renamed __HB_SYMBOL_UNUSED() to __HB_CLS_SYMBOL_UNUSED() to keep
      the same name convention as for other hbclass definitions/commands

  * harbour/include/hbsetup.h
    * added commented by default #define HB_PP_MULTILINE_STRING
      with small description

  * harbour/source/rtl/net.c
    * added missing #include(s) for OS2 build

  * harbour/source/rdd/dbfcdx/dbfcdx1.c
    * formatting

best regards,
Przemek
From hbco2 at sbcglobal.net  Thu Apr  5 22:38:47 2007
From: hbco2 at sbcglobal.net (Bill Smith)
Date: Thu Apr  5 22:39:16 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070406003357.GA21364@localhost.localdomain>
Message-ID: <007101c777f4$b45a70a0$0303a8c0@hbco>

You work is very much appreciated, Przemyslaw.  Thank you!

Bill

----- Original Message ----- 
From: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Thursday, April 05, 2007 5:33 PM
Subject: [Harbour] ChangeLog 2007-04-06 02:32 UTC+0200 Przemyslaw
Czerpak(druzus/at/priv.onet.pl)


> 2007-04-06 02:32 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/common.mak
>   * harbour/source/lang/Makefile
>   + harbour/source/lang/msgnl.c
>     + added Dutch language module by Rene Koot
>
>   * harbour/config/os2/gcc.cf
>     * commented out -DTCPV40HDRS in CFLAGS
>   * harbour/make_gnu.cmd
>     * added commented by default: set C_USR=-DTCPV40HDRS %C_USR%
>
>   * harbour/contrib/libnf/menu1.prg
>   * harbour/contrib/libnf/pegs.prg
>   * harbour/contrib/libnf/popadder.prg
>   * harbour/contrib/libnf/savesets.prg
>   * harbour/source/debug/dbgmenu.prg
>     + added missing #include "common.ch" for HB_SYMBOL_UNUSED()
>
>   * harbour/include/hbclass.ch
>     * renamed __HB_SYMBOL_UNUSED() to __HB_CLS_SYMBOL_UNUSED() to keep
>       the same name convention as for other hbclass definitions/commands
>
>   * harbour/include/hbsetup.h
>     * added commented by default #define HB_PP_MULTILINE_STRING
>       with small description
>
>   * harbour/source/rtl/net.c
>     * added missing #include(s) for OS2 build
>
>   * harbour/source/rdd/dbfcdx/dbfcdx1.c
>     * formatting
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From dmacias at mail.udg.mx  Thu Apr  5 23:46:25 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Thu Apr  5 23:46:28 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <4615C291.5000701@mail.udg.mx>

Przemek, Viktor:

 >  * harbour/contrib/hgf/os2pm/tform.prg
 >    ! Fixed unused symbol.
...
 >  * harbour/config/os2/gcc.cf
 >    * commented out -DTCPV40HDRS in CFLAGS
 >  * harbour/make_gnu.cmd
 >    * added commented by default: set C_USR=-DTCPV40HDRS %C_USR%
...
 >  * harbour/source/rtl/net.c
 >    * added missing #include(s) for OS2 build

Thanks for your work
Current Harbour devel branch under OS/2 build entirely, with a little 
surprise

---------------------------------------------------------
make[3]: *** Warning: File `../../msgnl.c' has modification time in the 
future
make[3]: *** Warning:  Clock skew detected.  Your build may be incomplete.
---------------------------------------------------------


David Macias


From maurilio.longo at libero.it  Fri Apr  6 02:38:01 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Fri Apr  6 02:38:38 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32 UTC+0200 Przemyslaw 
	Czerpak(druzus/at/priv.onet.pl)
References: <20070406003357.GA21364@localhost.localdomain>
Message-ID: <4615EAC9.D69B88B1@libero.it>

Przemyslaw,

with this change to the OS/2 gcc.cf the resulting harbour won't run anymore on
'old' versions of OS/2 (like Warp 3 and Warp 4) which are, numerically, the
biggest part of the remaining OS/2 out there.

That said, since there is only one OS/2 user here, as it seems, it won't be a
big issue anyway.

Maurilio.

Przemyslaw Czerpak ha scritto:
> 
> 2007-04-06 02:32 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/common.mak
>   * harbour/source/lang/Makefile
>   + harbour/source/lang/msgnl.c
>     + added Dutch language module by Rene Koot
> 
>   * harbour/config/os2/gcc.cf
>     * commented out -DTCPV40HDRS in CFLAGS
>   * harbour/make_gnu.cmd
>     * added commented by default: set C_USR=-DTCPV40HDRS %C_USR%
> 
>   * harbour/contrib/libnf/menu1.prg
>   * harbour/contrib/libnf/pegs.prg
>   * harbour/contrib/libnf/popadder.prg
>   * harbour/contrib/libnf/savesets.prg
>   * harbour/source/debug/dbgmenu.prg
>     + added missing #include "common.ch" for HB_SYMBOL_UNUSED()
> 
>   * harbour/include/hbclass.ch
>     * renamed __HB_SYMBOL_UNUSED() to __HB_CLS_SYMBOL_UNUSED() to keep
>       the same name convention as for other hbclass definitions/commands
> 
>   * harbour/include/hbsetup.h
>     * added commented by default #define HB_PP_MULTILINE_STRING
>       with small description
> 
>   * harbour/source/rtl/net.c
>     * added missing #include(s) for OS2 build
> 
>   * harbour/source/rdd/dbfcdx/dbfcdx1.c
>     * formatting
> 
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From druzus at priv.onet.pl  Fri Apr  6 05:08:38 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 05:09:14 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
In-Reply-To: <4615EAC9.D69B88B1@libero.it>
References: <20070406003357.GA21364@localhost.localdomain>
	<4615EAC9.D69B88B1@libero.it>
Message-ID: <20070406090838.GA23619@localhost.localdomain>

On Fri, 06 Apr 2007, Maurilio Longo wrote:
> with this change to the OS/2 gcc.cf the resulting harbour won't run anymore on
> 'old' versions of OS/2 (like Warp 3 and Warp 4) which are, numerically, the
> biggest part of the remaining OS/2 out there.

It's not true. Just simply make:
    SET C_USR=-DTCPV40HDRS
before you build Harbour.

> That said, since there is only one OS/2 user here, as it seems, it won't be a
> big issue anyway.

Before this change it was not possible to build Harbour on newer OS2 versions
without modifying some source files. Now it can be build on all versions but
for older it's necessary to set one environment variable.
IMHO much better situation but of course the question about default setting
is still open. I'm not OS2 user and I do not know what should be default.
If the older version is more popular then we can make other modification
and add in os2/gcc.cf sth like:

ifneq ($(HB_OS2_VER),new)
CFLAGS += -DTCPV40HDRS
endif

so for newer OS2 version it will be necesary to make:
    SET HB_OS2_VER=new
before building Harbour. This is your and other OS2 users decision
but the build process should be control by environment settings and
previous situations when it was necessary to modify core make make
files to create Harbour binaries was not good.
Just simply tell me what you think should be set by default and what
environment name chose to inform our make system about used OS2 version.

best regards,
Przemek
From druzus at priv.onet.pl  Fri Apr  6 05:34:25 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 05:35:00 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <4615C291.5000701@mail.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<4615C291.5000701@mail.udg.mx>
Message-ID: <20070406093425.GA23938@localhost.localdomain>

On Thu, 05 Apr 2007, David Arturo Macias Corona wrote:
> Current Harbour devel branch under OS/2 build entirely, with a little 
> surprise
> ---------------------------------------------------------
> make[3]: *** Warning: File `../../msgnl.c' has modification time in the 
> future
> make[3]: *** Warning:  Clock skew detected.  Your build may be incomplete.

It has to be some local problem with your clock/time zone settings.
In CVS msgnl.c has date 2007/04/06 00:33:49 and exactly the same date
on my local disk: 2007/04/06 02:33 UTC+0200 and I committed it with
ChangeLog: 2007-04-06 02:32 UTC+0200 Przemyslaw Czerpak
so all is correct here (with the exception to missing $Date$ field in
version string in this file what I'll add in a while) and probably now
you do not the problem above is not reported in your system.

best regards,
Przemek
From druzus at priv.onet.pl  Fri Apr  6 05:56:29 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 05:57:06 2007
Subject: [Harbour] HBZLIB is not working ?
In-Reply-To: <tka713d0ecmdui3io8g84hfirj4n3i2hvk@4ax.com>
References: <tka713d0ecmdui3io8g84hfirj4n3i2hvk@4ax.com>
Message-ID: <20070406095629.GA24184@localhost.localdomain>

On Wed, 04 Apr 2007, Toninho@fwi wrote:
> Hi ppl.
> I try to build HBZLIB from contrib but it is not working. This is
> right ?

This library needs very serious modifications and cleanups to make it
well working - in both Harbour and xHarbour. I do not use it and I
do not plan to make them so it will have to work for some other developer
or maybe someone else will create alternative ZIP implementation.

best regards,
Przemek
From maurilio.longo at libero.it  Fri Apr  6 06:08:25 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Fri Apr  6 06:09:02 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32 UTC+0200 
	PrzemyslawCzerpak(druzus/at/priv.onet.pl)
References: <20070406003357.GA21364@localhost.localdomain>
	<4615EAC9.D69B88B1@libero.it>
	<20070406090838.GA23619@localhost.localdomain>
Message-ID: <46161C19.C0DBEB04@libero.it>

Przemyslaw,

> It's not true. Just simply make:
>     SET C_USR=-DTCPV40HDRS
> before you build Harbour.
> 
exactly, you now have to build a different one, while before a single build
was working in both systems.

> Before this change it was not possible to build Harbour on newer OS2 versions
> without modifying some source files. Now it can be build on all versions but
> for older it's necessary to set one environment variable.
> IMHO much better situation but of course the question about default setting
> is still open. I'm not OS2 user and I do not know what should be default.

It sounds strange to me since xharbour is built with that setting without
problems and, as I've read here, tip comes from xharbour (TCPV40HDRS tells the
compiler to use a previous version of tcp/ip headers wich are needed for the
tcp/ip stack of old OS/2 systems since in those systems the tcp/ip was a
16/32bit mixed stack, while on newer systems the stack is fully 32 bit, but
for the end user there is nearly no difference).

> If the older version is more popular then we can make other modification
> and add in os2/gcc.cf sth like:
> 
> ifneq ($(HB_OS2_VER),new)
> CFLAGS += -DTCPV40HDRS
> endif
> 
it is not enough, you need to change the order in which the linker searches
for libraries to link, since it has to find the V40 libraries before the newer
ones or else your executable can't be built.

> so for newer OS2 version it will be necesary to make:
>     SET HB_OS2_VER=new
> before building Harbour. This is your and other OS2 users decision
> but the build process should be control by environment settings and
> previous situations when it was necessary to modify core make make
> files to create Harbour binaries was not good.

Core make files? 
It has been a long time since I last built harbour, if I find a little spare
time I'll try again (with the TCPV40HDRS to see what fails and I'll let you
know).
 
Thanks.

Maurilio. 

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From harbour.01 at syenar.hu  Fri Apr  6 07:52:19 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr  6 07:52:25 2007
Subject: [Harbour] ChangeLog 2007-04-04 10:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070404083528.GA24578@localhost.localdomain>
References: <20070404083528.GA24578@localhost.localdomain>
Message-ID: <5D6DDA07-B731-4410-AA25-A5CF39889A49@syenar.hu>

Hi Przemek,

I'm replacing __StrT*() calls with new hb_Token*() ones and in the
process I've found several comments pointing to different limitations
of the old __StrT*() functions. Find them below.

Are these still valid or can we remove some of the workarounds?

----------------------------- (teditor.prg, tbrowse.prg)
    // __StrTkPtr() needs that string to be tokenized be terminated  
with a token delimiter

    // If cString starts with an EOL delimiter I have to add an empty  
line since __StrTkPtr
    // gives back _next_ token and would skip this first EOL delimiter

    /* TOFIX: Note that __StrToken() is not able to cope with  
delimiters longer than one char */
    // Dos - OS/2 - Windows have CRLF as EOL

    // __StrToken needs that even last token be ended with token  
separator
-----------------------------

Brgds,
Viktor

On 2007.04.04., at 10:35, Przemyslaw Czerpak wrote:

> 2007-04-04 10:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/contrib/tip/Makefile
>   - harbour/contrib/tip/atokens.c
>     * removed HB_ATOKENS()
>
>   - harbour/source/rtl/teditorl.c
>     - removed __STRTOKEN(), __STRTKPTR()
>
>   * harbour/common.mak
>   * harbour/source/rtl/Makefile
>   * harbour/include/hbextern.ch
>   + harbour/source/rtl/hbtoken.c
>     + added set of functions to manipulate string tokens:
>          HB_TOKENCOUNT( <cString>, [ <cDelim> ], [ <lSkipStrings> ],
>                         [ <lDoubleQuoteOnly> ] ) -> <nTokens>
>          HB_TOKENGET( <cString>, <nToken>, [ <cDelim> ],  
> [ <lSkipStrings> ],
>                       [ <lDoubleQuoteOnly> ] ) -> <cToken>
>          HB_TOKENPTR( <cString>, @<nSkip>, [ <cDelim> ],  
> [ <lSkipStrings> ],
>                       [ <lDoubleQuoteOnly> ] ) -> <cToken>
>          HB_ATOKENS( <cString>, [ <cDelim> ], [ <lSkipStrings> ],
>                      [ <lDoubleQuoteOnly> ] ) -> <aTokens>
>       All these functions use the same method of tokenization. They  
> can
>       accept as delimiters string longer then one character. By  
> default
>       they are using " " as delimiter. " " delimiter has special  
> mening
>       Unlike other delimiters repeted ' ' characters does not  
> create empty
>       tokens, f.e.: HB_ATOKENS( "    1     2 3  " ) returns array  
> { "1", "2" }
>       Any other delimiters are restrictly counted, f.e. HB_ATOKENS 
> ( ",,1,,2,")
>       return array: { "", "", "1", "", "2", "" }.
>
>     + added emulation for old __STRTOKEN(), __STRTKPTR() and  
> xHarbour's
>       __STRTOKENCOUNT() by HB_TOKEN*() functions. They do not return
>       exactly the same result as __STRT*() functions which in some  
> cases
>       ignored some delimiters and return wrong results.
>
>   * harbour/source/rdd/Makefile
>   + harbour/source/rdd/dbsql.c
>     + added __DBSQL() function
>
>   * harbour/include/hbsetup.h
>   * harbour/source/vm/fm.c
>     + added support for native Windows memory allocation functions
>       It can be enabled by HB_FM_WIN32_ALLOC macro and disable C-RTL
>       memory manager.
>
>   * harbour/tests/mousetst.prg
>     * touch screen output before MPRESENT() to work with GTXWC
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Fri Apr  6 09:02:08 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 09:02:44 2007
Subject: [Harbour] ChangeLog 2007-04-04 10:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <5D6DDA07-B731-4410-AA25-A5CF39889A49@syenar.hu>
References: <20070404083528.GA24578@localhost.localdomain>
	<5D6DDA07-B731-4410-AA25-A5CF39889A49@syenar.hu>
Message-ID: <20070406130208.GA24751@localhost.localdomain>

On Fri, 06 Apr 2007, Szak?ts Viktor wrote:
> I'm replacing __StrT*() calls with new hb_Token*() ones and in the
> process I've found several comments pointing to different limitations
> of the old __StrT*() functions. Find them below.
> Are these still valid or can we remove some of the workarounds?

Now all HB_TOKEN*() functions uses the same method of dividing
string into tokens so if sth works with one function should also
work with other. If not then please inform me - it's a bug which
should be fixed.
New functions should work with delimiters longer then 1 character
but please use recent CVS were I fixed one bug.
I'm attaching small test where you can check how some text is
divided into tokens.

> ----------------------------- (teditor.prg, tbrowse.prg)
>    // __StrTkPtr() needs that string to be tokenized be terminated  
> with a token delimiter

It's not longer true.

>    // If cString starts with an EOL delimiter I have to add an empty  
> line since __StrTkPtr
>    // gives back _next_ token and would skip this first EOL delimiter

It's not longer true.

>    /* TOFIX: Note that __StrToken() is not able to cope with  
> delimiters longer than one char */

It's not longer true.

>    // Dos - OS/2 - Windows have CRLF as EOL

and ??? ;-)

>    // __StrToken needs that even last token be ended with token  
> separator

It's not longer true.

best regards,
Przemek


/*** t.prg ***/
proc main()
local s:=",,1,33, 4", d:=",", d2:=chr(13)+chr(10), d3:=" "
? "==="
tst(s,d)
? "==="
tst(strtran(s,d,d2),d2)
? "==="
tst(strtran(s,d,d3),d3)
? "==="
return

proc tst(s,d)
local a:=hb_atokens(s,d), n:=0, i
aeval(a,{|x,i|qout(i,"["+x+"]",;
                     "["+hb_tokenget(s,i,d)+"]",;
                     "["+hb_tokenptr(s,@n,d)+"]")})
? "=> "
n:=i:=0
while n <= len(s)
   ?? "["+hb_tokenptr(s,@n,d)+"] "
   ++i
enddo
?? " =>", ltrim(str(hb_tokencount(s,d))), "==", ltrim(str(i)), ;
          hb_tokencount(s,d)==i
return
From druzus at priv.onet.pl  Fri Apr  6 09:02:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 09:03:07 2007
Subject: [Harbour] ChangeLog 2007-04-06 14:33 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070406130232.GB24751@localhost.localdomain>

2007-04-06 14:33 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rtl/hbtoken.c
    ! fixed using delimiters longer then 1 character

best regards,
Przemek
From harbour.01 at syenar.hu  Fri Apr  6 09:16:50 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr  6 09:16:55 2007
Subject: [Harbour] ChangeLog 2007-04-04 10:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070406130208.GA24751@localhost.localdomain>
References: <20070404083528.GA24578@localhost.localdomain>
	<5D6DDA07-B731-4410-AA25-A5CF39889A49@syenar.hu>
	<20070406130208.GA24751@localhost.localdomain>
Message-ID: <4AC68725-7067-4509-AB7A-73E962069D05@syenar.hu>

Thanks, I'll change the function calls, remove the comments and possibly
the workarounds too.

Brgds,
Viktor

On 2007.04.06., at 15:02, Przemyslaw Czerpak wrote:

> On Fri, 06 Apr 2007, Szak?ts Viktor wrote:
>> I'm replacing __StrT*() calls with new hb_Token*() ones and in the
>> process I've found several comments pointing to different limitations
>> of the old __StrT*() functions. Find them below.
>> Are these still valid or can we remove some of the workarounds?
>
> Now all HB_TOKEN*() functions uses the same method of dividing
> string into tokens so if sth works with one function should also
> work with other. If not then please inform me - it's a bug which
> should be fixed.
> New functions should work with delimiters longer then 1 character
> but please use recent CVS were I fixed one bug.
> I'm attaching small test where you can check how some text is
> divided into tokens.
>
>> ----------------------------- (teditor.prg, tbrowse.prg)
>>    // __StrTkPtr() needs that string to be tokenized be terminated
>> with a token delimiter
>
> It's not longer true.
>
>>    // If cString starts with an EOL delimiter I have to add an empty
>> line since __StrTkPtr
>>    // gives back _next_ token and would skip this first EOL delimiter
>
> It's not longer true.
>
>>    /* TOFIX: Note that __StrToken() is not able to cope with
>> delimiters longer than one char */
>
> It's not longer true.
>
>>    // Dos - OS/2 - Windows have CRLF as EOL
>
> and ??? ;-)
>
>>    // __StrToken needs that even last token be ended with token
>> separator
>
> It's not longer true.
>
> best regards,
> Przemek
>
>
> /*** t.prg ***/
> proc main()
> local s:=",,1,33, 4", d:=",", d2:=chr(13)+chr(10), d3:=" "
> ? "==="
> tst(s,d)
> ? "==="
> tst(strtran(s,d,d2),d2)
> ? "==="
> tst(strtran(s,d,d3),d3)
> ? "==="
> return
>
> proc tst(s,d)
> local a:=hb_atokens(s,d), n:=0, i
> aeval(a,{|x,i|qout(i,"["+x+"]",;
>                      "["+hb_tokenget(s,i,d)+"]",;
>                      "["+hb_tokenptr(s,@n,d)+"]")})
> ? "=> "
> n:=i:=0
> while n <= len(s)
>    ?? "["+hb_tokenptr(s,@n,d)+"] "
>    ++i
> enddo
> ?? " =>", ltrim(str(hb_tokencount(s,d))), "==", ltrim(str(i)), ;
>           hb_tokencount(s,d)==i
> return
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Fri Apr  6 10:42:02 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr  6 09:42:18 2007
Subject: [Harbour] CHANGELOG: 2007-04-06 15:38 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77859$Blat.v2.6.1$bd1d6f16$a04c6e0f53e@127.0.0.1>

2007-04-06 15:38 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/persist.prg
   * harbour/source/rtl/tbrowse.prg
   * harbour/source/rtl/teditor.prg
     % Replaced __StrT*() internal functions with native Harbour 
       extensions hb_Token*().
     % Removed workarounds for problems with the previous implementation 
       of the __StrT*() functions.
       Please test TEditor (all) and TBrowse class (header/footer line splitting).

From druzus at priv.onet.pl  Fri Apr  6 10:01:09 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 10:01:43 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32 UTC+0200
	PrzemyslawCzerpak(druzus/at/priv.onet.pl)
In-Reply-To: <46161C19.C0DBEB04@libero.it>
References: <20070406003357.GA21364@localhost.localdomain>
	<4615EAC9.D69B88B1@libero.it>
	<20070406090838.GA23619@localhost.localdomain>
	<46161C19.C0DBEB04@libero.it>
Message-ID: <20070406140109.GA30228@localhost.localdomain>

On Fri, 06 Apr 2007, Maurilio Longo wrote:
> > It's not true. Just simply make:
> >     SET C_USR=-DTCPV40HDRS
> > before you build Harbour.
> exactly, you now have to build a different one, while before a single build
> was working in both systems.

Sorry but you are wrong. It was not working in both system.
See the messages from David.
    ../../../../source/rtl/os2/gcc/rtl.a(hbinet.o): Undefined symbol
    tcp_h_errno referenced from text segment

> > Before this change it was not possible to build Harbour on newer OS2 versions
> > without modifying some source files. Now it can be build on all versions but
> > for older it's necessary to set one environment variable.
> > IMHO much better situation but of course the question about default setting
> > is still open. I'm not OS2 user and I do not know what should be default.
> It sounds strange to me since xharbour is built with that setting without
> problems and, as I've read here, tip comes from xharbour (TCPV40HDRS tells the
> compiler to use a previous version of tcp/ip headers wich are needed for the
> tcp/ip stack of old OS/2 systems since in those systems the tcp/ip was a
> 16/32bit mixed stack, while on newer systems the stack is fully 32 bit, but
> for the end user there is nearly no difference).

I'm not OS2 user but as I can see in OpenWatcom header files then
this compiler also cannot work with older OS2 versions because
it requests for symbols which does not exists in old systems.
IMHO OW authors had some serious reasons to make sth like that.

> > If the older version is more popular then we can make other modification
> > and add in os2/gcc.cf sth like:
> > 
> > ifneq ($(HB_OS2_VER),new)
> > CFLAGS += -DTCPV40HDRS
> > endif
> > 
> it is not enough, you need to change the order in which the linker searches
> for libraries to link, since it has to find the V40 libraries before the newer
> ones or else your executable can't be built.

One of the worst idea. In such way it's possible to mix code from
two different libraries and create buggy binaries. In the past
I tried to explain you why missing code from two different libraries
cannot be safe in _ANY_ system in all cases and only sometimes
it can work but you need very deep knowledge about internals of
both libraries and used C compiler with its optimizations to say
if final binaries are valid. For sure it's not sth what can be
be done automatically and it's the reason why all linker should
refuse linking binaries with replicated symbols by default.
In this case it's possible that adding library with tcp_h_errno
symbol will make linker happy by it's also possible that this
function will return pointer incompatible with the rest of inet
functions taken from previous libraries so you have final binaries
bu broken - valid error codes are never set. The worst possible
solution which can be detected only with very careful runtime
tests and often after many years of distributing wrong binaries.
Absolutely unacceptable situation for me.
Maybe in this case everything is OK but I cannot say it without
information about internals of old and new TCP stack implementaion
in OS2 (BTW did you tested it?) and this is enough reason for me.
In general such hacks with using many libraries with the same
symbols to create single libraries is shooting into own goal and
sooner or later causes very serious troubles.

> > so for newer OS2 version it will be necesary to make:
> >     SET HB_OS2_VER=new
> > before building Harbour. This is your and other OS2 users decision
> > but the build process should be control by environment settings and
> > previous situations when it was necessary to modify core make make
> > files to create Harbour binaries was not good.
> Core make files? 
> It has been a long time since I last built harbour, if I find a little spare
> time I'll try again (with the TCPV40HDRS to see what fails and I'll let you
> know).

So please try, I'll be very happy if someone with OS2 knowledge will try
to keep this port working. It's hard to me to update code after analyzing
header files in other projects or looking for information in the inet.

best regards,
Przemek
From maurilio.longo at libero.it  Fri Apr  6 10:59:36 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Fri Apr  6 11:00:23 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32 
	UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
References: <20070406003357.GA21364@localhost.localdomain>
	<4615EAC9.D69B88B1@libero.it>
	<20070406090838.GA23619@localhost.localdomain>
	<46161C19.C0DBEB04@libero.it>
	<20070406140109.GA30228@localhost.localdomain>
Message-ID: <46166058.F61D3C38@libero.it>

Przemyslaw Czerpak ha scritto:
> 
> On Fri, 06 Apr 2007, Maurilio Longo wrote:
> > > It's not true. Just simply make:
> > >     SET C_USR=-DTCPV40HDRS
> > > before you build Harbour.
> > exactly, you now have to build a different one, while before a single build
> > was working in both systems.
> 
> Sorry but you are wrong. It was not working in both system.
> See the messages from David.
>     ../../../../source/rtl/os2/gcc/rtl.a(hbinet.o): Undefined symbol
>     tcp_h_errno referenced from text segment
> 
> > > Before this change it was not possible to build Harbour on newer OS2 versions
> > > without modifying some source files. Now it can be build on all versions but
> > > for older it's necessary to set one environment variable.
> > > IMHO much better situation but of course the question about default setting
> > > is still open. I'm not OS2 user and I do not know what should be default.
> > It sounds strange to me since xharbour is built with that setting without
> > problems and, as I've read here, tip comes from xharbour (TCPV40HDRS tells the
> > compiler to use a previous version of tcp/ip headers wich are needed for the
> > tcp/ip stack of old OS/2 systems since in those systems the tcp/ip was a
> > 16/32bit mixed stack, while on newer systems the stack is fully 32 bit, but
> > for the end user there is nearly no difference).
> 

tcp_h_errno comes from the use of h_errno (which is redefined inside netdb.h)
inside hbinet.c, the same is inside source\vm\inet.c on xharbour where it
compiles without problems.


> I'm not OS2 user but as I can see in OpenWatcom header files then
> this compiler also cannot work with older OS2 versions because
> it requests for symbols which does not exists in old systems.
> IMHO OW authors had some serious reasons to make sth like that.
> 

I've never used OW, but I think it is no longer maintained on OS/2.

> > > If the older version is more popular then we can make other modification
> > > and add in os2/gcc.cf sth like:
> > >
> > > ifneq ($(HB_OS2_VER),new)
> > > CFLAGS += -DTCPV40HDRS
> > > endif
> > >
> > it is not enough, you need to change the order in which the linker searches
> > for libraries to link, since it has to find the V40 libraries before the newer
> > ones or else your executable can't be built.
> 
> One of the worst idea. In such way it's possible to mix code from
> two different libraries and create buggy binaries. In the past
> I tried to explain you why missing code from two different libraries

It's not my fault, this is the way GCC on OS/2 works, and the TCPV40HDRS come
from OS/2 SDK made by IBM which did this to let programmers build a single
binary file which works on old tcp/ip stacks and on newer ones and nearly
every program on OS/2 is built this way.


> cannot be safe in _ANY_ system in all cases and only sometimes
> it can work but you need very deep knowledge about internals of
> both libraries and used C compiler with its optimizations to say
> if final binaries are valid. For sure it's not sth what can be
> be done automatically and it's the reason why all linker should
> refuse linking binaries with replicated symbols by default.
> In this case it's possible that adding library with tcp_h_errno
> symbol will make linker happy by it's also possible that this
> function will return pointer incompatible with the rest of inet
> functions taken from previous libraries so you have final binaries
> bu broken - valid error codes are never set. The worst possible
> solution which can be detected only with very careful runtime
> tests and often after many years of distributing wrong binaries.
> Absolutely unacceptable situation for me.
> Maybe in this case everything is OK but I cannot say it without
> information about internals of old and new TCP stack implementaion
> in OS2 (BTW did you tested it?) and this is enough reason for me.

I've used inet functions of xharbour and tip library since it was available
and I have a couple of programs that run here at work processing emails and
answering web queries and they both are written in xharbour on OS/2 and work
flawlessly day in day out..

> In general such hacks with using many libraries with the same
> symbols to create single libraries is shooting into own goal and
> sooner or later causes very serious troubles.

I think IBM made this move since it had to be backwards compatible because
banks and big customers were not willing to move to the new versions of OS/2.

> So please try, I'll be very happy if someone with OS2 knowledge will try
> to keep this port working. It's hard to me to update code after analyzing
> header files in other projects or looking for information in the inet.
> 
I can believe that it is difficult to do 'blind programming' and you, as
usual, are doing a really wonderfull job.

I'm slowly moving to Macs (since OS/2 is diyng), I still have some OS/2
systems here at work, but I don't have it anymore at home.

I'm setting up a system on my mac using parallel deskop to run OS/2, but I
don't have so much spare time since I have a child now (born two months ago)
which uses all my spare time :)

I'll try to do this test next week, just to find out if it can be built (but
I'm sure it can, given that xharbour can), then I'll let you know.

Maurilio.

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From lorenzo.fiorini at gmail.com  Fri Apr  6 11:27:11 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr  6 11:27:15 2007
Subject: [Harbour] common.ch vs valtype.c
Message-ID: <9257026e0704060827o578cee82rc34d38c8cf335c54@mail.gmail.com>

I'm cleaning my code and I've found that in common.ch we miss ISHASH
#xtranslate while we have HB_ISHAS in valtype.c.

Also there are differences in names between common.ch and valtype.c:

ISNUMBER() -> HB_ISNUMERIC
ISCHARACTER() -> HB_ISSTRING | HB_ISCHAR

is there any difference between HB_ISXXX and his eq valtype() == x?

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Fri Apr  6 11:36:18 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr  6 11:36:22 2007
Subject: [Harbour] common.ch vs valtype.c
In-Reply-To: <9257026e0704060827o578cee82rc34d38c8cf335c54@mail.gmail.com>
References: <9257026e0704060827o578cee82rc34d38c8cf335c54@mail.gmail.com>
Message-ID: <E8743F02-9089-4409-842D-BB545E33C6AE@syenar.hu>

We can't have ISHASH() in common.ch, because that would
pollute the namespace. We could have HB_ISHASH() but that
is already implemented as a function.

Just out of curiosity I wonder what is the difference between
HB_ISSTRING() and HB_ISCHAR()?

Brgds,
Viktor

On 2007.04.06., at 17:27, Lorenzo Fiorini wrote:

> I'm cleaning my code and I've found that in common.ch we miss ISHASH
> #xtranslate while we have HB_ISHAS in valtype.c.
>
> Also there are differences in names between common.ch and valtype.c:
>
> ISNUMBER() -> HB_ISNUMERIC
> ISCHARACTER() -> HB_ISSTRING | HB_ISCHAR
>
> is there any difference between HB_ISXXX and his eq valtype() == x?
>
> regards,
> Lorenzo Fiorini
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Fri Apr  6 12:25:54 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 12:26:30 2007
Subject: [Harbour] common.ch vs valtype.c
In-Reply-To: <E8743F02-9089-4409-842D-BB545E33C6AE@syenar.hu>
References: <9257026e0704060827o578cee82rc34d38c8cf335c54@mail.gmail.com>
	<E8743F02-9089-4409-842D-BB545E33C6AE@syenar.hu>
Message-ID: <20070406162554.GA31433@localhost.localdomain>

On Fri, 06 Apr 2007, Szak?ts Viktor wrote:
> We can't have ISHASH() in common.ch, because that would
> pollute the namespace. We could have HB_ISHASH() but that
> is already implemented as a function.
> 
> Just out of curiosity I wonder what is the difference between
> HB_ISSTRING() and HB_ISCHAR()?

#xtranslate VALTYPE( <x> ) == "C" => HB_ISCHAR( <x> )
#xtranslate VALTYPE( <x> ) == "M" => HB_ISMEMO( <x> )
#xtranslate VALTYPE( <x> ) $ "CM" => HB_ISSTRING( <x> )

> >ISNUMBER() -> HB_ISNUMERIC
> >ISCHARACTER() -> HB_ISSTRING | HB_ISCHAR

I used the same names as in xHarbour to reduce the problem with
portability.

> >is there any difference between HB_ISXXX and his eq valtype() == x?

In [x]Harbour VALTYPE is normal function just like any other so code
    IF VALTYPE(x) == "L"
is slower then:
    IF HB_ISLOGICAL(x)
just compare generated PCODE.
So using the above #xtranslate can give some small speed improvement.
xHarbour has a set of such translation rules in its common.ch file.
The difference is very small and in most cases you will not notice it
until you are not using some code which hast to call VALTYPE() very
often. F.e. this code:

    /*** t.prg ***/
    #define N_LOOP 10000000
    proc main()
    local i, x, t

    ? VERSION(), OS(), DATE(), TIME()

    t:=secondsCPU()
    for i:=1 to N_LOOP
        x:=VALTYPE(i)=="N"
    next
    ? secondsCPU()-t, "sec."

    #xtranslate VALTYPE( <x> ) == "N" => HB_ISNUMERIC( <x> )

    t:=secondsCPU()
    for i:=1 to N_LOOP
        x:=VALTYPE(i)=="N"
    next
    ? secondsCPU()-t, "sec."
    ?
    return
    /*** t.prg ***/

gives the following results:

druzus:/tmp/8# hbmk -n -w -es2 -l -gtcgi t && ./t
Harbour devel build 1.1-0 Intl.
Copyright 1999-2007, http://www.harbour-project.org/
Compiling 't.prg'...
Lines 39, Functions/Procedures 1
Generating C source output to 't.c'... Done.

Harbour devel build 1.1-0 Intl. Linux 2.6.15 i686 04/06/07 18:24:35
         4.76 sec.
         3.60 sec.
druzus:/tmp/8# xhbmk -n -w -es2 -l -gtcgi t && ./t
xHarbour Compiler build 0.99.71 (SimpLex)
Copyright 1999-2007, http://www.xharbour.org http://www.harbour-project.org/
Compiling 't.prg'...
Lines 24, Functions/Procedures 1
Generating C source output to 't.c'...
Done.
xHarbour build 0.99.71 Intl. (SimpLex) Linux 2.6.15 i686 04/06/07 18:24:49
         6.55 sec.
         4.98 sec.
druzus:/tmp/8#


best regards,
Przemek
From e.m.giordano at emagsoftware.it  Fri Apr  6 12:58:51 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Fri Apr  6 12:59:26 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32
	UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
References: <20070406003357.GA21364@localhost.localdomain><4615EAC9.D69B88B1@libero.it><20070406090838.GA23619@localhost.localdomain><46161C19.C0DBEB04@libero.it><20070406140109.GA30228@localhost.localdomain>
	<46166058.F61D3C38@libero.it>
Message-ID: <017c01c7786c$d9f2d640$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Maurilio Longo" <maurilio.longo@libero.it>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: venerd? 6 aprile 2007 16.59
Oggetto: Re: [Harbour] ChangeLog 2007-04-06 02:32 
UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)


> I don't have so much spare time since I have a child now
> (born two months ago)

Congratulations and my best wishes for the new Harbour programmer. :-)

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Fri Apr  6 13:44:15 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr  6 13:44:19 2007
Subject: [Harbour] common.ch vs valtype.c
In-Reply-To: <20070406162554.GA31433@localhost.localdomain>
References: <9257026e0704060827o578cee82rc34d38c8cf335c54@mail.gmail.com>
	<E8743F02-9089-4409-842D-BB545E33C6AE@syenar.hu>
	<20070406162554.GA31433@localhost.localdomain>
Message-ID: <CE05D7CE-5396-432C-885C-7966F17BEE52@syenar.hu>

>> Just out of curiosity I wonder what is the difference between
>> HB_ISSTRING() and HB_ISCHAR()?
>
> #xtranslate VALTYPE( <x> ) == "C" => HB_ISCHAR( <x> )
> #xtranslate VALTYPE( <x> ) == "M" => HB_ISMEMO( <x> )
> #xtranslate VALTYPE( <x> ) $ "CM" => HB_ISSTRING( <x> )

Ok, I see.

>>> ISNUMBER() -> HB_ISNUMERIC
>>> ISCHARACTER() -> HB_ISSTRING | HB_ISCHAR
>
> I used the same names as in xHarbour to reduce the problem with
> portability.
>
>>> is there any difference between HB_ISXXX and his eq valtype() == x?
>
> In [x]Harbour VALTYPE is normal function just like any other so code
>     IF VALTYPE(x) == "L"
> is slower then:
>     IF HB_ISLOGICAL(x)
> just compare generated PCODE.

Well, couldn't we change the #defines in common.ch to
translate to the faster calls then? Any downsides?

Brgds,
Viktor



From druzus at priv.onet.pl  Fri Apr  6 14:37:25 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 14:38:01 2007
Subject: [Harbour] common.ch vs valtype.c
In-Reply-To: <CE05D7CE-5396-432C-885C-7966F17BEE52@syenar.hu>
References: <9257026e0704060827o578cee82rc34d38c8cf335c54@mail.gmail.com>
	<E8743F02-9089-4409-842D-BB545E33C6AE@syenar.hu>
	<20070406162554.GA31433@localhost.localdomain>
	<CE05D7CE-5396-432C-885C-7966F17BEE52@syenar.hu>
Message-ID: <20070406183725.GA32071@localhost.localdomain>

On Fri, 06 Apr 2007, Szak?ts Viktor wrote:
> >In [x]Harbour VALTYPE is normal function just like any other so code
> >    IF VALTYPE(x) == "L"
> >is slower then:
> >    IF HB_ISLOGICAL(x)
> >just compare generated PCODE.
> Well, couldn't we change the #defines in common.ch to
> translate to the faster calls then? Any downsides?

We can and here I do not see anything dangerous.
But if you want to add xHarbour like #xtranslate(s) then I'm
against because PP does not know anything about operator precedence
so such rules break valid Clipper code, f.e.:

    #include "common.ch"
    proc main()
    local x:=0
    ? "C" + valtype( x ) == "C" + "N"
    return


druzus:/tmp/8# hbmk -n -w -es2 -gtcgi t2 && ./t2
Harbour devel build 1.1-0 Intl.
Copyright 1999-2007, http://www.harbour-project.org/
Compiling 't2.prg'...
Lines 111, Functions/Procedures 1
Generating C source output to 't2.c'... Done.

.T.
druzus:/tmp/8# xhbmk -n -w -es2 -gtcgi t2 && ./t2
xHarbour Compiler build 0.99.71 (SimpLex)
Copyright 1999-2007, http://www.xharbour.org http://www.harbour-project.org/
Compiling 't2.prg'...
Lines 8, Functions/Procedures 1
Generating C source output to 't2.c'...
Done.
Error BASE/1081  Argument error: + Arguments: ( [ 1] =
Type: C Val: C [ 2] = Type: L Val: .T.)
MAIN(4) in module: t2.prg

best regards,
Przemek
From druzus at priv.onet.pl  Fri Apr  6 14:45:16 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr  6 14:45:52 2007
Subject: [Harbour] ChangeLog 2007-04-06 02:32
	UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
In-Reply-To: <46166058.F61D3C38@libero.it>
References: <20070406003357.GA21364@localhost.localdomain>
	<4615EAC9.D69B88B1@libero.it>
	<20070406090838.GA23619@localhost.localdomain>
	<46161C19.C0DBEB04@libero.it>
	<20070406140109.GA30228@localhost.localdomain>
	<46166058.F61D3C38@libero.it>
Message-ID: <20070406184516.GB32071@localhost.localdomain>

On Fri, 06 Apr 2007, Maurilio Longo wrote:
> I've never used OW, but I think it is no longer maintained on OS/2.

They are still releasing OS2 versions.

[...]
> I'm setting up a system on my mac using parallel deskop to run OS/2, but I
> don't have so much spare time since I have a child now (born two months ago)
> which uses all my spare time :)

This is the most important message and you priority :-).
My congratulations and best wishes for your growing family,
And of course good luck with a new jobs - I've got two daughters
and son so I know a little bit what does it mean - digital world
is much more simple ;-)

best regards,
Przemek
From sircaulises at gmail.com  Sat Apr  7 11:09:26 2007
From: sircaulises at gmail.com (Sirca Ulises)
Date: Sat Apr  7 11:09:29 2007
Subject: [Harbour] __clsModMsg working example
Message-ID: <001701c77926$bd21de20$3e02a8c0@PORTATIL>

Hi  Everybody,

 

I try use the __clsModMsg function in the next example, but not working.

 

Have any body a working example ??

 

Thanks,

 

Fernando

 

---- Example ----

#include "HBCLASS.CH"

 

FUNCTION MAIN()

 

 LOCAL oTest := TEST():New()

 

? oTest:SayStr()

 

__clsModMsg( oTest, "SAYSTR", @SAYHELLO() )

 

? oTest:SayStr()

 

RETURN NIL

 

CLASS TEST

 

 DATA cStr

 

 METHOD New()

 METHOD SayStr()// INLINE ::nNum

 

ENDCLASS

 

METHOD New() CLASS TEST

 

RETURN Self

 

METHOD SayStr() CLASS TEST

 

 ::cStr := "from SayStr"

 

RETURN ::cStr

 

FUNCTION SayHello()

 

RETURN "from SayHello"

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070407/3346eb7a/attachment.html
From druzus at priv.onet.pl  Sat Apr  7 11:41:10 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat Apr  7 11:41:46 2007
Subject: [Harbour] __clsModMsg working example
In-Reply-To: <001701c77926$bd21de20$3e02a8c0@PORTATIL>
References: <001701c77926$bd21de20$3e02a8c0@PORTATIL>
Message-ID: <20070407154110.GA5707@localhost.localdomain>

On Sat, 07 Apr 2007, Sirca Ulises wrote:
> Hi  Everybody,
> I try use the __clsModMsg function in the next example, but not working.
[...]
> __clsModMsg( oTest, "SAYSTR", @SAYHELLO() )

Should be:
  __clsModMsg( oTest:classH, "SAYSTR", @SAYHELLO() )

But please note that Harbour has locking mechanism for class definition
so modification of given class can be forbidden by class programmer.

best regards,
Przemek
From sircaulises at gmail.com  Sat Apr  7 11:56:20 2007
From: sircaulises at gmail.com (Sirca Ulises)
Date: Sat Apr  7 11:56:23 2007
Subject: [Harbour] __clsModMsg working example
In-Reply-To: <20070407154110.GA5707@localhost.localdomain>
References: <001701c77926$bd21de20$3e02a8c0@PORTATIL>
	<20070407154110.GA5707@localhost.localdomain>
Message-ID: <000001c7792d$4a9582b0$3e02a8c0@PORTATIL>

> Hi  Everybody,
> I try use the __clsModMsg function in the next example, but not working.
[...]
> __clsModMsg( oTest, "SAYSTR", @SAYHELLO() )

Hi Przemek,

>>Should be:
>>  __clsModMsg( oTest:classH, "SAYSTR", @SAYHELLO() )

Thank you very much, can you change this comment on classes.c source code
line 2881:

/*
 * __clsModMsg( <oObj>, <cMessage>, <pFunc> )
 *
 * Modify message (only for INLINE and METHOD)
 */

To

/*
 * __clsModMsg( <oObj>:classH, <cMessage>, <pFunc> )
 *
 * Modify message (only for INLINE and METHOD)
 */


>>But please note that Harbour has locking mechanism for class definition
>>so modification of given class can be forbidden by class programmer.

This locking mechanism is possible activate from Creation Class ?? or later
?

Best Regards,

Fer

From alex at belacy.belgorod.su  Sat Apr  7 12:33:14 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Sat Apr  7 12:35:09 2007
Subject: [Harbour] Re: Error while compiling hwgui.lib
In-Reply-To: <46169B90.3080505@obukhov.kiev.ua>
References: <46169B90.3080505@obukhov.kiev.ua>
Message-ID: <7326059241.20070407203314@belacy.belgorod.su>

???????, 6 ?????? 2007 ?. atzct atzct@obukhov.kiev.ua wrote:

a> With last version harbour and hwgui from cvs i cannot build hwgui.lib:

a>     c:\harbour\bin\b32\harbour.exe -iinclude;c:\harbour\include -n -q0 
a> -w -es2 -gc0   source\richtext.prg -oobj\b32\richtext.c

a> source\richtext.prg(1541) Warning W0027  Meaningless use of expression: 
a> 'String'

a> [ ... ]

 Fixed:

2007-04-07 20:30 UTC+0300 Alexander Kresin <alex@belacy.belgorod.su>
   * source/menu_c.c
     * SetMenuCaption() changed in the same way as CheckMenuItem(),etc.
   * source/richtext.prg
     ! Few warnings fixed
   * samples/testxml.prg
     * Call of SetMenuCaption() has been fixed due to changes in this function.
 

Regards,
 Alexander
http://kresin.belgorod.su

From alex at belacy.belgorod.su  Sat Apr  7 12:38:19 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Sat Apr  7 12:38:44 2007
Subject: [Harbour] Re: Error while compiling hwgui.lib
In-Reply-To: <7326059241.20070407203314@belacy.belgorod.su>
References: <46169B90.3080505@obukhov.kiev.ua>
	<7326059241.20070407203314@belacy.belgorod.su>
Message-ID: <10926363759.20070407203819@belacy.belgorod.su>

On  Saturday, April 07, 2007, 20:33 Alexander S.Kresin <alex@belacy.belgorod.su> wrote:

a>> With last version harbour and hwgui from cvs i cannot build hwgui.lib:

a>> [ ... ]

 Sorry, wrong list.


Regards,
 Alexander
http://kresin.belgorod.su

From lorenzo.fiorini at gmail.com  Sat Apr  7 14:10:00 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr  7 14:10:02 2007
Subject: [Harbour] I'd like to upload contrib/gd
Message-ID: <9257026e0704071110v4f48d2ecw4bcda8efe48fd363@mail.gmail.com>

I've cleaned sources, dirs and make files to follow Harbour contrib standards.

It has still some problems, but basic functions and tests work.
I've contacted the author and I hope he'll help to fix it.

Any objection?

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Sat Apr  7 14:29:13 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr  7 14:29:17 2007
Subject: [Harbour] I'd like to upload contrib/gd
In-Reply-To: <9257026e0704071110v4f48d2ecw4bcda8efe48fd363@mail.gmail.com>
References: <9257026e0704071110v4f48d2ecw4bcda8efe48fd363@mail.gmail.com>
Message-ID: <E753A312-040B-4131-9F3A-7DE9681527F7@syenar.hu>

Hi Lorenzo,

None from me.

I understand GD is a business graphics library, which looks like
a nice addition.

Brgds,
Viktor

On 2007.04.07., at 20:10, Lorenzo Fiorini wrote:

> I've cleaned sources, dirs and make files to follow Harbour contrib  
> standards.
>
> It has still some problems, but basic functions and tests work.
> I've contacted the author and I hope he'll help to fix it.
>
> Any objection?
>
> regards,
> Lorenzo Fiorini
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Sat Apr  7 14:31:49 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr  7 14:31:52 2007
Subject: [Harbour] Class constructor call xHarbour vs Harbour
Message-ID: <9257026e0704071131s1333eb1ap914a2e82cf338f95@mail.gmail.com>

The test below return nil in Harbour and 1 in xHarbour.
If it is an expected behaviour?

#include "hbclass.ch"

procedure main()

   local o

   o := cls( 1, 2 )

   ? o:x

   wait

return

class cls

   DATA x
   DATA y

   METHOD New( x, y ) CONSTRUCTOR

end class

METHOD New( x, y )

   ::x := x
   ::y := y

   return Self
From lorenzo.fiorini at gmail.com  Sat Apr  7 14:41:13 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr  7 14:41:16 2007
Subject: [Harbour] I'd like to upload contrib/gd
In-Reply-To: <E753A312-040B-4131-9F3A-7DE9681527F7@syenar.hu>
References: <9257026e0704071110v4f48d2ecw4bcda8efe48fd363@mail.gmail.com>
	<E753A312-040B-4131-9F3A-7DE9681527F7@syenar.hu>
Message-ID: <9257026e0704071141n1bc6aedfu9c98668b009b1539@mail.gmail.com>

On 4/7/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> I understand GD is a business graphics library, which looks like
> a nice addition.

Yes, hbgd is a wrapper around www.libgd.org graphic library.

It has classes for creating images, charts and barcode.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Sat Apr  7 14:43:23 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr  7 14:43:25 2007
Subject: [Harbour] I'd like to upload contrib/gd
In-Reply-To: <E753A312-040B-4131-9F3A-7DE9681527F7@syenar.hu>
References: <9257026e0704071110v4f48d2ecw4bcda8efe48fd363@mail.gmail.com>
	<E753A312-040B-4131-9F3A-7DE9681527F7@syenar.hu>
Message-ID: <9257026e0704071143y70e63786md8ee850208ed5806@mail.gmail.com>

On 4/7/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> I understand GD is a business graphics library, which looks like
> a nice addition.

Sorry I forgot to mention that I borrowed it from xHarbour contrib/gd.

regards,
Lorenzo Fiorini
From jorgeagiraldo at hotmail.com  Sun Apr  8 09:08:33 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Sun Apr  8 09:09:10 2007
Subject: [Harbour] := operator
Message-ID: <BAY136-F22D10BD79D293087340C9DA15A0@phx.gbl>

Hi,

I'm trying to recompile my Harbour app using Harbour Beta build 0.99-2 Intl. 
  and the following line gives me a syntax error:

oFile := FileH{"FILENAME","ALIASN", "SH",600}

There is no problem with the following code:

oFile = FileH{"FILENAME","ALIASN", "SH",600}

I'm responsible for the Contrib\Delphi\hbdll sources, and there would be 
nice if I could download the current snapshot for testing, my username seems 
locked.

C:\HB-DEV>login
Password:
Permission denied.
C:\HB-DEV>

The script is:

@echo off
SET HOME=C:\HB-DEV\
ssh\ssh -l jgiraldo Harbour-project.cvs.sourceforge.net

Regards,

Jorge A.

_________________________________________________________________
MSN Amor: busca tu ? naranja http://latam.msn.com/amor/

From i at kevincarmody.com  Sun Apr  8 19:10:08 2007
From: i at kevincarmody.com (Kevin Carmody)
Date: Sun Apr  8 19:08:57 2007
Subject: [Harbour] := operator
In-Reply-To: <BAY136-F22D10BD79D293087340C9DA15A0@phx.gbl>
References: <BAY136-F22D10BD79D293087340C9DA15A0@phx.gbl>
Message-ID: <46197650.5070103@kevincarmody.com>

Jorge A. Giraldo wrote:
> I'm trying to recompile my Harbour app using Harbour Beta build 0.99-2 
> Intl.  and the following line gives me a syntax error:
>
> oFile := FileH{"FILENAME","ALIASN", "SH",600}
It's objecting to the braces.  Braces are illegal immediately after a 
symbol.  Try changing the braces to parentheses.
> There is no problem with the following code:
>
> oFile = FileH{"FILENAME","ALIASN", "SH",600}
This should be illegal too.

Kevin

From alex at belacy.belgorod.su  Mon Apr  9 10:42:05 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Mon Apr  9 10:43:16 2007
Subject: [Harbour] Re := operator
In-Reply-To: <BAY136-F22D10BD79D293087340C9DA15A0@phx.gbl>
References: <BAY136-F22D10BD79D293087340C9DA15A0@phx.gbl>
Message-ID: <723015836.20070409184205@belacy.belgorod.su>

On  Sunday, April 08, 2007, 17:08 Jorge A. Giraldo <jorgeagiraldo@hotmail.com> wrote:

JAG> Hi,

JAG> I'm trying to recompile my Harbour app using Harbour Beta build 0.99-2 Intl. 
JAG>   and the following line gives me a syntax error:

JAG> oFile := FileH{"FILENAME","ALIASN", "SH",600}

JAG> There is no problem with the following code:

JAG> oFile = FileH{"FILENAME","ALIASN", "SH",600}

  Hm... Strange use of braces... Are you sure that there should be
  '{}', not the '()' ?

JAG> I'm responsible for the Contrib\Delphi\hbdll sources, and there would be 
JAG> nice if I could download the current snapshot for testing, my username seems 
JAG> locked.

  Your username isn't locked, you are in the developers list.
  Maybe, something wrong with the password ?
  Have you tried to login into the http://www.sourceforge.net/ with
  your username ?
  

Regards,
 Alexander
http://kresin.belgorod.su

From jorgeagiraldo at hotmail.com  Mon Apr  9 11:31:16 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Mon Apr  9 11:31:51 2007
Subject: [Harbour] Re := operator
In-Reply-To: <723015836.20070409184205@belacy.belgorod.su>
Message-ID: <BAY136-F3991FC677E72ABAFB5ED8FA1590@phx.gbl>

Hi Alexander,

This is TopClass syntax, it comes from C4W and it was supported by the 
HbClass implementation in previous versions (Harbour Compiler Alpha build 
44.0 (Flex)), the program compiles fine if I change the ":=" for "=", it 
tries to run but stops with the following message : "Assigned value is wrong 
class: ARCHIVO:CVIA", I will try to isolate the problem and report the 
results here.

On the other hand, my password had expired in SourceForge, right now I'm 
doing a full checkout with the new password, thank you.

Jorge A.


>From: "Alexander S.Kresin" <alex@belacy.belgorod.su>
>Reply-To: "Alexander S.Kresin" <alex@belacy.belgorod.su>,"Harbour Project 
>Main Developer List." <harbour@harbour-project.org>
>To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
>Subject: [Harbour] Re := operator
>Date: Mon, 9 Apr 2007 18:42:05 +0400
>
>On  Sunday, April 08, 2007, 17:08 Jorge A. Giraldo 
><jorgeagiraldo@hotmail.com> wrote:
>
>JAG> Hi,
>
>JAG> I'm trying to recompile my Harbour app using Harbour Beta build 0.99-2 
>Intl.
>JAG>   and the following line gives me a syntax error:
>
>JAG> oFile := FileH{"FILENAME","ALIASN", "SH",600}
>
>JAG> There is no problem with the following code:
>
>JAG> oFile = FileH{"FILENAME","ALIASN", "SH",600}
>
>   Hm... Strange use of braces... Are you sure that there should be
>   '{}', not the '()' ?
>
>JAG> I'm responsible for the Contrib\Delphi\hbdll sources, and there would 
>be
>JAG> nice if I could download the current snapshot for testing, my username 
>seems
>JAG> locked.
>
>   Your username isn't locked, you are in the developers list.
>   Maybe, something wrong with the password ?
>   Have you tried to login into the http://www.sourceforge.net/ with
>   your username ?
>
>
>Regards,
>  Alexander
>http://kresin.belgorod.su
>
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour

_________________________________________________________________
MSN Amor: busca tu ? naranja http://latam.msn.com/amor/

From niki at synel.co.il  Tue Apr 10 03:33:31 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue Apr 10 03:34:38 2007
Subject: [Harbour] Re: SF bugtracker#1672233: GET ... READ skipping Logical
	Vars
References: <460FBA44.C07@synel.co.il>
Message-ID: <461B3DCB.1EE2@synel.co.il>

This is still not working.
Tested with devel ChangeLog 2007-04-06 15:38 UTC+0100 Viktor Szakats

On Sun, 01 Apr 2007 Chen Kedem wrote:
> 
> The following was posted on the Harbour SF bug tracker:
> http://sourceforge.net/tracker/index.php?func=detail&aid=1672233&group_id=681&atid=100681
> 
> --tt31.prg--
> PROCEDURE MAIN
> public GetList, lVar1 := .T., lVar2 := .T.
> CLS
> @ 10, 10 GET lVar1                // Can edit
> @ 12, 10 GET lVar2 PICTURE "L"    // Can not edit
> READ
> RETURN
> ------------
> 
> bld_b32 tt31 /w/a/n
> 
> The logic GET with the PICTURE does not allow to edit the value.
> Work with Clipper 5.2, does not work with BCC32 devel ChangeLog: 2007-04-01 13:47 UTC+0100 Viktor Szakats
> 
>   Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From niki at synel.co.il  Tue Apr 10 03:56:03 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue Apr 10 03:57:12 2007
Subject: [Harbour] Re: SF bugtracker#1692268: when in get causes error
References: <460FB496.389E@synel.co.il>
Message-ID: <461B4313.531E@synel.co.il>

This was fixed in the devel version in ChangeLog 2007-04-01 16:56 UTC+0100 Viktor Szakats
and in the beta version in ChangeLog 2007-04-02 17:00 UTC+0300 Alexander Kresin

BUT, according to the ViewVC at SourceForge, the fixed was made for
beta1 but is NOT contained in beta2. Please look at it, so we don't
create a sets with missing fixes.

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From niki at synel.co.il  Tue Apr 10 03:59:52 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue Apr 10 04:00:47 2007
Subject: [Harbour] SF bugtracker#1695073: cphu852.c is buggy
Message-ID: <461B43F8.13A5@synel.co.il>

Victor,

There is a report about the Hungarian codepage:
http://sourceforge.net/tracker/index.php?func=detail&aid=1695073&group_id=681&atid=100681

Can you look at it, please?

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From druzus at priv.onet.pl  Tue Apr 10 04:47:14 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 04:47:49 2007
Subject: [Harbour] := operator
In-Reply-To: <BAY136-F22D10BD79D293087340C9DA15A0@phx.gbl>
References: <BAY136-F22D10BD79D293087340C9DA15A0@phx.gbl>
Message-ID: <20070410084714.GA27700@localhost.localdomain>

On Sun, 08 Apr 2007, Jorge A. Giraldo wrote:
> Hi,
> I'm trying to recompile my Harbour app using Harbour Beta build 0.99-2 
> Intl. and the following line gives me a syntax error:
> oFile := FileH{"FILENAME","ALIASN", "SH",600}
> There is no problem with the following code:
> oFile = FileH{"FILENAME","ALIASN", "SH",600}
> I'm responsible for the Contrib\Delphi\hbdll sources, and there would be 
> nice if I could download the current snapshot for testing, my username 
> seems locked.

Any of the above was never supported by [x]Harbour compiler.
Anyhow in our hbclass.ch we have rules which translates such
expressions:

    #xtranslate  ( <!name!>{ [<p,...>] }        =>  ( <name>():New( <p> )
    #xtranslate  = <!name!>{ [<p,...>] }        =>  = <name>():New( <p> )
    #xtranslate  , <!name!>{ [<p,...>] }        =>  , <name>():New( <p> )

With new preprocessor you have to add to above translations also:
    #xtranslate := <!name!>{ [<p,...>] }        => := <name>():New( <p> )
and I'll add it ASAP.
With new PP it's also possible to use single rule like:
    #xtranslate <!name!>{ [<p,...>] }        => <name>():New( <p> )
but I do not want to add such "aggressive" translation to default hbclass.ch
because it may interact with some existing user commands.

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr 10 04:47:57 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 04:48:32 2007
Subject: [Harbour] I'd like to upload contrib/gd
In-Reply-To: <9257026e0704071110v4f48d2ecw4bcda8efe48fd363@mail.gmail.com>
References: <9257026e0704071110v4f48d2ecw4bcda8efe48fd363@mail.gmail.com>
Message-ID: <20070410084757.GB27700@localhost.localdomain>

On Sat, 07 Apr 2007, Lorenzo Fiorini wrote:
> I've cleaned sources, dirs and make files to follow Harbour contrib 
> standards.
> It has still some problems, but basic functions and tests work.
> I've contacted the author and I hope he'll help to fix it.
> Any objection?

No, very dood news. Thank you very much.

best regards,
Przemek
From harbour.01 at syenar.hu  Tue Apr 10 04:50:14 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 10 04:50:26 2007
Subject: [Harbour] SF bugtracker#1695073: cphu852.c is buggy
In-Reply-To: <461B43F8.13A5@synel.co.il>
References: <461B43F8.13A5@synel.co.il>
Message-ID: <D9A830F8-195C-41CB-B911-45E757ACFD66@syenar.hu>

Hi Chen,

Thanks for the pointer.

It's not a bug, because - as noted in the NOTE in the source - the char
in question - although indeed not an HU char - is actually included in
both the NTXHU852.OBJ for CA-Cl*pper and SIXHU852.OBJ (3rd party).

In it's current form Harbour is 100% compatible with SIXHU852.OBJ.

To be fully CA-Cl*pper compatible Harbour would need to emulate
NTXHU852.OBJ, which has more extra - so called CWI - chars included.

Unfortunately this one would need different number of uppercase and
lowercase chars which I believe is not currently supported by Harbour.

Brgds,
Viktor

On 2007.04.10., at 9:59, Chen Kedem wrote:

> Victor,
>
> There is a report about the Hungarian codepage:
> http://sourceforge.net/tracker/index.php? 
> func=detail&aid=1695073&group_id=681&atid=100681
>
> Can you look at it, please?
>
>   Chen.
> ********************************************************************** 
> ************************
> IMPORTANT: The contents of this email and any attachments are  
> confidential. They are intended for the
> named recipient(s) only.
> If you have received this email in error, please notify the system  
> manager or the sender immediately and do
> not disclose the contents to anyone or make copies thereof.
> *** eSafe scanned this email for viruses, vandals, and malicious  
> content. ***
> ********************************************************************** 
> ************************
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Tue Apr 10 05:13:19 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 05:13:54 2007
Subject: [Harbour] Class constructor call xHarbour vs Harbour
In-Reply-To: <9257026e0704071131s1333eb1ap914a2e82cf338f95@mail.gmail.com>
References: <9257026e0704071131s1333eb1ap914a2e82cf338f95@mail.gmail.com>
Message-ID: <20070410091319.GC27700@localhost.localdomain>

On Sat, 07 Apr 2007, Lorenzo Fiorini wrote:
> The test below return nil in Harbour and 1 in xHarbour.
> If it is an expected behaviour?

Yes and it's sth what we should discuss.
It's one of the most important incompatibilities between xHarbour and
class(y).
In xHarbour when you are calling class function you receive an object
of given class, f.e.:

    ? cls():classname

will show CLS when in class(y) you receive a class object which understands
message NEW(). This message create an object of given class. F.e.:
    o:=cls()
    ? o:classname   // "class CLS" or "class"
    o1:=o:new()
    o2:=o:new()
    ? o1:classname  // "CLS"
    ? o2:classname  // "CLS"

The class messages and members can be sent (access/assing) only by class
object. The class object can be accessed from object using CLASS message,
f.e.;
    ? o1:class:classname  // "class CLS"
    ? o1:class == o       // .T.
It means that class messages and members can have the same names as object
messages and members because the belongs to differ class.
It also means that you can sent class messages wihout creating and object,
f.e.:
    CLS():CLASSMSG1()
when in [x]Harbour each call to CLS() creates new instance of class CLS().
The interface used by class(y) is IMHO very nice and clean. Unfortunately
neither Harbour nor xHarbour never respect the above and people already
created code which expects that class function returns an instance of given
class not a class object. I want to change it and make our class code full
class(y) compatible and it means that in the future class function will
return class object so I decided to not replicate xHarbour behavior and
automatically call constructor in class function.

If you want to reach effect similar to xHarbour then you should change
in hbclass.ch:
   return s_oClass:Instance() AS CLASS _CLASS_NAME_ ;;
to:
   return s_oClass:Instance():new(...) AS CLASS _CLASS_NAME_ ;;

and:
   <static> function __HB_CLS_OPT([<FuncName>,] <ClassName>) ;;
to:
   <static> function __HB_CLS_OPT([<FuncName>,] <ClassName>)(...) ;;

Maybe we should add some #define to control it.

best regards,
Przemek


> #include "hbclass.ch"
> procedure main()
>   local o
>   o := cls( 1, 2 )
>   ? o:x
>   wait
> return
> class cls
>   DATA x
>   DATA y
>   METHOD New( x, y ) CONSTRUCTOR
> end class
> METHOD New( x, y )
>   ::x := x
>   ::y := y
>   return Self
From druzus at priv.onet.pl  Tue Apr 10 05:17:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 05:18:07 2007
Subject: [Harbour] __clsModMsg working example
In-Reply-To: <000001c7792d$4a9582b0$3e02a8c0@PORTATIL>
References: <001701c77926$bd21de20$3e02a8c0@PORTATIL>
	<20070407154110.GA5707@localhost.localdomain>
	<000001c7792d$4a9582b0$3e02a8c0@PORTATIL>
Message-ID: <20070410091732.GD27700@localhost.localdomain>

On Sat, 07 Apr 2007, Sirca Ulises wrote:
> Hi Przemek,
> >>Should be:
> >>  __clsModMsg( oTest:classH, "SAYSTR", @SAYHELLO() )
> 
> Thank you very much, can you change this comment on classes.c source code
> line 2881:
> 
>  * __clsModMsg( <oObj>, <cMessage>, <pFunc> )
> To
>  * __clsModMsg( <oObj>:classH, <cMessage>, <pFunc> )

rather:
 * __clsModMsg( <hClass>, <cMessage>, <pFunc> )

and yes I'll do that thanks for information.

> >>But please note that Harbour has locking mechanism for class definition
> >>so modification of given class can be forbidden by class programmer.
> This locking mechanism is possible activate from Creation Class ?? or later
> ?

Class can be locked at any moment by:
    __clsLock( <hClass> )
and this blocks any later RT class modifications.
When I'll be working on some hbclass.ch modifications I'll also add:
support for:
    ENDCLASS LOCK[ED]
and such classes will be locked automatically.

best regards,
Przemek
From harbour.01 at syenar.hu  Tue Apr 10 05:22:14 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 10 05:22:16 2007
Subject: [Harbour] Class constructor call xHarbour vs Harbour
In-Reply-To: <20070410091319.GC27700@localhost.localdomain>
References: <9257026e0704071131s1333eb1ap914a2e82cf338f95@mail.gmail.com>
	<20070410091319.GC27700@localhost.localdomain>
Message-ID: <2F09DC9B-821F-4F5D-8067-DD45BE1A8AD1@syenar.hu>

Well, my vote for default Class(y) compatibility,
and HB_COMPAT_XHB (or a dedicated switch) might
override that if defined.

Brgds,
Viktor

On 2007.04.10., at 11:13, Przemyslaw Czerpak wrote:

> On Sat, 07 Apr 2007, Lorenzo Fiorini wrote:
>> The test below return nil in Harbour and 1 in xHarbour.
>> If it is an expected behaviour?
>
> Yes and it's sth what we should discuss.
> It's one of the most important incompatibilities between xHarbour and
> class(y).
> In xHarbour when you are calling class function you receive an object
> of given class, f.e.:
>
>     ? cls():classname
>
> will show CLS when in class(y) you receive a class object which  
> understands
> message NEW(). This message create an object of given class. F.e.:
>     o:=cls()
>     ? o:classname   // "class CLS" or "class"
>     o1:=o:new()
>     o2:=o:new()
>     ? o1:classname  // "CLS"
>     ? o2:classname  // "CLS"
>
> The class messages and members can be sent (access/assing) only by  
> class
> object. The class object can be accessed from object using CLASS  
> message,
> f.e.;
>     ? o1:class:classname  // "class CLS"
>     ? o1:class == o       // .T.
> It means that class messages and members can have the same names as  
> object
> messages and members because the belongs to differ class.
> It also means that you can sent class messages wihout creating and  
> object,
> f.e.:
>     CLS():CLASSMSG1()
> when in [x]Harbour each call to CLS() creates new instance of class  
> CLS().
> The interface used by class(y) is IMHO very nice and clean.  
> Unfortunately
> neither Harbour nor xHarbour never respect the above and people  
> already
> created code which expects that class function returns an instance  
> of given
> class not a class object. I want to change it and make our class  
> code full
> class(y) compatible and it means that in the future class function  
> will
> return class object so I decided to not replicate xHarbour behavior  
> and
> automatically call constructor in class function.
>
> If you want to reach effect similar to xHarbour then you should change
> in hbclass.ch:
>    return s_oClass:Instance() AS CLASS _CLASS_NAME_ ;;
> to:
>    return s_oClass:Instance():new(...) AS CLASS _CLASS_NAME_ ;;
>
> and:
>    <static> function __HB_CLS_OPT([<FuncName>,] <ClassName>) ;;
> to:
>    <static> function __HB_CLS_OPT([<FuncName>,] <ClassName>)(...) ;;
>
> Maybe we should add some #define to control it.
>
> best regards,
> Przemek
>
>
>> #include "hbclass.ch"
>> procedure main()
>>   local o
>>   o := cls( 1, 2 )
>>   ? o:x
>>   wait
>> return
>> class cls
>>   DATA x
>>   DATA y
>>   METHOD New( x, y ) CONSTRUCTOR
>> end class
>> METHOD New( x, y )
>>   ::x := x
>>   ::y := y
>>   return Self
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Tue Apr 10 05:32:27 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 10 05:32:32 2007
Subject: [Harbour] ChangeLog 2007-04-10 11:30 UTC+0200 Lorenzo Fiorini
Message-ID: <9257026e0704100232q55287b3fj5003ca1b20f15fc4@mail.gmail.com>

2007-04-10 11:30 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
  * harbour/contrib/gd
    * added new directory
	 * harbour wrapper classes for www.libgd.prg graphic library
	 * see README and hbgd.txt for docs

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Tue Apr 10 05:50:35 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 10 05:50:38 2007
Subject: [Harbour] Class constructor call xHarbour vs Harbour
In-Reply-To: <20070410091319.GC27700@localhost.localdomain>
References: <9257026e0704071131s1333eb1ap914a2e82cf338f95@mail.gmail.com>
	<20070410091319.GC27700@localhost.localdomain>
Message-ID: <9257026e0704100250i76e028b8id9ff037c072f5624@mail.gmail.com>

On 4/10/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Yes and it's sth what we should discuss.

I agree that the Classy behaviour is the best.

Is it possible to issue a warning?
Since the code class(x,y) compiles and links it is not easy to find
out the problems.

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Tue Apr 10 05:59:40 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 10 05:59:41 2007
Subject: [Harbour] SF bugtracker#1695073: cphu852.c is buggy
In-Reply-To: <461B43F8.13A5@synel.co.il>
References: <461B43F8.13A5@synel.co.il>
Message-ID: <18B3CE5E-DF07-41C8-8925-2654B6835B44@syenar.hu>

Update:

I could work around the uppcase/lowercase problem, so I'll soon
commit a fully NTXHU852 compatible codepage in addition to the
SIXHU852 compatible one.

Brgds,
Viktor

On 2007.04.10., at 9:59, Chen Kedem wrote:

> Victor,
>
> There is a report about the Hungarian codepage:
> http://sourceforge.net/tracker/index.php? 
> func=detail&aid=1695073&group_id=681&atid=100681
>
> Can you look at it, please?
>
>   Chen.
> ********************************************************************** 
> ************************
> IMPORTANT: The contents of this email and any attachments are  
> confidential. They are intended for the
> named recipient(s) only.
> If you have received this email in error, please notify the system  
> manager or the sender immediately and do
> not disclose the contents to anyone or make copies thereof.
> *** eSafe scanned this email for viruses, vandals, and malicious  
> content. ***
> ********************************************************************** 
> ************************
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From M.Horodyski at pzuzycie.com.pl  Tue Apr 10 06:07:21 2007
From: M.Horodyski at pzuzycie.com.pl (Horodyski Marek (PZUZ))
Date: Tue Apr 10 06:07:59 2007
Subject: [Harbour] RE: Harbour Digest, Vol 6, Issue 20
Message-ID: <503AD832DBBF60469E9F807668A2F6A201909F0F@PINK.zycie.pzu>

>2007-04-10 11:30 UTC+0200 Lorenzo Fiorini 
>(lorenzo.fiorini/at/gmail.com)
>  * harbour/contrib/gd
>    * added new directory
>	 * harbour wrapper classes for www.libgd.prg graphic library
>	 * see README and hbgd.txt for docs

Lorenzo, can you send correct adress for this page ?

Regards,
Marek Horodyski
From lorenzo.fiorini at gmail.com  Tue Apr 10 06:31:31 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 10 06:31:33 2007
Subject: [Harbour] RE: Harbour Digest, Vol 6, Issue 20
In-Reply-To: <503AD832DBBF60469E9F807668A2F6A201909F0F@PINK.zycie.pzu>
References: <503AD832DBBF60469E9F807668A2F6A201909F0F@PINK.zycie.pzu>
Message-ID: <9257026e0704100331w16a31a86ra5d408d25cf96f2@mail.gmail.com>

On 4/10/07, Horodyski Marek (PZUZ) <M.Horodyski@pzuzycie.com.pl> wrote:

> Lorenzo, can you send correct adress for this page ?

Sorry for the typo. I've corrected the ChangeLog.

The correct address is www.libgd.org

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Tue Apr 10 06:40:36 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 06:41:11 2007
Subject: [Harbour] ChangeLog 2007-04-10 11:30 UTC+0200 Lorenzo Fiorini
In-Reply-To: <9257026e0704100232q55287b3fj5003ca1b20f15fc4@mail.gmail.com>
References: <9257026e0704100232q55287b3fj5003ca1b20f15fc4@mail.gmail.com>
Message-ID: <20070410104036.GA22651@localhost.localdomain>

On Tue, 10 Apr 2007, Lorenzo Fiorini wrote:
> 2007-04-10 11:30 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
>  * harbour/contrib/gd
>    * added new directory
> 	 * harbour wrapper classes for www.libgd.prg graphic library
> 	 * see README and hbgd.txt for docs

Thank you very much but please check file rights before commit.
All files in GD library have noe executable attributr and I do
not know how to remove such attribute using CVS command.
BTW does anyone know a method to change file attributes in CVS repository?

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr 10 06:50:14 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 10 06:50:18 2007
Subject: [Harbour] ChangeLog 2007-04-10 11:30 UTC+0200 Lorenzo Fiorini
In-Reply-To: <20070410104036.GA22651@localhost.localdomain>
References: <9257026e0704100232q55287b3fj5003ca1b20f15fc4@mail.gmail.com>
	<20070410104036.GA22651@localhost.localdomain>
Message-ID: <9257026e0704100350u74bc5ca1q14f0ae628c10d471@mail.gmail.com>

On 4/10/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Thank you very much but please check file rights before commit.
> All files in GD library have noe executable attributr and I do
> not know how to remove such attribute using CVS command.
> BTW does anyone know a method to change file attributes in CVS repository?

Sorry it was not the right moment to do that.
Phone keeps on ringing....

Is there anything I can do?

regards,
Lorenzo
From druzus at priv.onet.pl  Tue Apr 10 06:51:09 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 06:51:44 2007
Subject: [Harbour] Re: SF bugtracker#1692268: when in get causes error
In-Reply-To: <461B4313.531E@synel.co.il>
References: <460FB496.389E@synel.co.il> <461B4313.531E@synel.co.il>
Message-ID: <20070410105109.GB22651@localhost.localdomain>

On Tue, 10 Apr 2007, Chen Kedem wrote:
> BUT, according to the ViewVC at SourceForge, the fixed was made for
> beta1 but is NOT contained in beta2. Please look at it, so we don't
> create a sets with missing fixes.

Seems that CVS was not retagged with BETA2 tag after adding the fix.
I do not think that now we have to revert it.
I plan to add some other fixes from devel branch and probably also
some other developers will want to commit something so everything
will be included in BETA3.
BTW. Please remember that "beta1" is branch tag so after checkout with
-r beta1 you always have the recent beta branch code when after beta2
(and future beta3, ...) you have the exact beta version.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr 10 07:12:57 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 10 07:13:00 2007
Subject: [Harbour] ChangeLog 2007-04-10 11:30 UTC+0200 Lorenzo Fiorini
In-Reply-To: <20070410104036.GA22651@localhost.localdomain>
References: <9257026e0704100232q55287b3fj5003ca1b20f15fc4@mail.gmail.com>
	<20070410104036.GA22651@localhost.localdomain>
Message-ID: <9257026e0704100412l4f53197ai3d9decc0ebdf10fb@mail.gmail.com>

On 4/10/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Thank you very much but please check file rights before commit.

What about if I delete all the files and reload them?

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Tue Apr 10 07:38:20 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 10 07:37:20 2007
Subject: [Harbour] CHANGELOG: 2007-04-10 13:31 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77b64$Blat.v2.6.1$bd4d3c10$b944266d00e@127.0.0.1>

2007-04-10 13:31 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/common.mak
   * harbour/source/codepage/Makefile
   * harbour/source/codepage/cphu852.c
   + harbour/source/codepage/cphu852s.c
     ! Default Hungarian 852 codepage made 100% compatible with 
       ntxhu852.obj for CA-Cl*pper 5.x.
     + Added Hungarian 852 codepage 100% compatible with 
       sixhu852.obj for S*ccessWare SIx Driver.
       (this was formerly used as the default Hungarian 852 
       codepage for Harbour, the only change now is the ID and 
       comment cleanup.)

From niki at synel.co.il  Tue Apr 10 07:37:15 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue Apr 10 07:38:12 2007
Subject: [Harbour] ChangeLog 2007-04-10 11:30 UTC+0200 Lorenzo Fiorini
Message-ID: <461B76EB.5F55@synel.co.il>

Also, the binary pictures are not marked as BINARY in CVS, and there
are files and directories with non 8.3 names.

Przemyslaw Czerpak wrote:
> All files in GD library have noe executable attributr and I do
> not know how to remove such attribute using CVS command.
> BTW does anyone know a method to change file attributes in CVS
> repository?

Can it have something to do with the use of cvs edit / cvs release ?


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From alex at belacy.belgorod.su  Tue Apr 10 08:06:36 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Tue Apr 10 08:05:52 2007
Subject: [Harbour] Re: SF bugtracker#1692268: when in get causes error
In-Reply-To: <461B4313.531E@synel.co.il>
References: <460FB496.389E@synel.co.il> <461B4313.531E@synel.co.il>
Message-ID: <11126464645.20070410160636@belacy.belgorod.su>

Tuesday, April 10, 2007, 11:56:03 AM, Chen Kedem <niki@synel.co.il> wrote:

CK> This was fixed in the devel version in ChangeLog 2007-04-01 16:56 UTC+0100 Viktor Szakats
CK> and in the beta version in ChangeLog 2007-04-02 17:00 UTC+0300 Alexander Kresin

CK> BUT, according to the ViewVC at SourceForge, the fixed was made for
CK> beta1 but is NOT contained in beta2. Please look at it, so we don't
CK> create a sets with missing fixes.

 I have confused a bit with all those branches ...

 I had made a checkout with a -r "beta2" switch, then have updated the
 tgetlist.prg and the Changelog. But trying to commit these changes, I
 get:

cvs commit: sticky tag `beta2' for file `harbour/ChangeLog' is not a branch
cvs commit: sticky tag `beta2' for file `harbour/source/rtl/tgetlist.prg' is not a branch
cvs [commit aborted]: correct above errors first!

What can I do to fix this ?

-- 
Regards,
 Alexander
http://kresin.belgorod.su


From druzus at priv.onet.pl  Tue Apr 10 08:21:48 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 08:22:34 2007
Subject: [Harbour] Re: SF bugtracker#1692268: when in get causes error
In-Reply-To: <11126464645.20070410160636@belacy.belgorod.su>
References: <460FB496.389E@synel.co.il> <461B4313.531E@synel.co.il>
	<11126464645.20070410160636@belacy.belgorod.su>
Message-ID: <20070410122148.GA24850@localhost.localdomain>

On Tue, 10 Apr 2007, Alexander S.Kresin wrote:
>  I have confused a bit with all those branches ...
>  I had made a checkout with a -r "beta2" switch, then have updated the
>  tgetlist.prg and the Changelog. But trying to commit these changes, I
>  get:
> cvs commit: sticky tag `beta2' for file `harbour/ChangeLog' is not a branch
> cvs commit: sticky tag `beta2' for file `harbour/source/rtl/tgetlist.prg' is not a branch
> cvs [commit aborted]: correct above errors first!
> What can I do to fix this ?

Sync your cvs using branch tag: "beta1" then add your modifications
commit them and before new release mark CVS as betaN using normal
sitcky tag on beta1 branch so other users can simply use betaN tag
to take the exact version.

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr 10 08:37:08 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 08:37:43 2007
Subject: [Harbour] ChangeLog 2007-04-10 14:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070410123707.GA25110@localhost.localdomain>

2007-04-10 14:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/Makefile
    + added hbregex.h

  * harbour/include/hbclass.ch
    + added support for ENDCLASS LOCK[ED]
    + := <clasname> { <constructorParams,...> }

  * harbour/source/debug/tbrwtext.prg
  * harbour/source/rtl/memoedit.prg
  * harbour/utils/hbdoc/ffile1.prg
  * harbour/utils/hbmake/ffile1.prg
    * changed code with:
         super:<msg>
      to
         ::super:<msg>
      I will want to remove lines with:
         [ ; #translate Super( <SuperClassN> ): => ::<SuperClassN>: ] ;
         [ ; #translate Super( <SuperClass1> ): => ::<SuperClass1>: ] ;
         [ ; #translate Super(): => ::<SuperClass1>: ] ;
         [ ; #translate Super: => ::<SuperClass1>: ] ;
         [ ; #translate ::Super : => ::<SuperClass1>: ]
      from our hbclass.ch (at least the last three ones) because they beaks
      code which uses SUPER identifier

  * harbour/source/rtl/philes.c
    * changed FSEEK() to use hb_fsSeekLarge() for OSes which supports
      large (64bit) files

  * harbour/source/vm/classes.c
    ! updated some comments about function syntax

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr 10 08:43:32 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 10 08:43:37 2007
Subject: [Harbour] xHarbour vs Harbour SWITCH ... END syntax
Message-ID: <9257026e0704100543q5c0c6e14lb0edfdbaf800b8cb@mail.gmail.com>

Can I use PP to avoid using:

SWITCH ...

   ...

      #ifndef __XHARBOUR__
      OTHERWISE
      #else
      DEFAULT
      #endif

I still need xHarbour for some apps and I'd like to keep only a
version of the prgs.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Tue Apr 10 08:51:09 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 08:51:43 2007
Subject: [Harbour] xHarbour vs Harbour SWITCH ... END syntax
In-Reply-To: <9257026e0704100543q5c0c6e14lb0edfdbaf800b8cb@mail.gmail.com>
References: <9257026e0704100543q5c0c6e14lb0edfdbaf800b8cb@mail.gmail.com>
Message-ID: <20070410125109.GA30276@localhost.localdomain>

On Tue, 10 Apr 2007, Lorenzo Fiorini wrote:
> Can I use PP to avoid using:
> SWITCH ...
>   ...
>      #ifndef __XHARBOUR__
>      OTHERWISE
>      #else
>      DEFAULT
>      #endif
> I still need xHarbour for some apps and I'd like to keep only a
> version of the prgs.

Yes. Add to hbcompat.ch:
    #ifndef __XHARBOUR__
       #xcommand DEFAULT => OTHERWISE
    #endif

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr 10 09:01:07 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 10 09:01:14 2007
Subject: [Harbour] xHarbour vs Harbour SWITCH ... END syntax
In-Reply-To: <20070410125109.GA30276@localhost.localdomain>
References: <9257026e0704100543q5c0c6e14lb0edfdbaf800b8cb@mail.gmail.com>
	<20070410125109.GA30276@localhost.localdomain>
Message-ID: <9257026e0704100601j64a87c4hd11e001186127aec@mail.gmail.com>

On 4/10/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Yes. Add to hbcompat.ch:
>     #ifndef __XHARBOUR__
>        #xcommand DEFAULT => OTHERWISE
>     #endif

Many thanks.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Tue Apr 10 09:05:53 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 10 09:06:29 2007
Subject: [Harbour] ChangeLog BETA 2007-04-10 14:45 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
Message-ID: <20070410130553.GA6595@localhost.localdomain>

2007-04-10 14:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbclass.ch
  * harbour/include/hbpp.h
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
  * harbour/source/debug/tbrwtext.prg
  * harbour/source/pp/ppcore.c
  * harbour/source/pp/pplib.c
  * harbour/source/rtl/memoedit.prg
  * harbour/source/rtl/philes.c
  * harbour/source/rtl/valtype.c
  * harbour/source/vm/classes.c
  * harbour/source/vm/extend.c
  * harbour/utils/hbdoc/ffile1.prg
  * harbour/utils/hbmake/ffile1.prg
    * synced with some important fixes and cleanups in devel branch

best regards,
Przemek
From jorgeagiraldo at hotmail.com  Tue Apr 10 12:30:10 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Tue Apr 10 12:30:47 2007
Subject: [Harbour] Some Make_b32 sentences
Message-ID: <BAY136-F142D61907723DFECFEA60DA1580@phx.gbl>

Hi,

I don't know about make but this two sentences stops the process, I 
commented them out and the process ended with success, hope I'm no missing 
anything.

<<<<<<< make_b32.bat
>>>>>>>1.37

The error was:

No se esperaba << en este momento.

<< was not expected right now

Jorge A.

_________________________________________________________________
Las mejores tiendas, los precios mas bajos, entregas en todo el mundo, 
YupiMSN Compras: http://latam.msn.com/compras/

From antonioharbour at gmail.com  Tue Apr 10 14:02:50 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Tue Apr 10 16:02:58 2007
Subject: [Harbour] hbapi
Message-ID: <461bed6d.183da3c0.7363.ffffa4d5@mx.google.com>

Przemek,

Do we have a function to use instead of this ?

&( uParam->item.asString.value )

Thanks,

Regards,

Antonio


From info at fsgiudice.com  Tue Apr 10 18:14:10 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Tue Apr 10 18:15:02 2007
Subject: [Harbour] gdlib fixed and some problems
References: <20070410123707.GA25110@localhost.localdomain>
Message-ID: <00ac01c77bbd$94bf5130$b400a8c0@ASUSFSG>

Hi All,

I have fixed contrib/gd that Lorenzo has uploaded.
But I have found some problems:

1) __objClone() doesn't work as I need. Is there a way to full clone an 
object recursively ?
actually I have fixed this changing __objectClone() function that I wrote in 
gd and it actually copy data values *and* clones complex datas (in 
particular 2 arrays)
but, this causes that I have to change data scoping putting all properties 
as exported, loosing data scope.

2) there is any function that permits this ? in xharbour I have added an 
internal function, __SetClassScope(), that unlocks data scoping for time I 
need to access to hidden vars. This is not correct from a formal point of 
view, but there are some points where there is needs to access to them, 
debugger first of all.

3) I have to ask how do you debug programs in harbour ? I have not found any 
debugging functions, like tracelog, hb_dumpvar or similar. But probably I 
miss something.

4) math.c in libct needs to change name because there is a conflict with 
math.c file in rtl folder. I have changed it in my local copy in ctmath2.c 
as in xharbour.

5) One more, not related to gd, about PUBLISHED data scope in classes.
I have added it to xharbour to have a level more than EXPORTED, but near it.
PUBLISHED means that a var is EXPORTED and it is used only to filter them. I 
have cloned it from Borland Delphi where it is used to filter data that user 
can changes in an IDE, like colors, captions, etc.
Instead a pure EXPORTED data is used at application level where PUBLISHED is 
same of EXPORTED.

if anyone objects I would like to upload these changes for gd. Otherwise I 
will send them to Lorenzo.
my sf account is fsgiudice

best regards

Francesco Saverio Giudice


From niki at synel.co.il  Wed Apr 11 02:31:17 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed Apr 11 02:32:11 2007
Subject: [Harbour] Some Make_b32 sentences
Message-ID: <461C80B5.61FB@synel.co.il>

Jorge,

> I don't know about make but this two sentences stops the process,
> I commented them out and the process ended with success, hope I'm
> no missing anything.
> <<<<<<< make_b32.bat
> >>>>>>>1.37

These are CVS collision marks. Your local copy was modified and was
not the one that CVS was expecting to find. The lines which are marked
are those you probably modified by yourself.

Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From info at fsgiudice.com  Wed Apr 11 03:36:10 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Wed Apr 11 03:36:54 2007
Subject: [Harbour] gdlib fixed and some problems
References: <20070410123707.GA25110@localhost.localdomain>
	<00ac01c77bbd$94bf5130$b400a8c0@ASUSFSG>
Message-ID: <000201c77c0c$13fedcb0$b400a8c0@ASUSFSG>

Hi All,

> But I have found some problems:
>
> 1) __objClone() doesn't work as I need. Is there a way to full clone an 
> object recursively ?
> actually I have fixed this changing __objectClone() function that I wrote 
> in gd and it actually copy data values *and* clones complex datas (in 
> particular 2 arrays)
> but, this causes that I have to change data scoping putting all properties 
> as exported, loosing data scope.
>

Sorry, my fault, it was too late yesterday.
Now I correct rewrote it and cloning (as I need in gd) is fixed.

Regards

Francesco Saverio Giudice
From niki at synel.co.il  Wed Apr 11 03:56:29 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed Apr 11 03:57:25 2007
Subject: [Harbour] Re: SF bugtracker#1672233: GET ... READ skipping Logical
	Vars
References: <460FBA44.C07@synel.co.il> <461B3DCB.1EE2@synel.co.il>
Message-ID: <461C94AD.5340@synel.co.il>

> The logic GET with the PICTURE does not allow to edit the value.

The following fix the problem:

File: source/rtl/tget.prg METHOD IsEditable() Lines: 1108-1109

--Change--
  case ::cType == "L"
     return cChar $ "TFYN"
----------

--Into--
  case ::cType == "L"
     return cChar $ "LY#"
--------

cChar is the alowed Picture value and not the allowed buffer value.


Also, Clipper 5.2e allow "#" as a picture for Logical variables.
It allow T, F, Y, N (and maybe the national Y/N too). To fix it,
you need to modify MATHOD Input() for the CASE cPic == "#" and
I guess do the IsDigit check only for non Logical, and do the same
test as the following CASE cPic == "L"


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From harbour.01 at syenar.hu  Wed Apr 11 04:41:34 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 11 04:41:43 2007
Subject: [Harbour] __HARBOUR__ value
Message-ID: <45792D5A-27DB-4358-899A-E728E9519F71@syenar.hu>

Hi all,

__HARBOUR__ has the value 257 now. (1 * 256 + 1 = 1.01)

Is this intentional, or could we come up with a more intuitive
value here? (like for example 101 = 1 * 100 + 1)

Brgds,
Viktor

From druzus at priv.onet.pl  Wed Apr 11 05:42:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 11 05:43:11 2007
Subject: [Harbour] __HARBOUR__ value
In-Reply-To: <45792D5A-27DB-4358-899A-E728E9519F71@syenar.hu>
References: <45792D5A-27DB-4358-899A-E728E9519F71@syenar.hu>
Message-ID: <20070411094235.GA30724@localhost.localdomain>

On Wed, 11 Apr 2007, Szak?ts Viktor wrote:
> Hi all,
> __HARBOUR__ has the value 257 now. (1 * 256 + 1 = 1.01)
> Is this intentional, or could we come up with a more intuitive
> value here? (like for example 101 = 1 * 100 + 1)

It is 101 but in hexadecimal representation: 257 = 0x101 ;-)
Most compilers I know uses hexadecimal representation but we can
change it of course.

best regards,
Przemek
From druzus at priv.onet.pl  Wed Apr 11 06:23:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 11 06:24:08 2007
Subject: [Harbour] gdlib fixed and some problems
In-Reply-To: <00ac01c77bbd$94bf5130$b400a8c0@ASUSFSG>
References: <20070410123707.GA25110@localhost.localdomain>
	<00ac01c77bbd$94bf5130$b400a8c0@ASUSFSG>
Message-ID: <20070411102332.GB30724@localhost.localdomain>

On Wed, 11 Apr 2007, Francesco Saverio Giudice wrote:
> 1) __objClone() doesn't work as I need. Is there a way to full clone an 
> object recursively ?

IMHO it works like in xHarbour with the exception to class constructors
which are executed in xHarbour just after cloning. Do you use them?

> actually I have fixed this changing __objectClone() function that I wrote 
> in gd and it actually copy data values *and* clones complex datas (in 
> particular 2 arrays)
> but, this causes that I have to change data scoping putting all properties 
> as exported, loosing data scope.

Sorry I do not know what exactly you want to do.
In general cloning object is not sth what we can implement ourself as
HVM mechanism. We can only give programmer some helper functions.
Only class programmer can answer which members should be cloned,
which shared between object and which one needs some special operations,
f.e.: duplicate file handle with dup() or sth like that. The __objClone()
function is only helper function which allows to implement cloning object
body but not object members which should be cloned by programmer. I plan
to add special clone message to class definition so programmer will be able
to define his own actions when object is cloned. In some cases he may need
simple recursive object cloning like with arrays and in some others some
more complicated actions. But now neither Harbour nor xHarbour have such
functionality though in xHarbour some things can be implemented with
class constructors.

> 2) there is any function that permits this ? in xharbour I have added an 
> internal function, __SetClassScope(), that unlocks data scoping for time I 
> need to access to hidden vars. This is not correct from a formal point of 
> view, but there are some points where there is needs to access to them, 
> debugger first of all.

Harbour does not have such function. I planed to add Class(y) compatible
   CsyEnforce( lChkScope, lChkRdOnly )
in the future but I'm not a fun of such extensions. Please note that
now Harbour has _real_ scoping which also control which object members
or method you can access/assign/execute. Global modification of scope
cannot be used for debugging because it may also change used members
and method. Please compile tests/clsnv.prg, carefully check the results,
compare it with xHarbour and think what will happen without working
scoping (f.e. you will execute function like __SetClassScope(.f.))

> 3) I have to ask how do you debug programs in harbour ? I have not found 
> any debugging functions, like tracelog, hb_dumpvar or similar. But probably 
> I miss something.

There are some debug and tracelog functions similar to xHarbour but probably
with a little bit different names and functionality. Sorry but I cannot help
you here I very seldom use sth like above and usually simple [f]printf()
is all what I need and I do not even know xHarbour functions.
AFAIR you can easy compile xHarbour TraceLog() function with Harbour.

> 4) math.c in libct needs to change name because there is a conflict with 
> math.c file in rtl folder. I have changed it in my local copy in ctmath2.c 
> as in xharbour.

It's a problem only for non GNU make systems but I'll change it.

> 5) One more, not related to gd, about PUBLISHED data scope in classes.
> I have added it to xharbour to have a level more than EXPORTED, but near it.
> PUBLISHED means that a var is EXPORTED and it is used only to filter them. 
> I have cloned it from Borland Delphi where it is used to filter data that 
> user can changes in an IDE, like colors, captions, etc.
> Instead a pure EXPORTED data is used at application level where PUBLISHED 
> is same of EXPORTED.

So if I understand you well, In Harbour it's the same as EXPORTED with
PERSISTENT/PROPERTY attribute:
   #define HB_OO_CLSTP_PUBLISHED  (HB_OO_CLSTP_EXPORTED + HB_OO_CLSTP_PERSIST)

> if anyone objects I would like to upload these changes for gd. Otherwise I 
> will send them to Lorenzo.
> my sf account is fsgiudice

I hope Phil or Alexander will give you developer access to Harbour CVS ASAP.

best regards,
Przemek
From druzus at priv.onet.pl  Wed Apr 11 06:30:44 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 11 06:31:18 2007
Subject: [Harbour] hbapi
In-Reply-To: <461bed6d.183da3c0.7363.ffffa4d5@mx.google.com>
References: <461bed6d.183da3c0.7363.ffffa4d5@mx.google.com>
Message-ID: <20070411103044.GA30952@localhost.localdomain>

On Tue, 10 Apr 2007, Antonio Linares wrote:
> Przemek,
> Do we have a function to use instead of this ?
> &( uParam->item.asString.value )

Changing item internals by 3-rd party code is forbidden.
If you will change string address inside HB_ITEM pointed
by uParam using above address you may cause internal HVM
structure corruption or even global memory manger structure
corruption so we will never have functions which allow to
make sth like above documented as legal public API.
Why do you need it? Maybe I can help you with some
alternative solution.

best regards,
Przemek
From harbour.01 at syenar.hu  Wed Apr 11 06:32:45 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 11 06:32:45 2007
Subject: [Harbour] __HARBOUR__ value
In-Reply-To: <20070411094235.GA30724@localhost.localdomain>
References: <45792D5A-27DB-4358-899A-E728E9519F71@syenar.hu>
	<20070411094235.GA30724@localhost.localdomain>
Message-ID: <F26FE948-FEE7-4C28-8C9A-B1DD3A0CD79F@syenar.hu>

On 2007.04.11., at 11:42, Przemyslaw Czerpak wrote:

> On Wed, 11 Apr 2007, Szak?ts Viktor wrote:
>> Hi all,
>> __HARBOUR__ has the value 257 now. (1 * 256 + 1 = 1.01)
>> Is this intentional, or could we come up with a more intuitive
>> value here? (like for example 101 = 1 * 100 + 1)
>
> It is 101 but in hexadecimal representation: 257 = 0x101 ;-)
> Most compilers I know uses hexadecimal representation but we can
> change it of course.

OK, I see, let's stick with this then.

Can I use hex numbers in #if PP statements?

Like: #if __HARBOUR__ > 0x101

Brgds,
Viktor



From antonioharbour at gmail.com  Wed Apr 11 06:34:45 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Wed Apr 11 06:34:52 2007
Subject: [Harbour] hbapi
In-Reply-To: <20070411103044.GA30952@localhost.localdomain>
References: <461bed6d.183da3c0.7363.ffffa4d5@mx.google.com>
	<20070411103044.GA30952@localhost.localdomain>
Message-ID: <55134B31-73AE-4DB2-8ED9-D2926394ACCF@gmail.com>

Przemek,

i.e. its used by OLE code.

Anyhow I already found a solution, Thanks,

regards,

Antonio

From druzus at priv.onet.pl  Wed Apr 11 06:45:46 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 11 06:46:20 2007
Subject: [Harbour] __HARBOUR__ value
In-Reply-To: <F26FE948-FEE7-4C28-8C9A-B1DD3A0CD79F@syenar.hu>
References: <45792D5A-27DB-4358-899A-E728E9519F71@syenar.hu>
	<20070411094235.GA30724@localhost.localdomain>
	<F26FE948-FEE7-4C28-8C9A-B1DD3A0CD79F@syenar.hu>
Message-ID: <20070411104546.GA31154@localhost.localdomain>

On Wed, 11 Apr 2007, Szak?ts Viktor wrote:
> Can I use hex numbers in #if PP statements?
> Like: #if __HARBOUR__ > 0x101

Yes, you can. You can even use math and logical expressions and also
pseudo function defined() in similar to C way, f.e.:

    #if defined( __HARBOUR__ ) .and. !defined( __XHARBOUR__ )
       #if __HARBOUR__ >= 0x101 .and. __HARBOUR__ <= 0x102
          #stdout It is Harbour 1.1 or 1.2
       #else
          #error You need Harbour 1.1 or 1.2 to compile this code
       #endif
    #else
       #error Unrecognize compiler
    #endif

best regards,
Przemek
From harbour.01 at syenar.hu  Wed Apr 11 07:08:13 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 11 07:08:16 2007
Subject: [Harbour] __HARBOUR__ value
In-Reply-To: <20070411104546.GA31154@localhost.localdomain>
References: <45792D5A-27DB-4358-899A-E728E9519F71@syenar.hu>
	<20070411094235.GA30724@localhost.localdomain>
	<F26FE948-FEE7-4C28-8C9A-B1DD3A0CD79F@syenar.hu>
	<20070411104546.GA31154@localhost.localdomain>
Message-ID: <360620C2-A39F-4613-ADB7-3B73C5F8C4BB@syenar.hu>

Very good, thanks Przemek.

Brgds,
Viktor

On 2007.04.11., at 12:45, Przemyslaw Czerpak wrote:

> On Wed, 11 Apr 2007, Szak?ts Viktor wrote:
>> Can I use hex numbers in #if PP statements?
>> Like: #if __HARBOUR__ > 0x101
>
> Yes, you can. You can even use math and logical expressions and also
> pseudo function defined() in similar to C way, f.e.:
>
>     #if defined( __HARBOUR__ ) .and. !defined( __XHARBOUR__ )
>        #if __HARBOUR__ >= 0x101 .and. __HARBOUR__ <= 0x102
>           #stdout It is Harbour 1.1 or 1.2
>        #else
>           #error You need Harbour 1.1 or 1.2 to compile this code
>        #endif
>     #else
>        #error Unrecognize compiler
>     #endif
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From rao at obuhov.net  Wed Apr 11 08:05:50 2007
From: rao at obuhov.net (rao)
Date: Wed Apr 11 08:08:53 2007
Subject: [Harbour] Error while compiling nf.lib
Message-ID: <461CCF1E.5040001@obuhov.net>

    ..\..\bin\b32\harbour.exe -i..\..\include -n -q0 -w2 -es2 -gc0    
mouse1.prg   -o..\..\obj\b32\mouse1.c

mouse1.prg(749) Warning W0003  Variable: 'NPAGE' declared but not used 
in function: 'FT_MGETPAGE(733)'

No code generated.

** error 1 ** deleting ..\..\obj\b32\mouse1.c

Regards,
Alexey Myronenko
From e.m.giordano at emagsoftware.it  Wed Apr 11 08:48:05 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 11 08:48:41 2007
Subject: [Harbour] Error while compiling nf.lib
References: <461CCF1E.5040001@obuhov.net>
Message-ID: <005b01c77c37$a65321e0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "rao" <rao@obuhov.net>
A: <harbour@harbour-project.org>
Data invio: mercoledi 11 aprile 2007 14.05
Oggetto: [Harbour] Error while compiling nf.lib


>    ..\..\bin\b32\harbour.exe -i..\..\include -n -q0 -w2 -es2 -gc0    
> mouse1.prg   -o..\..\obj\b32\mouse1.c
> 
> mouse1.prg(749) Warning W0003  Variable: 'NPAGE' declared but not used 
> in function: 'FT_MGETPAGE(733)'
> 
> No code generated.
> 
> ** error 1 ** deleting ..\..\obj\b32\mouse1.c

This is a warning, not an error.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic
From jorgeagiraldo at hotmail.com  Wed Apr 11 08:50:56 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Wed Apr 11 08:51:33 2007
Subject: [Harbour] Some Make_b32 sentences
In-Reply-To: <461C80B5.61FB@synel.co.il>
Message-ID: <BAY136-F1442352CBDD46A324232C9A15F0@phx.gbl>

Hi Chen,

I deleted the files and made an update, this solved the problem, thank you.

Jorge A.


>From: Chen Kedem <niki@synel.co.il>
>Reply-To: "Harbour Project Main Developer List." 
><harbour@harbour-project.org>
>To: harbour@harbour-project.org
>Subject: [Harbour] Some Make_b32 sentences
>Date: Wed, 11 Apr 2007 09:31:17 +0300
>
>Jorge,
>
> > I don't know about make but this two sentences stops the process,
> > I commented them out and the process ended with success, hope I'm
> > no missing anything.
> > <<<<<<< make_b32.bat
> > >>>>>>>1.37
>
>These are CVS collision marks. Your local copy was modified and was
>not the one that CVS was expecting to find. The lines which are marked
>are those you probably modified by yourself.
>
>Chen.
>**********************************************************************************************
>IMPORTANT: The contents of this email and any attachments are confidential. 
>They are intended for the
>named recipient(s) only.
>If you have received this email in error, please notify the system manager 
>or the sender immediately and do
>not disclose the contents to anyone or make copies thereof.
>*** eSafe scanned this email for viruses, vandals, and malicious content. 
>***
>**********************************************************************************************
>
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour

_________________________________________________________________
Charla con tus amigos en l?nea mediante MSN Messenger: 
http://messenger.latam.msn.com/

From harbour.01 at syenar.hu  Wed Apr 11 09:27:19 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 11 09:26:19 2007
Subject: [Harbour] CHANGELOG: 2007-04-11 15:25 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77c3d$Blat.v2.6.1$20e3d580$b1cadacd9ee@127.0.0.1>

2007-04-11 15:25 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/contrib/libnf/mouse1.prg
     ! Fixed unused variable.

   * harbour/source/compiler/genc.c
     % Compact compiler output (-gc0) made even more compact
       (~20% size reduction).

From druzus at priv.onet.pl  Wed Apr 11 16:01:04 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 11 16:01:45 2007
Subject: [Harbour] ChangeLog 2007-04-11 22:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070411200104.GA1116@localhost.localdomain>

2007-04-11 22:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/harbour.yyc
    ! fixed some possible false warning messages

  * harbour/include/hboo.ch
  * harbour/source/vm/classes.c
    + added support for HB_OO_MSG_PROPERTY and HB_OO_MSG_CLASSPROPERTY
      to make some xHarbour users happy ;-)

  * harbour/common.mak
  * harbour/harbour.spec
  * harbour/include/hbcompdf.h
  * harbour/source/compiler/Makefile
  + harbour/source/compiler/hbcmplib.c
    + added HB_COMPILE() function - it accepts exactly the same parameters
      as harbour compiler and makes the same job :-)

  * harbour/utils/hbrun/Makefile
  * harbour/utils/hbrun/hbrun.prg
    + added support for compilation and direct execution of .prg files
      Now hbrun can accept as first parameter .hrb or .prg file and if
      it's .prg file it's compiled and then executed just like .hrb one.
      In *nixes if you copy compiled hbrun to /usr/bin directory then
      you can add to your .prg files as first line:
         #!/usr/bin/hbrun
      and then after setting executable attribute you can directly
      execute them, f.e.:
         ./test.prg
      If you are using Linux then you can also chose default gt driver
      by dding to above line: //gt<name>
      F.e.
         #!/usr/bin/hbrun //gtstd


best regards,
Przemek
From e.m.giordano at emagsoftware.it  Wed Apr 11 16:07:10 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 11 16:07:48 2007
Subject: [Harbour] Error in latest CVS
Message-ID: <009c01c77c74$fd241780$0100a8c0@emag>

Error: Unresolved external '_HB_FUN_HB_COMPILE' referenced from C:\HARBOUR 
CVS\HARBOUR\OBJ\B32\HBRUN.OBJ

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From druzus at priv.onet.pl  Wed Apr 11 16:19:50 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 11 16:20:26 2007
Subject: [Harbour] Error in latest CVS
In-Reply-To: <009c01c77c74$fd241780$0100a8c0@emag>
References: <009c01c77c74$fd241780$0100a8c0@emag>
Message-ID: <20070411201950.GA1800@localhost.localdomain>

On Wed, 11 Apr 2007, Enrico Maria Giordano wrote:
> Error: Unresolved external '_HB_FUN_HB_COMPILE' referenced from C:\HARBOUR 
> CVS\HARBOUR\OBJ\B32\HBRUN.OBJ

add COMPILER.LIB to linked library list in common.mak
I'll commit such modification in a while - thanks for the information.

best regards,
Przemek
From druzus at priv.onet.pl  Wed Apr 11 16:22:41 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 11 16:23:15 2007
Subject: [Harbour] ChangeLog 2007-04-11 22:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070411202241.GB1800@localhost.localdomain>

2007-04-11 22:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
    + added compiler.lib to linked libraries

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Wed Apr 11 17:55:10 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 11 17:55:44 2007
Subject: [Harbour] ChangeLog 2007-04-11 22:20 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070411202241.GB1800@localhost.localdomain>
Message-ID: <00b001c77c84$1380e490$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoledi 11 aprile 2007 22.22
Oggetto: [Harbour] ChangeLog 2007-04-11 22:20 UTC+0200 Przemyslaw 
Czerpak(druzus/at/priv.onet.pl)


> 2007-04-11 22:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>  * harbour/common.mak
>    + added compiler.lib to linked libraries

Thank you, it's ok now.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From philb at philb.us  Wed Apr 11 19:36:14 2007
From: philb at philb.us (Phil Barnett)
Date: Wed Apr 11 19:36:17 2007
Subject: [Harbour] ChangeLog 2007-04-11 22:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070411200104.GA1116@localhost.localdomain>
References: <20070411200104.GA1116@localhost.localdomain>
Message-ID: <200704111936.14526.philb@philb.us>

On Wednesday 11 April 2007 16:01, Przemyslaw Czerpak wrote:
> * harbour/utils/hbrun/hbrun.prg
> ? ? + added support for compilation and direct execution of .prg files
> ? ? ? Now hbrun can accept as first parameter .hrb or .prg file and if
> ? ? ? it's .prg file it's compiled and then executed just like .hrb one.
> ? ? ? In *nixes if you copy compiled hbrun to /usr/bin directory then
> ? ? ? you can add to your .prg files as first line:
> ? ? ? ? ?#!/usr/bin/hbrun
> ? ? ? and then after setting executable attribute you can directly
> ? ? ? execute them, f.e.:
> ? ? ? ? ?./test.prg
> ? ? ? If you are using Linux then you can also chose default gt driver
> ? ? ? by dding to above line: //gt<name>
> ? ? ? F.e.
> ? ? ? ? ?#!/usr/bin/hbrun //gtstd

Very cool! Thanks a lot for that one!!!

-- 
Ballmer is basically saying: We know there's a problem but we're not going to 
tell you what it is because we want to ambush you in the future. 
http://blogs.zdnet.com/hardware/?p=154
From philb at philb.us  Wed Apr 11 21:56:25 2007
From: philb at philb.us (Phil Barnett)
Date: Wed Apr 11 21:56:28 2007
Subject: [Harbour] gdlib fixed and some problems
In-Reply-To: <20070411102332.GB30724@localhost.localdomain>
References: <20070410123707.GA25110@localhost.localdomain>
	<00ac01c77bbd$94bf5130$b400a8c0@ASUSFSG>
	<20070411102332.GB30724@localhost.localdomain>
Message-ID: <200704112156.25463.philb@philb.us>

On Wednesday 11 April 2007 06:23, Przemyslaw Czerpak wrote:
> > if anyone objects I would like to upload these changes for gd. Otherwise
> > I will send them to Lorenzo.
> > my sf account is fsgiudice
>
> I hope Phil or Alexander will give you developer access to Harbour CVS
> ASAP.

Done.

-- 
Ballmer is basically saying: We know there's a problem but we're not going to 
tell you what it is because we want to ambush you in the future. 
http://blogs.zdnet.com/hardware/?p=154
From lorenzo.fiorini at gmail.com  Thu Apr 12 04:02:39 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 12 04:02:45 2007
Subject: [Harbour] get error
Message-ID: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>

The test below works in Clipper C53B and xHarbour but in Harbour gives
a segfault due to recursive calls.

I've analyzed it and I've found that the "problem" is Assign() used in:

   METHOD UpdateBuffer() INLINE  ::buffer := ::PutMask( ),
iif(::lEdit, ::Assign(),), ::Display(), Self

Just for comparison in xHarbour the code is:

METHOD UpdateBuffer() INLINE  if( ::hasfocus, ( ::buffer := ::PutMask(
::VarGet() ), ::Display() ), ), Self

Any comment?

regards,
Lorenzo Fiorini

// testget1.prg

STATIC oGet

PROCEDURE Main()

   LOCAL   GetList := {}, nVar := 0

   CLS

   @ 10,10 SAY "nVar            :" GET nVar PICTURE "@ZE 999,999.99"

   oGet := atail( GetList )

   oGet:block := { |u| iif( empty( u ), nVar, ( nVar := u,
oGet:UpdateBuffer() ) ) }

   READ

   wait

   alert( str( nVar ) )

RETURN

// end of testget1.prg
From niki at synel.co.il  Thu Apr 12 04:16:42 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu Apr 12 04:17:49 2007
Subject: [Harbour] ChangeLog: 2007-04-12 11:14 UTC+0300 Chen Kedem
Message-ID: <461DEAEA.28C0@synel.co.il>

2007-04-12 11:14 UTC+0300 Chen Kedem <niki@actcom.co.il>
  * source/rtl/tget.prg
    ! Fix bug#1672233 - Picture masks for Logical GET variables.

  * source/lang/msgtrdos.c
  * source/lang/msgtrwin.c
    ! Change ID from TR to TR857 and TRWIN.

  * doc/en/lang.txt
    + Update language and codepage lists with the latests additions.

  * doc/dirstruc.txt
    + Add short description to the newly added directories.


I would be happy if some one could look in tget.prg to check that
I didn't break anything.


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From lorenzo.fiorini at gmail.com  Thu Apr 12 05:46:05 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 12 05:46:07 2007
Subject: [Harbour] xHarbour vs Harbour debugger
Message-ID: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>

I need to use xHarbour's tbrowse and teditor but they break Harbour debugger.
Also I need to apply changes to debugger code to avoid conflicts with
custom made getsys.prg.

As a first quick try I've tried to copy source/debug from xHarbour and
after cleaning warnings I got the errors below.

Are there plans to implement those funcs into Harbour VM?

Is there anybody else working on debugger to sync efforts?

regards,
Lorenzo Fiorini

../../debugger.prg: In function 'HB_FUN_HB_INLINE_001':
../../debugger.prg:158: error: 'hb_vm_pFunDbgEntry' undeclared (first
use in this function)
../../debugger.prg:158: error: (Each undeclared identifier is reported only once
../../debugger.prg:158: error: for each function it appears in.)
../../debugger.prg:158: error: 'hb_dbgEntry' undeclared (first use in
this function)
../../debugger.prg: In function 'HB_FUN_HB_INLINE_002':
../../debugger.prg:174: warning: implicit declaration of function 'hb_dbgSetGo'
...
../../debugger.prg: In function 'HB_FUN_HB_INLINE_019':
../../debugger.prg:3154: warning: implicit declaration of function
'hb_dbgSetWatch'
From harbour.01 at syenar.hu  Thu Apr 12 05:57:46 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr 12 05:57:45 2007
Subject: [Harbour] xHarbour vs Harbour debugger
In-Reply-To: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>
References: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>
Message-ID: <7FF37C6E-726F-4E3F-99E6-F69C072F1A10@syenar.hu>

Hi Lorenzo,

> I need to use xHarbour's tbrowse and teditor but they break Harbour  
> debugger.

This sounds strange, could you give some details?
(I understand both files are pure .prg code, so they are not
supposed to break the Harbour debugger)

> Also I need to apply changes to debugger code to avoid conflicts with
> custom made getsys.prg.

Maybe we can make some simple modifications on our debugger
to avoid such name conflicts, in case this is a namespace violation
issue.

Could you give some details here too?

Brgds,
Viktor

>
> As a first quick try I've tried to copy source/debug from xHarbour and
> after cleaning warnings I got the errors below.
>
> Are there plans to implement those funcs into Harbour VM?
>
> Is there anybody else working on debugger to sync efforts?
>
> regards,
> Lorenzo Fiorini
>
> ../../debugger.prg: In function 'HB_FUN_HB_INLINE_001':
> ../../debugger.prg:158: error: 'hb_vm_pFunDbgEntry' undeclared (first
> use in this function)
> ../../debugger.prg:158: error: (Each undeclared identifier is  
> reported only once
> ../../debugger.prg:158: error: for each function it appears in.)
> ../../debugger.prg:158: error: 'hb_dbgEntry' undeclared (first use in
> this function)
> ../../debugger.prg: In function 'HB_FUN_HB_INLINE_002':
> ../../debugger.prg:174: warning: implicit declaration of function  
> 'hb_dbgSetGo'
> ...
> ../../debugger.prg: In function 'HB_FUN_HB_INLINE_019':
> ../../debugger.prg:3154: warning: implicit declaration of function
> 'hb_dbgSetWatch'
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Thu Apr 12 06:49:05 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 12 06:49:08 2007
Subject: [Harbour] xHarbour vs Harbour debugger
In-Reply-To: <7FF37C6E-726F-4E3F-99E6-F69C072F1A10@syenar.hu>
References: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>
	<7FF37C6E-726F-4E3F-99E6-F69C072F1A10@syenar.hu>
Message-ID: <9257026e0704120349u63850b47u6412b3bb74ac826@mail.gmail.com>

On 4/12/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> This sounds strange, could you give some details?
> (I understand both files are pure .prg code, so they are not
> supposed to break the Harbour debugger)

When I invoke debugger i get:

Program received signal SIGSEGV, Segmentation fault.
0x004860a2 in realloc () from /lib/libc.so.6
(gdb) bt
#0  0x004860a2 in realloc () from /lib/libc.so.6
#1  0x08070838 in hb_xrealloc ()
#2  0x0806e9f2 in hb_stackIncrease ()
#3  0x080844a5 in hb_vmExecute ()
#4  0x080b1bbb in HB_FUN_HBEDITOR_MOVECURSOR ()
#5  0x080853e8 in hb_vmSend ()
#6  0x08081584 in hb_vmExecute ()
#7  0x080649ab in HB_FUN_TBRWTEXT_GOTOP ()
#8

as I said this is not an Harbour fault. I heavily use memoedit and
tbrowse in my apps and it took me years to me and many others to "fix"
and extend xHarbour's ones.
I respect the choice of the project to be C52e compatible but I can't
remove features from apps.

Basically the differences are:

- meomoedit/teditor: use of an extended inkey.ch to distinguish
between K_CTRL_C and PgDn and K_SH_LEFT to K_LEFT and so on. This
allow to have copy/cut/paste using Ctrl+C/Ctrl+X/Ctrl+V, text
selection using Shift+Arrows or Ctrl+A

- tbrowse: use a tdatacache object to store values. This avoid reread
the datas simply moving left/right ( as C53B does ). Without it
filtered tbrowses are really slow.

> Maybe we can make some simple modifications on our debugger
> to avoid such name conflicts, in case this is a namespace violation
> issue.

I can easily avoid name conflicts using
-Wl,--allow-multiple-definition but this doesn't solve the
fact that debugger got "messed" by tracing its code.
So I've added HB_NO_READDBG to exclude getsys.prg (READs) from debugger code.

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Thu Apr 12 07:56:43 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 12 07:57:19 2007
Subject: [Harbour] ChangeLog 2007-04-12 13:55 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070412115643.GA27037@localhost.localdomain>

2007-04-12 13:55 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbpp.h
  * harbour/include/hbcomp.h
  * harbour/source/compiler/hbgenerr.c
  * harbour/source/compiler/ppcomp.c
  * harbour/source/pp/ppcore.c
  * harbour/source/pp/pplib.c
  * harbour/utils/hbpp/hbpp.c
  * harbour/utils/hbpp/hbppcore.c
  * harbour/utils/hbpp/hbppdef.h
    * changed error and warning messages to const char *

  * harbour/source/compiler/genhrb.c
    * rewritten to work on memory buffers and with new compiler code

  * harbour/include/hbcomp.h
  * harbour/include/hbcompdf.h
  * harbour/source/compiler/hbmain.c
  * harbour/source/main/harbour.c
    + added LANG_PORT_OBJ_BUF which allow to generate .hrb files into
      memory buffers

  * harbour/source/compiler/hbcmplib.c
    + added HB_COMPILEBUF() functions which returns compiled .hrb file
      as string item

  * harbour/source/vm/runner.c
    + added support for executing compiled .hrb files stored in string
      items in __HRBRUN() function - it works just like in __HRBLOAD()

  * harbour/harbour.spec
  * harbour/utils/hbrun/hbrun.prg
    + added default include directories to hbrun
    * use HB_COMPILEBUF() instead of HB_COMPILE() to eliminate temporary
      files

best regards,
Przemek
From druzus at priv.onet.pl  Thu Apr 12 08:08:11 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 12 08:08:45 2007
Subject: [Harbour] gdlib fixed and some problems
In-Reply-To: <200704112156.25463.philb@philb.us>
References: <20070410123707.GA25110@localhost.localdomain>
	<00ac01c77bbd$94bf5130$b400a8c0@ASUSFSG>
	<20070411102332.GB30724@localhost.localdomain>
	<200704112156.25463.philb@philb.us>
Message-ID: <20070412120811.GA27341@localhost.localdomain>

On Wed, 11 Apr 2007, Phil Barnett wrote:
> > > if anyone objects I would like to upload these changes for gd. Otherwise
> > > I will send them to Lorenzo.
> > > my sf account is fsgiudice
> > I hope Phil or Alexander will give you developer access to Harbour CVS
> > ASAP.
> Done.

Thank you.

best regards,
Przemek
From druzus at priv.onet.pl  Thu Apr 12 08:18:07 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 12 08:18:42 2007
Subject: [Harbour] ChangeLog 2007-04-11 22:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <200704111936.14526.philb@philb.us>
References: <20070411200104.GA1116@localhost.localdomain>
	<200704111936.14526.philb@philb.us>
Message-ID: <20070412121807.GB27341@localhost.localdomain>

On Wed, 11 Apr 2007, Phil Barnett wrote:
> > * harbour/utils/hbrun/hbrun.prg
> > ? ? + added support for compilation and direct execution of .prg files
> > ? ? ? Now hbrun can accept as first parameter .hrb or .prg file and if
> > ? ? ? it's .prg file it's compiled and then executed just like .hrb one.
> > ? ? ? In *nixes if you copy compiled hbrun to /usr/bin directory then
> > ? ? ? you can add to your .prg files as first line:
> > ? ? ? ? ?#!/usr/bin/hbrun
> > ? ? ? and then after setting executable attribute you can directly
> > ? ? ? execute them, f.e.:
> > ? ? ? ? ?./test.prg
> > ? ? ? If you are using Linux then you can also chose default gt driver
> > ? ? ? by dding to above line: //gt<name>
> > ? ? ? F.e.
> > ? ? ? ? ?#!/usr/bin/hbrun //gtstd
> Very cool! Thanks a lot for that one!!!

Hope you will find it useful but real work was done in last months and
now I'm only "showing" new features ;-)

BTW if you do not build Harbour using make_rpm.sh or make_tgz.sh then
I suggest to rebuild hbrun linked with harbour.so (shared library), f.e.
using hbmk script:
    hbmk -n -w -es2 -gtstd hbrun.prg
In such binaries you will have all GT drives accessible so you can later
chose the best one in you .prg scripts.

best regards,
Przemek
From druzus at priv.onet.pl  Thu Apr 12 08:28:46 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 12 08:29:23 2007
Subject: [Harbour] xHarbour vs Harbour debugger
In-Reply-To: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>
References: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>
Message-ID: <20070412122846.GC27341@localhost.localdomain>

On Thu, 12 Apr 2007, Lorenzo Fiorini wrote:
> I need to use xHarbour's tbrowse and teditor but they break Harbour 
> debugger.
> Also I need to apply changes to debugger code to avoid conflicts with
> custom made getsys.prg.

Debugger is the weakest thing in Harbour. Phil made fantastic job
in xHarbour working on debugger and we should borrow this code.
But I cannot work myself on everything and we will need someone
who can port xHarbour debugger to Harbour. If you want then I can
make necessary modifications in compiler and HVM but someone else will
have to work on core debugger library.
I do not know if Ryszard is still interested or if he has spare time
for it. Probably not so maybe some other developers can do that?

> As a first quick try I've tried to copy source/debug from xHarbour and
> after cleaning warnings I got the errors below.
> Are there plans to implement those funcs into Harbour VM?

As I said I can make HVM and compiler modifications but core debugger
library also will have to be updated and I do not want to start
modifications which will break current debugger without anyone who
will work on new debugger code.

> Is there anybody else working on debugger to sync efforts?

???

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Thu Apr 12 08:51:34 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 12 08:51:43 2007
Subject: [Harbour] xHarbour vs Harbour debugger
In-Reply-To: <20070412122846.GC27341@localhost.localdomain>
References: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>
	<20070412122846.GC27341@localhost.localdomain>
Message-ID: <9257026e0704120551g2886fa90x720dea602646ff42@mail.gmail.com>

On 4/12/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> As I said I can make HVM and compiler modifications but core debugger
> library also will have to be updated and I do not want to start
> modifications which will break current debugger without anyone who
> will work on new debugger code.

If you mean porting source/debug/*.prg I'll do my best.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Thu Apr 12 09:02:59 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 12 09:03:02 2007
Subject: [Harbour] ChangeLog 2007-04-11 22:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070412121807.GB27341@localhost.localdomain>
References: <20070411200104.GA1116@localhost.localdomain>
	<200704111936.14526.philb@philb.us>
	<20070412121807.GB27341@localhost.localdomain>
Message-ID: <9257026e0704120602y7b144335j56fb5d6342295750@mail.gmail.com>

On 4/12/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> BTW if you do not build Harbour using make_rpm.sh or make_tgz.sh then
> I suggest to rebuild hbrun linked with harbour.so (shared library), f.e.
> using hbmk script:
>     hbmk -n -w -es2 -gtstd hbrun.prg
> In such binaries you will have all GT drives accessible so you can later
> chose the best one in you .prg scripts.

Really wonderful.
I'm running tests using simply "hbrun test.prg".
The only thing that is needed is to define locals, publics and privates var.
Many thanks.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Thu Apr 12 11:08:22 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 12 11:08:25 2007
Subject: [Harbour] GETENV(0) WARNING! Memory allocated but not released: 5
	bytes (1 blocks)
Message-ID: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>

Looking in my error_log I've a lot of:

Total memory allocated: 417249 bytes (3642 blocks)
WARNING! Memory allocated but not released: 5 bytes (1 blocks)
fm.c:622: HB_TR_ERROR Block 1 (size 1) GETENV(0), "00"

Clearly a simple ? getenv( "name" ) works as expected.

Any idea?

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Thu Apr 12 12:51:49 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 12 12:52:26 2007
Subject: [Harbour] GETENV(0) WARNING! Memory allocated but not released: 5
	bytes (1 blocks)
In-Reply-To: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>
References: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>
Message-ID: <20070412165149.GA1085@localhost.localdomain>

On Thu, 12 Apr 2007, Lorenzo Fiorini wrote:
> Looking in my error_log I've a lot of:
> Total memory allocated: 417249 bytes (3642 blocks)
> WARNING! Memory allocated but not released: 5 bytes (1 blocks)
> fm.c:622: HB_TR_ERROR Block 1 (size 1) GETENV(0), "00"
> Clearly a simple ? getenv( "name" ) works as expected.
> Any idea?

There is a memory leak when "name" is set to empty value, f.e.:
    export name=""

I'll fix it in next commit, thanks for the info.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Thu Apr 12 12:59:50 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 12 12:59:53 2007
Subject: [Harbour] GETENV(0) WARNING! Memory allocated but not released: 5
	bytes (1 blocks)
In-Reply-To: <20070412165149.GA1085@localhost.localdomain>
References: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>
	<20070412165149.GA1085@localhost.localdomain>
Message-ID: <9257026e0704120959w5b60bfddnac5da8441d2c96e@mail.gmail.com>

On 4/12/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> I'll fix it in next commit, thanks for the info.

Thanks to you.

regards,
Lorenzo Fiorini
From info at fsgiudice.com  Thu Apr 12 15:55:45 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Thu Apr 12 15:56:28 2007
Subject: [Harbour] gdlib fixed and some problems
References: <20070410123707.GA25110@localhost.localdomain><00ac01c77bbd$94bf5130$b400a8c0@ASUSFSG><20070411102332.GB30724@localhost.localdomain>
	<200704112156.25463.philb@philb.us>
Message-ID: <010f01c77d3c$93460da0$b400a8c0@ASUSFSG>

Hi Phil,

> On Wednesday 11 April 2007 06:23, Przemyslaw Czerpak wrote:
>> > if anyone objects I would like to upload these changes for gd. 
>> > Otherwise
>> > I will send them to Lorenzo.
>> > my sf account is fsgiudice
>>
>> I hope Phil or Alexander will give you developer access to Harbour CVS
>> ASAP.
>
> Done.
>

thank you.

Regards

Francesco
From info at fsgiudice.com  Thu Apr 12 19:03:49 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Thu Apr 12 19:04:28 2007
Subject: [Harbour] compiler flags availables in compiling time
References: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>
	<20070412165149.GA1085@localhost.localdomain>
Message-ID: <03f401c77d56$d6641090$b400a8c0@ASUSFSG>


Hi Przemek,

I would to know if I may add below lines in source/pp/ppcore.c (at line 
4866):

/* ------------------------------- */
/* compiler flags from hb_setup.ch */
#if defined( HB_EXTENSION )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_EXTENSION__", szResult );
#endif
#if defined( HB_C52_UNDOC )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_C52_UNDOC__", szResult );
#endif
#if defined( HB_C52_STRICT )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_C52_STRICT__", szResult );
#endif
#if defined( HB_COMPAT_C53 )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_C53__", szResult );
#endif
#if defined( HB_COMPAT_XPP )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_XPP__", szResult );
#endif
#if defined( HB_COMPAT_VO )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_VO__", szResult );
#endif
#if defined( HB_COMPAT_FLAGSHIP )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_FLAGSHIP__", szResult );
#endif
#if defined( HB_COMPAT_FOXPRO )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_FOXPRO__", szResult );
#endif
#if defined( HB_COMPAT_DBASE )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_DBASE__", szResult );
#endif
#if defined( HB_COMPAT_CLIP )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_CLIP__", szResult );
#endif
#if defined( HB_COMPAT_XHB )
   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_XHB__", szResult );
#endif
/* ------------------------------- */

this because I have seen that actually there is no way to know if harbour it 
is compiled with above flags apart from running harbour /build, AFAIK.
Because above flags are defined in hbsetup.ch I have thought that if a user 
uses a pre-built harbour.exe and he has a not synched hbsetup.ch he may has 
different behaviours from expected and a source may be not portable.

for example I have a program that has these lines:

   #if ( defined( __HARBOUR__ ) .and. !defined( HB_COMPAT_XHB ) )
   LOCAL hParams := HB_Hash()
   #else
   LOCAL hParams := Hash()
   #endif

but if I have a harbour.exe that is compiled with HB_COMPAT_XHB flag and I 
have a not synched hbsetup.ch this give me wrong results.
On the other hand lines as:

   #if ( defined( __HARBOUR__ ) .and. !defined( 
__COMP_FLAG_HB_COMPAT_XHB__ ) )
   LOCAL hParams := HB_Hash()
   #else
   LOCAL hParams := Hash()
   #endif

are independent from current compiler settings and then portable.

What do you think ?

Ah, if I run harbour /build I got memory not released error.

Regards

Francesco



From harbour.01 at syenar.hu  Thu Apr 12 19:43:07 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr 12 19:43:06 2007
Subject: [Harbour] compiler flags availables in compiling time
In-Reply-To: <03f401c77d56$d6641090$b400a8c0@ASUSFSG>
References: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>
	<20070412165149.GA1085@localhost.localdomain>
	<03f401c77d56$d6641090$b400a8c0@ASUSFSG>
Message-ID: <D283B5FC-1B31-41BE-9A83-37E1630AA77B@syenar.hu>

Hi,

In case we agree on your proposal I'd propose to use
the same #defines name as we already use in hb_setup.ch
(if technically possible), for example:

#if defined( HB_EXTENSION )
    hb_pp_addDefine( pState, "HB_EXTENSION", szResult );
#endif

These are properly prefixed and we're familiar with them already.

This would also make it possible to drop #include "hbsetup.ch"
from all Harbour .ch files (except one: hbstdgen.ch).

Brgds,
Viktor

On 2007.04.13., at 1:03, Francesco Saverio Giudice wrote:

>
> Hi Przemek,
>
> I would to know if I may add below lines in source/pp/ppcore.c (at  
> line 4866):
>
> /* ------------------------------- */
> /* compiler flags from hb_setup.ch */
> #if defined( HB_EXTENSION )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_EXTENSION__", szResult );
> #endif
> #if defined( HB_C52_UNDOC )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_C52_UNDOC__", szResult );
> #endif
> #if defined( HB_C52_STRICT )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_C52_STRICT__", szResult );
> #endif
> #if defined( HB_COMPAT_C53 )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_C53__", szResult );
> #endif
> #if defined( HB_COMPAT_XPP )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_XPP__", szResult );
> #endif
> #if defined( HB_COMPAT_VO )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_VO__", szResult );
> #endif
> #if defined( HB_COMPAT_FLAGSHIP )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_FLAGSHIP__",  
> szResult );
> #endif
> #if defined( HB_COMPAT_FOXPRO )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_FOXPRO__",  
> szResult );
> #endif
> #if defined( HB_COMPAT_DBASE )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_DBASE__",  
> szResult );
> #endif
> #if defined( HB_COMPAT_CLIP )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_CLIP__", szResult );
> #endif
> #if defined( HB_COMPAT_XHB )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_COMPAT_XHB__", szResult );
> #endif
> /* ------------------------------- */
>
> this because I have seen that actually there is no way to know if  
> harbour it is compiled with above flags apart from running harbour / 
> build, AFAIK.
> Because above flags are defined in hbsetup.ch I have thought that  
> if a user uses a pre-built harbour.exe and he has a not synched  
> hbsetup.ch he may has different behaviours from expected and a  
> source may be not portable.
>
> for example I have a program that has these lines:
>
>   #if ( defined( __HARBOUR__ ) .and. !defined( HB_COMPAT_XHB ) )
>   LOCAL hParams := HB_Hash()
>   #else
>   LOCAL hParams := Hash()
>   #endif
>
> but if I have a harbour.exe that is compiled with HB_COMPAT_XHB  
> flag and I have a not synched hbsetup.ch this give me wrong results.
> On the other hand lines as:
>
>   #if ( defined( __HARBOUR__ ) .and. !defined 
> ( __COMP_FLAG_HB_COMPAT_XHB__ ) )
>   LOCAL hParams := HB_Hash()
>   #else
>   LOCAL hParams := Hash()
>   #endif
>
> are independent from current compiler settings and then portable.
>
> What do you think ?
>
> Ah, if I run harbour /build I got memory not released error.
>
> Regards
>
> Francesco
>
>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Thu Apr 12 20:57:21 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 12 20:58:01 2007
Subject: [Harbour] compiler flags availables in compiling time
In-Reply-To: <03f401c77d56$d6641090$b400a8c0@ASUSFSG>
References: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>
	<20070412165149.GA1085@localhost.localdomain>
	<03f401c77d56$d6641090$b400a8c0@ASUSFSG>
Message-ID: <20070413005721.GA32191@localhost.localdomain>

On Fri, 13 Apr 2007, Francesco Saverio Giudice wrote:
> Hi Przemek,
> I would to know if I may add below lines in source/pp/ppcore.c (at line 
> 4866):
> /* ------------------------------- */
> /* compiler flags from hb_setup.ch */
> #if defined( HB_EXTENSION )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_EXTENSION__", szResult );
> #endif
> #if defined( HB_C52_UNDOC )
>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_C52_UNDOC__", szResult );
> #endif
[...]

1. IMHO we should not introduce new names if they are not strictly
   necessary so simple HB_EXTENSION and HB_C52_UNDOC is better for me.
2. instead of changing source/pp/ppcore.c you can simply remove some of
       #undef ...
   from hbstdgen.ch and these defines will be included in default build in
   compiler table
3. It cannot be only my own decision. I'm interesting with other opinions?

> this because I have seen that actually there is no way to know if harbour 
> it is compiled with above flags apart from running harbour /build, AFAIK.
> Because above flags are defined in hbsetup.ch I have thought that if a user 
> uses a pre-built harbour.exe and he has a not synched hbsetup.ch he may has 
> different behaviours from expected and a source may be not portable.
> for example I have a program that has these lines:
>   #if ( defined( __HARBOUR__ ) .and. !defined( HB_COMPAT_XHB ) )
>   LOCAL hParams := HB_Hash()
>   #else
>   LOCAL hParams := Hash()
>   #endif
> but if I have a harbour.exe that is compiled with HB_COMPAT_XHB flag and I 
> have a not synched hbsetup.ch this give me wrong results.
> On the other hand lines as:
>   #if ( defined( __HARBOUR__ ) .and. !defined( __COMP_FLAG_HB_COMPAT_XHB__ ) )
>   LOCAL hParams := HB_Hash()
>   #else
>   LOCAL hParams := Hash()
>   #endif
> are independent from current compiler settings and then portable.
> What do you think ?

For things like above I strongly suggest to update hbcompat.ch:

   #ifdef __HARBOUR__
      #ifdef __XHARBOUR__
         #xtranslate HB_HASH([<x,...>]) => HASH(<x>)
      #else
         #xtranslate HASH([<x,...>]) => HB_HASH(<x>)
      #endif
   #endif

and keep only one #include "hbcompat.ch" in your source code
instead of many different lines with #if[n]def __[X]HARBOUR__
It's enough to add:

> Ah, if I run harbour /build I got memory not released error.

Yes, with -build and -credit switches FMstat reported memory leaks.
Thanks for info, fixed.

best regards,
Przemek
From harbour.01 at syenar.hu  Thu Apr 12 21:05:36 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr 12 21:05:38 2007
Subject: [Harbour] compiler flags availables in compiling time
In-Reply-To: <20070413005721.GA32191@localhost.localdomain>
References: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>
	<20070412165149.GA1085@localhost.localdomain>
	<03f401c77d56$d6641090$b400a8c0@ASUSFSG>
	<20070413005721.GA32191@localhost.localdomain>
Message-ID: <B6954695-EFED-4DDC-9855-75925AF60614@syenar.hu>

> 1. IMHO we should not introduce new names if they are not strictly
>    necessary so simple HB_EXTENSION and HB_C52_UNDOC is better for me.

I agree.

> 2. instead of changing source/pp/ppcore.c you can simply remove  
> some of
>        #undef ...
>    from hbstdgen.ch and these defines will be included in default  
> build in
>    compiler table
> 3. It cannot be only my own decision. I'm interesting with other  
> opinions?

I've noticed solution #2 while writing my prev mail and if this is a  
viable
solution with no forseeable bad side effects (it looks safe to me), put
my vote for it.

Brgds,
Viktor



From druzus at priv.onet.pl  Thu Apr 12 21:05:40 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 12 21:06:16 2007
Subject: [Harbour] ChangeLog 2007-04-13 03:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070413010540.GB32191@localhost.localdomain>

2007-04-13 03:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbapi.h
  + harbour/include/hbapidbg.h
  * harbour/include/hbcomp.h
  * harbour/include/hbcompdf.h
  * harbour/include/hbdebug.ch
  * harbour/include/hbdefs.h
  * harbour/source/compiler/Makefile
  * harbour/source/compiler/genc.c
  + harbour/source/compiler/hbdbginf.c
  * harbour/source/compiler/hbmain.c
  * harbour/source/debug/debugger.prg
  * harbour/source/rtl/altd.prg
  * harbour/source/vm/Makefile
  + harbour/source/vm/dbgentry.c
  * harbour/source/vm/debug.c
  * harbour/source/vm/hvm.c
    + added xHarbour compatible low level debugger code
      Without some small exceptions like my hbdbginf.c most of
      the code created by Phil Krylov <phil a t newstar.rinet.ru>
      and borrowed from xHarbour with some small modifications.

  * harbour/source/rtl/gete.c
    ! fixed memory leak in GETENV()

  * harbour/source/compiler/hbmain.c
    ! fixed memory leak when -build or -credit switches were used

I hope that I haven't broken old debugger and now you can try to port
xHarbour debug library (source/debug/*.prg files) to Harbour.

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Fri Apr 13 03:25:48 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Fri Apr 13 03:26:23 2007
Subject: [Harbour] Error in latest CVS
Message-ID: <00aa01c77d9c$f4fbeeb0$0100a8c0@emag>

Error: Unresolved external '_hb_compGetDebugInfo' referenced from C:\HARBOUR 
CVS\HARBOUR\LIB\B32\COMPILER.LIB|hbmain

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From druzus at priv.onet.pl  Fri Apr 13 05:21:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 13 05:22:18 2007
Subject: [Harbour] Error in latest CVS
In-Reply-To: <00aa01c77d9c$f4fbeeb0$0100a8c0@emag>
References: <00aa01c77d9c$f4fbeeb0$0100a8c0@emag>
Message-ID: <20070413092142.GA14263@localhost.localdomain>

On Fri, 13 Apr 2007, Enrico Maria Giordano wrote:
> Error: Unresolved external '_hb_compGetDebugInfo' referenced from 
> C:\HARBOUR CVS\HARBOUR\LIB\B32\COMPILER.LIB|hbmain

As usual ;-) - not updated common.mak - I'll do that in a while.
Thanks for information.

best regards,
Przemek
From druzus at priv.onet.pl  Fri Apr 13 05:26:07 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 13 05:26:43 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070413092607.GB14263@localhost.localdomain>

2007-04-13 11:25 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
    ! updated for new files

  * harbour/contrib/libct/Makefile
  - harbour/contrib/libct/math.c
  + harbour/contrib/libct/ctmath2.c
  * harbour/contrib/libct/makefile.bc
  * harbour/contrib/libct/makefile.vc
    * renamed math.c to ctmath2.c

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Fri Apr 13 05:35:14 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Fri Apr 13 05:35:50 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:25 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070413092607.GB14263@localhost.localdomain>
Message-ID: <013201c77daf$0a114040$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: venerdi 13 aprile 2007 11.26
Oggetto: [Harbour] ChangeLog 2007-04-13 11:25 UTC+0200 Przemyslaw 
Czerpak(druzus/at/priv.onet.pl)


> 2007-04-13 11:25 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>  * harbour/common.mak
>    ! updated for new files

Thank you.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From lorenzo.fiorini at gmail.com  Fri Apr 13 05:57:01 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr 13 05:57:05 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini
Message-ID: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>

2007-04-13 11:50 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
  * harbour/common.mak
    ! updated for new files
  * harbour/source/debug/Makefile
  * harbour/source/debug/dbgbrwsr.prg
  * harbour/source/debug/dbghelp.prg
  * harbour/source/debug/dbgmenu.prg
  * harbour/source/debug/dbgtarr.prg
  * harbour/source/debug/dbgtmenu.prg
  * harbour/source/debug/dbgtmitm.prg
  * harbour/source/debug/dbgtobj.prg
  * harbour/source/debug/dbgtwin.prg
  * harbour/source/debug/dbgwa.prg
  * harbour/source/debug/debugger.prg
  + harbour/source/debug/dbgaltd.prg
  + harbour/source/debug/dbgthsh.prg
    * debugger code borrowed from xHarbour
  + harbour/include/hbcompat.ch
    * xHarbour compatibility defines

it seems to work for basic tasks. Please test it and report problems.

regards,
Lorenzo Fiorini
From e.m.giordano at emagsoftware.it  Fri Apr 13 06:03:29 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Fri Apr 13 06:04:08 2007
Subject: [Harbour] Warnings
Message-ID: <01d701c77db2$fc8b0b50$0100a8c0@emag>

source\debug\debugger.prg(1601) Warning W0001  Ambiguous reference: 'OGET'

source\debug\debugger.prg(1603) Warning W0001  Ambiguous reference: 'OGET'

source\debug\debugger.prg(1603) Warning W0001  Ambiguous reference: 'OGET'

source\debug\debugger.prg(1603) Warning W0001  Ambiguous reference: 
'BMOUSESAVE'

source\debug\debugger.prg(1605) Warning W0001  Ambiguous reference: 
'BMOUSESAVE'

No code generated.

** error 1 ** deleting obj\b32\debugger.obj

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Fri Apr 13 06:08:40 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 06:08:39 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini
In-Reply-To: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
References: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
Message-ID: <E8A35B06-1E13-4FC7-87BC-49E9E3516041@syenar.hu>

My debugger.prg filename handling fixes were lost in the process.
I'll reapply them.

Brgds,
Viktor

On 2007.04.13., at 11:57, Lorenzo Fiorini wrote:

> 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/ 
> gmail.com)
>  * harbour/common.mak
>    ! updated for new files
>  * harbour/source/debug/Makefile
>  * harbour/source/debug/dbgbrwsr.prg
>  * harbour/source/debug/dbghelp.prg
>  * harbour/source/debug/dbgmenu.prg
>  * harbour/source/debug/dbgtarr.prg
>  * harbour/source/debug/dbgtmenu.prg
>  * harbour/source/debug/dbgtmitm.prg
>  * harbour/source/debug/dbgtobj.prg
>  * harbour/source/debug/dbgtwin.prg
>  * harbour/source/debug/dbgwa.prg
>  * harbour/source/debug/debugger.prg
>  + harbour/source/debug/dbgaltd.prg
>  + harbour/source/debug/dbgthsh.prg
>    * debugger code borrowed from xHarbour
>  + harbour/include/hbcompat.ch
>    * xHarbour compatibility defines
>
> it seems to work for basic tasks. Please test it and report problems.
>
> regards,
> Lorenzo Fiorini
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Fri Apr 13 06:20:02 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 06:18:59 2007
Subject: [Harbour] CHANGELOG: 2007-04-13 12:18 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77db5$Blat.v2.6.1$4bfd20c2$e882122b368@127.0.0.1>

2007-04-13 12:18 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/debug/debugger.prg
     ! Fixed a few compile errors.
     ! Reapplied (and extended) a former fix regarding 
       the proper handling of the filenames.

   * harbour/source/rtl/tbrowse.prg
     ; Cosmetic.

From e.m.giordano at emagsoftware.it  Fri Apr 13 06:25:01 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Fri Apr 13 06:25:50 2007
Subject: [Harbour] CHANGELOG: 2007-04-13 12:18 UTC+0100 Viktor
	Szakats(harbour.01 syenar.hu)
References: <01c77db5$Blat.v2.6.1$4bfd20c2$e882122b368@127.0.0.1>
Message-ID: <01eb01c77db5$fe7065c0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Szak?ts Viktor" <harbour.01@syenar.hu>
A: <harbour@harbour-project.org>
Data invio: venerd? 13 aprile 2007 12.20
Oggetto: [Harbour] CHANGELOG: 2007-04-13 12:18 UTC+0100 Viktor 
Szakats(harbour.01 syenar.hu)


> 2007-04-13 12:18 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>   * harbour/source/debug/debugger.prg
>     ! Fixed a few compile errors.

Thank you.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic

From lorenzo.fiorini at gmail.com  Fri Apr 13 06:43:58 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr 13 06:44:01 2007
Subject: [Harbour] CHANGELOG: 2007-04-13 12:18 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
In-Reply-To: <01c77db5$Blat.v2.6.1$4bfd20c2$e882122b368@127.0.0.1>
References: <01c77db5$Blat.v2.6.1$4bfd20c2$e882122b368@127.0.0.1>
Message-ID: <9257026e0704130343j32a0d882u4fab56c089e1c05b@mail.gmail.com>

On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

>      ! Fixed a few compile errors.

Many thanks.

> ! Reapplied (and extended) a former fix regarding
>       the proper handling of the filenames.

Sorry it was not my intention.

BTW did you see my msg about tget error?
It's my last "problem" to migrate my "desktop" apps to Harbour.
I'm trying to fix it but I haven't found a simple solution.
xHarbour uses xVarGet to store changes of the get value to avoid some
varputs/vargets.
Have you a better idea?

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Fri Apr 13 07:28:03 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 13 07:28:39 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini
In-Reply-To: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
References: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
Message-ID: <20070413112803.GA18075@localhost.localdomain>

On Fri, 13 Apr 2007, Lorenzo Fiorini wrote:
> 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
>  * harbour/common.mak
>    ! updated for new files
>  * harbour/source/debug/Makefile
>  * harbour/source/debug/dbgbrwsr.prg
>  * harbour/source/debug/dbghelp.prg
>  * harbour/source/debug/dbgmenu.prg
>  * harbour/source/debug/dbgtarr.prg
>  * harbour/source/debug/dbgtmenu.prg
>  * harbour/source/debug/dbgtmitm.prg
>  * harbour/source/debug/dbgtobj.prg
>  * harbour/source/debug/dbgtwin.prg
>  * harbour/source/debug/dbgwa.prg
>  * harbour/source/debug/debugger.prg
>  + harbour/source/debug/dbgaltd.prg
>  + harbour/source/debug/dbgthsh.prg
>    * debugger code borrowed from xHarbour
>  + harbour/include/hbcompat.ch
>    * xHarbour compatibility defines
> it seems to work for basic tasks. Please test it and report problems.

Thank you very much. In practice I never used debugger in [x]Harbour so
I cannot help you in tests and locating problems. Just only few notes
about some modifications I made porting debugger code from xHarbour.

The line information with good break points (HB_FUNC_INITLINES) in
xHarbour is collected during compilation before PCODE optimization
and in Harbour from the final compiled and optimized PCODE so the results
can be differ in some cases. The Harbour ones are valid so any tricks/fixes
in upper level code (if any) should be removed.

I added dummy functions for debugging global variables. Harbour does not
support them and I haven't decided yet if it should so maybe you should
not remove from debugger code used for GLOBALs. If we add them in the future
they should work as is.

I fixed some memory leaks in dbgentry.c. They seems to also exists in
xHarbour and I do not know if Phils knows about. For me some code is
redundant (not cleanly removed old code) or it's a work in progress and
Phil plans to add some modifications. I do not know but probably we should
ask Phil about it.

In .prg debugger code there is special code to store and then restore
user screen and HVM settings. IMHO actions like saving and restoring
screen and keyboard settings should be done by GT driver because only
GT drivers knows what should be saved/restored. Also some GT drivers
can create new virtual window and then simply destroy them or switch
to the user one. In Harbour such functionality has CTWIN GT driver which
can inherit from any other one. Some other GTs can create new physical
Window. In debugger code such functionality is hardcoded for GTWVW when
but in fact more GT drivers can do that. I implemented it for GTCRS and
when you are working in XWindow GTCRS can open many XTerm window and
programmer can switch between them. As I can see these code was base
from other GT drivers so when Peter created GTWVT it was possible to
make multi window functionality (GTWVW) with only few modifications.
This code was also inherited by GTXVT and then GTXWC so finally we
have many GT drivers which can create second window for debugger.
So some general mechanism probably using hb_gtInfo() function can
greatly increase debugger functionality and make its code much more
simple. Please also note that some GT drivers can start without
console/terminal window and then open them on user request. Such
GT drivers can be nicely linked with GUI programs without and visual
effect and used with debugger because debugger console window will
be created when user activate debugger. I'll think about adding some
GTI_* actions which should give some common interfaces for all GT
drivers and then we can overload them in these GTs which have some
additional functionality.

In Harbour it's possible to catch QUIT exception without any problem
so maybe we should think about activating debugger at application
startup and not close debugger with program when debugged application
QUITs. Probably not by default but using some REQUEST mechanism.

best regards,
Przemek
From druzus at priv.onet.pl  Fri Apr 13 10:05:38 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 13 10:06:13 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini
In-Reply-To: <20070413112803.GA18075@localhost.localdomain>
References: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
	<20070413112803.GA18075@localhost.localdomain>
Message-ID: <20070413140537.GA1277@localhost.localdomain>

On Fri, 13 Apr 2007, Przemyslaw Czerpak wrote:
[...]

And one thing else. HB_INLINE() should be eliminated from core
code but it's minor thing which can be done at the end.
I've just checked what you've done and I'm really under express.
Very good job - thank you.

A small information for other developers.
The main difference between current debugger code and the old one
is interface between debugger and HVM. The old debugger uses .prg
function and the new one C function. It gives horrible speed
improvement and resolves some unpleasure problems which can appear
due to interaction between debugger code and debugging/trace process.
To see the speed difference simply compare results from this smal example:

    proc main()
    local i, t
    t:=secondsCPU()
    for i:=1 to 100000
       p(0)
    next
    ? secondsCPU() - t, "sec."
    return
    proc p(n)
    if n<10
       p(n+1)
    endif
    return

Compiled without -b option:
         0.60 sec.
with -b and old debugger:
        65.31 sec.
with -b and new debugger:
         2.36 sec.

I think I do not have to comment the results ;-)

best regards,
Przemek
From harbour.01 at syenar.hu  Fri Apr 13 11:42:29 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 11:41:26 2007
Subject: [Harbour] CHANGELOG: 2007-04-13 17:38 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77de2$Blat.v2.6.1$5814ccac$5b45b94adc2@127.0.0.1>

2007-04-13 17:38 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/tget.prg
     ! Get method UpdateBuffer() fixed to be effective only 
       when the object has focus (as per the C52 docs and 
       Lorenzo's report).

From harbour.01 at syenar.hu  Fri Apr 13 11:42:34 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 11:42:30 2007
Subject: [Harbour] get error
In-Reply-To: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
Message-ID: <5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>

Hi Lorenzo,

The xhb version looks right and in sync with the C52 docs.

I've committed a fix, pls test it.

Brgds,
Viktor

On 2007.04.12., at 10:02, Lorenzo Fiorini wrote:

> The test below works in Clipper C53B and xHarbour but in Harbour gives
> a segfault due to recursive calls.
>
> I've analyzed it and I've found that the "problem" is Assign() used  
> in:
>
>   METHOD UpdateBuffer() INLINE  ::buffer := ::PutMask( ),
> iif(::lEdit, ::Assign(),), ::Display(), Self
>
> Just for comparison in xHarbour the code is:
>
> METHOD UpdateBuffer() INLINE  if( ::hasfocus, ( ::buffer := ::PutMask(
> ::VarGet() ), ::Display() ), ), Self
>
> Any comment?
>
> regards,
> Lorenzo Fiorini
>
> // testget1.prg
>
> STATIC oGet
>
> PROCEDURE Main()
>
>   LOCAL   GetList := {}, nVar := 0
>
>   CLS
>
>   @ 10,10 SAY "nVar            :" GET nVar PICTURE "@ZE 999,999.99"
>
>   oGet := atail( GetList )
>
>   oGet:block := { |u| iif( empty( u ), nVar, ( nVar := u,
> oGet:UpdateBuffer() ) ) }
>
>   READ
>
>   wait
>
>   alert( str( nVar ) )
>
> RETURN
>
> // end of testget1.prg
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Fri Apr 13 11:44:12 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr 13 11:44:15 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini
In-Reply-To: <20070413140537.GA1277@localhost.localdomain>
References: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
	<20070413112803.GA18075@localhost.localdomain>
	<20070413140537.GA1277@localhost.localdomain>
Message-ID: <9257026e0704130844q361bbb23x565c1190feace5c@mail.gmail.com>

On 4/13/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> And one thing else. HB_INLINE() should be eliminated from core
> code but it's minor thing which can be done at the end.
> I've just checked what you've done and I'm really under express.
> Very good job - thank you.

Thanks, but I did the minimum necessary to get it working under Harbour.
For the moment I kept all the code waiting for tests and comments.

BTW is it possible to avoid W2 errors with code like:

   HB_hEval( hHash, {|k,v,p| HB_SYMBOL_UNUSED( k ), HB_SYMBOL_UNUSED(
v ), nKeyLen := Max( nKeyLen, len( ::hashName+"["+ HashKeyString(
hHash, p ) +"]" ) ) } )

k,v,p parameters are defined by the caller and are positional. Adding
HB_SYMBOL_UNUSED is somewhat "strange".

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Fri Apr 13 11:57:19 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr 13 11:57:22 2007
Subject: [Harbour] get error
In-Reply-To: <5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
Message-ID: <9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>

On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> I've committed a fix, pls test it.

Many thanks, but I've the same error.

Does the test works for you?

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Fri Apr 13 12:16:01 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 12:15:57 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini
In-Reply-To: <9257026e0704130844q361bbb23x565c1190feace5c@mail.gmail.com>
References: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
	<20070413112803.GA18075@localhost.localdomain>
	<20070413140537.GA1277@localhost.localdomain>
	<9257026e0704130844q361bbb23x565c1190feace5c@mail.gmail.com>
Message-ID: <FC944E1F-967C-4A2F-A729-59961F83A2B5@syenar.hu>

>> And one thing else. HB_INLINE() should be eliminated from core
>> code but it's minor thing which can be done at the end.
>> I've just checked what you've done and I'm really under express.
>> Very good job - thank you.
>
> Thanks, but I did the minimum necessary to get it working under  
> Harbour.
> For the moment I kept all the code waiting for tests and comments.

I agree that INLINE should be avoided. Maybe a simple .c file with
all the needed functionality would solve the problem. (as we did
once with all the INLINE stuff already in Harbour)

> BTW is it possible to avoid W2 errors with code like:
>
>   HB_hEval( hHash, {|k,v,p| HB_SYMBOL_UNUSED( k ), HB_SYMBOL_UNUSED(
> v ), nKeyLen := Max( nKeyLen, len( ::hashName+"["+ HashKeyString(
> hHash, p ) +"]" ) ) } )
>
> k,v,p parameters are defined by the caller and are positional. Adding
> HB_SYMBOL_UNUSED is somewhat "strange".

Yes, that's the normal way to do it, as the "unused var" warnings
applies to the codeblocks as well (which is also expected and
normal).

Just a raw idea, but if we would support this form:
{|,,p| processvar( p ) } we might be able to solve the
problem in somewhat more straightforward way.
Dunno if this is something usual for other languages,
but it looks a bit strange too.

Brgds,
Viktor

From druzus at priv.onet.pl  Fri Apr 13 12:43:19 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 13 12:43:54 2007
Subject: [Harbour] ChangeLog 2007-04-13 18:43 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070413164319.GA10847@localhost.localdomain>

2007-04-13 18:43 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
  * harbour/source/rtl/Makefile
  + harbour/source/rtl/valtoexp.prg
    + added HB_VALTOEXP() and HB_CSTR()

  * harbour/source/debug/dbgthsh.prg
  * harbour/source/debug/debugger.prg
    * replaced CSTR() with HB_CSTR() and SETLASTKEY() with HB_SETLASTKEY()
      now debugger can be used without CT and TIP libraries

  * harbour/include/hbgtinfo.ch
  * harbour/source/rtl/hbgtcore.c
    + added GTI_ISMULTIWIN, GTI_GETWIN, GTI_SETWIN, GTI_NEWWIN
      and TODO note - it's not finished yet, work in progress

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Fri Apr 13 12:47:33 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr 13 12:47:37 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini
In-Reply-To: <20070413112803.GA18075@localhost.localdomain>
References: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
	<20070413112803.GA18075@localhost.localdomain>
Message-ID: <9257026e0704130947o5e95ce2brbf5c1675e14dfc3f@mail.gmail.com>

On 4/13/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Just only few notes
> about some modifications I made porting debugger code from xHarbour.

I get this at the end of my apps build with -B. It does not happen in
simple tests.

Any suggestion where should I start to look to reproduce it in a test?

regards,
Lorenzo Fiorini

Program received signal SIGSEGV, Segmentation fault.
0x00489cc3 in memmove () from /lib/libc.so.6
(gdb) bt
#0  0x00489cc3 in memmove () from /lib/libc.so.6
#1  0x08068248 in hb_dbgEntry ()
#2  0x080858fe in hb_vmQuit ()
#3  0x0808d7e3 in main ()
(gdb) quit
From info at fsgiudice.com  Fri Apr 13 13:02:28 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Fri Apr 13 13:03:08 2007
Subject: [Harbour] compiler flags availables in compiling time
References: <9257026e0704120808u15544570ted0bbe3fb9078c89@mail.gmail.com>
	<20070412165149.GA1085@localhost.localdomain>
	<03f401c77d56$d6641090$b400a8c0@ASUSFSG>
	<20070413005721.GA32191@localhost.localdomain>
Message-ID: <000601c77ded$85fbeeb0$b400a8c0@ASUSFSG>

Hi Przemek,

>> /* ------------------------------- */
>> /* compiler flags from hb_setup.ch */
>> #if defined( HB_EXTENSION )
>>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_EXTENSION__", szResult );
>> #endif
>> #if defined( HB_C52_UNDOC )
>>   hb_pp_addDefine( pState, "__COMP_FLAG_HB_C52_UNDOC__", szResult );
>> #endif
> [...]
>
> 1. IMHO we should not introduce new names if they are not strictly
>   necessary so simple HB_EXTENSION and HB_C52_UNDOC is better for me.

ok, I did above proposal because I didn't know if there are possible 
conflicts with standard names.

> 2. instead of changing source/pp/ppcore.c you can simply remove some of
>       #undef ...
>   from hbstdgen.ch and these defines will be included in default build in
>   compiler table

ok, I will try.
But could you kindly explain the use of #undef in hbstdgen.ch ?
Commenting out all #undef what happens ?
To see compiler flags surely I have to comment out all

#undef HB_EXTENSION

#undef HB_C52_UNDOC
#undef HB_C52_STRICT

#undef HB_COMPAT_C53
#undef HB_COMPAT_XPP
#undef HB_COMPAT_VO
#undef HB_COMPAT_FLAGSHIP
#undef HB_COMPAT_FOXPRO
#undef HB_COMPAT_DBASE
#undef HB_COMPAT_CLIP
#undef HB_COMPAT_XHB

but could be usefull to comment out also

#undef HB_SHORTNAMES
#undef HB_FILE_VER_STATIC

#undef __HARBOUR__
#undef __DATE__
#undef __TIME__
#undef __HB_MAIN__
#undef __ARCH16BIT__
#undef __ARCH32BIT__
#undef __ARCH64BIT__
#undef __LITTLE_ENDIAN__
#undef __BIG_ENDIAN__
#undef __PDP_ENDIAN__

so them will be available in built version ?

> 3. It cannot be only my own decision. I'm interesting with other opinions?
>

I also will respect your and other opinions.

>> On the other hand lines as:
>>   #if ( defined( __HARBOUR__ ) .and. !defined( 
>> __COMP_FLAG_HB_COMPAT_XHB__ ) )
>>   LOCAL hParams := HB_Hash()
>>   #else
>>   LOCAL hParams := Hash()
>>   #endif
>> are independent from current compiler settings and then portable.
>> What do you think ?
>
> For things like above I strongly suggest to update hbcompat.ch:
>
>   #ifdef __HARBOUR__
>      #ifdef __XHARBOUR__
>         #xtranslate HB_HASH([<x,...>]) => HASH(<x>)
>      #else
>         #xtranslate HASH([<x,...>]) => HB_HASH(<x>)
>      #endif
>   #endif
>

I have already tested #translate commands and they work, but if I have some 
problems with this command:

#xtranslate HASH([<x,...>]) => HB_HASH(<x>)

because it has to be

#xtranslate HASH([<x,...>]) => HB_HAUTOADD( HB_HASH(<x>), .T. )

but HB_HAUTOADD() doesn't work so.
So in this case it could be usefull a global set function, as Maurilio asks, 
to set a default method of work for hashes to be xharbour compatible.
Otherwise should be added a function like
FUNCTION HB_HSETXHCOMP( hHash )
   HB_hAutoAdd( hHash, .T. )
   HB_hDefault( hHash, 0 )
   .....
RETURN hHash

and add it in #xtranslate

#xtranslate HASH([<x,...>]) => HB_HSETXHCOMP( HB_HASH(<x>) )

and one more thing
>
>   #ifdef __HARBOUR__
>      #ifdef __XHARBOUR__
>         #xtranslate HB_HASH([<x,...>]) => HASH(<x>)
>      #else
>         #xtranslate HASH([<x,...>]) => HB_HASH(<x>)
>      #endif
>   #endif
>

should be, using compiler flags:

  #ifdef __HARBOUR__
     #ifdef __XHARBOUR__
        #xtranslate HB_HASH([<x,...>]) => HASH(<x>)
     #elseif !defined( HB_COMPAT_XHB )
        #xtranslate HASH([<x,...>]) => HB_HASH(<x>)
     #endif
  #endif

 isn't it ?

>> Ah, if I run harbour /build I got memory not released error.
>
> Yes, with -build and -credit switches FMstat reported memory leaks.
> Thanks for info, fixed.
>

thank you

best regards

Francesco
From harbour.01 at syenar.hu  Fri Apr 13 13:09:14 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 13:09:11 2007
Subject: [Harbour] get error
In-Reply-To: <9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
Message-ID: <7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>

The fix is definitely right, but the real problem seems
to lie elsewhere.

Problem is, the block gets executed while the get
has focus (somewhere inside the READ command),
so my change didn't matter in this case.

Then, inside UpdateBuffer() an :Assign() is called,
which in turn calls :VarPut() which in turn evals
the block in assign mode calling UpdateBuffer().

:Assign() seems to be a bit out of place in UpdateBuffer()
(called only in "overstrike" mode), you can try experimenting
with removing it from UpdateBuffer(). It might work, but I
cannot oversee it's side-effects ATM, or see why was it
added there in the first place. FWIW CA-Cl*pper does no
:Assign inside UpdateBuffer().

Brgds,
Viktor

On 2007.04.13., at 17:57, Lorenzo Fiorini wrote:

> On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
>
>> I've committed a fix, pls test it.
>
> Many thanks, but I've the same error.
>
> Does the test works for you?
>
> regards,
> Lorenzo Fiorini
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From dbtopas at dbtopas.lt  Fri Apr 13 13:11:43 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Fri Apr 13 13:09:22 2007
Subject: [Harbour] xHarbour vs Harbour debugger
In-Reply-To: <20070412122846.GC27341@localhost.localdomain>
References: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>
	<20070412122846.GC27341@localhost.localdomain>
Message-ID: <461FB9CF.7030905@dbtopas.lt>

Przemyslaw Czerpak wrote:
> Sorry but I cannot help you here I very seldom use sth like above
> and usually simple [f]printf() is all what I need

> But I cannot work myself on everything and we will need someone
> who can port xHarbour debugger to Harbour. If you want then I can
> make necessary modifications in compiler and HVM but someone else will
> have to work on core debugger library.


Hello,


I'm also using printf() or look at the error.log file to find bugs, but 
I never use debugger. But I still find useful debugger functions to find 
reason of seldom GPF or recursive error blocks, or some other "mystic" 
error like errors in destructors. I just log function name, stack depth 
and line number of every HB_P_LINE instructions. This debugging could be 
switched on without recompiling source with /b switch.

I've modified hvm.c logic of s_bDebug* variables and make to accomplish 
this task. But it seems many things can be optimised: 
s_bDebuggerIsWorking is not used at all! We can delete it.

It seems (I've not tested yet) s_bDebugShowLines can also be removed, we 
just need to change hb_vmLocalName(), etc., to:

static void hb_vmLocalName( USHORT uiLocal, char * szLocalName )
{
    if( s_pDynsDbgEntry )
    {
       s_bDebugging = FALSE;

       if ( hb_vm_pFunDbgEntry )
          ...
       else
       {
          ...
       }

       s_bDebugging = TRUE;
    }
}


To implement the idea of HB_P_LINE logging it's enough to change hvm.c 
module:
   case HB_P_LINE:
      ...
      if( s_bDebugging | s_bDebugTraceLines )
            hb_vmDebuggerShowLine( ... );
      ...

HB_EXPORT void hb_vmSetTraceLines( BOOL bTrace )
{
    s_bDebugTraceLines = bTrace;
}


The rest of code is a small module I'm using:

static int s_iFunctionOnce = 0;
static ULONG s_ulLastProcLevel = 1;
static char s_szLastProcName[ MAX_PROC_NAME ] = "";


HB_FUNC( HB_DBG_TRACELINES )
{
   BOOL  lTrace;

   lTrace = hb_parl( 1 );
   hb_vmSetTraceLines( lTrace );
   s_iFunctionOnce = hb_parl( 2 );
   s_szLastProcName[ 0 ] = '\0';
   if ( lTrace )
   {
     hb_vm_pFunDbgEntry = tracelinesDbgEntry;
   }
}

// the original xHarbour's function is buggy
ULONG my_dbg_ProcLevel ( void )
{
   PHB_ITEM * pBase = HB_VM_STACK.pBase;
   int        iLevel;

   iLevel = 0;
   while( pBase != HB_VM_STACK.pItems )  {
     iLevel++;
     pBase = HB_VM_STACK.pItems + ( *pBase )->item.asSymbol.stackbase;
   }
   return (ULONG) iLevel;
}

static void tracelinesDbgEntry( int iMode, int iLine, char *szName, int 
iIndex, int iFrame )
{
   FILE   *hFile;
   ULONG  ulProcLevel, ulIndex;
   USHORT usLine;
   char   szProcName[ MAX_PROC_NAME ], szProcName2[ MAX_PROC_NAME ], 
szTime[ 9 ];

    HB_SYMBOL_UNUSED( szName );
    HB_SYMBOL_UNUSED( iIndex );
    HB_SYMBOL_UNUSED( iFrame );

   if ( iMode == HB_DBG_SHOWLINE )
   {
     hb_procinfo( 0, szProcName, NULL, NULL );

     if ( s_iFunctionOnce )
     {
       if ( strcmp( s_szLastProcName, szProcName ) )
         strcpy( s_szLastProcName, szProcName );
       else
         return;
     }

     ulProcLevel = my_dbg_ProcLevel();  // hb_dbg_ProcLevel();

     hFile = fopen( "debug.log", "a" );
     if ( hFile )
     {
       if ( s_ulLastProcLevel + 1 < ulProcLevel )
       {
         for ( ulIndex = s_ulLastProcLevel + 1; ulIndex < ulProcLevel ; 
ulIndex++ )
         {
           hb_procinfo( ulProcLevel - ulIndex, szProcName2, &usLine, NULL );
           fprintf( hFile, "**:**:** %*s%s(%d)\n", (int) ulIndex, "", 
szProcName2, (int) usLine );
         }
       }
       s_ulLastProcLevel = ulProcLevel;
       hb_dateTimeStr( szTime );
       fprintf( hFile, "%s %*s%s(%d)\n", szTime, (int) ulProcLevel, "", 
szProcName, iLine );
       fclose( hFile );
     }
   }
}

The drawback of this is that it conflicts with standard debugger for 
hb_vm_pFunDbgEntry.



Best regards,
Mindaugas
From harbour.01 at syenar.hu  Fri Apr 13 13:18:48 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 13:18:46 2007
Subject: [Harbour] get error
In-Reply-To: <7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
	<7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
Message-ID: <A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>

Hi Lorenzo,

Well, the :Assign call is there since the very beginning, and the
initial implemenation is cleary wrong (but probably better than
nothing in 1999). So I suspect the call can be safely removed now
that we have the correct behaviour already implemented.

Pls do some test, and I'll commit the change.

Brgds,
Viktor

On 2007.04.13., at 19:09, Szak?ts Viktor wrote:

> The fix is definitely right, but the real problem seems
> to lie elsewhere.
>
> Problem is, the block gets executed while the get
> has focus (somewhere inside the READ command),
> so my change didn't matter in this case.
>
> Then, inside UpdateBuffer() an :Assign() is called,
> which in turn calls :VarPut() which in turn evals
> the block in assign mode calling UpdateBuffer().
>
> :Assign() seems to be a bit out of place in UpdateBuffer()
> (called only in "overstrike" mode), you can try experimenting
> with removing it from UpdateBuffer(). It might work, but I
> cannot oversee it's side-effects ATM, or see why was it
> added there in the first place. FWIW CA-Cl*pper does no
> :Assign inside UpdateBuffer().
>
> Brgds,
> Viktor
>
> On 2007.04.13., at 17:57, Lorenzo Fiorini wrote:
>
>> On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
>>
>>> I've committed a fix, pls test it.
>>
>> Many thanks, but I've the same error.
>>
>> Does the test works for you?
>>
>> regards,
>> Lorenzo Fiorini
>> _______________________________________________
>> Harbour mailing list
>> Harbour@harbour-project.org
>> http://lists.harbour-project.org/mailman/listinfo/harbour
>

From lorenzo.fiorini at gmail.com  Fri Apr 13 13:24:12 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr 13 13:24:15 2007
Subject: [Harbour] get error
In-Reply-To: <A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
	<7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
	<A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>
Message-ID: <9257026e0704131024s3833135dka592bbb9b2fcf1f5@mail.gmail.com>

On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> Well, the :Assign call is there since the very beginning, and the
> initial implemenation is cleary wrong (but probably better than
> nothing in 1999). So I suspect the call can be safely removed now
> that we have the correct behaviour already implemented.
>
> Pls do some test, and I'll commit the change.

I've already tried this but it breaks completely the "edit".
The "problem" seems to be that tget.prg rely havily on ::VarGet() to
get the var value and in turn it needs varput to update the var.

xHarbour use a temporay ::xVarGet, but this requires many changes in
the tget.prg code.

regards,
Lorenzo
From harbour.01 at syenar.hu  Fri Apr 13 13:55:55 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 13:55:52 2007
Subject: [Harbour] get error
In-Reply-To: <9257026e0704131024s3833135dka592bbb9b2fcf1f5@mail.gmail.com>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
	<7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
	<A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>
	<9257026e0704131024s3833135dka592bbb9b2fcf1f5@mail.gmail.com>
Message-ID: <3EC7E25B-7088-475C-BCCF-9D1ABD30A7D7@syenar.hu>

UpdateBuffer() is not used from inside the TGet class, only
from TGetList. That's all Harbour usage. TGetList calls it
from 5 places, while C52 GETSYS.PRG calls it from 2 places.
5 places is not very much, it can be even worked around with
extra :Assign() calls if needed.

When testing with my large app, everything seems to
behave normally after this change.

UpdateBuffer() is not supposed to touch the var itself, just
the edit buffer according to the var and picture. So if removing
this bug reveals others we need to fix them.

If you could give some sample code which breaks without
the ::Assign() call in UpdateBuffer(), I could check further.

Brgds,
Viktor

On 2007.04.13., at 19:24, Lorenzo Fiorini wrote:

> On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
>
>> Well, the :Assign call is there since the very beginning, and the
>> initial implemenation is cleary wrong (but probably better than
>> nothing in 1999). So I suspect the call can be safely removed now
>> that we have the correct behaviour already implemented.
>>
>> Pls do some test, and I'll commit the change.
>
> I've already tried this but it breaks completely the "edit".
> The "problem" seems to be that tget.prg rely havily on ::VarGet() to
> get the var value and in turn it needs varput to update the var.
>
> xHarbour use a temporay ::xVarGet, but this requires many changes in
> the tget.prg code.
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From e.m.giordano at emagsoftware.it  Fri Apr 13 14:03:44 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Fri Apr 13 14:04:20 2007
Subject: [Harbour] Warning
Message-ID: <038801c77df6$1397f0e0$0100a8c0@emag>

source\debug\dbgtarr.prg(309) Warning W0007  Function 'TDBGARRAY_DOGET' does 
not end with RETURN statement

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From lorenzo.fiorini at gmail.com  Fri Apr 13 15:26:40 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr 13 15:26:43 2007
Subject: [Harbour] get error
In-Reply-To: <3EC7E25B-7088-475C-BCCF-9D1ABD30A7D7@syenar.hu>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
	<7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
	<A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>
	<9257026e0704131024s3833135dka592bbb9b2fcf1f5@mail.gmail.com>
	<3EC7E25B-7088-475C-BCCF-9D1ABD30A7D7@syenar.hu>
Message-ID: <9257026e0704131226m3ed8ed51m1a359d93e73dac16@mail.gmail.com>

On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> When testing with my large app, everything seems to
> behave normally after this change.

Do you mean removing ::Assign() from updatebuffer()?

If I remove it and I type 12345 in the test I sent I see:
1, 21, 321, 421, 451

and 451 is the value showed in the alert.

regards,
Lorenzo
From harbour.01 at syenar.hu  Fri Apr 13 15:41:53 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 13 15:41:51 2007
Subject: [Harbour] get error
In-Reply-To: <9257026e0704131226m3ed8ed51m1a359d93e73dac16@mail.gmail.com>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
	<7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
	<A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>
	<9257026e0704131024s3833135dka592bbb9b2fcf1f5@mail.gmail.com>
	<3EC7E25B-7088-475C-BCCF-9D1ABD30A7D7@syenar.hu>
	<9257026e0704131226m3ed8ed51m1a359d93e73dac16@mail.gmail.com>
Message-ID: <DD587A3E-311D-4704-A81E-CB7B2B1C8257@syenar.hu>

Okey, I see what you mean, if we remove the "oGet:block :=" line
though, it works alright. So for normal cases it looks no worse than
before, and for your example it doesn't crash anymore, but another
problem surfaced instead.

After that move we'd need to find out which call inside :UpdateBuffer()
causes the strange edit behaviour we're seeing.

Brgds,
Viktor

On 2007.04.13., at 21:26, Lorenzo Fiorini wrote:

> On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
>
>> When testing with my large app, everything seems to
>> behave normally after this change.
>
> Do you mean removing ::Assign() from updatebuffer()?
>
> If I remove it and I type 12345 in the test I sent I see:
> 1, 21, 321, 421, 451
>
> and 451 is the value showed in the alert.
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Sat Apr 14 06:01:57 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 14 06:00:53 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 11:56 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77e7b$Blat.v2.6.1$f025d77c$b18c1ea068@127.0.0.1>

2007-04-14 11:56 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/debug/dbgtarr.prg
     ! Fixed unclosed #if construct.
       Question: What does HB_NO_READDBG do?

   * harbour/source/rtl/tget.prg
     ! Removed :Assign() call from :UpdateBuffer() to close 
       the functionality to CA-Cl*pper.

From harbour.01 at syenar.hu  Sat Apr 14 06:43:11 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 14 06:42:04 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 12:40 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77e81$Blat.v2.6.1$b2c6aad6$d9ce0cf8d7c@127.0.0.1>

2007-04-14 12:40 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/include/hbstdgen.ch
   * harbour/include/box.ch
   * harbour/include/hbclass.ch
   * harbour/include/hbcommon.ch
   * harbour/include/hbextern.ch
   * harbour/include/hbgetcmt.ch
   * harbour/include/hbsetup.ch
   * harbour/include/ord.ch
   * harbour/source/rdd/dbdelim.prg
   * harbour/source/rdd/dbfuncs.prg
   * harbour/source/rdd/dbjoin.prg
   * harbour/source/rdd/dblist.prg
   * harbour/source/rdd/dbsort.prg
   * harbour/source/rdd/dbstrux.prg
   * harbour/source/rdd/dbtotal.prg
   * harbour/source/rdd/dbupdat.prg
   * harbour/source/rdd/rddord.prg
   * harbour/source/rtl/alert.prg
   * harbour/source/rtl/browdb.prg
   * harbour/source/rtl/browdbx.prg
   * harbour/source/rtl/checkbox.prg
   * harbour/source/rtl/dircmd.prg
   * harbour/source/rtl/getsys.prg
   * harbour/source/rtl/input.prg
   * harbour/source/rtl/mssgline.prg
   * harbour/source/rtl/pushbtn.prg
   * harbour/source/rtl/radiobtn.prg
   * harbour/source/rtl/radiogrp.prg
   * harbour/source/rtl/setfunc.prg
   * harbour/source/rtl/setta.prg
   * harbour/source/rtl/tbcolumn.prg
   * harbour/source/rtl/tget.prg
   * harbour/source/rtl/tgetint.prg
   * harbour/source/rtl/tmenuitm.prg
   * harbour/source/rtl/tpopup.prg
   * harbour/source/rtl/ttopbar.prg
   * harbour/source/rtl/typefile.prg
   * harbour/source/vm/harbinit.prg
   * harbour/utils/hbrun/external.prg
   * harbour/utils/hbtest/rt_main.ch
     + Following #defines are now available by default without 
       the need to #include "hbsetup.ch". These are of course 
       also available for applications as defined at Harbour 
       build time:
       HB_EXTENSION
       HB_C52_UNDOC
       HB_C52_STRICT
       HB_COMPAT_C53
       HB_COMPAT_XPP
       HB_COMPAT_VO
       HB_COMPAT_FLAGSHIP
       HB_COMPAT_FOXPRO
       HB_COMPAT_DBASE
       HB_COMPAT_CLIP
       HB_COMPAT_XHB
       HB_SHORTNAMES
       HB_FILE_VER_STATIC

   * harbour/source/compiler/hbusage.c
     * Mail address update.

From info at fsgiudice.com  Sat Apr 14 06:58:39 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Sat Apr 14 06:59:24 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 12:40 UTC+0100 Viktor
	Szakats(harbour.01 syenar.hu)
References: <01c77e81$Blat.v2.6.1$b2c6aad6$d9ce0cf8d7c@127.0.0.1>
Message-ID: <001301c77e83$dd066d70$b400a8c0@ASUSFSG>


----- Original Message ----- 
From: "Szak?ts Viktor" <harbour.01@syenar.hu>
To: <harbour@harbour-project.org>
Sent: Saturday, April 14, 2007 12:43 PM
Subject: [Harbour] CHANGELOG: 2007-04-14 12:40 UTC+0100 Viktor 
Szakats(harbour.01 syenar.hu)


> 2007-04-14 12:40 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>   * harbour/include/hbstdgen.ch
...
>   * harbour/utils/hbtest/rt_main.ch
>     + Following #defines are now available by default without
>       the need to #include "hbsetup.ch". These are of course
>       also available for applications as defined at Harbour
>       build time:
>       HB_EXTENSION
>       HB_C52_UNDOC
>       HB_C52_STRICT
>       HB_COMPAT_C53
>       HB_COMPAT_XPP
>       HB_COMPAT_VO
>       HB_COMPAT_FLAGSHIP
>       HB_COMPAT_FOXPRO
>       HB_COMPAT_DBASE
>       HB_COMPAT_CLIP
>       HB_COMPAT_XHB
>       HB_SHORTNAMES
>       HB_FILE_VER_STATIC
>

I had just finished to do same work :-(,
but the important thing is the result ;-)
Thanks

Now I'm finishing last tests on gd and I'm uploading fixies.

Ah, as proposal, could be anyone interested if I add switched (from 
hbsetup.ch) version of hbrun that could be used also with integraded gd ?
Lorenzo ?

regards

Francesco
From info at fsgiudice.com  Sat Apr 14 07:38:41 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Sat Apr 14 07:39:22 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 13:36 UTC+0200 Francesco Saverio
	Giudice (info/at/fsgiudice.com)
References: <01c77e81$Blat.v2.6.1$b2c6aad6$d9ce0cf8d7c@127.0.0.1>
	<001301c77e83$dd066d70$b400a8c0@ASUSFSG>
Message-ID: <001801c77e89$74191a50$b400a8c0@ASUSFSG>

2007-04-14 13:36 UTC+0200 Francesco Saverio Giudice (info/at/fsgiudice.com)
   * harbour/bin/bld.bat
     * added HB_USER_LIB var to bcc link line to make usable bldtest.bat
       Question: Is there a way to build from bcc adding contrib libs ?

   - harbour/contrib/gd/hbgd.txt
   + harbour/contrib/gd/doc/hbgd.txt
     * moved in doc dir

   + harbour/contrib/gd/doc/COPYING
     + gd copyright text (it's free for any use, but this file has to be
                          reported)

   + harbour/contrib/gd/include/entities.h
   + harbour/contrib/gd/include/gd.h
   + harbour/contrib/gd/include/gd_io.h
   + harbour/contrib/gd/include/gdcache.h
   + harbour/contrib/gd/include/gdfontg.h
   + harbour/contrib/gd/include/gdfontl.h
   + harbour/contrib/gd/include/gdfontmb.h
   + harbour/contrib/gd/include/gdfonts.h
   + harbour/contrib/gd/include/gdfontt.h
   + harbour/contrib/gd/include/gdfx.h
   + harbour/contrib/gd/include/gdhelpers.h
   + harbour/contrib/gd/include/jisx0208.h
   + harbour/contrib/gd/include/wbmp.h
     + include files for compiling in windows environment

   + harbour/contrib/gd/tests/digits/57chevy.gif
   + harbour/contrib/gd/tests/digits/7seg.gif
   + harbour/contrib/gd/tests/digits/brsd.gif
   + harbour/contrib/gd/tests/digits/digib.gif
   + harbour/contrib/gd/tests/digits/fdb.gif
   + harbour/contrib/gd/tests/digits/jelly.gif
   + harbour/contrib/gd/tests/digits/odb.gif
   + harbour/contrib/gd/tests/digits/odw.gif
   + harbour/contrib/gd/tests/digits/pdg.gif
   + harbour/contrib/gd/tests/digits/pdw.gif
     + digits images for counter.prg sample

   + harbour/contrib/gd/gdexternal.ch
     + external declarations for use with linker

   + harbour/contrib/gd/make_b32.bat
   + harbour/contrib/gd/makefile.bc
   + harbour/contrib/gd/tests/bldtest.bat
   + harbour/contrib/gd/tests/bldtest.sh
     + make files

   * harbour/contrib/gd/tests/images_in/conv_test.jpeg
   * harbour/contrib/gd/tests/images_in/gdlogobig.png
   * harbour/contrib/gd/tests/images_in/theclipper.gif
     * updated images (I got them corrupted, probably is CVS ?)

   * harbour/contrib/gd/README
   * harbour/contrib/gd/gd.prg
   * harbour/contrib/gd/gdbar.prg
   * harbour/contrib/gd/gdbarcod.prg
   * harbour/contrib/gd/gdchart.prg
   * harbour/contrib/gd/gdimage.prg
   * harbour/contrib/gd/gdwrp.c
   * harbour/contrib/gd/tests/animgif.prg
   * harbour/contrib/gd/tests/antialiased.prg
   * harbour/contrib/gd/tests/barms.prg
   * harbour/contrib/gd/tests/bartest.prg
   * harbour/contrib/gd/tests/counter.prg
   * harbour/contrib/gd/tests/gdtestcls.prg
   * harbour/contrib/gd/tests/test_out.prg
   * harbour/contrib/gd/tests/testdpi.prg
   * harbour/contrib/gd/tests/tostring.prg
     * fixed hbgd files

     ! Please test in other environment.
       I have built harbour as downloaded from CVS,
       no HB_COMPAT_XHB defined


Regards

Francesco Saverio Giudice
From info at fsgiudice.com  Sat Apr 14 07:48:04 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Sat Apr 14 07:48:46 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 13:47 UTC+0200 Francesco Saverio
	Giudice (info/at/fsgiudice.com)
References: <01c77e81$Blat.v2.6.1$b2c6aad6$d9ce0cf8d7c@127.0.0.1><001301c77e83$dd066d70$b400a8c0@ASUSFSG>
	<001801c77e89$74191a50$b400a8c0@ASUSFSG>
Message-ID: <001d01c77e8a$c4496740$b400a8c0@ASUSFSG>

2007-04-14 13:47 UTC+0200 Francesco Saverio Giudice (info/at/fsgiudice.com)
   * harbour/include/hbcompat.ch
     * added xharbour compatible hash translations

  Missing file from previous commit

Regards

Francesco Saverio Giudice
From harbour.01 at syenar.hu  Sat Apr 14 08:34:10 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 14 08:33:02 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 14:31 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c77e91$Blat.v2.6.1$3366fd76$b70273a7cbc@127.0.0.1>

2007-04-14 14:31 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/include/hbcompat.ch
     ! Added copyright and CVS header.
     ! Indentation fixes.

From lorenzo.fiorini at gmail.com  Sat Apr 14 09:34:23 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr 14 09:34:27 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 11:56 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
In-Reply-To: <01c77e7b$Blat.v2.6.1$f025d77c$b18c1ea068@127.0.0.1>
References: <01c77e7b$Blat.v2.6.1$f025d77c$b18c1ea068@127.0.0.1>
Message-ID: <9257026e0704140634i44eb5cd2l77dca2a7d010b9c0@mail.gmail.com>

On 4/14/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
> 2007-04-14 11:56 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>    * harbour/source/debug/dbgtarr.prg
>      ! Fixed unclosed #if construct.
>        Question: What does HB_NO_READDBG do?

Sorry I forgot to test the code without HB_NO_READDBG.

HB_NO_READDBG allow to link debugger with an application that uses a
modified getsys.prg.
If not gcc gives duplicates function name errors and more important
debugger "debugs itsef".

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Sat Apr 14 09:35:38 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr 14 09:35:41 2007
Subject: [Harbour] get error
In-Reply-To: <DD587A3E-311D-4704-A81E-CB7B2B1C8257@syenar.hu>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
	<7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
	<A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>
	<9257026e0704131024s3833135dka592bbb9b2fcf1f5@mail.gmail.com>
	<3EC7E25B-7088-475C-BCCF-9D1ABD30A7D7@syenar.hu>
	<9257026e0704131226m3ed8ed51m1a359d93e73dac16@mail.gmail.com>
	<DD587A3E-311D-4704-A81E-CB7B2B1C8257@syenar.hu>
Message-ID: <9257026e0704140635o171236ccj67f83a2dfa657aa3@mail.gmail.com>

On 4/13/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> After that move we'd need to find out which call inside :UpdateBuffer()
> causes the strange edit behaviour we're seeing.

I've found the problem.

In fact it is more in tgetlist.prg where PostValidate uses
UpdateBuffer instead of Assign.

But this does not solve the problem of "multiple" ::varget() used in tget.

I've added xVarGet to temporary store the value.

I'm testing it.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Sat Apr 14 10:06:53 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr 14 10:06:56 2007
Subject: [Harbour] OT: vfat umask and file permissions
Message-ID: <9257026e0704140706t466f5fd8ree36be226fff3292@mail.gmail.com>

After googling a lot I still can't figure out how to solve this:

When I create a file in my dev dir it has 755 while on "standard" dirs
it has correctly 644.
My dev dirs are on fat32 partition to allow me to build my apps under Windows.
But if I change etc/fstab umask I can't access dirs.

It seems to me there is no solution but I hope I'm wrong.

Any idea?

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Sat Apr 14 13:37:22 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 14 13:37:20 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 12:40 UTC+0100 Viktor
	Szakats(harbour.01 syenar.hu)
In-Reply-To: <001301c77e83$dd066d70$b400a8c0@ASUSFSG>
References: <01c77e81$Blat.v2.6.1$b2c6aad6$d9ce0cf8d7c@127.0.0.1>
	<001301c77e83$dd066d70$b400a8c0@ASUSFSG>
Message-ID: <A2674316-0633-4C11-B8AD-D9F169CDA5CD@syenar.hu>

>>       HB_SHORTNAMES
>>       HB_FILE_VER_STATIC
>>
>
> I had just finished to do same work :-(,

Ops, sorry Francesco.

Brgds,
Viktor

> but the important thing is the result ;-)
> Thanks
>
> Now I'm finishing last tests on gd and I'm uploading fixies.
>
> Ah, as proposal, could be anyone interested if I add switched (from  
> hbsetup.ch) version of hbrun that could be used also with  
> integraded gd ?
> Lorenzo ?
>
> regards
>
> Francesco

From info at fsgiudice.com  Sat Apr 14 15:19:45 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Sat Apr 14 15:20:38 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 12:40 UTC+0100 Viktor
	Szakats(harbour.01 syenar.hu)
References: <01c77e81$Blat.v2.6.1$b2c6aad6$d9ce0cf8d7c@127.0.0.1>
	<001301c77e83$dd066d70$b400a8c0@ASUSFSG>
	<A2674316-0633-4C11-B8AD-D9F169CDA5CD@syenar.hu>
Message-ID: <000301c77ec9$e3ea2e10$6501a8c0@ASUSFSG>

Viktor,

>>
>> I had just finished to do same work :-(,
> 
> Ops, sorry Francesco.
> 

no problem at all, you are welcome

regards

Francesco
From sircaulises at gmail.com  Sat Apr 14 20:47:50 2007
From: sircaulises at gmail.com (Sirca Ulises)
Date: Sat Apr 14 20:47:48 2007
Subject: [Harbour] TRY CATCH
Message-ID: <007401c77ef7$b3311a30$3e02a8c0@PORTATIL>

Hello,

 

Is TRY 
 CATCH supported in Harbour ??

 

Thank you,

 

Fernando

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070415/cd2caf33/attachment.html
From niki at synel.co.il  Sun Apr 15 02:04:37 2007
From: niki at synel.co.il (Chen Kedem)
Date: Sun Apr 15 02:05:23 2007
Subject: [Harbour] CHANGELOG: 2007-04-14 13:36 UTC+0200 Francesco Saverio
	Giudice (info/at/fsgiudice.com)
Message-ID: <4621C075.3D48@synel.co.il>

Francesco,

>  * harbour/contrib/gd/tests/images_in/conv_test.jpeg
>  * harbour/contrib/gd/tests/images_in/gdlogobig.png
>  * harbour/contrib/gd/tests/images_in/theclipper.gif
>    * updated images (I got them corrupted, probably is CVS ?)

You did not mark them as BINARY files for the CVS! You must do
something like the following to fix it:

---CVS doc---
Here is an example of how you can create a new file using the `-kb'
flag: 

$ echo '$Id$' > kotest
$ cvs add -kb -m"A test file" kotest
$ cvs ci -m"First checkin; contains a keyword" kotest

If a file accidentally gets added without `-kb', one can use the cvs
admin command to recover. For
example: 

$ echo '$Id$' > kotest
$ cvs add -m"A test file" kotest
$ cvs ci -m"First checkin; contains a keyword" kotest
$ cvs admin -kb kotest
$ cvs update -A kotest
# For non-unix systems:
# Copy in a good copy of the file from outside CVS
$ cvs commit -m "make it binary" kotest
---CVS doc---


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From niki at synel.co.il  Sun Apr 15 03:50:51 2007
From: niki at synel.co.il (Chen Kedem)
Date: Sun Apr 15 03:51:40 2007
Subject: [Harbour] CodeGuard error in hbver
Message-ID: <4621D95B.19C2@synel.co.il>

In source/common/hbver.h function hb_verPCode():

The allocated buffer is 24 bytes, but 32 is passed to snprintf as
the buffer length, which makes CodeGuad edgy.

--From----
char * hb_verPCode( void )
{
   char * pszPCode;

   HB_TRACE(HB_TR_DEBUG, ("hb_verPCode()"));

   pszPCode = ( char * ) hb_xgrab( 24 );

   snprintf( pszPCode, 32, "PCode version: %d.%d",
             HB_PCODE_VER >> 8, HB_PCODE_VER & 0xff );

   return pszPCode;
}
----------

--Change Into----
char * hb_verPCode( void )
{
   char * pszPCode;

   HB_TRACE(HB_TR_DEBUG, ("hb_verPCode()"));

   pszPCode = ( char * ) hb_xgrab( 24 );

   snprintf( pszPCode, 24, "PCode version: %d.%d",
             HB_PCODE_VER >> 8, HB_PCODE_VER & 0xff );

   return pszPCode;
}
-----------------

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From info at fsgiudice.com  Sun Apr 15 05:25:51 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Sun Apr 15 05:26:44 2007
Subject: [Harbour] CHANGELOG: 2007-04-15 11:20 UTC+0200 Francesco Saverio
	Giudice (info/at/fsgiudice.com)
References: <4621C075.3D48@synel.co.il>
Message-ID: <000401c77f40$1354d670$6501a8c0@ASUSFSG>


2007-04-15 11:20 UTC+0200 Francesco Saverio Giudice (info/at/fsgiudice.com)
   + harbour/contrib/gd/tests/images_in/conv_test.jpeg
   + harbour/contrib/gd/tests/images_in/gdlogobig.png
   + harbour/contrib/gd/tests/images_in/theclipper.gif
     + uploaded in binary form

2007-04-15 11:17 UTC+0200 Francesco Saverio Giudice (info/at/fsgiudice.com)
   - harbour/contrib/gd/tests/images_in/empty.jpeg
   - harbour/contrib/gd/tests/images_in/conv_test.jpeg
   - harbour/contrib/gd/tests/images_in/gdlogobig.png
   - harbour/contrib/gd/tests/images_in/theclipper.gif
     - removed from CVS because not marked as binary
       I will upload them in binary form on next commit,
       but not empty.jpeg


----- Original Message ----- 
From: "Chen Kedem" <niki@synel.co.il>
To: <harbour@harbour-project.org>
Sent: Sunday, April 15, 2007 8:04 AM
Subject: [Harbour] CHANGELOG: 2007-04-14 13:36 UTC+0200 Francesco 
SaverioGiudice (info/at/fsgiudice.com)


> Francesco,
>
>>  * harbour/contrib/gd/tests/images_in/conv_test.jpeg
>>  * harbour/contrib/gd/tests/images_in/gdlogobig.png
>>  * harbour/contrib/gd/tests/images_in/theclipper.gif
>>    * updated images (I got them corrupted, probably is CVS ?)
>
> You did not mark them as BINARY files for the CVS! You must do
> something like the following to fix it:
>


Chen,
thank you. I didn't realized that first upload made from Lorenzo was done 
not in correct way.
Now it works as needed.

Regards

Francesco
From lorenzo.fiorini at gmail.com  Sun Apr 15 06:34:37 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr 15 06:34:40 2007
Subject: [Harbour] CHANGELOG: 2007-04-15 11:20 UTC+0200 Francesco Saverio
	Giudice (info/at/fsgiudice.com)
In-Reply-To: <000401c77f40$1354d670$6501a8c0@ASUSFSG>
References: <4621C075.3D48@synel.co.il>
	<000401c77f40$1354d670$6501a8c0@ASUSFSG>
Message-ID: <9257026e0704150334j805d9eald26a190c5341c134@mail.gmail.com>

On 4/15/07, Francesco Saverio Giudice <info@fsgiudice.com> wrote:

> Chen,
> thank you. I didn't realized that first upload made from Lorenzo was done
> not in correct way.
> Now it works as needed.

Francesco, Chen, sorry it has been my fault.

regards,
Lorenzo Fiorini
From lorenzo.fiorini at gmail.com  Sun Apr 15 06:43:03 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr 15 06:43:06 2007
Subject: [Harbour] get error
In-Reply-To: <9257026e0704140635o171236ccj67f83a2dfa657aa3@mail.gmail.com>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
	<7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
	<A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>
	<9257026e0704131024s3833135dka592bbb9b2fcf1f5@mail.gmail.com>
	<3EC7E25B-7088-475C-BCCF-9D1ABD30A7D7@syenar.hu>
	<9257026e0704131226m3ed8ed51m1a359d93e73dac16@mail.gmail.com>
	<DD587A3E-311D-4704-A81E-CB7B2B1C8257@syenar.hu>
	<9257026e0704140635o171236ccj67f83a2dfa657aa3@mail.gmail.com>
Message-ID: <9257026e0704150343r51af64b3ue14c3968886de0c8@mail.gmail.com>

On 4/14/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

> I'm testing it.

It seems working but I'd like that you test it also.

What should I do commit or send it to you?

regards,
Lorenzo
From harbour.01 at syenar.hu  Sun Apr 15 06:49:05 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sun Apr 15 06:49:02 2007
Subject: [Harbour] get error
In-Reply-To: <9257026e0704150343r51af64b3ue14c3968886de0c8@mail.gmail.com>
References: <9257026e0704120102l54170c21s6dbd3c9fb48f52bb@mail.gmail.com>
	<5494B2AD-77B0-4889-97CC-2E81AF56B555@syenar.hu>
	<9257026e0704130857n3c3f45a1hbf15892f033a9eb9@mail.gmail.com>
	<7D79DE31-1587-49A8-8E0D-2ACE2417B515@syenar.hu>
	<A240E326-74D2-4E3B-9B0A-DEF3690B29C9@syenar.hu>
	<9257026e0704131024s3833135dka592bbb9b2fcf1f5@mail.gmail.com>
	<3EC7E25B-7088-475C-BCCF-9D1ABD30A7D7@syenar.hu>
	<9257026e0704131226m3ed8ed51m1a359d93e73dac16@mail.gmail.com>
	<DD587A3E-311D-4704-A81E-CB7B2B1C8257@syenar.hu>
	<9257026e0704140635o171236ccj67f83a2dfa657aa3@mail.gmail.com>
	<9257026e0704150343r51af64b3ue14c3968886de0c8@mail.gmail.com>
Message-ID: <1212A035-88AE-402F-8BD4-5A4B078BEC30@syenar.hu>

Hi Lorenzo,

Send it to my mail address directly, I'll check it.

Brgds,
Viktor

On 2007.04.15., at 12:43, Lorenzo Fiorini wrote:

> On 4/14/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:
>
>> I'm testing it.
>
> It seems working but I'd like that you test it also.
>
> What should I do commit or send it to you?
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Sun Apr 15 08:13:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 08:14:18 2007
Subject: [Harbour] OT: vfat umask and file permissions
In-Reply-To: <9257026e0704140706t466f5fd8ree36be226fff3292@mail.gmail.com>
References: <9257026e0704140706t466f5fd8ree36be226fff3292@mail.gmail.com>
Message-ID: <20070415121342.GA5532@localhost.localdomain>

On Sat, 14 Apr 2007, Lorenzo Fiorini wrote:
> After googling a lot I still can't figure out how to solve this:
> When I create a file in my dev dir it has 755 while on "standard" dirs
> it has correctly 644.
> My dev dirs are on fat32 partition to allow me to build my apps under 
> Windows.
> But if I change etc/fstab umask I can't access dirs.
> It seems to me there is no solution but I hope I'm wrong.
> Any idea?

add 'showexec' to mount options in your fstab.

best regards,
Przemek
From druzus at priv.onet.pl  Sun Apr 15 08:20:21 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 08:20:56 2007
Subject: [Harbour] ChangeLog 2007-04-13 11:50 UTC+0200 Lorenzo Fiorini
In-Reply-To: <9257026e0704130947o5e95ce2brbf5c1675e14dfc3f@mail.gmail.com>
References: <9257026e0704130257r346364c2ifc8850c413b038a6@mail.gmail.com>
	<20070413112803.GA18075@localhost.localdomain>
	<9257026e0704130947o5e95ce2brbf5c1675e14dfc3f@mail.gmail.com>
Message-ID: <20070415122021.GB5532@localhost.localdomain>

On Fri, 13 Apr 2007, Lorenzo Fiorini wrote:
> >Just only few notes
> >about some modifications I made porting debugger code from xHarbour.
> I get this at the end of my apps build with -B. It does not happen in
> simple tests.
> Any suggestion where should I start to look to reproduce it in a test?

It's caused by very dangerous method of activating debugger.
If any of debug PCODEs is executed before HB_P_MODULNAME or
debugger ignores HB_P_MODULNAME we have GPF. Such ignored
HB_P_MODULNAME was the reason of GPF in code like:

    static s:={||NIL}
    proc main()
       eval(s)
    return

I'll fix compiler to add (_INITSTATICS) HB_P_MODULNAME in static
initialization but in fact we should change debugger API which
is simply too dangerous now.

best regards,
Przemek
From druzus at priv.onet.pl  Sun Apr 15 08:32:29 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 08:33:04 2007
Subject: [Harbour] xHarbour vs Harbour debugger
In-Reply-To: <461FB9CF.7030905@dbtopas.lt>
References: <9257026e0704120246u7a4d2834me431f82a61c86869@mail.gmail.com>
	<20070412122846.GC27341@localhost.localdomain>
	<461FB9CF.7030905@dbtopas.lt>
Message-ID: <20070415123229.GC5532@localhost.localdomain>

On Fri, 13 Apr 2007, Mindaugas Kavaliauskas wrote:
> I'm also using printf() or look at the error.log file to find bugs, but 
> I never use debugger. But I still find useful debugger functions to find 
> reason of seldom GPF or recursive error blocks, or some other "mystic" 
> error like errors in destructors. I just log function name, stack depth 
> and line number of every HB_P_LINE instructions. This debugging could be 
> switched on without recompiling source with /b switch.
> I've modified hvm.c logic of s_bDebug* variables and make to accomplish 
> this task. But it seems many things can be optimised: 
> s_bDebuggerIsWorking is not used at all! We can delete it.
> It seems (I've not tested yet) s_bDebugShowLines can also be removed, we 
> just need to change hb_vmLocalName(), etc., to:
> static void hb_vmLocalName( USHORT uiLocal, char * szLocalName )
> {
>    if( s_pDynsDbgEntry )
>    {
>       s_bDebugging = FALSE;
> 
>       if ( hb_vm_pFunDbgEntry )
>          ...
>       else
>       {
>          ...
>       }
> 
>       s_bDebugging = TRUE;
>    }
> }

Yes. Some parts of debugger interface in HVM seem to be an old unused code.
I've never planed to work on debugger and I haven't tried to change it so
far but if we want to make sth with debugger now then I suggest to change
used API to make it safer and remove old unused code.

> To implement the idea of HB_P_LINE logging it's enough to change hvm.c 
> module:
>   case HB_P_LINE:
>      ...
>      if( s_bDebugging | s_bDebugTraceLines )
>            hb_vmDebuggerShowLine( ... );
>      ...
> 
> HB_EXPORT void hb_vmSetTraceLines( BOOL bTrace )
> {
>    s_bDebugTraceLines = bTrace;
> }
> 
> The rest of code is a small module I'm using:
[...]

The idea logging HB_P_LINE pcodes is really nice and many people
will find very useful. IMHO we should add some basic support for
it to HVM.

> The drawback of this is that it conflicts with standard debugger for 
> hb_vm_pFunDbgEntry.

It's a problem only with current API. We can quite easy resolve it
cleaning the debugger interface in HVM.

best regards,
Przemek
From druzus at priv.onet.pl  Sun Apr 15 08:37:26 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 08:38:01 2007
Subject: [Harbour] ChangeLog 2007-04-15 14:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070415123726.GA2757@localhost.localdomain>

2007-04-15 14:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/compiler/hbmain.c
  * harbour/source/vm/dbgentry.c
  * harbour/source/vm/hvm.c
    ! fixed GPF in debugger

best regards,
Przemek
From druzus at priv.onet.pl  Sun Apr 15 08:41:40 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 08:42:15 2007
Subject: [Harbour] CodeGuard error in hbver
In-Reply-To: <4621D95B.19C2@synel.co.il>
References: <4621D95B.19C2@synel.co.il>
Message-ID: <20070415124140.GB2757@localhost.localdomain>

On Sun, 15 Apr 2007, Chen Kedem wrote:
> In source/common/hbver.h function hb_verPCode():
> The allocated buffer is 24 bytes, but 32 is passed to snprintf as
> the buffer length, which makes CodeGuad edgy.

Yes, sure. Stupid typo. Many thanks for information.
I'll fix it in a while.

best regards,
Przemek
From druzus at priv.onet.pl  Sun Apr 15 08:54:58 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 08:55:32 2007
Subject: [Harbour] TRY CATCH
In-Reply-To: <007401c77ef7$b3311a30$3e02a8c0@PORTATIL>
References: <007401c77ef7$b3311a30$3e02a8c0@PORTATIL>
Message-ID: <20070415125458.GC2757@localhost.localdomain>

On Sun, 15 Apr 2007, Sirca Ulises wrote:
> Hello,
> Is TRY 
 CATCH supported in Harbour ??

TRAY/CATCH/FINALLY/END is exactly the same as BEGIN SEQUENCE/RECOVE/ALWAYS/END
with error block set to break(oErr)

   #xcommand TRY              => BEGIN SEQUENCE
   #xcommand CATCH [<!oErr!>] => RECOVER [USING <oErr>] <-oErr->
   #xcommand FINALLY          => ALWAYS

   PROC MAIN()
      LOCAL l, oErr
      errorblock({|oErr|break(oErr)})
      TRY
         l += "ABC"
      CATCH oErr
         ? "Error:", oErr:subcode, oErr:description, oErr:operation
      END
   RETURN


best regards,
Przemek
From druzus at priv.onet.pl  Sun Apr 15 09:00:09 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 09:00:45 2007
Subject: [Harbour] ChangeLog 2007-04-15 14:57 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070415130009.GA3461@localhost.localdomain>

2007-04-15 14:57 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/common/hbver.c
    ! fixed typo in buffer size passed to snprintf()

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Sun Apr 15 10:54:12 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr 15 10:54:16 2007
Subject: [Harbour] ChangeLog 2007-04-15 14:35 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070415123726.GA2757@localhost.localdomain>
References: <20070415123726.GA2757@localhost.localdomain>
Message-ID: <9257026e0704150754s735026b0o1228301bc924f8f2@mail.gmail.com>

On 4/15/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> 2007-04-15 14:35 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/source/compiler/hbmain.c
>   * harbour/source/vm/dbgentry.c
>   * harbour/source/vm/hvm.c
>     ! fixed GPF in debugger

Thanks, it's ok now.

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Sun Apr 15 11:15:15 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr 15 11:15:18 2007
Subject: [Harbour] OT: vfat umask and file permissions
In-Reply-To: <20070415121342.GA5532@localhost.localdomain>
References: <9257026e0704140706t466f5fd8ree36be226fff3292@mail.gmail.com>
	<20070415121342.GA5532@localhost.localdomain>
Message-ID: <9257026e0704150815j5d3d6593xe19dcb3802618383@mail.gmail.com>

On 4/15/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> add 'showexec' to mount options in your fstab.

Thanks for the hint but it doesn't solve the problem.
I build my local harbour in vfat also for linux and without 755 it
doesn't run ppgen or harbour.

Probably it is better to move the dev dir into a real ext3 partition.

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Sun Apr 15 12:01:50 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sun Apr 15 12:01:53 2007
Subject: [Harbour] gtxwc and euro sign
Message-ID: <9257026e0704150901r542a7805o3342b6d1f00ce55f@mail.gmail.com>

In xHarbour/source/rtl/gtxwc I've added an hack to support euro sign.

I've added this in hb_gt_xwc_ProcessKey:

      if ( outISO == 0x20ac )
      {
         buf[0] = (BYTE) 0x80;
         n = 1;
      }

but under harbour I get only a "square".

Any hint?

regards,
Lorenzo Fiorini
From sircaulises at gmail.com  Sun Apr 15 14:40:22 2007
From: sircaulises at gmail.com (Sirca Ulises)
Date: Sun Apr 15 14:43:32 2007
Subject: [Harbour] TRY CATCH
In-Reply-To: <20070415125458.GC2757@localhost.localdomain>
References: <007401c77ef7$b3311a30$3e02a8c0@PORTATIL>
	<20070415125458.GC2757@localhost.localdomain>
Message-ID: <002601c77f8d$88455570$3e02a8c0@PORTATIL>

Hi Przemek,


>>TRAY/CATCH/FINALLY/END is exactly the same as BEGIN
>>SEQUENCE/RECOVE/ALWAYS/END
>>with error block set to break(oErr)

>>   #xcommand TRY              => BEGIN SEQUENCE
>>   #xcommand CATCH [<!oErr!>] => RECOVER [USING <oErr>] <-oErr->
>>   #xcommand FINALLY          => ALWAYS

>>   PROC MAIN()
>>      LOCAL l, oErr
>>      errorblock({|oErr|break(oErr)})
>>      TRY
>>         l += "ABC"
>>      CATCH oErr
>>         ? "Error:", oErr:subcode, oErr:description, oErr:operation
>>      END
>>   RETUR

Thank you very much, It's work fine.

That Harbour Support:

SWITCH ...

CASE ...

END

Best Regards,

Fernando

From druzus at priv.onet.pl  Sun Apr 15 18:20:51 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 18:21:28 2007
Subject: [Harbour] ChangeLog 2007-04-16 00:20 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070415222051.GA5645@localhost.localdomain>

2007-04-16 00:20 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/common.mak
  * harbour/bin/pack_src.sh
  * harbour/source/vm/Makefile
  - harbour/source/vm/dbgentry.c
  * harbour/source/debug/Makefile
  + harbour/source/debug/dbgentry.c
    * moved dbgentry.c from HVM to DEBUG library

  * harbour/source/rtl/hbgtcore.c
    + added basic version of GTI_{NEW,GET,SET}WIN

  * harbour/include/hbapidbg.h
  * harbour/source/vm/hvm.c
  * harbour/source/debug/debugger.prg
  * harbour/source/debug/dbgentry.c
    + added set of .prg level functions (HB_DBG_*()) to control
      debugger internals
    * eliminated HB_INLINE() calls
    * use GTI_{NEW,GET,SET}WIN to switch between user and debugger screen
    * cleaned debugger interface in HVM, removed unused variables and
      added one common debug function
From druzus at priv.onet.pl  Sun Apr 15 19:50:18 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sun Apr 15 19:50:54 2007
Subject: [Harbour] ChangeLog 2007-04-16 01:50 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070415235018.GA27524@localhost.localdomain>

2007-04-16 01:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/debug/debugger.prg
    * removed some not longer necessary GTWVW extensions

  * harbour/source/rtl/hbgtcore.c
  * harbour/contrib/libct/ctwin.c
    + added support for GTI_{NEW,GET,SET}WIN in CTWIN
      Now debugger can be used with CTWIN without any problems

best regards,
Przemek
From sircaulises at gmail.com  Mon Apr 16 02:27:16 2007
From: sircaulises at gmail.com (Sirca Ulises)
Date: Mon Apr 16 02:27:19 2007
Subject: [Harbour] OLE support
Message-ID: <005201c77ff0$4a7293d0$3e02a8c0@PORTATIL>

Hi Przemek,

 

OLE support is very important for those of us who use Harbour on Windows.

 

Would it be possible to borrow win32ole.prg from xHarbour into Harbour ?

 

I have tried to build it but it seems that Harbour is not able to compile
it.

 

many thanks,

 

Fernando

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070416/e8e5f31c/attachment.html
From e.m.giordano at emagsoftware.it  Mon Apr 16 02:48:48 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Mon Apr 16 02:49:23 2007
Subject: [Harbour] OLE support
References: <005201c77ff0$4a7293d0$3e02a8c0@PORTATIL>
Message-ID: <003901c77ff3$495bec50$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Sirca Ulises" <sircaulises@gmail.com>
A: "'Harbour Project Main Developer List.'" <harbour@harbour-project.org>
Data invio: luned? 16 aprile 2007 8.27
Oggetto: [Harbour] OLE support


> Hi Przemek,
>
> OLE support is very important for those of us who use Harbour on Windows.
>
> Would it be possible to borrow win32ole.prg from xHarbour into Harbour ?

I strongly agree!

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From antonioharbour at gmail.com  Mon Apr 16 05:24:13 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 03:24:31 2007
Subject: [Harbour] cvs client
Message-ID: <0257AC70-CFE0-43F1-AEB5-1E910859DDA8@gmail.com>

cvs client for Windows was previously offered as a download from the  
Harbour website, but now the downloads page goes to sourceforge for  
Harbour packages only

Could we provide a url from Harbour website to download cvs ?

BTW, where may it be downloaded from ? :-)

regards,

Antonio
From niki at synel.co.il  Mon Apr 16 04:16:53 2007
From: niki at synel.co.il (Chen Kedem)
Date: Mon Apr 16 04:17:39 2007
Subject: [Harbour] cvs client
Message-ID: <462330F5.3D09@synel.co.il>

Antonio,

> BTW, where may it be downloaded from ? :-)

This is the CVS site: http://www.nongnu.org/cvs/

And here is the download direcories:
http://ftp.gnu.org/non-gnu/cvs/binary/stable/

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From harbour.01 at syenar.hu  Mon Apr 16 04:19:36 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 04:19:41 2007
Subject: [Harbour] Compiler error content bug
Message-ID: <F895CB5B-8C16-4B1C-B6C1-834210C43D94@syenar.hu>

Hi,

In this reduced example:

--- ap.ch
MEMVAR test
--- ap_menu.prg
#include "ap.ch"
#include "nonexistent.ch"
---

To "harbour /n ap_menu.prg"

Harbour says the following:
"ap.ch(2) Error F0028  Can't open #include file: 'nonexistent.ch"

While it should say:
"ap_menu.prg(2) Error F0028  Can't open #include file: 'nonexistent.ch"

Brgds,
Viktor

From antonioharbour at gmail.com  Mon Apr 16 04:20:23 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 04:20:41 2007
Subject: [Harbour] cvs client
In-Reply-To: <462330F5.3D09@synel.co.il>
Message-ID: <462331d4.45a20a92.266a.ffffda70@mx.google.com>

Chen, 

>> BTW, where may it be downloaded from ? :-)

> This is the CVS site: http://www.nongnu.org/cvs/
> And here is the download direcories:
> http://ftp.gnu.org/non-gnu/cvs/binary/stable/

Thanks,

Alexander, we should provide such info somewhere on the Harbour website,
thanks

Regards,

Antonio

From druzus at priv.onet.pl  Mon Apr 16 05:44:07 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 05:44:43 2007
Subject: [Harbour] ChangeLog 2007-04-16 11:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070416094407.GA15086@localhost.localdomain>

2007-04-16 11:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/compiler/hbmain.c
  * harbour/source/compiler/ppcomp.c
    ! fixed file name in errors/warnings generated from PP just after
      including some file

best regards,
Przemek
From harbour.01 at syenar.hu  Mon Apr 16 05:51:27 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 05:51:28 2007
Subject: [Harbour] ChangeLog 2007-04-16 11:45 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070416094407.GA15086@localhost.localdomain>
References: <20070416094407.GA15086@localhost.localdomain>
Message-ID: <A2D8419B-9964-493D-945D-1C0899138C0E@syenar.hu>

Many thanks Przemek.

Brgds,
Viktor

On 2007.04.16., at 11:44, Przemyslaw Czerpak wrote:

> 2007-04-16 11:45 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/source/compiler/hbmain.c
>   * harbour/source/compiler/ppcomp.c
>     ! fixed file name in errors/warnings generated from PP just after
>       including some file
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From niki at synel.co.il  Mon Apr 16 06:27:30 2007
From: niki at synel.co.il (Chen Kedem)
Date: Mon Apr 16 06:28:21 2007
Subject: [Harbour] Request for Admin privilege in the SF Feature Requests
	section
Message-ID: <46234F92.550A@synel.co.il>

Can one of the project admin would give me "Admin" privilege
in the SourseForge "Feature Requests" section so I could edit/close
requests.

User: ckedem

Thanks,

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From druzus at priv.onet.pl  Mon Apr 16 06:44:11 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 06:44:46 2007
Subject: [Harbour] OLE support
In-Reply-To: <005201c77ff0$4a7293d0$3e02a8c0@PORTATIL>
References: <005201c77ff0$4a7293d0$3e02a8c0@PORTATIL>
Message-ID: <20070416104411.GA16283@localhost.localdomain>

On Mon, 16 Apr 2007, Sirca Ulises wrote:
> Hi Przemek,
> OLE support is very important for those of us who use Harbour on Windows.
> Would it be possible to borrow win32ole.prg from xHarbour into Harbour ?

I'm not a MS-Windows user so here I do not help and sorry but I will
not even try. You will have to ask other Windows developers about some
help. F.e. I know that Marek Paliwoda created absolutely independent
OLE implementation but I do not know if he plans to release some public
version for Harbour.

> I have tried to build it but it seems that Harbour is not able to compile
> it.

In my opinion this code does not have enough quality to add it to CVS.
With some small modifications I can hack it and it's possiblt to compile
it and link with Harbour (I've just already done it) but I have no idea
if it will work or not.
I know how to exploit this code even in xHarbour to cause some bad GPFs
or internal HVM memory coruption and for sure my hacks do not fix any
of existing problems.

best regards,
Przemek
From antonioharbour at gmail.com  Mon Apr 16 06:53:43 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 06:54:01 2007
Subject: [Harbour] OLE support
In-Reply-To: <20070416104411.GA16283@localhost.localdomain>
Message-ID: <462355c5.26da828b.4361.0ab6@mx.google.com>

Przemek, 

We are also very much interested on this,

>
With some small modifications I can hack it and it's possiblt to compile it
and link with Harbour (I've just already done it) but I have no idea if it
will work or not.
>

Would you mind to provide your modifications ? We can test it here right now
and we will provide valuable feedback, thanks

Regards,

Antonio


From druzus at priv.onet.pl  Mon Apr 16 07:24:07 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 07:24:42 2007
Subject: [Harbour] Case sensitive COMMANDS and TRANSLATIONS
Message-ID: <20070416112407.GA17059@localhost.localdomain>

Hi All,

We already have:
    #[x][un]command
    #[x][un]translate

and I want to add also case sensitive version of them.
So my question is about the letter used as prefix.
Now "x" is used for rules which should compare whole
identifiers not only xBase like 4 letters.
What should I use for case sensitive rules: "c" or
maybe "y" to be closer to Clipper name convention.
f.e.:
    #ccommand
    #ctranslate
or:
    #ycommand
    #ytranslate
 
or maybe you have other proposition?

best regards,
Przemek
From druzus at priv.onet.pl  Mon Apr 16 07:44:22 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 07:44:58 2007
Subject: [Harbour] OLE support
In-Reply-To: <462355c5.26da828b.4361.0ab6@mx.google.com>
References: <20070416104411.GA16283@localhost.localdomain>
	<462355c5.26da828b.4361.0ab6@mx.google.com>
Message-ID: <20070416114422.GB17059@localhost.localdomain>

On Mon, 16 Apr 2007, Antonio Linares wrote:
> > With some small modifications I can hack it and it's possiblt to compile it
> > and link with Harbour (I've just already done it) but I have no idea if it
> > will work or not.
> Would you mind to provide your modifications ? We can test it here right now
> and we will provide valuable feedback, thanks

Modified file in attachment.
Compile it with harbour compiler to generate .c file then add in first
line of generated file:
    #include "hbvmopt.h"
and compile it with C compiler.
And please remember that any code which uses #include "hbvmopt.h"
is not portable and can stop to work on each next Harbour release
so should not be distributed in binary form only. This header is
reserved for core HVM code and should not be used by any 3-rd party
code. Eliminating hbvmopt.h from win32ole.c is first step to clean
this code so you can try to work on it. You should also eliminate
hb_itemPutCRawStatic() function - we will never have sth like that
in our HVM.

I also disabled FOR EACH support because in Harbour FOR EACH
overloading is differ then in xHarbour and I was to lazy too
write new code for it when I do not believe that rest is worth
of our efforts.
If you need an example how to overload FOR EACH in Harbour then
inform me and I'll create sth and commit to tests/ directory.

best regards,
Przemek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: win32ole.prg.gz
Type: application/x-gzip
Size: 13266 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070416/eee7e7cd/win32ole.prg-0001.gz
From druzus at priv.onet.pl  Mon Apr 16 07:54:59 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 07:55:34 2007
Subject: [Harbour] ChangeLog BETA2 2007-04-16 13:50 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
Message-ID: <20070416115459.GA17848@localhost.localdomain>

2007-04-16 13:50 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/compiler/harbour.c
  * harbour/source/compiler/ppcomp.c
  * harbour/source/rtl/gete.c
    * synced with some important fixes and cleanups in devel branch
      - fixed file name in errors/warnings generated from PP just after
        including some file
      - fixed typo in buffer size passed to snprintf()
      - fixed memory leak in GETENV()
      - fixed memory leak when -build or -credit switches were used

best regards,
Przemek
From harbour.01 at syenar.hu  Mon Apr 16 07:59:42 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 07:59:52 2007
Subject: [Harbour] Case sensitive COMMANDS and TRANSLATIONS
In-Reply-To: <20070416112407.GA17059@localhost.localdomain>
References: <20070416112407.GA17059@localhost.localdomain>
Message-ID: <F62D275B-0AA0-44A7-91C6-7D91A5445E96@syenar.hu>

> and I want to add also case sensitive version of them.
> So my question is about the letter used as prefix.
> Now "x" is used for rules which should compare whole
> identifiers not only xBase like 4 letters.
> What should I use for case sensitive rules: "c" or
> maybe "y" to be closer to Clipper name convention.
> f.e.:
>     #ccommand
>     #ctranslate
> or:
>     #ycommand
>     #ytranslate

I like "y" better.

Or maybe "s" like "strict" or (case)-"sensitive":

#scommand
#stranslate

Brgds,
Viktor



From dbtopas at dbtopas.lt  Mon Apr 16 08:06:46 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Mon Apr 16 08:04:25 2007
Subject: [Harbour] OLE support
In-Reply-To: <20070416104411.GA16283@localhost.localdomain>
References: <005201c77ff0$4a7293d0$3e02a8c0@PORTATIL>
	<20070416104411.GA16283@localhost.localdomain>
Message-ID: <462366D6.8060500@dbtopas.lt>

Hello,


Harbour has OLE module in contrib. I'm using my own simple 
implementation of OLE (even without TOLEAUTO class), because:
1) I use OLE very seldom and need only basic features
2) after some xHarbour OLE changes, it started to fail on simple code:
   oPOS := OleCreateObject("POS.SA97")
   nErr := OleInvoke(oPOS, "Init", "COM1", 9600, 10)
3) xHarbour OLE uses MessageBox() WinAPI instead of standard Clipper 
error handling
4) xHarbour OLE has public function HB_FUN_MESSAGEBOX and this conflicts 
with my own WinAPI library.


Best regards,
DB Topas
From lorenzo.fiorini at gmail.com  Mon Apr 16 08:42:31 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon Apr 16 08:42:34 2007
Subject: [Harbour] Case sensitive COMMANDS and TRANSLATIONS
In-Reply-To: <20070416112407.GA17059@localhost.localdomain>
References: <20070416112407.GA17059@localhost.localdomain>
Message-ID: <9257026e0704160542t46199f4diae72f0c5ee505e9a@mail.gmail.com>

On 4/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> What should I use for case sensitive rules: "c" or
> maybe "y" to be closer to Clipper name convention.
> f.e.:
>     #ccommand
>     #ctranslate
> or:
>     #ycommand
>     #ytranslate

I vote for y.

Like x has nothing to do with "more than 4 char" y has nothing to do
with "case sensitive" :)

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Mon Apr 16 08:47:02 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 08:47:24 2007
Subject: [Harbour] Case sensitive COMMANDS and TRANSLATIONS
In-Reply-To: <9257026e0704160542t46199f4diae72f0c5ee505e9a@mail.gmail.com>
References: <20070416112407.GA17059@localhost.localdomain>
	<9257026e0704160542t46199f4diae72f0c5ee505e9a@mail.gmail.com>
Message-ID: <A62EBBB4-8712-49EE-857E-C1F5B577E599@syenar.hu>


On 2007.04.16., at 14:42, Lorenzo Fiorini wrote:

> On 4/16/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
>
>> What should I use for case sensitive rules: "c" or
>> maybe "y" to be closer to Clipper name convention.
>> f.e.:
>>     #ccommand
>>     #ctranslate
>> or:
>>     #ycommand
>>     #ytranslate
>
> I vote for y.
>
> Like x has nothing to do with "more than 4 char" y has nothing to do
> with "case sensitive" :)

:) And we still have "z" left for future purposes :)

Brgds,
Viktor



From lorenzo.fiorini at gmail.com  Mon Apr 16 09:00:37 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon Apr 16 09:00:41 2007
Subject: [Harbour] Case sensitive COMMANDS and TRANSLATIONS
In-Reply-To: <A62EBBB4-8712-49EE-857E-C1F5B577E599@syenar.hu>
References: <20070416112407.GA17059@localhost.localdomain>
	<9257026e0704160542t46199f4diae72f0c5ee505e9a@mail.gmail.com>
	<A62EBBB4-8712-49EE-857E-C1F5B577E599@syenar.hu>
Message-ID: <9257026e0704160600q7530686ex5aa4c27eb36205bf@mail.gmail.com>

On 4/16/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> :) And we still have "z" left for future purposes :)

Another plus for y :)

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Mon Apr 16 09:11:41 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon Apr 16 09:11:44 2007
Subject: [Harbour] Re: gtxwc and euro sign
In-Reply-To: <9257026e0704150901r542a7805o3342b6d1f00ce55f@mail.gmail.com>
References: <9257026e0704150901r542a7805o3342b6d1f00ce55f@mail.gmail.com>
Message-ID: <9257026e0704160611q3c7387acn2d856a736ef014c8@mail.gmail.com>

On 4/15/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:

> but under harbour I get only a "square".

Sorry, I forgot to copy modified codepage/uc88591b.c also.

BTW are there better solutions?

May I commit it?

regards,
Lorenzo
From niki at synel.co.il  Mon Apr 16 09:34:32 2007
From: niki at synel.co.il (Chen Kedem)
Date: Mon Apr 16 09:35:20 2007
Subject: [Harbour] Re: Request for Admin privilege in the SF Feature
	Requests section
References: <46234F92.550A@synel.co.il>
Message-ID: <46237B68.3435@synel.co.il>

Phil decided to give me full Project Admin (thanks Phil).
I'm notifying the group, so if there are objections, I can remove
myself (I only asked to admin the tracker section).

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From druzus at priv.onet.pl  Mon Apr 16 09:36:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 09:37:17 2007
Subject: [Harbour] Re: gtxwc and euro sign
In-Reply-To: <9257026e0704160611q3c7387acn2d856a736ef014c8@mail.gmail.com>
References: <9257026e0704150901r542a7805o3342b6d1f00ce55f@mail.gmail.com>
	<9257026e0704160611q3c7387acn2d856a736ef014c8@mail.gmail.com>
Message-ID: <20070416133642.GA23062@localhost.localdomain>

On Mon, 16 Apr 2007, Lorenzo Fiorini wrote:
> On 4/15/07, Lorenzo Fiorini <lorenzo.fiorini@gmail.com> wrote:
> >but under harbour I get only a "square".
> Sorry, I forgot to copy modified codepage/uc88591b.c also.
> BTW are there better solutions?

We need valid unicode value for euro sign.
It can be hacked in some other ways but this one is not better or
worser.

> May I commit it?

Yes, uc88591b.c is our own CP so it will not interact with any code
which needs some strict encoding for iso-8859-1.

best regards,
Przemek
From antonioharbour at gmail.com  Mon Apr 16 10:04:06 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 10:04:27 2007
Subject: [Harbour] OLE support
In-Reply-To: <20070416114422.GB17059@localhost.localdomain>
Message-ID: <46238267.706db6ac.266a.0f7e@mx.google.com>

Przemek, 

> Modified file in attachment.

Thanks for sharing it, we are testing it.

Could we include this modified file in Harbour CVS in some folder ?

regards,

Antonio



From harbour.01 at syenar.hu  Mon Apr 16 14:18:21 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 14:18:16 2007
Subject: [Harbour] OLE support
In-Reply-To: <46238267.706db6ac.266a.0f7e@mx.google.com>
References: <46238267.706db6ac.266a.0f7e@mx.google.com>
Message-ID: <6574C7E1-18DF-4533-88F7-42D15530709B@syenar.hu>

Yes, in the contrib folder at this stage IMO.

Brgds,
Viktor

On 2007.04.16., at 16:04, Antonio Linares wrote:

> Przemek,
>
>> Modified file in attachment.
>
> Thanks for sharing it, we are testing it.
>
> Could we include this modified file in Harbour CVS in some folder ?
>
> regards,
>
> Antonio
>
>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Mon Apr 16 14:31:05 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 14:31:40 2007
Subject: [Harbour] Case sensitive COMMANDS and TRANSLATIONS
In-Reply-To: <9257026e0704160600q7530686ex5aa4c27eb36205bf@mail.gmail.com>
References: <20070416112407.GA17059@localhost.localdomain>
	<9257026e0704160542t46199f4diae72f0c5ee505e9a@mail.gmail.com>
	<A62EBBB4-8712-49EE-857E-C1F5B577E599@syenar.hu>
	<9257026e0704160600q7530686ex5aa4c27eb36205bf@mail.gmail.com>
Message-ID: <20070416183105.GA9567@localhost.localdomain>

On Mon, 16 Apr 2007, Lorenzo Fiorini wrote:
> On 4/16/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
> >:) And we still have "z" left for future purposes :)
> Another plus for y :)

OK. Let's chose "y".

best regards,
Przemek
From harbour.01 at syenar.hu  Mon Apr 16 14:32:14 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 14:32:53 2007
Subject: [Harbour] Mac idle problem
Message-ID: <9234DE02-055F-4058-9E8B-971DCCA99F3B@syenar.hu>

Hi Antonio and OS X users,

Is there something we can call under OS X to release
CPU cycles?

(A simple example is ac_test //gtcrs, where CPU
usage stays at 50%)

Brgds,
Viktor

From antonioharbour at gmail.com  Mon Apr 16 14:39:53 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 14:40:13 2007
Subject: [Harbour] OLE support
In-Reply-To: <6574C7E1-18DF-4533-88F7-42D15530709B@syenar.hu>
Message-ID: <4623c309.148768e9.052e.5121@mx.google.com>

Viktor, 

> Yes, in the contrib folder at this stage IMO.

Would you mind to add it to the CVS and upload it ? Many thanks,

Also, Przemek provided instructions to use it could be uploaded too.

We are testing it to check if it works. Up to now it is failing but on
Windows code, not on PRG code, so we need to do more testings.

Regards,

Antonio

From druzus at priv.onet.pl  Mon Apr 16 15:02:39 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 15:03:15 2007
Subject: [Harbour] OLE support
In-Reply-To: <46238267.706db6ac.266a.0f7e@mx.google.com>
References: <20070416114422.GB17059@localhost.localdomain>
	<46238267.706db6ac.266a.0f7e@mx.google.com>
Message-ID: <20070416190239.GB9567@localhost.localdomain>

On Mon, 16 Apr 2007, Antonio Linares wrote:
> > Modified file in attachment.
> Thanks for sharing it, we are testing it.
> Could we include this modified file in Harbour CVS in some folder ?

In contrib/ole we have some ole implementation which seems to be
the base version from which xHarbour one started.
If you want to commit the xHarbour OLE implementation to CVS then
please chose: contrib/ole/altxhb or similar subdirectory in contrib/ole.
I also suggest to start with code like in the attachment. I divided
it into .c and .prg part and added code to set/restore errorblock in
TRY statement.

best regards,
Przemek
-------------- next part --------------
A non-text attachment was scrubbed...
Name: w32ole.tgz
Type: application/x-gzip
Size: 14730 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070416/cdbd9131/w32ole-0001.tgz
From druzus at priv.onet.pl  Mon Apr 16 15:16:03 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 15:16:38 2007
Subject: [Harbour] Mac idle problem
In-Reply-To: <9234DE02-055F-4058-9E8B-971DCCA99F3B@syenar.hu>
References: <9234DE02-055F-4058-9E8B-971DCCA99F3B@syenar.hu>
Message-ID: <20070416191603.GC9567@localhost.localdomain>

On Mon, 16 Apr 2007, Szak?ts Viktor wrote:
> Hi Antonio and OS X users,
> Is there something we can call under OS X to release
> CPU cycles?
> (A simple example is ac_test //gtcrs, where CPU
> usage stays at 50%)

we already have in source/rtl/idle.c:
   #if defined(HB_OS_DARWIN)
      {
         usleep( 1 );
      }
   #else

If it does not work for some reasons as expected you can try to increase
the value or change sleep function. The most portable method to freeze
process for a while in *nixes is select() function, f.e.:

    struct timeval tv;
    tv.tv_sec = 0;
    tv.tv_usec = 1000;
    select( 0, NULL, NULL, NULL, &tv );

best rgards,
Przemek
From lorenzo.fiorini at gmail.com  Mon Apr 16 15:28:33 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon Apr 16 15:28:37 2007
Subject: [Harbour] ChangeLog 2007-04-16 21:25 UTC+0200 Lorenzo Fiorini
Message-ID: <9257026e0704161228w13825b6dl5527511f3bc9807d@mail.gmail.com>

2007-04-16 21:25 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
  * harbour/source/rtl/tget.prg
  * harbour/source/rtl/tgetlist.prg
    * fixed ::UpdateBuffer()
  * source/codepage/uc88591b.c
  * source/rtl/gtxwc/gtxwc.c
    * added support for Euro sign

regards,
Lorenzo Fiorini
From druzus at priv.onet.pl  Mon Apr 16 15:29:47 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 15:30:23 2007
Subject: [Harbour] ChangeLog 2007-04-16 21:30 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070416192947.GA10758@localhost.localdomain>

2007-04-16 21:30 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbcompat.ch
    * always translate hash H*() function to HB_H*() ones even if
      HB_COMPAT_XHB is set. Code which uses HB_H*() functions can
      be linked with any Harbour builds

  * harbour/include/hbapi.h
  * harbour/source/vm/hashes.c
    + added hb_hashId()

  * harbour/source/pp/ppcore.c
    + added #ytranslate, #ycommand, #yuntranslate, #yuncommand
      case sensitive version of corresponding #x* directives

  * harbour/source/rtl/itemseri.c
    + added support for serialization arrays and/or hashes with cyclic
      references

best regards,
Przemek
From druzus at priv.onet.pl  Mon Apr 16 15:30:51 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 15:31:26 2007
Subject: [Harbour] OLE support
In-Reply-To: <4623c309.148768e9.052e.5121@mx.google.com>
References: <6574C7E1-18DF-4533-88F7-42D15530709B@syenar.hu>
	<4623c309.148768e9.052e.5121@mx.google.com>
Message-ID: <20070416193051.GB10758@localhost.localdomain>

On Mon, 16 Apr 2007, Antonio Linares wrote:
> Also, Przemek provided instructions to use it could be uploaded too.

The files I've sent a while ago does not need manual updating during
compilation.

best regards,
Przemek
From antonioharbour at gmail.com  Mon Apr 16 15:31:50 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 15:32:11 2007
Subject: [Harbour] Mac idle problem
In-Reply-To: <9234DE02-055F-4058-9E8B-971DCCA99F3B@syenar.hu>
Message-ID: <4623cf36.4029d8d4.3b0c.086d@mx.google.com>

Viktor, 

> Is there something we can call under OS X to release CPU cycles?

We really don't know it, because as I commented you, we work in GUI mode and
OSX provides and manages its own main messages loop, so we don't have to
care about it.

Regards,

Antonio

From antonioharbour at gmail.com  Mon Apr 16 15:34:21 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 15:34:45 2007
Subject: [Harbour] OLE support
In-Reply-To: <20070416190239.GB9567@localhost.localdomain>
Message-ID: <4623cfcd.55f950b3.3992.4f8f@mx.google.com>

Przemek, 

>
In contrib/ole we have some ole implementation which seems to be the base
version from which xHarbour one started.
If you want to commit the xHarbour OLE implementation to CVS then please
chose: contrib/ole/altxhb or similar subdirectory in contrib/ole.
I also suggest to start with code like in the attachment. I divided it into
.c and .prg part and added code to set/restore errorblock in TRY statement.
>

I do appreciate if you commit it yourself, as you are the author of the
changes. Many thanks.

We are actually testing it as something is going wrong with it (OLE itself)
and still we don't know what it is.

Regards,

Antonio

From harbour.01 at syenar.hu  Mon Apr 16 15:44:42 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 15:44:39 2007
Subject: [Harbour] Mac idle problem
In-Reply-To: <20070416191603.GC9567@localhost.localdomain>
References: <9234DE02-055F-4058-9E8B-971DCCA99F3B@syenar.hu>
	<20070416191603.GC9567@localhost.localdomain>
Message-ID: <9586EC5F-287C-4539-938A-C54A2A4E74AC@syenar.hu>

Thanks, I'll experiment with them.

Brgds,
Viktor

On 2007.04.16., at 21:16, Przemyslaw Czerpak wrote:

> On Mon, 16 Apr 2007, Szak?ts Viktor wrote:
>> Hi Antonio and OS X users,
>> Is there something we can call under OS X to release
>> CPU cycles?
>> (A simple example is ac_test //gtcrs, where CPU
>> usage stays at 50%)
>
> we already have in source/rtl/idle.c:
>    #if defined(HB_OS_DARWIN)
>       {
>          usleep( 1 );
>       }
>    #else
>
> If it does not work for some reasons as expected you can try to  
> increase
> the value or change sleep function. The most portable method to freeze
> process for a while in *nixes is select() function, f.e.:
>
>     struct timeval tv;
>     tv.tv_sec = 0;
>     tv.tv_usec = 1000;
>     select( 0, NULL, NULL, NULL, &tv );
>
> best rgards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Mon Apr 16 15:48:32 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 15:48:33 2007
Subject: [Harbour] Darwin warnings
Message-ID: <8976B1A6-643B-406C-A273-10938847466B@syenar.hu>

../../hbinet.c: In function 'hb_socketConnect':
../../hbinet.c:445: warning: pointer targets in passing argument 5 of  
'getsockopt' differ in signedness
../../hbinet.c: In function 'HB_FUN_HB_INETDGRAMRECV':
../../hbinet.c:1946: warning: pointer targets in passing argument 6  
of 'recvfrom' differ in signedness

According to man, both parameters should be of type "socklen_t *".

../../gtsln.h:73:19: error: slang.h: No such file or directory
(and a large bunch more due to the above)

Brgds,
Viktor

From druzus at priv.onet.pl  Mon Apr 16 16:04:13 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 16:04:47 2007
Subject: [Harbour] Darwin warnings
In-Reply-To: <8976B1A6-643B-406C-A273-10938847466B@syenar.hu>
References: <8976B1A6-643B-406C-A273-10938847466B@syenar.hu>
Message-ID: <20070416200413.GA11141@localhost.localdomain>

On Mon, 16 Apr 2007, Szak?ts Viktor wrote:
> ../../hbinet.c: In function 'hb_socketConnect':
> ../../hbinet.c:445: warning: pointer targets in passing argument 5 of  
> 'getsockopt' differ in signedness
> ../../hbinet.c: In function 'HB_FUN_HB_INETDGRAMRECV':
> ../../hbinet.c:1946: warning: pointer targets in passing argument 6  
> of 'recvfrom' differ in signedness
> According to man, both parameters should be of type "socklen_t *".

And it is. But at line 99 you will find:

   #ifdef HB_OS_DARWIN
      #ifndef socklen_t
         #define socklen_t int
      #endif
   #endif

Probably Phil added it but I have no idea why. I can only guess
that early MacOSX header files were broken and now they are fixed.
Please remove this code.

> ../../gtsln.h:73:19: error: slang.h: No such file or directory
> (and a large bunch more due to the above)

You need to install slang to compile GTSLN.

best regards,
Przemek
From antonioharbour at gmail.com  Mon Apr 16 16:14:25 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 16:14:46 2007
Subject: [Harbour] OLE support
In-Reply-To: <20070416193051.GB10758@localhost.localdomain>
Message-ID: <4623d931.2a9b03f3.5bf8.582b@mx.google.com>

Przemek,

We are testing your new files (thanks!) and they generate the same OLE error
as before:

    s_nOleError = CoCreateInstance( (REFCLSID) &ClassID, NULL,
CLSCTX_SERVER, (REFIID) riid, &pDisp );

    if( ! SUCCEEDED( s_nOleError ) )
       MessageBox( 0, "failed", "ok", 0 ); 	 

We are working to locate where the error may comes from. 

I am reporting this to you FYI and in case you may have a suggestion, thanks

We may test it with xHarbour to see if that makes a difference.

Regards,

Antonio

From druzus at priv.onet.pl  Mon Apr 16 16:15:04 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 16:15:40 2007
Subject: [Harbour] OLE support
In-Reply-To: <4623cfcd.55f950b3.3992.4f8f@mx.google.com>
References: <20070416190239.GB9567@localhost.localdomain>
	<4623cfcd.55f950b3.3992.4f8f@mx.google.com>
Message-ID: <20070416201504.GB11141@localhost.localdomain>

On Mon, 16 Apr 2007, Antonio Linares wrote:
> I do appreciate if you commit it yourself, as you are the author of the
> changes. Many thanks.

I'm sorry but I will not do that. I do not plan to work on this code
and quality of this code is not acceptable for me. Committing sth is
also taking some responsibility for the code. It's not my code and I
only hacked it to pass compilation with Harbour without fixing any
problems which I as can see have to exist. It's also possible that
I added some other problems or exploited some hidden ones with these
modifications. I do not know and I do not want to know ;-)
If you want to work on this code and update it then you can commit it
but if nobody will want to invest some time in it then I do not see any
reason to commit it to CVS.

> We are actually testing it as something is going wrong with it (OLE itself)
> and still we don't know what it is.

Sorry but I cannot help. WIN32OLE does not work in Linux ;-)

best regards,
Przemek
From antonioharbour at gmail.com  Mon Apr 16 16:23:11 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 16:23:57 2007
Subject: [Harbour] OLE support
In-Reply-To: <20070416201504.GB11141@localhost.localdomain>
Message-ID: <4623db3f.0ba09fde.4d39.5295@mx.google.com>

Przemek, 

> 
I'm sorry but I will not do that. I do not plan to work on this code and
quality of this code is not acceptable for me. Committing sth is also taking
some responsibility for the code. 
>

Ok, I will commit it, no problem. I plan to take care for it, and hopefully
to get it working with Harbour :-)

Do we use a new folder ? Or shall we use contrib/ole ? Maybe mixing the
files with the old ones is a mess.

Regards,

Antonio

From druzus at priv.onet.pl  Mon Apr 16 16:33:18 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 16:33:57 2007
Subject: [Harbour] OLE support
In-Reply-To: <4623d931.2a9b03f3.5bf8.582b@mx.google.com>
References: <20070416193051.GB10758@localhost.localdomain>
	<4623d931.2a9b03f3.5bf8.582b@mx.google.com>
Message-ID: <20070416203318.GA11454@localhost.localdomain>

On Mon, 16 Apr 2007, Antonio Linares wrote:
> Przemek,
> We are testing your new files (thanks!) and they generate the same OLE error
> as before:
>     s_nOleError = CoCreateInstance( (REFCLSID) &ClassID, NULL,
> CLSCTX_SERVER, (REFIID) riid, &pDisp );
> 
>     if( ! SUCCEEDED( s_nOleError ) )
>        MessageBox( 0, "failed", "ok", 0 ); 	 
> We are working to locate where the error may comes from. 
> I am reporting this to you FYI and in case you may have a suggestion, thanks

xHarbour at HVM startup executes C function:
   OleInitialize( NULL );
then .prg function:
   HB_OLEINIT()
and on HVM exit C function:
   OleUninitialize();

I guess you should make the same.
So before you begin to execute any OLE functions make sth like

    HB_INLINE() { OleInitialize( NULL ); }
    HB_OLEINIT()

But I do not know if it'll help.

best regards,
Przemek
From harbour.01 at syenar.hu  Mon Apr 16 16:48:11 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 16:48:17 2007
Subject: [Harbour] CHANGELOG: 2007-04-16 22:45 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c78068$Blat.v2.6.1$8c27494c$c80c39b0180@127.0.0.1>

2007-04-16 22:45 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/hbinet.c
     ! Warnings fixed for Darwin (gcc 4.0.1 OSX 10.4.9 PPC)

   * harbour/source/rtl/idle.c
     ! Fixed releasing idle CPU cycles. (thanks Przemek)
       The committed method was tested against usleep( 1 ) 
       and usleep( 100 ) and found to work perfect as 
       opposed to the usleep() calls.

   * harbour/source/rtl/tget.prg
     ! Adjusted my old TOFIX note.

From antonioharbour at gmail.com  Mon Apr 16 16:51:41 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 16:52:01 2007
Subject: [Harbour] OLE support
In-Reply-To: <20070416203318.GA11454@localhost.localdomain>
Message-ID: <4623e1ed.2548716c.7363.6874@mx.google.com>

Przemek, 

>
xHarbour at HVM startup executes C function:
   OleInitialize( NULL );
then .prg function:
   HB_OLEINIT()
and on HVM exit C function:
   OleUninitialize();
>

Excellent! Yes! :-)   

That made the difference. Its working fine now :-)

Many thanks for your help,

Regards,

Antonio

From antonioharbour at gmail.com  Mon Apr 16 17:00:26 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 17:00:47 2007
Subject: [Harbour] OLE support
In-Reply-To: <20070416203318.GA11454@localhost.localdomain>
Message-ID: <4623e3fa.188ab856.3992.5b7f@mx.google.com>

Should we create a new contrib\winole folder for the files ?

Please propose a name for it, thanks

Thanks,

Antonio

From lorenzo.fiorini at gmail.com  Mon Apr 16 17:06:10 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon Apr 16 17:06:14 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
Message-ID: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>

I've successfully cross compiled Harbour using mingw32 under Linux.

I had to change the line below in config/w32/mingw32.cf:
LINKLIBS += -l$(HB_GT_DEFAULT)
with
LDLIBS += -l$(HB_GT_DEFAULT)

Is it correct?

I'd also like to change make_xmingw.sh since the script does not find
my mingw32 installation.

In xHarbour I've implemented HB_CFG_FILE to allow different /etc/harbour.cfg.
Could it be useful to have it in Harbour?

regards,
Lorenzo
From harbour.01 at syenar.hu  Mon Apr 16 17:09:40 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 16 17:09:38 2007
Subject: [Harbour] OLE support
In-Reply-To: <4623e3fa.188ab856.3992.5b7f@mx.google.com>
References: <4623e3fa.188ab856.3992.5b7f@mx.google.com>
Message-ID: <841955CB-7782-483E-BF13-BC7114F2F6EF@syenar.hu>

We already have contrib/ole/, so having another one is quite
confusing. If it's not an option to evolve the current one into
this new one at this moment, I'd propose to put it into /contrib/ole2/
at least they are next to each other.

Brgds,
Viktor

On 2007.04.16., at 23:00, Antonio Linares wrote:

> Should we create a new contrib\winole folder for the files ?
>
> Please propose a name for it, thanks
>
> Thanks,
>
> Antonio
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From antonioharbour at gmail.com  Mon Apr 16 17:27:03 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 17:27:28 2007
Subject: [Harbour] OLE support
In-Reply-To: <841955CB-7782-483E-BF13-BC7114F2F6EF@syenar.hu>
Message-ID: <4623ea37.005a442a.72de.691a@mx.google.com>

Viktor, 

>
We already have contrib/ole/, so having another one is quite confusing. If
it's not an option to evolve the current one into this new one at this
moment, I'd propose to put it into /contrib/ole2/ at least they are next to
each other.
>

Ok, /contrib/ole2/

Thanks,

Antonio

From antonioharbour at gmail.com  Mon Apr 16 17:43:57 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 17:44:19 2007
Subject: [Harbour] ssh
Message-ID: <4623ee2e.5cf58b74.719f.6352@mx.google.com>

Where to download ssh ?

Was it also at www.harbour-project.org downloads ? (if yes, its no longer
there)

Thanks,

Antonio

From antonioharbour at gmail.com  Mon Apr 16 18:02:35 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 18:02:57 2007
Subject: [Harbour] RE: ssh
Message-ID: <4623f28c.475e256a.23b5.0168@mx.google.com>

> Where to download ssh ?

I meant the client ssh.exe for Windows

Thanks,

From antonioharbour at gmail.com  Mon Apr 16 18:07:25 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 18:07:46 2007
Subject: [Harbour] RE: ssh
Message-ID: <4623f3ad.4c54e2c3.3aa4.026d@mx.google.com>

 
>> Where to download ssh ?

> I meant the client ssh.exe for Windows

Never mind, I found my old copy of it :-)

Thanks,

From antonioharbour at gmail.com  Mon Apr 16 18:31:05 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 18:31:26 2007
Subject: [Harbour] CVS add
Message-ID: <4623f939.18c45e15.529b.03e1@mx.google.com>

D:\harbour\harbour\contrib\ole2>cvs add harbour/contrib/ole2/win32ole.prg
Password:
cvs add: in directory .:
cvs [add aborted]: there is no version here; do 'cvs checkout' first

Its a long time since I don't add a file,

Whats wrong ? Thanks,

If I do a checkout, there is no difference

Antonio

From druzus at priv.onet.pl  Mon Apr 16 18:55:42 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 18:56:19 2007
Subject: [Harbour] CVS add
In-Reply-To: <4623f939.18c45e15.529b.03e1@mx.google.com>
References: <4623f939.18c45e15.529b.03e1@mx.google.com>
Message-ID: <20070416225542.GA13227@localhost.localdomain>

On Tue, 17 Apr 2007, Antonio Linares wrote:
> D:\harbour\harbour\contrib\ole2>cvs add harbour/contrib/ole2/win32ole.prg
> Password:
> cvs add: in directory .:
> cvs [add aborted]: there is no version here; do 'cvs checkout' first
> Its a long time since I don't add a file,
> Whats wrong ? Thanks,

First add harbour/contrib/ole2/ directory, then files.

best regards,
Przemek
From antonioharbour at gmail.com  Mon Apr 16 19:04:58 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 19:05:20 2007
Subject: [Harbour] CVS add
In-Reply-To: <20070416225542.GA13227@localhost.localdomain>
Message-ID: <4624012c.2113af2d.2c40.0afa@mx.google.com>

Przemek,

> First add harbour/contrib/ole2/ directory, then files.

Ok,

See what I get now:

C:\harbour\harbour\contrib\ole2>cvs add harbour/contrib/ole2
Password:
cvs add: in directory .:
cvs [add aborted]: there is no version here; do 'cvs checkout' first

Any hints ?

Thanks,

Antonio

From antonioharbour at gmail.com  Mon Apr 16 19:13:42 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 19:14:03 2007
Subject: [Harbour] CVS add
In-Reply-To: <20070416225542.GA13227@localhost.localdomain>
Message-ID: <46240337.3d5a3535.2c40.0bd4@mx.google.com>

Ok got it :-)

Thanks,

Antonio

From philb at philb.us  Mon Apr 16 19:16:10 2007
From: philb at philb.us (Phil Barnett)
Date: Mon Apr 16 19:16:36 2007
Subject: [Harbour] ssh
In-Reply-To: <4623ee2e.5cf58b74.719f.6352@mx.google.com>
References: <4623ee2e.5cf58b74.719f.6352@mx.google.com>
Message-ID: <200704161916.10232.philb@philb.us>

On Monday 16 April 2007 17:43, Antonio Linares wrote:
> Where to download ssh ?
>
> Was it also at www.harbour-project.org downloads ? (if yes, its no longer
> there)

I have always used Putty.exe

-- 
Phil Barnett
AI4OF
SKCC #600
From antonioharbour at gmail.com  Mon Apr 16 19:20:35 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 19:20:57 2007
Subject: [Harbour] 2007-04-17 01:17 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <462404d4.7c062d50.253b.0c3d@mx.google.com>

2007-04-17 01:17 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   + contrib/ole2
   + contrib/ole2/win32ole.prg
   + contrib/ole2/w32ole.c
     * win32ole.prg borrowed from xharbour, source modifications by Przemek

Regards,

Antonio

From antonioharbour at gmail.com  Mon Apr 16 19:33:43 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 19:34:05 2007
Subject: [Harbour] 2007-04-17 01:32 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <462407e9.3ff892fa.7f04.0dbd@mx.google.com>

2007-04-17 01:32 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/ole2/win32ole.prg
   * contrib/ole2/w32ole.c
     * Some changes to get them working on Harbour

Regards,

Antonio

From antonioharbour at gmail.com  Mon Apr 16 20:00:04 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 16 20:00:28 2007
Subject: [Harbour] 2007-04-17 01:55 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <46240e16.1c8528c9.6ecb.10d9@mx.google.com>

2007-04-17 01:55 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   + contrib/ole2/make_b32.bat
   + contrib/ole2/makefile.bc
     * Borland makefile for HBOleAut.lib
     
   * contrib/ole2/win32ole.prg
     * minor fix

You can use make_b32.bat to build HBOleAut.lib and test it with Harbour.

Many thanks to Przemek superb help!

Regards,

Antonio

From druzus at priv.onet.pl  Mon Apr 16 22:12:21 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 16 22:12:56 2007
Subject: [Harbour] ChangeLog 2007-04-17 04:10 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070417021221.GA32323@localhost.localdomain>

2007-04-17 04:10 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbapi.h
  * harbour/source/vm/dynsym.c
    * changed some declarations from 'char *' to 'const char *'

  * harbour/include/hbapicls.h
  * harbour/source/vm/classes.c
    * changed some declarations from 'char *' to 'const char *'
    + added hb_clsFuncName(), hb_clsFindClass(), hb_objSetClass()

  * harbour/source/rtl/itemseri.c
    ! fixed some stupid typos in previous commit
    * added support for serialization of object variables - I'm
      not sure it's good idea anyhow people ask about it so we
      have it. Probably we should add some special method like
      OnError(), f.e.: OnRestore() or sth like that and execute
      it after deserialization or object cloning.

best regards,
Przemek
From niki at synel.co.il  Tue Apr 17 05:03:53 2007
From: niki at synel.co.il (Chen Kedem)
Date: Tue Apr 17 05:04:34 2007
Subject: [Harbour] compiler licence
Message-ID: <46248D79.3B50@synel.co.il>

I have some queries about the licence used with the Harbour compiler.

Most of Harbour source is licence to GPL + exception.
The compiler code itself was deliberately was made GPL only.

Now, with the introduction of compiler.lib and HB_COMPILE(),
HB_COMPILEBUF() ... functions, it is possible to include the
compiler as part of the user binary.

If so, does the user program still covered by the Harbour exception?
What are the meaning of that?

If including parts of compiler.lib into the user binary does have
effect on its licence, would it be possible to add something that
allow the user to identify the inclusion of such code?

Maybe part of the //info or //build information which is going
to be shown ONLY if the code was included?


  Chen.

PS: I do hope this thread would not turn into a flame fight.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From harbour.01 at syenar.hu  Tue Apr 17 06:17:49 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 17 06:17:55 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
Message-ID: <0F943BB6-667C-4B04-B252-BD4CE034E0A5@syenar.hu>

The change doesn't break the mingw build process under Win32.
(but it also works without this modification)

What does harbour.cfg do?

Brgds,
Viktor

On 2007.04.16., at 23:06, Lorenzo Fiorini wrote:

> I've successfully cross compiled Harbour using mingw32 under Linux.
>
> I had to change the line below in config/w32/mingw32.cf:
> LINKLIBS += -l$(HB_GT_DEFAULT)
> with
> LDLIBS += -l$(HB_GT_DEFAULT)
>
> Is it correct?
>
> I'd also like to change make_xmingw.sh since the script does not find
> my mingw32 installation.
>
> In xHarbour I've implemented HB_CFG_FILE to allow different /etc/ 
> harbour.cfg.
> Could it be useful to have it in Harbour?
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Tue Apr 17 07:04:20 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 17 07:04:23 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <0F943BB6-667C-4B04-B252-BD4CE034E0A5@syenar.hu>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
	<0F943BB6-667C-4B04-B252-BD4CE034E0A5@syenar.hu>
Message-ID: <9257026e0704170404j4800138bv832a998526f879e6@mail.gmail.com>

On 4/17/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> The change doesn't break the mingw build process under Win32.
> (but it also works without this modification)

It seems that w32/mingw32.cf uses LDLIBS and then it appends it to LINKLIBS.

If you use HB_GT_DEFAULT it should not work.

> What does harbour.cfg do?

It is used with -go compiler flag. harbour uses it to call the C
compiler and "mimic" clipper.exe behaviour where from a prg you get an
object.

It allows me to use my makefiles for both harbour and clipper.

Here is an example:

CC=gcc
CFLAGS=-c -I/harbour-linux/include -O3
VERBOSE=NO
DELTMP=YES

wirh mingw32 you need sth like:

CC=mingw32-gcc
CFLAGS=-c -I/harbour-mingw32/include -O3
VERBOSE=NO
DELTMP=YES

Clearly it is easy to sudo ln -s <cfgfile> /etc/harbour.cfg but it is
even easier to change HB_FG_FILE from /etc/hrblnx.cfg to
/etc/hrbw32.cfg ( and doesn't require sudo ).

regards,
Lorenzo
From druzus at priv.onet.pl  Tue Apr 17 10:12:32 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 10:13:09 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
Message-ID: <20070417141232.GA31138@localhost.localdomain>

On Mon, 16 Apr 2007, Lorenzo Fiorini wrote:
> I've successfully cross compiled Harbour using mingw32 under Linux.

I systematically create such builds too for testing.

> I had to change the line below in config/w32/mingw32.cf:
> LINKLIBS += -l$(HB_GT_DEFAULT)
> with
> LDLIBS += -l$(HB_GT_DEFAULT)
> Is it correct?

Yes. It was typo which should be fixed. Anyhow you do not have
to use HB_GT_DEFAULT at all. It's an old code which is not
necessary now.

> I'd also like to change make_xmingw.sh since the script does not find
> my mingw32 installation.

Can you show the diff?
By default it looks for MinGW cross compiled GCC in /usr/local/bin.
What MinGW packages did you use?

> In xHarbour I've implemented HB_CFG_FILE to allow different 
> /etc/harbour.cfg.
> Could it be useful to have it in Harbour?

Yes sure. Just add it.
Anyhow I think you should try to use hb* scripts. Harbour generate
them automatically in 'make install' phase also for cross compiled
MinGW environment so in your make files you can simply use hbcmp
and forget about any other environment settings.
If you want you can rename in MinGW build scripts and add some suffix
like "w" and then use them simultaneously with standard Linux ones, f.e.:

    hbmkw test.prg -n -w -es2 -gtcrs && ./test.exe

    hbmk  test.prg -n -w -es2 -gtcrs && ./test

best regards,
Przemek
From harbour.01 at syenar.hu  Tue Apr 17 10:28:47 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 17 10:28:42 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <9257026e0704170404j4800138bv832a998526f879e6@mail.gmail.com>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
	<0F943BB6-667C-4B04-B252-BD4CE034E0A5@syenar.hu>
	<9257026e0704170404j4800138bv832a998526f879e6@mail.gmail.com>
Message-ID: <3C5E7F9E-870E-4663-A17D-50742FA4905E@syenar.hu>

>> What does harbour.cfg do?
>
> It is used with -go compiler flag. harbour uses it to call the C
> compiler and "mimic" clipper.exe behaviour where from a prg you get an
> object.
>
> It allows me to use my makefiles for both harbour and clipper.
>
> Here is an example:
>
> CC=gcc
> CFLAGS=-c -I/harbour-linux/include -O3
> VERBOSE=NO
> DELTMP=YES
>
> wirh mingw32 you need sth like:
>
> CC=mingw32-gcc
> CFLAGS=-c -I/harbour-mingw32/include -O3
> VERBOSE=NO
> DELTMP=YES
>
> Clearly it is easy to sudo ln -s <cfgfile> /etc/harbour.cfg but it is
> even easier to change HB_FG_FILE from /etc/hrblnx.cfg to
> /etc/hrbw32.cfg ( and doesn't require sudo ).

"-go" is supposed to generate obj directly (we don't do it yet,
but maybe we once will), so we'd need to give it a different name
IMO (like: -gs).

I'd do it a bit differently:

harbour.cfg (or harbour.ini) could store all data needed to compile
a list of target platforms in separate sections:

[mingw-gcc]
CC=gcc
CompilerCmd=$(CC) etctetc
...

[bcc32]
...

So you wouldn't need to fiddle with the .cfg file.

Than you could use:
harbour -n hello.prg -ga:mingw32

I'm a bit sceptic though with these automated script things though,
I think a wrapper around harbour would be a cleaner solution
to this problem.

Brgds,
Viktor



>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Tue Apr 17 10:48:05 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 10:48:40 2007
Subject: [Harbour] compiler licence
In-Reply-To: <46248D79.3B50@synel.co.il>
References: <46248D79.3B50@synel.co.il>
Message-ID: <20070417144805.GB31138@localhost.localdomain>

On Tue, 17 Apr 2007, Chen Kedem wrote:
> I have some queries about the licence used with the Harbour compiler.
> Most of Harbour source is licence to GPL + exception.
> The compiler code itself was deliberately was made GPL only.
> Now, with the introduction of compiler.lib and HB_COMPILE(),
> HB_COMPILEBUF() ... functions, it is possible to include the
> compiler as part of the user binary.

Yes it is. The GPL code is inside compiler.lib

> If so, does the user program still covered by the Harbour exception?
> What are the meaning of that?

User can do what he only want for his own use but if he wants to
distribute such binaries he should respect GPL.

> If including parts of compiler.lib into the user binary does have
> effect on its licence, would it be possible to add something that
> allow the user to identify the inclusion of such code?

We can think about it but it's not new problem. In this case is enough
to not use compiler.lib. In some other cases the problem is more complicated,
f.e. GTSLN which uses SLANG library or GTSLN and GTCRS compiled with GPM
mouse support. In the past I added HB_COMMERCE=yes envvar to exclude any
code which may use some other code with more restricted license.

> Maybe part of the //info or //build information which is going
> to be shown ONLY if the code was included?

Yes, we can add additional information about _our_ GPL code in the
above switches but it will be hard to make sth like that with 3-rd
party code. Please also note that some other code in our CVS has
more restrictive license, f.e. contrib/hbzlib.

> PS: I do hope this thread would not turn into a flame fight.

It was very good question and I do not see anything wrong in the
fact that you are asking about it.

BTW, for compiler code I created I think I can agree to change the
license and also add an exception for some limited commercial use
but there is many other developers who should agree for it too so
it's not sth what can be easy done. I'm not a lawyer but maybe
exception in compiler license should be more restrictive.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr 17 10:56:38 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 17 10:56:42 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <20070417141232.GA31138@localhost.localdomain>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
	<20070417141232.GA31138@localhost.localdomain>
Message-ID: <9257026e0704170756i1b2e73b1x6e0b13cfcd564eea@mail.gmail.com>

On 4/17/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> Yes. It was typo which should be fixed. Anyhow you do not have
> to use HB_GT_DEFAULT at all. It's an old code which is not
> necessary now.

I use HB_GT_DEFAULT because I want gtcgi and not gtcrs or gtwin linked
by default.
Is it correct?

> Can you show the diff?

Here it is:

16c16,21
< [ -z "$HB_INSTALL_PREFIX" ] && export
HB_INSTALL_PREFIX=/usr/local/mingw32-harbour
---
> export HB_INSTALL_PREFIX=$HB_CROSS_INSTALL_PREFIX
> export HB_BIN_INSTALL=
> export HB_INC_INSTALL=
> export HB_LIB_INSTALL=
> export HB_GT_LIB=$HB_CROSS_GT_LIB
> [ -z "$HB_INSTALL_PREFIX" ] && export HB_INSTALL_PREFIX=/usr/local/mingw32-xharbour
33a39,42
>  elif [ -f /usr/local/mingw32/bin/mingw32-gcc ]; then
>     MINGW_PREFIX=/usr/local/mingw32
>     TARGET=mingw32
>     CCPREFIX="$TARGET-"

HB_CROSS_GT_LIB and HB_CROSS_INSTALL_PREFIX are mine.

I then use xcross script to set the env before the make:

#!/bin/sh
export CCPREFIX=mingw32-
export HB_ARCHITECTURE=w32
export HB_COMPILER=mingw32
#export HB_GT_LIB=$HB_CROSS_GT_LIB
export HB_GT_LIB=gtnul
export HB_CFG_FILE=/etc/hrbw32.cfg
export HB_BIN_INSTALL=$HB_CROSS_INSTALL_PREFIX/bin
export HB_LIB_INSTALL=$HB_CROSS_INSTALL_PREFIX/lib
export HB_INC_INSTALL=$HB_CROSS_INSTALL_PREFIX/include
export CC_PRG_USR="-D__PLATFORM__Windows -undef:__PLATFORM__UNIX
-undef:__PLATFORM__Linux"
export PRG_USR="$CC_PRG_USR $PRG_USR"
export PATH=/usr/local/mingw32/bin:~/dvl/hrb-w32/bin:$PATH
export PKG_CONFIG_PATH=/target/lib/pkgconfig
if which harbour &> /dev/null; then
    rm -f -r /tmp/harbour.exe
    ln -s `which harbour` /tmp/harbour.exe
    export HB_BIN_COMPILE=/tmp
else
    echo "You must have a working xHarbour executable for your
platform on your PATH."
    exit 1
fi
$*

> By default it looks for MinGW cross compiled GCC in /usr/local/bin.

> What MinGW packages did you use?

there are no Fedora "official" packages for mingw32 so I use a script
that I found on the net that download the tar.gz sources and put the
binaries in PREFIX=/usr/local/mingw32.

> Anyhow I think you should try to use hb* scripts. Harbour generate
> them automatically in 'make install' phase also for cross compiled
> MinGW environment so in your make files you can simply use hbcmp
> and forget about any other environment settings.

I know, I use them extensively with my cgi apps, but for desktop apps
I use the same makefiles for C53B, C53B/FiveWin16, [x]Harbour/gtxwc,
[x]Harbourhwgui/gtk, [x]Harbour/hwgui/w32.
I need all the power of the gnu make to set the env.

regards,
Lorenzo
From druzus at priv.onet.pl  Tue Apr 17 11:24:38 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 11:25:14 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <9257026e0704170756i1b2e73b1x6e0b13cfcd564eea@mail.gmail.com>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
	<20070417141232.GA31138@localhost.localdomain>
	<9257026e0704170756i1b2e73b1x6e0b13cfcd564eea@mail.gmail.com>
Message-ID: <20070417152438.GA31530@localhost.localdomain>

On Tue, 17 Apr 2007, Lorenzo Fiorini wrote:
> I use HB_GT_DEFAULT because I want gtcgi and not gtcrs or gtwin linked
> by default.
> Is it correct?

I'm using GTSTD as default GT driver.
Please note that in Harbour GT drivers works ins differ way then in
xHarbour. GTSTD is "nearly" full screen GT driver but is also works
nice as pure stream one.
But of course you can set GTCGI as default without any problems.
Just simply make:
    export HB_GT_LIB=gtcgi
before you rebuild Harbour.

> >Can you show the diff?
> Here it is:
[...]
I'll look at it. Thank you.

> >What MinGW packages did you use?
> there are no Fedora "official" packages for mingw32 so I use a script
> that I found on the net that download the tar.gz sources and put the
> binaries in PREFIX=/usr/local/mingw32.

I'm using some RPMs created by Hans Leidekker.

> >Anyhow I think you should try to use hb* scripts. Harbour generate
> >them automatically in 'make install' phase also for cross compiled
> >MinGW environment so in your make files you can simply use hbcmp
> >and forget about any other environment settings.
> I know, I use them extensively with my cgi apps, but for desktop apps
> I use the same makefiles for C53B, C53B/FiveWin16, [x]Harbour/gtxwc,
> [x]Harbourhwgui/gtk, [x]Harbour/hwgui/w32.
> I need all the power of the gnu make to set the env.

And this why this script was designed. Use them in your GNU make files.
Instead of 'harbour' simply use 'hbcmp' with all other options you are
using so far and to link your programs instead of 'gcc' use 'hblnk'
with all other gcc switches. You can drop standard harbour libraries
and paths because they will be added automatically.
Such modification can be done by simple s&r with any editor and your
make files should work with hb* scripts.
You can also use these additional switches with hb* scripts:
    -o<outputfilename>      # output file name
    -static                 # link with static Harbour libs
    -fullstatic             # link with all static libs
    -shared                 # link with shared libs (default)
    -mt                     # link with multi-thread libs
    -gt<hbgt>               # link with <hbgt> GT driver, can be repeated to
                            # link with more GTs. The first one will be
                            #      the default at runtime
    -xbgtk                  # link with xbgtk library (xBase GTK+ interface)
    -hwgui                  # link with HWGUI library (GTK+ interface)
    -l<libname>             # link with <libname> library
    -fmstat                 # link with the memory statistics lib
    -nofmstat               # do not link with the memory statistics lib (default)
    -[no]strip              # strip (no strip) binaries
    -main=<main_func>       # set the name of main program function/procedure.
                            # if not set then 'MAIN' is used or if it doesn't
                            # exist the name of first public function/procedure
                            # in first linked object module (link)

So if you will find _ANY_ limitation with using hb* scripts (sth what
you can do without them and with hb* scripts cannot be done) then please
inform me. I do not know about any limitations and only know some extensions
which can be done _ONLY_ with hb* scripts which I use with GNU make files.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr 17 11:40:31 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 17 11:40:34 2007
Subject: [Harbour] cString[-1] difference between Harbour and xHarbour
Message-ID: <9257026e0704170840k181105e2xb302644f5c06b2a7@mail.gmail.com>

The code below return .F. under xHarbour 0.99.71 and a RT under Harbour dev.

Is it expected?

It is not a big deal checking for empty before use it. I wanted only
to report it.

regards,
Lorenzo

procedure main()

   local cString := ""

   ? cString[-1] == " "

   return
From lorenzo.fiorini at gmail.com  Tue Apr 17 12:07:06 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 17 12:07:09 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <20070417152438.GA31530@localhost.localdomain>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
	<20070417141232.GA31138@localhost.localdomain>
	<9257026e0704170756i1b2e73b1x6e0b13cfcd564eea@mail.gmail.com>
	<20070417152438.GA31530@localhost.localdomain>
Message-ID: <9257026e0704170907k70ba72e3t98e90347751b7aa7@mail.gmail.com>

On 4/17/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> But of course you can set GTCGI as default without any problems.
> Just simply make:
>     export HB_GT_LIB=gtcgi
> before you rebuild Harbour.

I use gtcgi just to be sure that if I forget REQUEST the cgi apps
don't "freeze" httpd.

> I'm using some RPMs created by Hans Leidekker.

Thanks, I'll check for them.

> And this why this script was designed. Use them in your GNU make files.

I'l give them a better look.

I've already added some switches to hb-func.sh:

    -gwgtk              # link with gwgtklibrary (GTK+ interface)
    -gwwin              # link with gwwinlibrary (WIN32 interface)
    -xhgtk              # link with xhgtk library (GTK+ interface)

gtgtk=hwgui/gtk and gwwin=hwgui/win32

I also added HB_GD="" and HB_PGSQL="" to add paths and libs for
postgresql and gd.

These allow me to quickly run tests.

regards,
Lorenzo
From guy.roussin at teledetection.fr  Tue Apr 17 12:24:26 2007
From: guy.roussin at teledetection.fr (Guy Roussin)
Date: Tue Apr 17 12:24:59 2007
Subject: [Harbour] compiling hbrun with libct
Message-ID: <4624F4BA.2040106@teledetection.fr>

Hi,

I seek a (good) way of compiling hbrun with libct
under linux (harbour cvs).

Thank you,

-- 
Guy



From harbour.01 at syenar.hu  Tue Apr 17 12:49:01 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 17 12:49:00 2007
Subject: [Harbour] off: gcc/ld incremental linking?
Message-ID: <621C3CB5-ED3B-46B4-B63A-5A59A2AD53A1@syenar.hu>

Hi all,

Is there any way to use incremental linking with the gcc toolchain?

Brgds,
Viktor

From lorenzo.fiorini at gmail.com  Tue Apr 17 13:13:27 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 17 13:13:32 2007
Subject: [Harbour] May I port ctnet.c and hbini.prg from xHarbour?
Message-ID: <9257026e0704171013q278f8272p20e8ab3d771eb9de@mail.gmail.com>

ctnet implement NET functions like NETREDIR and NETCANCEL.

hbini.prg reads ini files and represent it as hashes.

regards,
Lorenzo
From harbour.01 at syenar.hu  Tue Apr 17 13:29:53 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 17 13:29:50 2007
Subject: [Harbour] May I port ctnet.c and hbini.prg from xHarbour?
In-Reply-To: <9257026e0704171013q278f8272p20e8ab3d771eb9de@mail.gmail.com>
References: <9257026e0704171013q278f8272p20e8ab3d771eb9de@mail.gmail.com>
Message-ID: <78B54D58-FE16-48EB-8894-1BEAF9B878B2@syenar.hu>

ctnet seems to be part of LIBCT, so I think it's okey.

As for hbinit, I think it's time to create an xhb compatible library
in Harbour contrib, and put all the xhb extensions there.
We can then evaluate them and decide to include them in
core Harbour.

IMO while .ini handling can indeed be useful (although
there is no standard, so it's difficult to please everyone
wanting .ini support), I don't see any reason to include it in
core Harbour at this time, since it can work just as perfectly
as a separate lib, and it's hard to tell anything about the
implementation at this moment.

Brgds,
Viktor

On 2007.04.17., at 19:13, Lorenzo Fiorini wrote:

> ctnet implement NET functions like NETREDIR and NETCANCEL.
>
> hbini.prg reads ini files and represent it as hashes.
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Tue Apr 17 13:35:01 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 17 13:35:05 2007
Subject: [Harbour] May I port ctnet.c and hbini.prg from xHarbour?
In-Reply-To: <78B54D58-FE16-48EB-8894-1BEAF9B878B2@syenar.hu>
References: <9257026e0704171013q278f8272p20e8ab3d771eb9de@mail.gmail.com>
	<78B54D58-FE16-48EB-8894-1BEAF9B878B2@syenar.hu>
Message-ID: <9257026e0704171035r2e1cd31fp9d5d770dcca0ed4b@mail.gmail.com>

On 4/17/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> IMO while .ini handling can indeed be useful (although
> there is no standard, so it's difficult to please everyone
> wanting .ini support), I don't see any reason to include it in
> core Harbour at this time, since it can work just as perfectly
> as a separate lib, and it's hard to tell anything about the
> implementation at this moment.

No problem, I can keep it local.

regards,
Lorenzo
From harbour.01 at syenar.hu  Tue Apr 17 13:35:12 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 17 13:35:16 2007
Subject: [Harbour] CHANGELOG: 2007-04-17 19:34 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c78116$Blat.v2.6.1$c0dec6fc$c88d0de6e74@127.0.0.1>

2007-04-17 19:34 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/common/hbver.c
     + Added Vista and 2003 Windows versions.
     * Updated Cygwin/Mingw compiler names.

From druzus at priv.onet.pl  Tue Apr 17 13:41:27 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 13:42:03 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <9257026e0704170907k70ba72e3t98e90347751b7aa7@mail.gmail.com>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
	<20070417141232.GA31138@localhost.localdomain>
	<9257026e0704170756i1b2e73b1x6e0b13cfcd564eea@mail.gmail.com>
	<20070417152438.GA31530@localhost.localdomain>
	<9257026e0704170907k70ba72e3t98e90347751b7aa7@mail.gmail.com>
Message-ID: <20070417174127.GA6783@localhost.localdomain>

On Tue, 17 Apr 2007, Lorenzo Fiorini wrote:
> >But of course you can set GTCGI as default without any problems.
> >Just simply make:
> >    export HB_GT_LIB=gtcgi
> >before you rebuild Harbour.
> I use gtcgi just to be sure that if I forget REQUEST the cgi apps
> don't "freeze" httpd.

    stty -tostop

for controlling terminal disables these "feature".
If you do no like it then in a while I'll change GTSTD to not stop the
process by SIGTTOU when controlling terminal has set TOSTOP attribute.

> I'l give them a better look.
> I've already added some switches to hb-func.sh:
>    -gwgtk              # link with gwgtklibrary (GTK+ interface)
>    -gwwin              # link with gwwinlibrary (WIN32 interface)
>    -xhgtk              # link with xhgtk library (GTK+ interface)
> gtgtk=hwgui/gtk and gwwin=hwgui/win32
> I also added HB_GD="" and HB_PGSQL="" to add paths and libs for
> postgresql and gd.
> These allow me to quickly run tests.

You can add any libraries with -l<libname> switch used with hbmk or hblnk.
Just like you use it with with gcc.
Anyhow the contrib libraries can be added to default library list so I'll
add GD and Harbour postgerss and mysql libraries.
I do not know what exactly -gwgtk, -gwwin, -xhgtk enables in your
modified version. Maybe we can add these switches to default build
but I'd like to know what they do first.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr 17 13:57:46 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 17 13:58:04 2007
Subject: [Harbour] Changes for mingw32 cross compiling. Anyone uses it?
In-Reply-To: <20070417174127.GA6783@localhost.localdomain>
References: <9257026e0704161406t4094272bp9b3d3a22d231918b@mail.gmail.com>
	<20070417141232.GA31138@localhost.localdomain>
	<9257026e0704170756i1b2e73b1x6e0b13cfcd564eea@mail.gmail.com>
	<20070417152438.GA31530@localhost.localdomain>
	<9257026e0704170907k70ba72e3t98e90347751b7aa7@mail.gmail.com>
	<20070417174127.GA6783@localhost.localdomain>
Message-ID: <9257026e0704171057j549aba73o4dc0c8cd1c43efe3@mail.gmail.com>

On 4/17/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> You can add any libraries with -l<libname> switch used with hbmk or hblnk.
> Just like you use it with with gcc.
> Anyhow the contrib libraries can be added to default library list so I'll
> add GD and Harbour postgerss and mysql libraries.

Thanks.

> I do not know what exactly -gwgtk, -gwwin, -xhgtk enables in your
> modified version. Maybe we can add these switches to default build
> but I'd like to know what they do first.

These are more "personal" so I can keep them as a patch in my local CVS.

If there is someone else interested:
gwwin and gwgtk are "simply" different names for hwgui "builds".
hwgui is gtk under linux and with win32 under windows while I like to
have both the "flavours" at the same time.
Since I develop for Windows ONLY from Linux I need gwwin for cross
platform win32 apps and gwgtk for linux gtk apps.

xhgtk is another GTK implementation for [x]Harbour ( it is in SF I've
only added it to quickly run the tests ).

regards,
Lorenzo
From druzus at priv.onet.pl  Tue Apr 17 14:01:34 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 14:02:09 2007
Subject: [Harbour] ChangeLog 2007-04-17 20:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070417180134.GA7155@localhost.localdomain>

2007-04-17 20:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/source/rdd/dbcmd.c
    ! update NetErr() in ordListAdd()
      If you know other then dbCreate()/dbUseArea() functions which reset
      NetErr() flag in Clipper then please report them. We will have to
      update our functions (dbSetIndex() is a wrapper to ordListAdd() so
      you nay not report it ;))

  * harbour/source/rtl/gtstd/gtstd.c
    * do not stop Harbour process when controlling terminal has TOSTOP
      attribute set (as long as no direct out is done)

  * harbour/source/rtl/tclass.prg
  * harbour/source/rtl/terror.prg
  * harbour/source/rtl/tobject.prg
    * set valid class function

  * harbour/source/rtl/tmenuitm.prg
  * harbour/source/rtl/tpopup.prg
    ! I think that no one has been checking what these code does for
      very long time. Both MenuItem() and PopUp() on each call tries
      to create new _CLASSES_ called "MenuItem" and "PopUpMenu"
      instead of creating only new instance of these classes (new objects)
      Updated to use standard hbclass.ch commands. If possible try
      to not create classes manually and always use documented commands
      from hbclass.ch

best regards,
Przemek
From randy at palmasdev.com  Tue Apr 17 14:51:41 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Tue Apr 17 14:51:11 2007
Subject: [Harbour] ChangeLog 2007-04-17 20:00 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
In-Reply-To: <20070417180134.GA7155@localhost.localdomain>
References: <20070417180134.GA7155@localhost.localdomain>
Message-ID: <20070417185107.8440A66D42@smtp.tor.pathcom.com>

Hi Przemek,

   * harbour/source/rdd/dbcmd.c
>     ! update NetErr() in ordListAdd()
>       If you know other then dbCreate()/dbUseArea() functions which reset
>       NetErr() flag in Clipper then please report them. We will have to
>       update our functions (dbSetIndex() is a wrapper to ordListAdd() so
>       you nay not report it ;))

dbAppend() uses NetErr() to indicate success or failure.

Randy. 

From druzus at priv.onet.pl  Tue Apr 17 15:01:26 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 15:02:01 2007
Subject: [Harbour] cString[-1] difference between Harbour and xHarbour
In-Reply-To: <9257026e0704170840k181105e2xb302644f5c06b2a7@mail.gmail.com>
References: <9257026e0704170840k181105e2xb302644f5c06b2a7@mail.gmail.com>
Message-ID: <20070417190126.GA8119@localhost.localdomain>

On Tue, 17 Apr 2007, Lorenzo Fiorini wrote:
> The code below return .F. under xHarbour 0.99.71 and a RT under Harbour dev.
> Is it expected?

Yes. Compiling Harbour with HB_COMPAT_XHB enables negative indexes
for arrays and string but for both the same rules are used.
I have absolutely no idea why in xHarbour range checking does
not work for strings and works only for arrays. Probably it
was a side effect of replacing substr( <cVal>, <n>, 1 ) with
<cVal>[<n>] in compile time optimizer so the action for <cVal>[<n>]
was tuned to be as close as possible to substr() function plus
support for negative indexes and the results are as below.
But I can only guess. For me it's a bug.
It also causes that I cannot locate some problems or typos in
my code, f.e.:

    proc main()
    local s:="123"
    ? s[-2], s[-200], s[-3,3,4,5,6]
    ? s[2], s[200], s[3,-3,-4,-5,-6]
    ? s[10000], s[2000000], s['q']
    return

can be compiled and executed by xHarbour without any errors.
I do not understand the logic used to calculate results but
it does something and shows some results (who can guess them
without real tests or looking at HVM code? Just try ;-))
For me at such level it stops to be a feature. If we eliminate all
RT errors over some reasonable limits then I do not see any reason
to use such upper level language like Clipper/[x]Harbour. I know C
quite well, I do not have any problems with writing even big
application using C and C code is hundreds times faster.
For me the only one reason to use upper level languages is
compiler/RTL/HVM support in bug/typos detection. Without it and
without serious HVM protection against buggy user code xHarbour
begins to be only very slow version of something like C compiler.

> It is not a big deal checking for empty before use it. I wanted only
> to report it.

Thanks for info but I do not want to replicate the exact xHarbour
behavior. IMHO even returning string is wrong. If you compile
Harbour without HB_COMPAT_XHB but with string indexes then
    ? "ABC"[2]
will show 66 not "B" what seems to be much better because now
    ? "ABC"[1,1,1]
does not generate RT error so some bugs with wrong indexing
arrays of strings are not detected.

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr 17 15:03:00 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 15:03:35 2007
Subject: [Harbour] ChangeLog 2007-04-17 20:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070417185107.8440A66D42@smtp.tor.pathcom.com>
References: <20070417180134.GA7155@localhost.localdomain>
	<20070417185107.8440A66D42@smtp.tor.pathcom.com>
Message-ID: <20070417190300.GB8119@localhost.localdomain>

On Tue, 17 Apr 2007, Randy Portnoff wrote:
> dbAppend() uses NetErr() to indicate success or failure.

Thanks for the info. I forgot to add dbAppend() to the list of
commands which we know that it resets NetErr()

best regards,
Przemek
From randy at palmasdev.com  Tue Apr 17 15:57:15 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Tue Apr 17 15:56:42 2007
Subject: [Harbour] ChangeLog 2007-04-17 20:00 UTC+0200 Przemyslaw
	Czerpak (druzus/at/priv.onet.pl)
In-Reply-To: <20070417190300.GB8119@localhost.localdomain>
References: <20070417180134.GA7155@localhost.localdomain>
	<20070417185107.8440A66D42@smtp.tor.pathcom.com>
	<20070417190300.GB8119@localhost.localdomain>
Message-ID: <20070417195637.2541666DAD@smtp.tor.pathcom.com>

I _think_ the following as well:

APPEND FROM
COPY TO
SORT
ERRORSYS.PRG (for certain errors)


At 03:03 PM 4/17/2007, you wrote:
>On Tue, 17 Apr 2007, Randy Portnoff wrote:
> > dbAppend() uses NetErr() to indicate success or failure.
>
>Thanks for the info. I forgot to add dbAppend() to the list of
>commands which we know that it resets NetErr()
>
>best regards,
>Przemek
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Tue Apr 17 16:45:29 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 16:46:05 2007
Subject: [Harbour] ChangeLog 2007-04-17 20:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070417195637.2541666DAD@smtp.tor.pathcom.com>
References: <20070417180134.GA7155@localhost.localdomain>
	<20070417185107.8440A66D42@smtp.tor.pathcom.com>
	<20070417190300.GB8119@localhost.localdomain>
	<20070417195637.2541666DAD@smtp.tor.pathcom.com>
Message-ID: <20070417204529.GA8930@localhost.localdomain>

On Tue, 17 Apr 2007, Randy Portnoff wrote:
> APPEND FROM

It's dbppend()

> COPY TO
> SORT

AFAIK only indirectly by internal dbUseArea()/dbCreate()

> ERRORSYS.PRG (for certain errors)

It does not reset NetErr() flag at all but it's the only one place
in Clipper where this flags is set.

To clarify.
I'm interesting in pure functions like ordListAdd() which resets
NetErr() flag in Clipper.
If someone has a while to make some tests with code like:

    NetErr(.t.)
    <someFunc>([...])
    ? NetErr()

To create list of such commands then it may help us to improve
Clipper compatibility. ordListAdd() has been never reseted NetErr()
in [x]Harbour in any RDD and this problem was reported after many
years today. I'm interesting if we can find some other similar
functions.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Tue Apr 17 17:25:10 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 17 17:25:13 2007
Subject: [Harbour] ChangeLog 2007-04-17 23:05 UTC+0200 Lorenzo Fiorini
Message-ID: <9257026e0704171425o49b36690wa3233c45eb99d719@mail.gmail.com>

2007-04-17 23:05 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
  * harbour/contrib/gd/Makefile
    * added install of gd.ch
  * harbour/contrib/gd/gd.prg
    * removed two unused vars
  * harbour/contrib/libct/ctnet.c
  * harbour/contrib/libct/Makefile
    * added ctnet.c borrowed from xHarbour
  * harbour/contrib/pgsql/postgres.c
    * fixes some warnings
  * harbour/contrib/tip/cgi.prg
    * added session name parameter
  * harbour/include/hbcompat.ch
    * added gtProcessMessages() translate

regards,
Lorenzo
From druzus at priv.onet.pl  Tue Apr 17 18:02:33 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 18:03:08 2007
Subject: [Harbour] ChangeLog 2007-04-18 00:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070417220233.GA9304@localhost.localdomain>

2007-04-18 00:00 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/contrib/mysql/Makefile
    * changed library name from mysql to hbmysql
  * harbour/bin/hb-func.sh
    + added hbgd hbole hbpg hbmysql to linked library list in hb* scripts

best regards,
Przemek
From harbour.01 at syenar.hu  Tue Apr 17 18:49:40 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 17 18:49:34 2007
Subject: [Harbour] ChangeLog 2007-04-17 20:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070417204529.GA8930@localhost.localdomain>
References: <20070417180134.GA7155@localhost.localdomain>
	<20070417185107.8440A66D42@smtp.tor.pathcom.com>
	<20070417190300.GB8119@localhost.localdomain>
	<20070417195637.2541666DAD@smtp.tor.pathcom.com>
	<20070417204529.GA8930@localhost.localdomain>
Message-ID: <699266A2-E040-4575-BE67-4B5F14E67473@syenar.hu>

I think that's the full list:
dbAppend()
dbUseArea()
ordListAdd()

dbCreate() _doesn't_ touch NetErr() as far as I could see.
Not even when called with the undocumented "keepopen"
parameter.

Brgds,
Viktor

On 2007.04.17., at 22:45, Przemyslaw Czerpak wrote:

> On Tue, 17 Apr 2007, Randy Portnoff wrote:
>> APPEND FROM
>
> It's dbppend()
>
>> COPY TO
>> SORT
>
> AFAIK only indirectly by internal dbUseArea()/dbCreate()
>
>> ERRORSYS.PRG (for certain errors)
>
> It does not reset NetErr() flag at all but it's the only one place
> in Clipper where this flags is set.
>
> To clarify.
> I'm interesting in pure functions like ordListAdd() which resets
> NetErr() flag in Clipper.
> If someone has a while to make some tests with code like:
>
>     NetErr(.t.)
>     <someFunc>([...])
>     ? NetErr()
>
> To create list of such commands then it may help us to improve
> Clipper compatibility. ordListAdd() has been never reseted NetErr()
> in [x]Harbour in any RDD and this problem was reported after many
> years today. I'm interesting if we can find some other similar
> functions.
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Tue Apr 17 19:11:20 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 19:11:58 2007
Subject: [Harbour] ChangeLog 2007-04-17 20:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <699266A2-E040-4575-BE67-4B5F14E67473@syenar.hu>
References: <20070417180134.GA7155@localhost.localdomain>
	<20070417185107.8440A66D42@smtp.tor.pathcom.com>
	<20070417190300.GB8119@localhost.localdomain>
	<20070417195637.2541666DAD@smtp.tor.pathcom.com>
	<20070417204529.GA8930@localhost.localdomain>
	<699266A2-E040-4575-BE67-4B5F14E67473@syenar.hu>
Message-ID: <20070417231120.GA10013@localhost.localdomain>

On Wed, 18 Apr 2007, Szak?ts Viktor wrote:
> I think that's the full list:
> dbAppend()
> dbUseArea()
> ordListAdd()

These ones are already supported by us.

> 
> dbCreate() _doesn't_ touch NetErr() as far as I could see.
> Not even when called with the undocumented "keepopen"
> parameter.

You are right. I've just check it and I have to say that
I'm a little bit surprised.

So seems that now we cover the whole list plus dbCreate().
Do you think we should remove NerErr() resetting from dbCreate()?
Personally I do not see anything wrong in keeping it though it's
not strictly Clipper compatible. But because on different platforms
sharing violation generates different OS error codes then in DOS
then we will never be strictly Clipper compatible here.

best regards,
Przemek
From ron at profit-master.com  Tue Apr 17 19:53:24 2007
From: ron at profit-master.com (Ron Pinkas)
Date: Tue Apr 17 19:53:53 2007
Subject: [Harbour] cString[-1] difference between Harbour and xHarbour
In-Reply-To: <20070417190126.GA8119@localhost.localdomain>
References: <9257026e0704170840k181105e2xb302644f5c06b2a7@mail.gmail.com>
	<20070417190126.GA8119@localhost.localdomain>
Message-ID: <011001c7814b$96623fa0$6611a8c0@vpcron>

Przemek,

Apparently, Clipper itself, and by extension Harbour too, are also  "only
very slow version of something  like C compiler".

//--------------------------------------------------------------------------
----------------------------//
PROCEDURE Main()

   LOCAL s := "123", a := Array(1)

   ? SubStr( s, -2, 1 ), SubStr( s, -200, 1 )
   ? SubStr( s, 2, 1 ), SubStr( s, 200, 1 )
   ? SubStr( s, 10000, 1 ), SubStr( s, 2000000, 1 ), SubStr( s, Asc( 'q' ),
1 )

   a[1] := a
   ? a[ 1, 1, 1, 1, 1, 1, 1 ]

RETURN
//--------------------------------------------------------------------------
----------------------------//

Since you seem convinced that these are "bug"s, and you "do not see any
reason to use such upper level language" I'll look forward to see you post
quick fixes. Until then please avoid such degrading comments about xHarbour.

I'll not engage in any argument here or elsewhere, this message was only
needed to defend xHarbour against such offensive  and baseless comments.

Ron

From harbour.01 at syenar.hu  Tue Apr 17 19:55:55 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 17 19:55:48 2007
Subject: [Harbour] ChangeLog 2007-04-17 20:00 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070417231120.GA10013@localhost.localdomain>
References: <20070417180134.GA7155@localhost.localdomain>
	<20070417185107.8440A66D42@smtp.tor.pathcom.com>
	<20070417190300.GB8119@localhost.localdomain>
	<20070417195637.2541666DAD@smtp.tor.pathcom.com>
	<20070417204529.GA8930@localhost.localdomain>
	<699266A2-E040-4575-BE67-4B5F14E67473@syenar.hu>
	<20070417231120.GA10013@localhost.localdomain>
Message-ID: <F16726EA-AE22-450E-B455-36F5C0349406@syenar.hu>

Hi Przemek,

>> dbCreate() _doesn't_ touch NetErr() as far as I could see.
>> Not even when called with the undocumented "keepopen"
>> parameter.
>
> You are right. I've just check it and I have to say that
> I'm a little bit surprised.
>
> So seems that now we cover the whole list plus dbCreate().
> Do you think we should remove NerErr() resetting from dbCreate()?
> Personally I do not see anything wrong in keeping it though it's
> not strictly Clipper compatible. But because on different platforms
> sharing violation generates different OS error codes then in DOS
> then we will never be strictly Clipper compatible here.

Personally it doesn't affect me either, but for example this Clipper
code could break in Harbour (in multiple ways):

dbUseArea(.T.,, "first.dbf", "FIRST")
dbCreate("second.dbf", ...)
IF NetErr()
      ? "first.dbf open error"
      RETURN
ENDIF
? FIRST->ID

This code is admittedly pretty odd, but I'd say let's keep it compatible
because the misleading app errors/behaviour make it quite difficult
to trace the real reason of this kind problem.

dbCreate() error checking can be done like in Clipper: DOSError() != 0
or via the error handler, where even NetErr(.T.) can be set on app  
level.

Brgds,
Viktor

From harbour.01 at syenar.hu  Tue Apr 17 20:06:38 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 17 20:06:31 2007
Subject: [Harbour] Namespace problems
Message-ID: <7850585D-A418-4B42-B58E-8B99E1658650@syenar.hu>

Hi Alexander, Przemek,

A few namespace problems I've run into today:

1) include/usrrdd.ch should be prefixed with "hb".
     Do you see any problem in adding it?
     Actually the content should be too, to fully comply,
     but it doesn't seem top priority.

2) include/hbapicdp.h has CPID_* and UNITB_* #defines
      also not prefixed. These might collide with other C level
      codepage related stuff, since the names are not very
      unique this way.

I can fix all/any of these in case we agree on them.

Brgds,
Viktor

From druzus at priv.onet.pl  Tue Apr 17 21:42:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 17 21:43:11 2007
Subject: [Harbour] cString[-1] difference between Harbour and xHarbour
In-Reply-To: <011001c7814b$96623fa0$6611a8c0@vpcron>
References: <9257026e0704170840k181105e2xb302644f5c06b2a7@mail.gmail.com>
	<20070417190126.GA8119@localhost.localdomain>
	<011001c7814b$96623fa0$6611a8c0@vpcron>
Message-ID: <20070418014235.GA10665@localhost.localdomain>

On Tue, 17 Apr 2007, Ron Pinkas wrote:
> Apparently, Clipper itself, and by extension Harbour too, are also  "only
> very slow version of something  like C compiler".

So far only xHarbour begins to be sth like that for me and I stopped to
use it. Additionally I had to spend more time looking for serious bugs
in xHarbour core code then I could benefit from using xHarbour.
Now Harbour is sth more for me. It still quite well validates my code and
It's very hard to break current Harbour VM with buggy user .prg code.
It's much more stable then Clipper, xHarbour, FS and CLIP.
It cleanly resolves most of bad situations which break other VMs in
the above languages without performance degradation so it's still very
fast. In my tests it's the fastest VM for xBase like code. Of course
it's much slower then pure C code but I can trust that my bugs will
be quickly detected and cleanly reported without bad side effects, f.e.
wrong pointer which corrupts important client data.

> PROCEDURE Main()
>    LOCAL s := "123", a := Array(1)
>    ? SubStr( s, -2, 1 ), SubStr( s, -200, 1 )
>    ? SubStr( s, 2, 1 ), SubStr( s, 200, 1 )
>    ? SubStr( s, 10000, 1 ), SubStr( s, 2000000, 1 ), SubStr( s, Asc( 'q' ), 1 )
>    a[1] := a
>    ? a[ 1, 1, 1, 1, 1, 1, 1 ]
> RETURN
> Since you seem convinced that these are "bug"s, and you "do not see any
> reason to use such upper level language" I'll look forward to see you post
> quick fixes. Until then please avoid such degrading comments about xHarbour.

As I expected - current xHarbour behavior was determinate by SUBSTR()
plus negative indexes so it's probably side effect of implementation
of some optimization not a designed and well though solution.
Just like many other xHarbour "features".
But now it's not my problem as long as someone will not try to replicate
it on Harbour and it's the reason I talked about it and showed the code
example.

> I'll not engage in any argument here or elsewhere, this message was only
> needed to defend xHarbour against such offensive  and baseless comments.

I do not work on xHarbour now and in the past I didn't introduced most
of xHarbour "extensions". It's not my fault that xHarbour is very
good example of some very bad design decision which now cannot be
fixed or reverted due to existing user code. I hope that in Harbour
something like that will not happen (at least not too often) so I'm
presenting possible danger things and xHarbour is usually very good
source of examples. That's all.

Wrong things in xHarbour happened in the past and now we can see
the results. It should not be sth new for you because many times
in the past I talked about it on xHarbour devel list, f.e. two years
ago (Thu, 14 Apr 2005 23:39:19 +0200) I wrote in one of messages
(Message-ID: <20050414213919.GA2054@189-moc-1.acn.waw.pl>) I sent
to xHarbour devel list (sorry for bad English and typos copied as
is without modifications):

,--------------------------------------------------------------------
| The cost of serving C level items is growing-up - we cannot remove
| your hack what will have to cause four additional mutex call in MT
| code. An I do not think we have finished. IMHO the number of known
| problems will grow up and we are stronger bound with 3-rd party
| code so our flexibility in fixes is systematically reduced.
| It will be interesting to see how xHarbour core VM code will look
| in some years. Look at Clipper's documented API and think why it
| was done in such way.
`--------------------------------------------------------------------

Today I can only say that IMHO it looks worser then I expected :-(
But it's only my opinion and you do not have to agree with it.
My advice: look at Harbour ChangeLog files for last two years and
begin to port Harbour fixes and implementation of some extensions
to xHarbour. It should greatly help in many cases.


I do not want to create a flame war here so I will not answer for
any other things then planed or not Harbour code modifications.
Now I answered because I believe that some of my arguments maybe
important in decision about farther Harbour modifications for
other Harbour developers.


best regards,
Przemek
From alex at belacy.belgorod.su  Wed Apr 18 03:12:32 2007
From: alex at belacy.belgorod.su (Alexander S.Kresin)
Date: Wed Apr 18 03:18:14 2007
Subject: [Harbour] Re: Namespace problems
In-Reply-To: <7850585D-A418-4B42-B58E-8B99E1658650@syenar.hu>
References: <7850585D-A418-4B42-B58E-8B99E1658650@syenar.hu>
Message-ID: <1688318797.20070418111232@belacy.belgorod.su>

Wednesday, April 18, 2007, 4:06:38 AM, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

SV> 2) include/hbapicdp.h has CPID_* and UNITB_* #defines
SV>       also not prefixed. These might collide with other C level
SV>       codepage related stuff, since the names are not very
SV>       unique this way.

SV> I can fix all/any of these in case we agree on them.

  Since these are internal names and they doesn't touch the end
  programmer, I haven't any objections.

-- 
Regards,
 Alexander
http://kresin.belgorod.su


From lorenzo.fiorini at gmail.com  Wed Apr 18 03:31:43 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr 18 03:31:59 2007
Subject: [Harbour] ChangeLog 2007-04-18 09:25 UTC+0200 Lorenzo Fiorini
Message-ID: <9257026e0704180031s37b77be7g46238facf1fcbdab@mail.gmail.com>

2007-04-18 09:25 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
  * harbour/source/compiler/gencobj.c
    * added support of HB_CFG_FILE envvar which define the file name to use
	 for -go compiler switch borrowed from xHarbour
  * harbour/config/w32/mingw32.cf
    * fixed a typo

Since there is no doc about this nice feature, there is a long
"printf" description how to define harbour.cfg if not found.

I hope it is English :) feel free to fix it.
Should it be defined as compiler error?

Comments are welcome.

regards,
Lorenzo
From e.m.giordano at emagsoftware.it  Wed Apr 18 03:34:01 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 18 03:34:38 2007
Subject: [Harbour] Error in latest CVS
Message-ID: <008501c7818b$ef39ac40$0100a8c0@emag>

Error E2140 source\compiler\gencobj.c 129: Declaration is not allowed here in 
function hb_compGenCObj

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Wed Apr 18 03:39:47 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 18 03:40:20 2007
Subject: [Harbour] Re: Namespace problems
In-Reply-To: <1688318797.20070418111232@belacy.belgorod.su>
References: <7850585D-A418-4B42-B58E-8B99E1658650@syenar.hu>
	<1688318797.20070418111232@belacy.belgorod.su>
Message-ID: <CE22338C-ED29-486C-B3BA-3EB06AB307BF@syenar.hu>

Thanks Alexander.

Brgds,
Viktor

On 2007.04.18., at 9:12, Alexander S.Kresin wrote:

> Wednesday, April 18, 2007, 4:06:38 AM, Szak?ts Viktor <harbour. 
> 01@syenar.hu> wrote:
>
> SV> 2) include/hbapicdp.h has CPID_* and UNITB_* #defines
> SV>       also not prefixed. These might collide with other C level
> SV>       codepage related stuff, since the names are not very
> SV>       unique this way.
>
> SV> I can fix all/any of these in case we agree on them.
>
>   Since these are internal names and they doesn't touch the end
>   programmer, I haven't any objections.
>
> -- 
> Regards,
>  Alexander
> http://kresin.belgorod.su
>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From lorenzo.fiorini at gmail.com  Wed Apr 18 03:43:22 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr 18 03:43:26 2007
Subject: [Harbour] CahngeLog 2007-04-18 09:43 UTC+0200 Lorenzo Fiorini
Message-ID: <9257026e0704180043r27645671lcbe75e7b9eb57cd8@mail.gmail.com>

2007-04-18 09:43 UTC+0200 Lorenzo Fiorini (lorenzo.fiorini/at/gmail.com)
  * harbour/source/compiler/gencobj.c
    * fixed declaration

regards,
Lorenzo
From lorenzo.fiorini at gmail.com  Wed Apr 18 03:44:18 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr 18 03:44:22 2007
Subject: [Harbour] Error in latest CVS
In-Reply-To: <008501c7818b$ef39ac40$0100a8c0@emag>
References: <008501c7818b$ef39ac40$0100a8c0@emag>
Message-ID: <9257026e0704180044q5596d47boa2fde388ba1487fe@mail.gmail.com>

On 4/18/07, Enrico Maria Giordano <e.m.giordano@emagsoftware.it> wrote:

> Error E2140 source\compiler\gencobj.c 129: Declaration is not allowed here in
> function hb_compGenCObj

Thanks, I hope it is ok now.

Ciao,
Lroenzo
From niki at synel.co.il  Wed Apr 18 03:45:27 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed Apr 18 03:46:06 2007
Subject: [Harbour] Re: compiler licence
References: <46248D79.3B50@synel.co.il>
Message-ID: <4625CC97.3144@synel.co.il>

I wrote:
>> Maybe part of the //info or //build information which is going
>> to be shown ONLY if the code was included?

Przemyslaw Czerpak wrote:
> Yes, we can add additional information about _our_ GPL code in the
> above switches but it will be hard to make sth like that with 3-rd
> party code.

What I asked is an easy way for the programmer to know the licence
status of his/her code. Not something that try to enforce the licence.
It is the responsibility of the 3rd party vendor to select a valid
licence for its product.

Any more input on this subject?


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From e.m.giordano at emagsoftware.it  Wed Apr 18 03:48:18 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 18 03:48:53 2007
Subject: [Harbour] Error in latest CVS
References: <008501c7818b$ef39ac40$0100a8c0@emag>
	<9257026e0704180044q5596d47boa2fde388ba1487fe@mail.gmail.com>
Message-ID: <009601c7818d$ee1f0290$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Lorenzo Fiorini" <lorenzo.fiorini@gmail.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 18 aprile 2007 9.44
Oggetto: Re: [Harbour] Error in latest CVS


> > Error E2140 source\compiler\gencobj.c 129: Declaration is not allowed here 
> > in
> > function hb_compGenCObj
>
> Thanks, I hope it is ok now.

Yes, but now there is a warning:

Warning W8004 source\compiler\gencobj.c 111: 'pszCfgFileName' is assigned a 
value that is never used in function hb_compGenCObj

:-)

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From lorenzo.fiorini at gmail.com  Wed Apr 18 04:06:02 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr 18 04:06:05 2007
Subject: [Harbour] Error in latest CVS
In-Reply-To: <009601c7818d$ee1f0290$0100a8c0@emag>
References: <008501c7818b$ef39ac40$0100a8c0@emag>
	<9257026e0704180044q5596d47boa2fde388ba1487fe@mail.gmail.com>
	<009601c7818d$ee1f0290$0100a8c0@emag>
Message-ID: <9257026e0704180106nb7e72a3w768f8e43f367b64a@mail.gmail.com>

On 4/18/07, Enrico Maria Giordano <e.m.giordano@emagsoftware.it> wrote:

> Yes, but now there is a warning:
>
> Warning W8004 source\compiler\gencobj.c 111: 'pszCfgFileName' is assigned a
> value that is never used in function hb_compGenCObj

Sorry, I use only Linux gcc and I don't get any warning.

I also don't see any problem looking at the code, but my C knowledge
is very "basic".

Are there "real" C developers that can fix it?

regards,
Lorenzo
From harbour.01 at syenar.hu  Wed Apr 18 04:14:15 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 18 04:14:15 2007
Subject: [Harbour] Error in latest CVS
In-Reply-To: <9257026e0704180106nb7e72a3w768f8e43f367b64a@mail.gmail.com>
References: <008501c7818b$ef39ac40$0100a8c0@emag>
	<9257026e0704180044q5596d47boa2fde388ba1487fe@mail.gmail.com>
	<009601c7818d$ee1f0290$0100a8c0@emag>
	<9257026e0704180106nb7e72a3w768f8e43f367b64a@mail.gmail.com>
Message-ID: <5A0E1DD3-2F5F-4819-99CB-0E766A96EEA9@syenar.hu>

The solution is either to remove "= NULL" from the declaration
of the newly added var, or to move the new "hb_getenv()" call
in place of "NULL" in the same declaration line. I'd choose the latter.

Brgds,
Viktor

On 2007.04.18., at 10:06, Lorenzo Fiorini wrote:

> On 4/18/07, Enrico Maria Giordano <e.m.giordano@emagsoftware.it>  
> wrote:
>
>> Yes, but now there is a warning:
>>
>> Warning W8004 source\compiler\gencobj.c 111: 'pszCfgFileName' is  
>> assigned a
>> value that is never used in function hb_compGenCObj
>
> Sorry, I use only Linux gcc and I don't get any warning.
>
> I also don't see any problem looking at the code, but my C knowledge
> is very "basic".
>
> Are there "real" C developers that can fix it?
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From e.m.giordano at emagsoftware.it  Wed Apr 18 04:14:13 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 18 04:14:47 2007
Subject: [Harbour] Error in latest CVS
References: <008501c7818b$ef39ac40$0100a8c0@emag><9257026e0704180044q5596d47boa2fde388ba1487fe@mail.gmail.com><009601c7818d$ee1f0290$0100a8c0@emag>
	<9257026e0704180106nb7e72a3w768f8e43f367b64a@mail.gmail.com>
Message-ID: <00c401c78191$8cb658b0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Lorenzo Fiorini" <lorenzo.fiorini@gmail.com>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 18 aprile 2007 10.06
Oggetto: Re: [Harbour] Error in latest CVS


> Sorry, I use only Linux gcc and I don't get any warning.
>
> I also don't see any problem looking at the code, but my C knowledge
> is very "basic".
>
> Are there "real" C developers that can fix it?

Let me look at the code...

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From e.m.giordano at emagsoftware.it  Wed Apr 18 04:16:26 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 18 04:17:00 2007
Subject: [Harbour] Error in latest CVS
References: <008501c7818b$ef39ac40$0100a8c0@emag><9257026e0704180044q5596d47boa2fde388ba1487fe@mail.gmail.com><009601c7818d$ee1f0290$0100a8c0@emag><9257026e0704180106nb7e72a3w768f8e43f367b64a@mail.gmail.com>
	<00c401c78191$8cb658b0$0100a8c0@emag>
Message-ID: <00cd01c78191$dc572c50$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Enrico Maria Giordano" <e.m.giordano@emagsoftware.it>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 18 aprile 2007 10.14
Oggetto: Re: [Harbour] Error in latest CVS


> Let me look at the code...

Just remove NULL that is never used from

char * pszCfgFileName = NULL;

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From dmacias at mail.udg.mx  Wed Apr 18 04:17:56 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Wed Apr 18 04:18:00 2007
Subject: [Harbour] Re: ChangeLog 2007-04-06 02:32
	UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
In-Reply-To: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
Message-ID: <4625D434.6070201@mail.udg.mx>

Maurilio:

> tcp_h_errno comes from the use of h_errno (which is redefined inside netdb.h)
> inside hbinet.c, the same is inside source\vm\inet.c on xharbour where it
> compiles without problems.
>
>   
...
> I'll try to do this test next week, just to find out if it can be built (but
> I'm sure it can, given that xharbour can), then I'll let you know.
>
>   

Below are results of    xHarbour    build under OS/2, from fresh 
xHarbour CVS checkout of April 7, without changes and just applying 
make_gnu.cmd

Surprisely, results with and without -DTCPV40HDRS are exactly the same

I made a computer reboot and then change -DTCPV40HDRS to be sure not to 
have some environment setting floating there between both build tests

I am using:
- eComStation 1.2 MR
- gcc (GCC) 3.3.5 (Innotek Build 2005-01-17 06:42) included with eCS


Another question:

xHarbour os2\gcc.cf have:
------------------------------------------------------
# statical linking with GCC 3.2.2 libc as not require its presence on 
user system
LDFLAGS += $(LINKPATHS) -s
------------------------------------------------------

while Harbour os2\gcc.cf have:
------------------------------------------------------
# statical linking with GCC 3.2.2 libc as not require its presence on 
user system
LDFLAGS += $(LINKPATHS)
------------------------------------------------------

-s value should be included in Harbour ?


David Macias


[E:\hbbuild\xharbour]make_gnu.cmd
../../hbdate.c: In function `hb_timeEncStr':
../../hbdate.c:899: warning: `lTime' might be used uninitialized in this 
function
../../gencc.c: In function `hb_p_pushdatetime':
../../gencc.c:1737: warning: int format, LONG arg (arg 3)
../../gencc.c:1737: warning: int format, LONG arg (arg 4)
../../gencc.c: In function `hb_p_pushdate':
../../gencc.c:1747: warning: int format, LONG arg (arg 3)
../../dateshb.c: In function `hb_timectot':
../../dateshb.c:226: warning: `fin' might be used uninitialized in this 
function
../../gtapi.c: In function `hb_ctShadow':
../../gtapi.c:2275: warning: implicit declaration of function 
`hb_gt_SetAttribut
eCT'
../../gtgraph.c: In function `HB_FUN_GTRGB':
../../gtgraph.c:110: warning: left shift count >= width of type
../../gtgraph.c:137: warning: left shift count >= width of type
../../gtgraph.c:141: warning: left shift count >= width of type
../../gtos2.c: In function `hb_gt_Init':
../../gtos2.c:240: warning: dereferencing type-punned pointer will break 
strict-
aliasing rules
../../gtos2.c:247: warning: dereferencing type-punned pointer will break 
strict-
aliasing rules
../../files.c: In function `HB_FUN_SETFDATI':
../../files.c:894: warning: unused variable `szFile'
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbrun.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(net.o): Undefined symbol 
gethostname refere
nced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbdoc.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(net.o): Undefined symbol 
gethostname refere
nced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbmake.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(net.o): Undefined symbol 
gethostname refere
nced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbdict.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [xbscript.exe] Error 1
make[2]: *** [descend] Error 2
make[1]: *** [first] Error 2
make: *** [first] Error 2




From harbour.01 at syenar.hu  Wed Apr 18 04:45:25 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 18 04:45:44 2007
Subject: [Harbour] CHANGELOG: 2007-04-18 10:43 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c78195$Blat.v2.6.1$e89d7c36$c70621cd06c@127.0.0.1>

2007-04-18 10:43 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/codepage/cp_tpl.c
     + Added NOTE about the fact that hb_Translate() 
       (and hb_cdpTranslate()) would only work properly 
       if all codepages for the same language are using the 
       exact same number of lowercase/uppercase cp chars 
       in the exact same order.

   * harbour/source/codepage/Makefile
   * harbour/common.mak
   * harbour/source/codepage/cphu852.c
   * harbour/source/codepage/cphu852s.c
   * harbour/source/codepage/cphuiso.c
   + harbour/source/codepage/cphuisos.c
   * harbour/source/codepage/cphuwin.c
   + harbour/source/codepage/cphuwins.c
     ! Synced HU WIN and HU ISO codepage lower/uppercase 
       strings with HU 852, so that hb_Translate() works 
       properly. (this means there are now several duplicate 
       chars included in the WIN/ISO versions, along with 
       a non-HU char, all just needed to stay compatible with 
       original CA-Cl*pper HU/852 index ordering and keep 
       hb_Translate() working at the same time.)
       IMO, we'd need to introduce a separate "collation" 
       string in each cp file to detach index ordering 
       from upper/lowercase and codepage translation without 
       any hacks, since as this example shows these two 
       are not always in sync. (or, as an alternative we might 
       want to make codepage translation more sophisticated, 
       like converting first to unicode and convert back to 
       the other codepage from unicode, but that leads a bit 
       further.). (If I'm missing something, pls don't hesitate 
       to clarify)
     + Added SixDriver compatible HU ISO/WIN codepage files 
       for the reasons described above.

   * harbour/include/hbapicdp.h
   * harbour/source/rtl/cdpapi.c
   * harbour/source/codepage/cpbg866.c
   * harbour/source/codepage/cpbgiso.c
   * harbour/source/codepage/cpbgwin.c
   * harbour/source/codepage/cpcs852.c
   * harbour/source/codepage/cpcsiso.c
   * harbour/source/codepage/cpcskam.c
   * harbour/source/codepage/cpcswin.c
   * harbour/source/codepage/cpeldos.c
   * harbour/source/codepage/cpelwin.c
   * harbour/source/codepage/cpesdos.c
   * harbour/source/codepage/cpesmwi.c
   * harbour/source/codepage/cpeswin.c
   * harbour/source/codepage/cpfrdos.c
   * harbour/source/codepage/cpgedos.c
   * harbour/source/codepage/cpgewin.c
   * harbour/source/codepage/cphr1250.c
   * harbour/source/codepage/cphr437.c
   * harbour/source/codepage/cphr852.c
   * harbour/source/codepage/cphu852.c
   * harbour/source/codepage/cphu852s.c
   * harbour/source/codepage/cphuiso.c
   * harbour/source/codepage/cphuwin.c
   * harbour/source/codepage/cpit437.c
   * harbour/source/codepage/cpit850.c
   * harbour/source/codepage/cpitisb.c
   * harbour/source/codepage/cpitiso.c
   * harbour/source/codepage/cpltwin.c
   * harbour/source/codepage/cppl852.c
   * harbour/source/codepage/cppliso.c
   * harbour/source/codepage/cpplmaz.c
   * harbour/source/codepage/cpplwin.c
   * harbour/source/codepage/cppt850.c
   * harbour/source/codepage/cpptiso.c
   * harbour/source/codepage/cpru866.c
   * harbour/source/codepage/cprukoi.c
   * harbour/source/codepage/cpruwin.c
   * harbour/source/codepage/cpsl437.c
   * harbour/source/codepage/cpsl852.c
   * harbour/source/codepage/cpsliso.c
   * harbour/source/codepage/cpslwin.c
   * harbour/source/codepage/cpsrwin.c
   * harbour/source/codepage/cptrdos.c
   * harbour/source/codepage/cptrwin.c
   * harbour/source/codepage/cpua866.c
   * harbour/source/codepage/cpuakoi.c
   * harbour/source/codepage/cpuawin.c
   * harbour/source/codepage/uc1250.c
   * harbour/source/codepage/uc1251.c
   * harbour/source/codepage/uc1253.c
   * harbour/source/codepage/uc1254.c
   * harbour/source/codepage/uc1257.c
   * harbour/source/codepage/uc737.c
   * harbour/source/codepage/uc850.c
   * harbour/source/codepage/uc852.c
   * harbour/source/codepage/uc857.c
   * harbour/source/codepage/uc866.c
   * harbour/source/codepage/uc88591b.c
   * harbour/source/codepage/uc8859_1.c
   * harbour/source/codepage/uc8859_2.c
   * harbour/source/codepage/uc8859_5.c
   * harbour/source/codepage/uckam.c
   * harbour/source/codepage/uckoi8.c
   * harbour/source/codepage/uckoi8u.c
   * harbour/source/codepage/ucmaz.c
     ! #define namespace issue in public API header file 
       corrected:
       CPID_* -> HB_CPID_*
       UNITB_* -> HB_UNITB_*

   * harbour/source/compiler/gencobj.c
     ! Fixed warning.

From soporte at dsgsoftware.com  Wed Apr 18 04:51:16 2007
From: soporte at dsgsoftware.com (=?iso-8859-1?Q?Juan_G=E1lvez?=)
Date: Wed Apr 18 04:51:46 2007
Subject: [Harbour] About some xHarbour extensions
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
	<4625D434.6070201@mail.udg.mx>
Message-ID: <001401c78196$c9adb330$6c00000a@PcJuanxp>

Hi all,

I want to test the current status of Harbour.

I'm trying to build our current xHarbour applications with Harbour but I'm 
using some xHarbour extensions intensively that I think there aren't present 
on Harbour.

What do you think about extended codeblocks ?
What do you think about object (message) notation for hash ?

Many thanks
-
Juan G?lvez
DSG Software, S.L.
www.dsg.es 

From e.m.giordano at emagsoftware.it  Wed Apr 18 04:52:19 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 18 04:52:54 2007
Subject: [Harbour] CHANGELOG: 2007-04-18 10:43 UTC+0100 Viktor
	Szakats(harbour.01 syenar.hu)
References: <01c78195$Blat.v2.6.1$e89d7c36$c70621cd06c@127.0.0.1>
Message-ID: <010901c78196$df760640$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Szak?ts Viktor" <harbour.01@syenar.hu>
A: <harbour@harbour-project.org>
Data invio: mercoled? 18 aprile 2007 10.45
Oggetto: [Harbour] CHANGELOG: 2007-04-18 10:43 UTC+0100 Viktor 
Szakats(harbour.01 syenar.hu)


>   * harbour/source/compiler/gencobj.c
>     ! Fixed warning.

Thank you.

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From druzus at priv.onet.pl  Wed Apr 18 05:09:46 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 18 05:10:23 2007
Subject: [Harbour] CHANGELOG: 2007-04-18 10:43 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
In-Reply-To: <01c78195$Blat.v2.6.1$e89d7c36$c70621cd06c@127.0.0.1>
References: <01c78195$Blat.v2.6.1$e89d7c36$c70621cd06c@127.0.0.1>
Message-ID: <20070418090946.GA12098@localhost.localdomain>

On Wed, 18 Apr 2007, Szak?ts Viktor wrote:
>        IMO, we'd need to introduce a separate "collation" 
>        string in each cp file to detach index ordering 
>        from upper/lowercase and codepage translation without 
>        any hacks, since as this example shows these two 
>        are not always in sync.

his will not work by definition.
    index on F1 to T1
    dbseek(cValMain)
    while F1 <= cValMac  /* here you have problem because index ordering
                            has to be exactly the same as in HVM or this
                            comparis will fail */
        ...
    enddo

>        (or, as an alternative we might 
>        want to make codepage translation more sophisticated, 
>        like converting first to unicode and convert back to 
>        the other codepage from unicode, but that leads a bit 
>        further.). (If I'm missing something, pls don't hesitate 
>        to clarify)

Unicode translations between codepages (also between differ languages
is sth what I wanted to add for a long time. There are still some
modifications for multibyte and neutral characters I wanted to add
to CP code so I'll also add unicode base translations too.

best regards,
Przemek
From lorenzo.fiorini at gmail.com  Wed Apr 18 05:20:33 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr 18 05:20:36 2007
Subject: [Harbour] CHANGELOG: 2007-04-18 10:43 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
In-Reply-To: <01c78195$Blat.v2.6.1$e89d7c36$c70621cd06c@127.0.0.1>
References: <01c78195$Blat.v2.6.1$e89d7c36$c70621cd06c@127.0.0.1>
Message-ID: <9257026e0704180220k54f66a9er163d05f795c2fd22@mail.gmail.com>

On 4/18/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

>    * harbour/source/compiler/gencobj.c
>      ! Fixed warning.

Many thanks.

regards,
Lorenzo
From druzus at priv.onet.pl  Wed Apr 18 06:09:39 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 18 06:10:14 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <001401c78196$c9adb330$6c00000a@PcJuanxp>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
	<4625D434.6070201@mail.udg.mx>
	<001401c78196$c9adb330$6c00000a@PcJuanxp>
Message-ID: <20070418100939.GA12377@localhost.localdomain>

On Wed, 18 Apr 2007, Juan G?lvez wrote:
> What do you think about extended codeblocks ?

I've never used them in xHarbour so I cannot say if it can be easy
ported or not. If extended codeblocks are unnamed functions then
I think yes they can but they can be also some differ thing.

> What do you think about object (message) notation for hash ?

I do not like it but if you want then can add such "feature" yourself
in just few lines, see code below.

best regards,
Przemek


/******************************************************************/
/* access/assign hash items using object messages 
 */
#include "error.ch"
init proc hashmsginit()
local cbErr := errorBlock( {|oErr| hashMsgErr( oErr, cbErr ) } )
return
static function hashMsgErr( oErr, cbErr )
if oErr:CanSubstitute .and. len( oErr:args ) > 0 .and. ;
   hb_isHash( oErr:args[ 1 ] )
   if oErr:genCode == EG_NOVARMETHOD .and. oErr:subCode == 1005
      return oErr:args[ 1, oErr:operation ] := ;
                     iif( len( oErr:args ) > 1, oErr:args[ 2 ], NIL )
   elseif oErr:genCode == EG_NOMETHOD .and. oErr:subCode == 1004
      return oErr:args[ 1, oErr:operation ]
   endif
endif
return eval( cbErr, oErr )
/******************************************************************/


proc main()
local hValue := {=>}, h
? "Test of assigning and accessing hash items using object messages"
hValue:KEY1:="key1"
hValue:KEY2:="key2"
? "===="
hb_heval( hValue, { |k,v,i| qout( i, "{", k, "=>", v, "}" ) } )
? "===="
? hValue:KEY1
? hValue:KEY2
? "===="
for each h in hValue
   ? h:__enumIndex(), "{", h:__enumKey(), "=>", h, "}"
next
? "===="
return
From sscc at mweb.co.za  Wed Apr 18 06:29:52 2007
From: sscc at mweb.co.za (Alex Strickland)
Date: Wed Apr 18 06:29:56 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070418100939.GA12377@localhost.localdomain>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>	<4625D434.6070201@mail.udg.mx>	<001401c78196$c9adb330$6c00000a@PcJuanxp>
	<20070418100939.GA12377@localhost.localdomain>
Message-ID: <4625F320.7070108@mweb.co.za>

Przemyslaw Czerpak wrote:
> On Wed, 18 Apr 2007, Juan G?lvez wrote:
>> What do you think about extended codeblocks ?
> 
> I've never used them in xHarbour so I cannot say if it can be easy
> ported or not. If extended codeblocks are unnamed functions then
> I think yes they can but they can be also some differ thing.

Aren't they just codeblocks defined over more than 1 line?

Regards
Alex

From harbour.01 at syenar.hu  Wed Apr 18 06:38:05 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 18 06:38:17 2007
Subject: [Harbour] CHANGELOG: 2007-04-18 10:43 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
In-Reply-To: <20070418090946.GA12098@localhost.localdomain>
References: <01c78195$Blat.v2.6.1$e89d7c36$c70621cd06c@127.0.0.1>
	<20070418090946.GA12098@localhost.localdomain>
Message-ID: <1A0BDDFA-FBB3-468C-96A0-09CB33EE7274@syenar.hu>

> his will not work by definition.
>     index on F1 to T1
>     dbseek(cValMain)
>     while F1 <= cValMac  /* here you have problem because index  
> ordering
>                             has to be exactly the same as in HVM or  
> this
>                             comparis will fail */
>         ...
>     enddo

hm, you're right, I was thinking of something like this (but not  
exactly this)
on the back of my mind.

>>        (or, as an alternative we might
>>        want to make codepage translation more sophisticated,
>>        like converting first to unicode and convert back to
>>        the other codepage from unicode, but that leads a bit
>>        further.). (If I'm missing something, pls don't hesitate
>>        to clarify)
>
> Unicode translations between codepages (also between differ languages
> is sth what I wanted to add for a long time. There are still some
> modifications for multibyte and neutral characters I wanted to add
> to CP code so I'll also add unicode base translations too.

Many thanks, that will be the best solution.

Brgds,
Viktor



From druzus at priv.onet.pl  Wed Apr 18 07:00:16 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 18 07:00:51 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <4625F320.7070108@mweb.co.za>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
	<4625D434.6070201@mail.udg.mx>
	<001401c78196$c9adb330$6c00000a@PcJuanxp>
	<20070418100939.GA12377@localhost.localdomain>
	<4625F320.7070108@mweb.co.za>
Message-ID: <20070418110016.GA14036@localhost.localdomain>

On Wed, 18 Apr 2007, Alex Strickland wrote:
> >On Wed, 18 Apr 2007, Juan G?lvez wrote:
> >>What do you think about extended codeblocks ?
> >I've never used them in xHarbour so I cannot say if it can be easy
> >ported or not. If extended codeblocks are unnamed functions then
> >I think yes they can but they can be also some differ thing.
> Aren't they just codeblocks defined over more than 1 line?

No. They are accpeting stetments inside not only expressions like
normal codeblocks, f.e.:
    cb := < | p |
          LOCAL h
          IF p == NIL
             ? "Wrong parameter", p
             RETURN NIL
          ENDIF
          h := FOPEN( p )
          IF h == -1
             h := NIL
          ENDIF
          RETURN h
       >

but even small basic tests shows anomalies in implementation.
Look at example below and try to guess the results then compile
and execute it.

best regards,
Przemek


    proc main()
    local cb
    cb := < | p1, p2, p3 |
             local l1, l2, l3
             ? p1, p2, p3
             ? l1, l2, l3
          >
    ? valtype(cb)
    ? eval(cb,1,2,3,4,5,6,7,8,9)
    ?
    return
From harbour.01 at syenar.hu  Wed Apr 18 07:17:04 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 18 07:17:13 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070418110016.GA14036@localhost.localdomain>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
	<4625D434.6070201@mail.udg.mx>
	<001401c78196$c9adb330$6c00000a@PcJuanxp>
	<20070418100939.GA12377@localhost.localdomain>
	<4625F320.7070108@mweb.co.za>
	<20070418110016.GA14036@localhost.localdomain>
Message-ID: <FC9E7286-C8BC-4870-8A16-DDC8DCE66026@syenar.hu>

> No. They are accpeting stetments inside not only expressions like
> normal codeblocks, f.e.:
>     cb := < | p |
>           LOCAL h
>           IF p == NIL
>              ? "Wrong parameter", p
>              RETURN NIL
>           ENDIF
>           h := FOPEN( p )
>           IF h == -1
>              h := NIL
>           ENDIF
>           RETURN h
>>
> but even small basic tests shows anomalies in implementation.
> Look at example below and try to guess the results then compile
> and execute it.

The usefulness is questionable too, because the same
can be achieved using a normal function and a call into that
function. The only thing gained here is the minimal overhead
of the extra function call.

Same can be solved by function pointer and DO(), without
the minimal overhead:

cb := @cb_func()
Do( cb, ... )

STATIC FUNCTION cb_func( p )
           LOCAL h
           IF p == NIL
              ? "Wrong parameter", p
              RETURN NIL
           ENDIF
           h := FOPEN( p )
           IF h == -1
              h := NIL
           ENDIF
           RETURN h

Brgds,
Viktor

From dbtopas at dbtopas.lt  Wed Apr 18 07:41:39 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Wed Apr 18 07:39:08 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <FC9E7286-C8BC-4870-8A16-DDC8DCE66026@syenar.hu>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>	<4625D434.6070201@mail.udg.mx>	<001401c78196$c9adb330$6c00000a@PcJuanxp>	<20070418100939.GA12377@localhost.localdomain>	<4625F320.7070108@mweb.co.za>	<20070418110016.GA14036@localhost.localdomain>
	<FC9E7286-C8BC-4870-8A16-DDC8DCE66026@syenar.hu>
Message-ID: <462603F3.7000409@dbtopas.lt>

Szak?ts Viktor wrote:
> The usefulness is questionable too, because the same
> can be achieved using a normal function and a call into that
> function. The only thing gained here is the minimal overhead
> of the extra function call.

Hello,


the most important different between codeblocks and pointer of nameless 
function are availability to access local variable of the function which 
contains codeblock.

This could not be implemented using nameless function:
    LOCAL cb, a := 1
    cb := <|p|
            ? p + a
          >
   ? EVAL(cb, 6)

But if implementation of extended codeblock could not be "clean" and 
requires some hacks or side effects in PP, compiler or parameter 
handling (see sample of Przemyslaw) it should not be implemented.

The are porting many xHarbour extensions or trying to be xHarbour 
compatible these days, and sometimes I affraid that Harbour's code will 
become hacky also.


Best regards,
Mindaugas
From soporte at dsgsoftware.com  Wed Apr 18 07:39:06 2007
From: soporte at dsgsoftware.com (=?iso-8859-2?Q?Juan_G=E1lvez?=)
Date: Wed Apr 18 07:40:54 2007
Subject: [Harbour] About some xHarbour extensions
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx><4625D434.6070201@mail.udg.mx><001401c78196$c9adb330$6c00000a@PcJuanxp><20070418100939.GA12377@localhost.localdomain><4625F320.7070108@mweb.co.za>
	<20070418110016.GA14036@localhost.localdomain>
Message-ID: <002a01c781ae$2e3d9970$6c00000a@PcJuanxp>

Przemek,

About extended codeblocks, I see you're testing them ... I'll wait your
opinion ...

About your suggestion to be able to use hash with object messages, I thank
it but I wonder if its intensive use will cause a poor performance ...

Best regards,
Juan

----- Original Message ----- 
From: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Wednesday, April 18, 2007 1:00 PM
Subject: Re: [Harbour] About some xHarbour extensions


> On Wed, 18 Apr 2007, Alex Strickland wrote:
>> >On Wed, 18 Apr 2007, Juan G?lvez wrote:
>> >>What do you think about extended codeblocks ?
>> >I've never used them in xHarbour so I cannot say if it can be easy
>> >ported or not. If extended codeblocks are unnamed functions then
>> >I think yes they can but they can be also some differ thing.
>> Aren't they just codeblocks defined over more than 1 line?
>
> No. They are accpeting stetments inside not only expressions like
> normal codeblocks, f.e.:
>    cb := < | p |
>          LOCAL h
>          IF p == NIL
>             ? "Wrong parameter", p
>             RETURN NIL
>          ENDIF
>          h := FOPEN( p )
>          IF h == -1
>             h := NIL
>          ENDIF
>          RETURN h
>       >
>
> but even small basic tests shows anomalies in implementation.
> Look at example below and try to guess the results then compile
> and execute it.
>
> best regards,
> Przemek
>
>
>    proc main()
>    local cb
>    cb := < | p1, p2, p3 |
>             local l1, l2, l3
>             ? p1, p2, p3
>             ? l1, l2, l3
>          >
>    ? valtype(cb)
>    ? eval(cb,1,2,3,4,5,6,7,8,9)
>    ?
>    return
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From harbour.01 at syenar.hu  Wed Apr 18 07:52:02 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 18 07:51:57 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <462603F3.7000409@dbtopas.lt>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>	<4625D434.6070201@mail.udg.mx>	<001401c78196$c9adb330$6c00000a@PcJuanxp>	<20070418100939.GA12377@localhost.localdomain>	<4625F320.7070108@mweb.co.za>	<20070418110016.GA14036@localhost.localdomain>
	<FC9E7286-C8BC-4870-8A16-DDC8DCE66026@syenar.hu>
	<462603F3.7000409@dbtopas.lt>
Message-ID: <7B44742D-1C32-4FAB-83AA-0D9AC0E53C3F@syenar.hu>

> the most important different between codeblocks and pointer of  
> nameless function are availability to access local variable of the  
> function which contains codeblock.
>
> This could not be implemented using nameless function:

True, but with minimal effort these can be solved using codeblocks /
worker function / reference params / objects in a cleaner, more modular,
easier to maintain way.

>  LOCAL cb, a := 1
>    cb := <|p|
>            ? p + a
>          >
>   ? EVAL(cb, 6)
>
> But if implementation of extended codeblock could not be "clean"  
> and requires some hacks or side effects in PP, compiler or  
> parameter handling (see sample of Przemyslaw) it should not be  
> implemented.
>
> The are porting many xHarbour extensions or trying to be xHarbour  
> compatible these days, and sometimes I affraid that Harbour's code  
> will become hacky also.

Yes, we should definitiely avoid that, otherwise we'd lose one of
the best merits of Harbour.

Brgds,
Viktor



From maurilio.longo at libero.it  Wed Apr 18 09:15:13 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Wed Apr 18 09:15:56 2007
Subject: [Harbour] Re: ChangeLog 2007-04-06 
	02:32UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
	<4625D434.6070201@mail.udg.mx>
Message-ID: <462619E1.E5283443@libero.it>

David,

I've just rebuilt xharbour, I got your warnings but not the error.

Please do note however that using -DTCPV40HDRS is _not_ enough, you have to
change the library path so that the compiler finds V40 libraries _before_ the
32bit ones, it is clearly explained in GCC docs.

Anyway, your error does not come from -DTCPV40HDRS.

I don't use gnumake.cmd, I simply issue a make inside xharbour dir.

-s is used to strip the symbol table, this way you get smaller .exes and .dlls

Best regards.

Maurilio.

PS.  
gcc --version
gcc (GCC) 3.3.5 (Bird Build 2006-03-18 05:37)


David Arturo Macias Corona ha scritto:
> 
> Maurilio:
> 
> > tcp_h_errno comes from the use of h_errno (which is redefined inside netdb.h)
> > inside hbinet.c, the same is inside source\vm\inet.c on xharbour where it
> > compiles without problems.
> >
> >
> ...
> > I'll try to do this test next week, just to find out if it can be built (but
> > I'm sure it can, given that xharbour can), then I'll let you know.
> >
> >
> 
> Below are results of    xHarbour    build under OS/2, from fresh
> xHarbour CVS checkout of April 7, without changes and just applying
> make_gnu.cmd
> 
> Surprisely, results with and without -DTCPV40HDRS are exactly the same
> 
> I made a computer reboot and then change -DTCPV40HDRS to be sure not to
> have some environment setting floating there between both build tests
> 
> I am using:
> - eComStation 1.2 MR
> - gcc (GCC) 3.3.5 (Innotek Build 2005-01-17 06:42) included with eCS
> 
> Another question:
> 
> xHarbour os2\gcc.cf have:
> ------------------------------------------------------
> # statical linking with GCC 3.2.2 libc as not require its presence on
> user system
> LDFLAGS += $(LINKPATHS) -s
> ------------------------------------------------------
> 
> while Harbour os2\gcc.cf have:
> ------------------------------------------------------
> # statical linking with GCC 3.2.2 libc as not require its presence on
> user system
> LDFLAGS += $(LINKPATHS)
> ------------------------------------------------------
> 
> -s value should be included in Harbour ?
> 
> David Macias
> 
> [E:\hbbuild\xharbour]make_gnu.cmd
> ../../hbdate.c: In function `hb_timeEncStr':
> ../../hbdate.c:899: warning: `lTime' might be used uninitialized in this
> function
> ../../gencc.c: In function `hb_p_pushdatetime':
> ../../gencc.c:1737: warning: int format, LONG arg (arg 3)
> ../../gencc.c:1737: warning: int format, LONG arg (arg 4)
> ../../gencc.c: In function `hb_p_pushdate':
> ../../gencc.c:1747: warning: int format, LONG arg (arg 3)
> ../../dateshb.c: In function `hb_timectot':
> ../../dateshb.c:226: warning: `fin' might be used uninitialized in this
> function
> ../../gtapi.c: In function `hb_ctShadow':
> ../../gtapi.c:2275: warning: implicit declaration of function
> `hb_gt_SetAttribut
> eCT'
> ../../gtgraph.c: In function `HB_FUN_GTRGB':
> ../../gtgraph.c:110: warning: left shift count >= width of type
> ../../gtgraph.c:137: warning: left shift count >= width of type
> ../../gtgraph.c:141: warning: left shift count >= width of type
> ../../gtos2.c: In function `hb_gt_Init':
> ../../gtos2.c:240: warning: dereferencing type-punned pointer will break
> strict-
> aliasing rules
> ../../gtos2.c:247: warning: dereferencing type-punned pointer will break
> strict-
> aliasing rules
> ../../files.c: In function `HB_FUN_SETFDATI':
> ../../files.c:894: warning: unused variable `szFile'
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> make[3]: *** [hbrun.exe] Error 1
> make[2]: *** [descend] Error 2
> ../../../../source/rtl/os2/gcc/rtl.a(net.o): Undefined symbol
> gethostname refere
> nced from text segment
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> make[3]: *** [hbdoc.exe] Error 1
> make[2]: *** [descend] Error 2
> ../../../../source/rtl/os2/gcc/rtl.a(net.o): Undefined symbol
> gethostname refere
> nced from text segment
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> make[3]: *** [hbmake.exe] Error 1
> make[2]: *** [descend] Error 2
> ../../../../source/rtl/os2/gcc/rtl.a(net.o): Undefined symbol
> gethostname refere
> nced from text segment
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> make[3]: *** [hbdict.exe] Error 1
> make[2]: *** [descend] Error 2
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> ../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
> _hb_gt_SetAttrib
> uteCT referenced from text segment
> make[3]: *** [xbscript.exe] Error 1
> make[2]: *** [descend] Error 2
> make[1]: *** [first] Error 2
> make: *** [first] Error 2
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From druzus at priv.onet.pl  Wed Apr 18 10:01:12 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 18 10:01:50 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
Message-ID: <20070418140112.GA16238@localhost.localdomain>

On Wed, 18 Apr 2007, Juan G?lvez wrote:
> About your suggestion to be able to use hash with object messages, I thank
> it but I wonder if its intensive use will cause a poor performance ...

Yes it is. It will be fatal, about 100 times slower. The cost of creating
error object in Harbour and xHarbour is much bigger then in Clipper and
it will consume most of time.
But using messages to access/assign hash items is also slower then
direct indexing. Of course the difference is not such huge.
See the results from the test below:

druzus:/tmp/5# xhbmk -n -w -es2 -l -gtcgi t1 && ./t1
xHarbour Compiler build 0.99.71 (SimpLex)
Copyright 1999-2007, http://www.xharbour.org http://www.harbour-project.org/
Compiling 't1.prg'...
Lines 72, Functions/Procedures 1
Generating C source output to 't1.c'...
Done.
Linux 2.6.15 i686 xHarbour build 0.99.71 Intl. (SimpLex) 04/18/07 15:31:40
Empty loop overhead:          0.19
hValue["ABC"]:=x          0.27 sec.
x:=hValue["ABC"]          0.38 sec.
hValue["ABC"]++           0.61 sec.
hValue:ABC:=x             0.39 sec.
x:=hValue:ABC             0.44 sec.
hValue:ABC++              0.78 sec.
druzus:/tmp/5#

Using the emulation we have:

druzus:/tmp/5# hbmk -n -w -es2 -gtcgi t1 && ./t1
Harbour devel build 1.1-0 Intl.
Copyright 1999-2007, http://www.harbour-project.org/
Compiling 't1.prg'...
Lines 230, Functions/Procedures 3
Generating C source output to 't1.c'... Done.

Linux 2.6.15 i686 Harbour devel build 1.1-0 Intl. 04/18/07 15:31:57
Empty loop overhead:          0.13
hValue["ABC"]:=x          0.24 sec.
x:=hValue["ABC"]          0.26 sec.
hValue["ABC"]++           0.28 sec.
hValue:ABC:=x            22.41 sec.
x:=hValue:ABC            20.94 sec.
hValue:ABC++             46.15 sec.
druzus:/tmp/5#


Direct access to hash items with message interface is just few lines
with current classes code so I added it to make a test and these are
results:

druzus:/tmp/5# hbmk -n -w -es2 -gtcgi t1 && ./t1
Harbour devel build 1.1-0 Intl.
Copyright 1999-2007, http://www.harbour-project.org/
Compiling 't1.prg'...
Lines 87, Functions/Procedures 1
Generating C source output to 't1.c'... Done.

Linux 2.6.15 i686 Harbour devel build 1.1-0 Intl. 04/18/07 15:46:28
Empty loop overhead:          0.13
hValue["ABC"]:=x          0.24 sec.
x:=hValue["ABC"]          0.25 sec.
hValue["ABC"]++           0.28 sec.
hValue:ABC:=x             0.35 sec.
x:=hValue:ABC             0.37 sec.
hValue:ABC++              0.68 sec.
druzus:/tmp/5#

But I have some doubts if I should commit it.

best regards,
Przemek



/*** t1.prg ***/
#define N_LOOP 1000000
proc main()
local i, x:=0, hValue:={"ABC"=>0}, t, tLoop

? OS(), VERSION(), DATE(), TIME()

tLoop:=secondsCPU()
for i:=1 to N_LOOP
next
tLoop:=secondsCPU()-tLoop
? "Empty loop overhead:", tLoop

t:=secondsCPU()
for i:=1 to N_LOOP
   hValue["ABC"]:=x
next
? 'hValue["ABC"]:=x', secondsCPU() - t - tLoop, "sec."

t:=secondsCPU()
for i:=1 to N_LOOP
   x:=hValue["ABC"]
next
? 'x:=hValue["ABC"]', secondsCPU() - t - tLoop, "sec."

t:=secondsCPU()
hValue["ABC"]:=0
for i:=1 to N_LOOP
   hValue["ABC"]++
next
? 'hValue["ABC"]++ ', secondsCPU() - t - tLoop, "sec."

t:=secondsCPU()
for i:=1 to N_LOOP
   hValue:ABC:=x
next
? 'hValue:ABC:=x   ', secondsCPU() - t - tLoop, "sec."

t:=secondsCPU()
for i:=1 to N_LOOP
   x:=hValue:ABC
next
? 'x:=hValue:ABC   ', secondsCPU() - t - tLoop, "sec."

t:=secondsCPU()
hValue:ABC:=0
for i:=1 to N_LOOP
   hValue:ABC++
next
? 'hValue:ABC++    ', secondsCPU() - t - tLoop, "sec."
?
return

#include "error.ch"
init proc hashmsginit()
local cbErr := errorBlock( {|oErr| hashMsgErr( oErr, cbErr ) } )
return
static function hashMsgErr( oErr, cbErr )
if oErr:CanSubstitute .and. len( oErr:args ) > 0 .and. hb_isHash( oErr:args[ 1 ] )
   if oErr:genCode == EG_NOVARMETHOD .and. oErr:subCode == 1005
      return oErr:args[ 1, oErr:operation ] := ;
                     iif( len( oErr:args ) > 1, oErr:args[ 2 ], NIL )
   elseif oErr:genCode == EG_NOMETHOD .and. oErr:subCode == 1004
      return oErr:args[ 1, oErr:operation ]
   endif
endif
return eval( cbErr, oErr )
/*** t1.prg ***/
From harbour.01 at syenar.hu  Wed Apr 18 10:21:52 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 18 10:22:05 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070418140112.GA16238@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
Message-ID: <FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>

On 2007.04.18., at 16:01, Przemyslaw Czerpak wrote:

>
> But I have some doubts if I should commit it.

Me too.

Reaons 1: This syntax is hiding what is really going on "under the  
hood", so
                     it makes the source less readable / maintainable.
Reason 2: I fail to see any advantage over the "pure" code (my fault  
probably),
                     where pure code is already an extension.
Reason 3: If we ever want to introduce object interface for hash  
type, I think we
                     need to think it over first and find the best  
solution considering the
                     needs (and benefits) and development "costs".  
This feature, as it is
                     now, doesn't seem to be a complete solution.

Correct me if I'm wrong but there could be built a hash class on the  
top of the
hash functions with similar functionality (maybe not similar syntax  
though) and
with no low-level support from Harbour.

Brgds,
Viktor

From soporte at dsgsoftware.com  Wed Apr 18 11:42:39 2007
From: soporte at dsgsoftware.com (=?iso-8859-2?Q?Juan_G=E1lvez?=)
Date: Wed Apr 18 11:42:56 2007
Subject: [Harbour] About some xHarbour extensions
References: <20070418110016.GA14036@localhost.localdomain><002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
Message-ID: <004601c781d0$3c0ffd50$6c00000a@PcJuanxp>

Przemek,

> But I have some doubts if I should commit it.

Perhaps it could only exist under xHarbour compatibility ...

From toninhofwi at yahoo.com.br  Wed Apr 18 12:04:26 2007
From: toninhofwi at yahoo.com.br (Toninho@fwi)
Date: Wed Apr 18 12:03:35 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <004601c781d0$3c0ffd50$6c00000a@PcJuanxp>
References: <20070418110016.GA14036@localhost.localdomain><002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<004601c781d0$3c0ffd50$6c00000a@PcJuanxp>
Message-ID: <vbgc239kaihnd08miq8qee3uk5qbk7hvgn@4ax.com>

>Perhaps it could only exist under xHarbour compatibility ...

I agree.

IMHO we need have in mind that 2 compilers need be compatible, and
users can choice one or another, simple changing a #define.

Regards,

Toninho.


	

	
		
_______________________________________________________ 
Yahoo! Mail - Sempre a melhor opo para voc! 
Experimente j e veja as novidades. 
http://br.yahoo.com/mailbeta/tudonovo/
From hbco2 at sbcglobal.net  Wed Apr 18 12:17:46 2007
From: hbco2 at sbcglobal.net (Bill Smith)
Date: Wed Apr 18 12:18:42 2007
Subject: [Harbour] About some xHarbour extensions
References: <20070418110016.GA14036@localhost.localdomain><002a01c781ae$2e3d9970$6c00000a@PcJuanxp><20070418140112.GA16238@localhost.localdomain><004601c781d0$3c0ffd50$6c00000a@PcJuanxp>
	<vbgc239kaihnd08miq8qee3uk5qbk7hvgn@4ax.com>
Message-ID: <006b01c781d5$25d239e0$0303a8c0@hbco>

----- Original Message ----- 
From: "Toninho@fwi" <toninhofwi@yahoo.com.br>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Wednesday, April 18, 2007 9:04 AM
Subject: Re: Re: [Harbour] About some xHarbour extensions


>>Perhaps it could only exist under xHarbour compatibility ...

>I agree.

>IMHO we need have in mind that 2 compilers need be compatible, and
>users can choice one or another, simple changing a #define.

But can the two compilers be made compatible?  Przemyslaw has described why
they cannot, and I for one very much respect his opinion (to say the least).
Szakats has described the resources available in a specific case, but in a
way that describes the whole project.

Seems there are many improvements to be made to harbour yet without
duplicating others efforts.

Bill






_______________________________________________________
Yahoo! Mail - Sempre a melhor op??o para voc?!
Experimente j? e veja as novidades.
http://br.yahoo.com/mailbeta/tudonovo/
_______________________________________________
Harbour mailing list
Harbour@harbour-project.org
http://lists.harbour-project.org/mailman/listinfo/harbour

From toninhofwi at yahoo.com.br  Wed Apr 18 12:29:50 2007
From: toninhofwi at yahoo.com.br (Toninho@fwi)
Date: Wed Apr 18 12:28:45 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <006b01c781d5$25d239e0$0303a8c0@hbco>
References: <20070418110016.GA14036@localhost.localdomain><002a01c781ae$2e3d9970$6c00000a@PcJuanxp><20070418140112.GA16238@localhost.localdomain><004601c781d0$3c0ffd50$6c00000a@PcJuanxp>
	<vbgc239kaihnd08miq8qee3uk5qbk7hvgn@4ax.com>
	<006b01c781d5$25d239e0$0303a8c0@hbco>
Message-ID: <krhc231pg1rnghpegijsbqds7kjlqoaq13@4ax.com>

>But can the two compilers be made compatible?  Przemyslaw has described why
>they cannot, and I for one very much respect his opinion (to say the least).
>Szakats has described the resources available in a specific case, but in a
>way that describes the whole project.
Same guarded by HB_COMPAT_XHB ???

>Seems there are many improvements to be made to harbour yet without
>duplicating others efforts.
I agree. I only answer based in this thread: "About some xHarbour
extensions".

Regards.

Toninho.

	

	
		
_______________________________________________________ 
Yahoo! Mail - Sempre a melhor opo para voc! 
Experimente j e veja as novidades. 
http://br.yahoo.com/mailbeta/tudonovo/
From harbour.01 at syenar.hu  Wed Apr 18 12:30:20 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 18 12:30:20 2007
Subject: [Harbour] Harbour and xhb features
Message-ID: <64F3BB27-D857-4AED-8433-5A90D39F4D7A@syenar.hu>

Hi all,

In the last weeks there was a high number of requests for xHarbour
features in Harbour. I'd like to react on that in a few words.

There was and there is a pretty articulate difference between the
development style of Harbour and xharbour and I like to think that
one of the reasons Harbour reached what it is now, is at least partially
the consequence of this development style and not lastly all the great
contributors who felt like endorsing it and putting huge work into it.

I'm more than happy that Harbour attracts more ppl., even from
xharbour, and I can just guess the reasons, but let's suppose one
of them is the fact that Harbour is a more stable platform for real-life
development. Which is in turn caused at least partially by the  
development
style we've tried to follow.

Now, if we let any xharbour features to appear in Harbour without
proper reasons or examination we'll slowly but surely end up with
a not-very-optimal mixture of features and lose focus. This is very
different from the goal we have, and I don't think this would be good
for anyone on the long run. For those who cannot move away from
specific xharbour features, the option is there to stay with xharbour,
which has these features now, and they are most probably maintained
and evolved there too.

This doesn't mean that we should reject everything which comes from
xharbour, far from it, lot of things came from there in the past, mostly
through Przemek (but not forgetting the others), who acted as a very
good filter for these features. This is very important, we need to  
carefully
examine and select everything before adding it to Harbour (*), to keep
the best of Harbour and xharbour at the same time.

So if someone wants to see some xhb feature (or any other feature
for that matter) please provide reasoning and information so that we
can see what the new request is all about, and be prepared the
feature might be debated before making a decision about the inclusion.
(Also, it might well need actual work to clean up the files before  
including
them here, which is also a nice area to contribute.)

One more though: since xharbour is also just a few years old, and
xharbour apps are (of course) actively developed, there is also the
option to back-port those special features into a more portable way
before switching to Harbour.

Disclaimer: No flaming of xhb or any contributors, requestors or
users was intended. Also sorry for the long post.

Now went to drink a beer or two!

Brgds,
Viktor

(*) Even if it's an HB_COMPAT_XHB guarded feature, since as all
these can create confusion, incompatibilities, strange support issues
(especially if these are not simple extra functions) and all of these
need attention and support from the developers. If such cannot be
provided, the feature is best to left out.

From toninhofwi at yahoo.com.br  Wed Apr 18 13:10:49 2007
From: toninhofwi at yahoo.com.br (Toninho@fwi)
Date: Wed Apr 18 13:09:44 2007
Subject: [Harbour] Harbour and xhb features
In-Reply-To: <64F3BB27-D857-4AED-8433-5A90D39F4D7A@syenar.hu>
References: <64F3BB27-D857-4AED-8433-5A90D39F4D7A@syenar.hu>
Message-ID: <n2kc239lk9nne0mihb3roi8j23h30hi53g@4ax.com>

>(*) Even if it's an HB_COMPAT_XHB guarded feature, since as all
>these can create confusion, incompatibilities, strange support issues
>(especially if these are not simple extra functions) and all of these
>need attention and support from the developers. If such cannot be
>provided, the feature is best to left out.

I 100% agree with Viktor. Leave harbour as it is and forget
HB_COMPAT_XHB to prevent confusion, or keep HB_COMPAT_XHB and
implement ALL XH extensions.

Bests,

Toninho.


		
_______________________________________________________ 
Yahoo! Mail - Sempre a melhor opo para voc! 
Experimente j e veja as novidades. 
http://br.yahoo.com/mailbeta/tudonovo/
 

From dmacias at mail.udg.mx  Wed Apr 18 14:58:12 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Wed Apr 18 14:58:16 2007
Subject: [Harbour] Re: Problems to build Harbour
In-Reply-To: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
Message-ID: <46266A44.7070002@mail.udg.mx>

Current Harbour devel branch build under OS/2:

---------------------------------------------------------
../../../../source/compiler/os2/gcc/compiler.a(hbident.o): Undefined
symbol _hb_hashTableFind referenced from text segment
../../../../source/compiler/os2/gcc/compiler.a(hbident.o): Undefined
symbol _hb_hashTableAdd referenced from text segment
../../../../source/compiler/os2/gcc/compiler.a(hbident.o): Undefined
symbol _hb_hashTableCreate referenced from text segment
../../../../source/compiler/os2/gcc/compiler.a(hbident.o): Undefined
symbol _hb_hashTableKill referenced from text segment
make[3]: *** [hbrun.exe] Error 1
make[2]: *** [descend] Error 2
---------------------------------------------------------


David Macias



From bhays at abacuslaw.com  Wed Apr 18 15:52:55 2007
From: bhays at abacuslaw.com (bhays)
Date: Wed Apr 18 15:51:26 2007
Subject: [Harbour] Harbour and xhb features
In-Reply-To: <64F3BB27-D857-4AED-8433-5A90D39F4D7A@syenar.hu>
Message-ID: <00f501c781f3$28381ab0$0301a8c0@bh>


Viktor:

Thank you for your very professional and courteous post,
acknowledging the differences between the two projects.

xHarbour was established around the idea of being more aggressive
in implementing features and extensions.  That's a simple fact,
and results in both benefits and drawbacks, like any other fact.

Over the past couple years, occasionally the downside of
having both projects has been brought up -- duplicate efforts,
confusion to users, etc.  But now the Harbour project is
experiencing the benefits: xHarbour has shown that a lot of
new features are very popular and useful for programmers,
and Harbour has the choice of reviewing implementation, and
using it or coming up with alternative approaches.

It's a wonderful evolution, and worth acknowledging.

BTW, as for "stable...real-life development", xHarbour has
been rock solid for years, allowing me to deliver commercial
software to tens of thousands of seats with a reputation
of being extremely stable.


--
  Brian Hays


> -----Original Message-----
> From: harbour-bounces@harbour-project.org
> [mailto:harbour-bounces@harbour-project.org] On Behalf Of
> Szakts Viktor
> Sent: Wednesday, April 18, 2007 9:30 AM
> To: Harbour Project Main Developer List.
> Subject: [Harbour] Harbour and xhb features
>
> Hi all,
>
> In the last weeks there was a high number of requests for
> xHarbour features in Harbour. I'd like to react on that in a
> few words.
>
> There was and there is a pretty articulate difference between
> the development style of Harbour and xharbour and I like to
> think that one of the reasons Harbour reached what it is now,
> is at least partially the consequence of this development
> style and not lastly all the great contributors who felt like
> endorsing it and putting huge work into it.
>
> I'm more than happy that Harbour attracts more ppl., even
> from xharbour, and I can just guess the reasons, but let's
> suppose one of them is the fact that Harbour is a more stable
> platform for real-life development. Which is in turn caused
> at least partially by the development style we've tried to follow.
>
> Now, if we let any xharbour features to appear in Harbour
> without proper reasons or examination we'll slowly but surely
> end up with a not-very-optimal mixture of features and lose
> focus. This is very different from the goal we have, and I
> don't think this would be good for anyone on the long run.
> For those who cannot move away from specific xharbour
> features, the option is there to stay with xharbour, which
> has these features now, and they are most probably maintained
> and evolved there too.
>
> This doesn't mean that we should reject everything which
> comes from xharbour, far from it, lot of things came from
> there in the past, mostly through Przemek (but not forgetting
> the others), who acted as a very good filter for these
> features. This is very important, we need to carefully
> examine and select everything before adding it to Harbour
> (*), to keep the best of Harbour and xharbour at the same time.
>
> So if someone wants to see some xhb feature (or any other
> feature for that matter) please provide reasoning and
> information so that we can see what the new request is all
> about, and be prepared the feature might be debated before
> making a decision about the inclusion.
> (Also, it might well need actual work to clean up the files
> before including them here, which is also a nice area to contribute.)
>
> One more though: since xharbour is also just a few years old,
> and xharbour apps are (of course) actively developed, there
> is also the option to back-port those special features into a
> more portable way before switching to Harbour.
>
> Disclaimer: No flaming of xhb or any contributors, requestors
> or users was intended. Also sorry for the long post.
>
> Now went to drink a beer or two!
>
> Brgds,
> Viktor
>
> (*) Even if it's an HB_COMPAT_XHB guarded feature, since as
> all these can create confusion, incompatibilities, strange
> support issues (especially if these are not simple extra
> functions) and all of these need attention and support from
> the developers. If such cannot be provided, the feature is
> best to left out.
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
>


From bhays at abacuslaw.com  Wed Apr 18 17:15:47 2007
From: bhays at abacuslaw.com (bhays)
Date: Wed Apr 18 17:14:21 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070418110016.GA14036@localhost.localdomain>
Message-ID: <010601c781fe$bc083800$0301a8c0@bh>


Re extended codeblocks:

There are actually a few significant qualities to these that are worth
noting:

In writing GUI code for Fivewin, where there are commands to create buttons
or windows or GETs that may have several codeblocks defined (INIT, VALID,
WHEN, etc.), the extended syntax is VERY handy. Such codeblocks often start
as a simple function call, but often grow in complexity. To have normal
IF/ENDIF and other flow controls instead of nested if(,,) stuff is MUCH more
readable.  There's always a "tipping point" as to when it should be
separated to a function BUT that has its downside:

1 - I find it much handier to have the code right there inline instead of
needing to jump to a function.

2 - Often the function would require passing many parameters; sometimes it's
convenient to have direct access to local vars without having to pass them
all.

3 - each function is another symbol. If I added 5 functions to support every
GET in my app, that's a huge number. Whether symbol table size should be of
any concern is a question, but sheer volume of functions and namespace
issues makes it a legitimate effort to minimize them where not really
needed. I was unable to find funcs to dump or inspect the size and contents
of the symbol table, but for those of use who had "memory overbooked"
fifteen years ago and have added 10 times the volume of code since then, it
does seem to be a resource to watch.

The extended codeblocks are also useful as a Pascal-style inline procedure,
where repeated code (that might access existing local vars) can be pulled
into a "pseudo-function" and eval'ed multiple times. Again this is a benefit
of codeblocks in general plus the greater readability of the extended
syntax.

--
  Brian Hays



> -----Original Message-----
> From: harbour-bounces@harbour-project.org
> [mailto:harbour-bounces@harbour-project.org] On Behalf Of
> Przemyslaw Czerpak
> Sent: Wednesday, April 18, 2007 4:00 AM
> To: Harbour Project Main Developer List.
> Subject: Re: [Harbour] About some xHarbour extensions
>
> On Wed, 18 Apr 2007, Alex Strickland wrote:
> > >On Wed, 18 Apr 2007, Juan Glvez wrote:
> > >>What do you think about extended codeblocks ?
> > >I've never used them in xHarbour so I cannot say if it can be easy
> > >ported or not. If extended codeblocks are unnamed functions then I
> > >think yes they can but they can be also some differ thing.
> > Aren't they just codeblocks defined over more than 1 line?
>
> No. They are accpeting stetments inside not only expressions
> like normal codeblocks, f.e.:
>     cb := < | p |
>           LOCAL h
>           IF p == NIL
>              ? "Wrong parameter", p
>              RETURN NIL
>           ENDIF
>           h := FOPEN( p )
>           IF h == -1
>              h := NIL
>           ENDIF
>           RETURN h
>        >
>
> but even small basic tests shows anomalies in implementation.
> Look at example below and try to guess the results then
> compile and execute it.
>
> best regards,
> Przemek
>
>
>     proc main()
>     local cb
>     cb := < | p1, p2, p3 |
>              local l1, l2, l3
>              ? p1, p2, p3
>              ? l1, l2, l3
>           >
>     ? valtype(cb)
>     ? eval(cb,1,2,3,4,5,6,7,8,9)
>     ?
>     return
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
>


From nsystem at terra.com.br  Wed Apr 18 17:16:13 2007
From: nsystem at terra.com.br (Nsystem)
Date: Wed Apr 18 17:17:15 2007
Subject: [Harbour] harbour from cvs
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<46266A44.7070002@mail.udg.mx>
Message-ID: <006f01c781fe$cbbe6f80$7dc69fc8@nlf000>

Hi, how to configure tortoise cvs to down harbour?

thanks
From e.m.giordano at emagsoftware.it  Wed Apr 18 17:24:00 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Wed Apr 18 17:24:35 2007
Subject: [Harbour] harbour from cvs
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx><46266A44.7070002@mail.udg.mx>
	<006f01c781fe$cbbe6f80$7dc69fc8@nlf000>
Message-ID: <011f01c781ff$e1d4ed20$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Nsystem" <nsystem@terra.com.br>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: mercoled? 18 aprile 2007 23.16
Oggetto: [Harbour] harbour from cvs


> Hi, how to configure tortoise cvs to down harbour?

:ext:youruserid@harbour-project.cvs.sourceforge.net:/cvsroot/harbour-project

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From nsystem at terra.com.br  Wed Apr 18 17:38:13 2007
From: nsystem at terra.com.br (Nsystem)
Date: Wed Apr 18 17:39:16 2007
Subject: [Harbour] harbour from cvs
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx><46266A44.7070002@mail.udg.mx><006f01c781fe$cbbe6f80$7dc69fc8@nlf000>
	<011f01c781ff$e1d4ed20$0100a8c0@emag>
Message-ID: <009001c78201$de819180$7dc69fc8@nlf000>

EMG, thanks, but an password is required.


----- Original Message ----- 
From: "Enrico Maria Giordano" <e.m.giordano@emagsoftware.it>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Wednesday, April 18, 2007 6:24 PM
Subject: Re: [Harbour] harbour from cvs


>
> -----Messaggio Originale----- 
> Da: "Nsystem" <nsystem@terra.com.br>
> A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
> Data invio: mercoled? 18 aprile 2007 23.16
> Oggetto: [Harbour] harbour from cvs
>
>
>> Hi, how to configure tortoise cvs to down harbour?
>
> :ext:youruserid@harbour-project.cvs.sourceforge.net:/cvsroot/harbour-project
>
> EMG
>
> --
> EMAG Software Homepage:     http://www.emagsoftware.it
> The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
> The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
> The EMG Music page:         http://www.emagsoftware.it/emgmusic
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From info at fsgiudice.com  Wed Apr 18 17:59:09 2007
From: info at fsgiudice.com (Francesco Saverio Giudice)
Date: Wed Apr 18 18:00:00 2007
Subject: [Harbour] harbour from cvs
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx><46266A44.7070002@mail.udg.mx><006f01c781fe$cbbe6f80$7dc69fc8@nlf000><011f01c781ff$e1d4ed20$0100a8c0@emag>
	<009001c78201$de819180$7dc69fc8@nlf000>
Message-ID: <000c01c78204$cf78f7c0$6601a8c0@ASUSFSG>


Change it to:

:pserver:anonymous@harbour-project.cvs.sourceforge.net:/cvsroot/harbour-project

best regards

Francesco

----- Original Message ----- 
From: "Nsystem" <nsystem@terra.com.br>
To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Sent: Wednesday, April 18, 2007 11:38 PM
Subject: Re: [Harbour] harbour from cvs


> EMG, thanks, but an password is required.
>
>
> ----- Original Message ----- 
> From: "Enrico Maria Giordano" <e.m.giordano@emagsoftware.it>
> To: "Harbour Project Main Developer List." <harbour@harbour-project.org>
> Sent: Wednesday, April 18, 2007 6:24 PM
> Subject: Re: [Harbour] harbour from cvs
>
>
>>
>> -----Messaggio Originale----- 
>> Da: "Nsystem" <nsystem@terra.com.br>
>> A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
>> Data invio: mercoled? 18 aprile 2007 23.16
>> Oggetto: [Harbour] harbour from cvs
>>
>>
>>> Hi, how to configure tortoise cvs to down harbour?
>>
>> :ext:youruserid@harbour-project.cvs.sourceforge.net:/cvsroot/harbour-project
>>
>> EMG
>>
>> --
>> EMAG Software Homepage:     http://www.emagsoftware.it
>> The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
>> The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
>> The EMG Music page:         http://www.emagsoftware.it/emgmusic
>> _______________________________________________
>> Harbour mailing list
>> Harbour@harbour-project.org
>> http://lists.harbour-project.org/mailman/listinfo/harbour
>>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour 
From druzus at priv.onet.pl  Wed Apr 18 18:15:10 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 18 18:15:45 2007
Subject: [Harbour] ChangeLog 2007-04-19 00:15 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070418221510.GA27234@localhost.localdomain>

2007-04-19 00:15 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/contrib/gd/gdwrp.c
  * harbour/contrib/libmisc/hb_f.c
  * harbour/contrib/samples/dbf.c
  * harbour/contrib/samples/time.c
  * harbour/doc/es/hb_apiln.txt
  * harbour/include/hbapicdp.h
  * harbour/include/hbapilng.h
  * harbour/source/rdd/dbcmd.c
  * harbour/source/rdd/dbnubs.c
  * harbour/source/rdd/hsx/cftsfunc.c
  * harbour/source/rtl/accept.c
  * harbour/source/rtl/defpath.c
  * harbour/source/rtl/oemansi.c
  * harbour/source/rtl/pad.c
  * harbour/source/rtl/shadow.c
  * harbour/source/rtl/trim.c
  * harbour/source/vm/debug.c
    * changed HB_FUNCNAME( <name> )() to HB_FUNC_EXEC( <name> )

  * harbour/utils/hbrun/Makefile
    * changed order of linked libraries

  * harbour/source/rtl/empty.c
    * changed EMPTY( <symboItem> ) - not it returns .T. when <symboItem>
      is not a function symbol

  * harbour/source/rtl/errorapi.c
    % replaced all hb_dynsym{Find,Get}*() by static variables initialized
      at HVM startup variables - it reduce the cost of creating and
      initializing error object about 50%

  * harbour/include/hbapifs.h
  * harbour/source/rtl/fssize.c
  * harbour/source/rtl/filesys.c
  * harbour/source/rtl/hbffind.c
    * changed to use 64bit file API

  + harbour/contrib/libct/ctextern.ch
    + added list with EXTERN requests for our CT3 function. List generated
      automatically from final binary CT lib created on Linux.

best regards,
Przemek
From maurilio.longo at libero.it  Thu Apr 19 03:17:58 2007
From: maurilio.longo at libero.it (Maurilio Longo)
Date: Thu Apr 19 03:18:49 2007
Subject: [Harbour] Harbour and xhb features
References: <00f501c781f3$28381ab0$0301a8c0@bh>
Message-ID: <462717A6.C0CDAB89@libero.it>

Brian,

I just want to confirm, xharbour is rock-solid, I have several programs
written with xharbour, a few of them run 24x7 for weeks, or even months,
without any problem.

So, porting back xharbour extensions is not a cause of instability by itself.

Best regards.

Maurilio.

bhays ha scritto:
> 
> Viktor:
> 
> Thank you for your very professional and courteous post,
> acknowledging the differences between the two projects.
> 
> xHarbour was established around the idea of being more aggressive
> in implementing features and extensions.  That's a simple fact,
> and results in both benefits and drawbacks, like any other fact.
> 
> Over the past couple years, occasionally the downside of
> having both projects has been brought up -- duplicate efforts,
> confusion to users, etc.  But now the Harbour project is
> experiencing the benefits: xHarbour has shown that a lot of
> new features are very popular and useful for programmers,
> and Harbour has the choice of reviewing implementation, and
> using it or coming up with alternative approaches.
> 
> It's a wonderful evolution, and worth acknowledging.
> 
> BTW, as for "stable...real-life development", xHarbour has
> been rock solid for years, allowing me to deliver commercial
> software to tens of thousands of seats with a reputation
> of being extremely stable.
> 
> --
>   Brian Hays
> 
> > -----Original Message-----
> > From: harbour-bounces@harbour-project.org
> > [mailto:harbour-bounces@harbour-project.org] On Behalf Of
> > Szak?ts Viktor
> > Sent: Wednesday, April 18, 2007 9:30 AM
> > To: Harbour Project Main Developer List.
> > Subject: [Harbour] Harbour and xhb features
> >
> > Hi all,
> >
> > In the last weeks there was a high number of requests for
> > xHarbour features in Harbour. I'd like to react on that in a
> > few words.
> >
> > There was and there is a pretty articulate difference between
> > the development style of Harbour and xharbour and I like to
> > think that one of the reasons Harbour reached what it is now,
> > is at least partially the consequence of this development
> > style and not lastly all the great contributors who felt like
> > endorsing it and putting huge work into it.
> >
> > I'm more than happy that Harbour attracts more ppl., even
> > from xharbour, and I can just guess the reasons, but let's
> > suppose one of them is the fact that Harbour is a more stable
> > platform for real-life development. Which is in turn caused
> > at least partially by the development style we've tried to follow.
> >
> > Now, if we let any xharbour features to appear in Harbour
> > without proper reasons or examination we'll slowly but surely
> > end up with a not-very-optimal mixture of features and lose
> > focus. This is very different from the goal we have, and I
> > don't think this would be good for anyone on the long run.
> > For those who cannot move away from specific xharbour
> > features, the option is there to stay with xharbour, which
> > has these features now, and they are most probably maintained
> > and evolved there too.
> >
> > This doesn't mean that we should reject everything which
> > comes from xharbour, far from it, lot of things came from
> > there in the past, mostly through Przemek (but not forgetting
> > the others), who acted as a very good filter for these
> > features. This is very important, we need to carefully
> > examine and select everything before adding it to Harbour
> > (*), to keep the best of Harbour and xharbour at the same time.
> >
> > So if someone wants to see some xhb feature (or any other
> > feature for that matter) please provide reasoning and
> > information so that we can see what the new request is all
> > about, and be prepared the feature might be debated before
> > making a decision about the inclusion.
> > (Also, it might well need actual work to clean up the files
> > before including them here, which is also a nice area to contribute.)
> >
> > One more though: since xharbour is also just a few years old,
> > and xharbour apps are (of course) actively developed, there
> > is also the option to back-port those special features into a
> > more portable way before switching to Harbour.
> >
> > Disclaimer: No flaming of xhb or any contributors, requestors
> > or users was intended. Also sorry for the long post.
> >
> > Now went to drink a beer or two!
> >
> > Brgds,
> > Viktor
> >
> > (*) Even if it's an HB_COMPAT_XHB guarded feature, since as
> > all these can create confusion, incompatibilities, strange
> > support issues (especially if these are not simple extra
> > functions) and all of these need attention and support from
> > the developers. If such cannot be provided, the feature is
> > best to left out.
> >
> > _______________________________________________
> > Harbour mailing list
> > Harbour@harbour-project.org
> > http://lists.harbour-project.org/mailman/listinfo/harbour
> >
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

-- 
 __________                   
|  |  | |__| Maurilio Longo
|_|_|_|____| farmaconsult s.r.l.
From soporte at dsgsoftware.com  Thu Apr 19 03:52:51 2007
From: soporte at dsgsoftware.com (=?iso-8859-1?Q?Juan_G=E1lvez?=)
Date: Thu Apr 19 03:53:16 2007
Subject: [Harbour] About some xHarbour extensions
References: <010601c781fe$bc083800$0301a8c0@bh>
Message-ID: <005e01c78257$c9a778f0$6c00000a@PcJuanxp>

Brian,

I absolutely agree. The utility and use frequency of these extensions always 
depends on the preference, situation and tools of the programmer.

I think if the implementation of them could be make without generating other 
additional issues, improving and correcting that one of xHarbour, why not?

Best regards,
Juan G?lvez

----- Original Message ----- 
From: "bhays" <bhays@abacuslaw.com>
To: "'Harbour Project Main Developer List.'" <harbour@harbour-project.org>
Sent: Wednesday, April 18, 2007 11:15 PM
Subject: RE: [Harbour] About some xHarbour extensions


>
> Re extended codeblocks:
>
> There are actually a few significant qualities to these that are worth
> noting:
>
> In writing GUI code for Fivewin, where there are commands to create 
> buttons
> or windows or GETs that may have several codeblocks defined (INIT, VALID,
> WHEN, etc.), the extended syntax is VERY handy. Such codeblocks often 
> start
> as a simple function call, but often grow in complexity. To have normal
> IF/ENDIF and other flow controls instead of nested if(,,) stuff is MUCH 
> more
> readable.  There's always a "tipping point" as to when it should be
> separated to a function BUT that has its downside:
>
> 1 - I find it much handier to have the code right there inline instead of
> needing to jump to a function.
>
> 2 - Often the function would require passing many parameters; sometimes 
> it's
> convenient to have direct access to local vars without having to pass them
> all.
>
> 3 - each function is another symbol. If I added 5 functions to support 
> every
> GET in my app, that's a huge number. Whether symbol table size should be 
> of
> any concern is a question, but sheer volume of functions and namespace
> issues makes it a legitimate effort to minimize them where not really
> needed. I was unable to find funcs to dump or inspect the size and 
> contents
> of the symbol table, but for those of use who had "memory overbooked"
> fifteen years ago and have added 10 times the volume of code since then, 
> it
> does seem to be a resource to watch.
>
> The extended codeblocks are also useful as a Pascal-style inline 
> procedure,
> where repeated code (that might access existing local vars) can be pulled
> into a "pseudo-function" and eval'ed multiple times. Again this is a 
> benefit
> of codeblocks in general plus the greater readability of the extended
> syntax.
>
> --
>  Brian Hays
>
>
>
>> -----Original Message-----
>> From: harbour-bounces@harbour-project.org
>> [mailto:harbour-bounces@harbour-project.org] On Behalf Of
>> Przemyslaw Czerpak
>> Sent: Wednesday, April 18, 2007 4:00 AM
>> To: Harbour Project Main Developer List.
>> Subject: Re: [Harbour] About some xHarbour extensions
>>
>> On Wed, 18 Apr 2007, Alex Strickland wrote:
>> > >On Wed, 18 Apr 2007, Juan G?lvez wrote:
>> > >>What do you think about extended codeblocks ?
>> > >I've never used them in xHarbour so I cannot say if it can be easy
>> > >ported or not. If extended codeblocks are unnamed functions then I
>> > >think yes they can but they can be also some differ thing.
>> > Aren't they just codeblocks defined over more than 1 line?
>>
>> No. They are accpeting stetments inside not only expressions
>> like normal codeblocks, f.e.:
>>     cb := < | p |
>>           LOCAL h
>>           IF p == NIL
>>              ? "Wrong parameter", p
>>              RETURN NIL
>>           ENDIF
>>           h := FOPEN( p )
>>           IF h == -1
>>              h := NIL
>>           ENDIF
>>           RETURN h
>>        >
>>
>> but even small basic tests shows anomalies in implementation.
>> Look at example below and try to guess the results then
>> compile and execute it.
>>
>> best regards,
>> Przemek
>>
>>
>>     proc main()
>>     local cb
>>     cb := < | p1, p2, p3 |
>>              local l1, l2, l3
>>              ? p1, p2, p3
>>              ? l1, l2, l3
>>           >
>>     ? valtype(cb)
>>     ? eval(cb,1,2,3,4,5,6,7,8,9)
>>     ?
>>     return
>> _______________________________________________
>> Harbour mailing list
>> Harbour@harbour-project.org
>> http://lists.harbour-project.org/mailman/listinfo/harbour
>>
>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour 

From lorenzo.fiorini at gmail.com  Thu Apr 19 04:53:26 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 19 04:53:30 2007
Subject: [Harbour] Harbour vs xHarbour syntax differences
Message-ID: <9257026e0704190153t519f7e81wac2e6c684b463083@mail.gmail.com>

Sorry I don't want to start a flame.
I'm talking about SYNTAX differences not extensions or features.

The only two BIG syntax differences I've found are:

1) SWITCH DEFAULT vs OTHERWISE

2) char IN vs $ string

without those moving prg code between projects will be much easier and
since I know that IN operator is under "discussion" in xHarbour:

1) could SWITCH have both DEFAULT and OTHERWISE?

2) could xHarbour replace IN with $ ( HAS could sth like $* or $+ )

I think this will be a first step to improve interoperability.

regards,
Lorenzo
From druzus at priv.onet.pl  Thu Apr 19 07:52:12 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 19 07:52:48 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <010601c781fe$bc083800$0301a8c0@bh>
References: <20070418110016.GA14036@localhost.localdomain>
	<010601c781fe$bc083800$0301a8c0@bh>
Message-ID: <20070419115212.GA13603@localhost.localdomain>

On Wed, 18 Apr 2007, bhays wrote:
> There are actually a few significant qualities to these that are worth
> noting:
[...]
reasonable for me arguments.
But I still do not accept the form as in xHarbour so I will introduce
the following modifications:
1. using variable declaration with STATIC, LOCAL, FIELD, MEMVAR, PARAMETERS
   statement inside extended codeblock should be forbidden.
   xHarbour allows to use LOCAL but in fact it does not allocate any local
   variables but simply add declared locals to codeblock parameter list.
   IMHO it only confuse users.
   In the future we may want to add nested functions so now I do not
   want to define any semantic for nested variable declaration which
   because it's possible that I will not be able to keep it in nested
   functions. We already have some rules used by Clipper for file wide
   and function wide declaration but they are not cover all cases.
   I would like to avoid situation like with GLOBALs in xHarbour
   which does not respect even this few Clipper rules when name conflicts
   appears.
2. unlike normal codeblock the extended ones by default does not leave
   on HVM stack a return value. HVM expects such value so we should
   force explicit: RETURN <value> at the end of extended codeblock
   or change generated PCODE to use HB_P_ENDPROC instead of HB_P_ENDBLOCK
   Without it users will receive unexpected results from EVAL(<ExtBlock>)
3. extended codeblock is multiline line declaration but it should be
   usable in the same context as standard codeblocks so compiler
   should accept code like:
        <|p|
           ? p
           return nil
        >:eval("Hellow!")

   just like it accepts:

        {|p|qout(p)}:eval("Hellow!")

respecting the above conditions I think that i can add extended codeblocks
if other developers will agree.

> The extended codeblocks are also useful as a Pascal-style inline procedure,
> where repeated code (that might access existing local vars) can be pulled
> into a "pseudo-function" and eval'ed multiple times. Again this is a benefit
> of codeblocks in general plus the greater readability of the extended
> syntax.

We may have real nested functions in the future if we will keep
the syntax clear. I'm not against extensions. Please note that the most
important thing in each extension is the fact that it cannot block us in
the future modifications because will will not be able to be backward
compatible with existing user code. If this fundamental rules is not
passed then there is no sense to talk about any benefits because sooner
or later we lost much more then we won.

best regards,
Przemek
From randy at palmasdev.com  Thu Apr 19 13:58:49 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Thu Apr 19 13:58:15 2007
Subject: [Harbour] Bug in Beta 2 RDD
In-Reply-To: <011f01c781ff$e1d4ed20$0100a8c0@emag>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<46266A44.7070002@mail.udg.mx>
	<006f01c781fe$cbbe6f80$7dc69fc8@nlf000>
	<011f01c781ff$e1d4ed20$0100a8c0@emag>
Message-ID: <20070419175811.E761365813@smtp.tor.pathcom.com>

Hi all,

This bug was introduced with the syncing of the xHarbour RDD (ie. it 
did not happen in build 43) and I understand is also a bug in xHarbour.

The problem is that "APPEND FROM" and "COPY TO" do not respect the 
current RDD. For example:

RDDSetDefault( "ADSCDX" )

use ( SQL_TABLE ) via "MEDNTX"

APPEND FROM ( DBF_TABLE )  // This uses the MEDNTX RDD but should use ADSCDX
APPEND FROM ( DBF_TABLE ) VIA "ADSCDX"  // This works

COPY TO ( DBF_TABLE )  // This uses the MEDNTX RDD but should use ADSCDX
COPY TO ( DBF_TABLE ) VIA "ADSCDX"  // This works

Regards,
Randy.

From druzus at priv.onet.pl  Thu Apr 19 15:36:33 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 19 15:37:08 2007
Subject: [Harbour] Bug in Beta 2 RDD
In-Reply-To: <20070419175811.E761365813@smtp.tor.pathcom.com>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<46266A44.7070002@mail.udg.mx>
	<006f01c781fe$cbbe6f80$7dc69fc8@nlf000>
	<011f01c781ff$e1d4ed20$0100a8c0@emag>
	<20070419175811.E761365813@smtp.tor.pathcom.com>
Message-ID: <20070419193633.GA21997@localhost.localdomain>

On Thu, 19 Apr 2007, Randy Portnoff wrote:
> Hi all,
> This bug was introduced with the syncing of the xHarbour RDD (ie. it 
> did not happen in build 43) and I understand is also a bug in xHarbour.
> The problem is that "APPEND FROM" and "COPY TO" do not respect the 
> current RDD. For example:

No. The problem is that they respect current RDD not the default one.
Many thanks for the info. Fixed.

BTW I'm 95% sure that in the past someone reported that these commands
should respect current RDD instead of default one and it was changed.
Now I made real tests with Clipper and for sure the default RDD should
be chosen.

best regards,
Przemek
From randy at palmasdev.com  Thu Apr 19 16:21:09 2007
From: randy at palmasdev.com (Randy Portnoff)
Date: Thu Apr 19 16:20:41 2007
Subject: [Harbour] Bug in Beta 2 RDD
In-Reply-To: <20070419193633.GA21997@localhost.localdomain>
References: <20070304160715.C41882572F8@antivirus.noc.udg.mx>
	<46266A44.7070002@mail.udg.mx>
	<006f01c781fe$cbbe6f80$7dc69fc8@nlf000>
	<011f01c781ff$e1d4ed20$0100a8c0@emag>
	<20070419175811.E761365813@smtp.tor.pathcom.com>
	<20070419193633.GA21997@localhost.localdomain>
Message-ID: <20070419202031.AB9C2103553@smtp.tor.pathcom.com>

Sorry, my "current" really meant your "default". ;-)

At 03:36 PM 4/19/2007, you wrote:
>On Thu, 19 Apr 2007, Randy Portnoff wrote:
> > Hi all,
> > This bug was introduced with the syncing of the xHarbour RDD (ie. it
> > did not happen in build 43) and I understand is also a bug in xHarbour.
> > The problem is that "APPEND FROM" and "COPY TO" do not respect the
> > current RDD. For example:
>
>No. The problem is that they respect current RDD not the default one.
>Many thanks for the info. Fixed.
>
>BTW I'm 95% sure that in the past someone reported that these commands
>should respect current RDD instead of default one and it was changed.
>Now I made real tests with Clipper and for sure the default RDD should
>be chosen.
>
>best regards,
>Przemek
>_______________________________________________
>Harbour mailing list
>Harbour@harbour-project.org
>http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Thu Apr 19 21:30:53 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 19 21:31:31 2007
Subject: [Harbour] Re: [xHarbour-developers] Harbour vs xHarbour syntax
	differences
In-Reply-To: <9257026e0704190153t519f7e81wac2e6c684b463083@mail.gmail.com>
References: <9257026e0704190153t519f7e81wac2e6c684b463083@mail.gmail.com>
Message-ID: <20070420013053.GA29215@localhost.localdomain>

On Thu, 19 Apr 2007, Lorenzo Fiorini wrote:
> Sorry I don't want to start a flame.
> I'm talking about SYNTAX differences not extensions or features.
> The only two BIG syntax differences I've found are:
> 1) SWITCH DEFAULT vs OTHERWISE
> 2) char IN vs $ string

But there is a lot of small semantic differences.
In many places Harbour and xHarbour are differ.

> without those moving prg code between projects will be much easier and
> since I know that IN operator is under "discussion" in xHarbour:

You do not have to use IN operator - $ makes exactly the same.

Adding any operators represented as valid identifiers breaks PP
commands which uses such identifier in optional clauses after
an expression.
F.e. old version of xHarbour cannot preproces this rule from
Clipper's std.ch:
   #command SET ORDER TO <xOrder>                           ;
            [IN <(cOrdBag)>]                                ;
                                                            ;
         => ordSetFocus( <xOrder> [, <(cOrdBag)>] )

   SET ORDER TO tag1 IN bag1

and generated preprocesed code:

   ordSetFocus( tag1 IN bag1 )

because 'tag1 IN bag1' was single expression for old PP.

So if we want to be Clipper compatible we cannot have operators
like IN, HAS, LIKE.

I do not think that anyone here will agree to drop Clipper compatibility
to have IN operator.

> 1) could SWITCH have both DEFAULT and OTHERWISE?

OTHERWISE in SWITCH

   SWITCH
      CASE ...
         [EXIT]
      CASE ...
         [EXIT]
      OTHERWISE
         [EXIT]
   END

is compatible with OTHERWISE in CASE and IMHO is much better name.
Using C like DEFAULT confuse users which may want to use also BREAK
and the effect will not be the same ;-)
But these are only my own preferences.

> 2) could xHarbour replace IN with $ ( HAS could sth like $* or $+ )

In last months I repeated over 10 times that IN in xHarbour makes
exactly the same job as $. xHarbour _NEVER_ has separated IN operator
and SIMPLEX internally always replace IN by $ so exactly the same
PCODE is generated when you have
   IF var1 IN var2
and:
   IF var1 $ var2

HAS and LIKE: 
I do not see any reason to create operators for all possible operations.
I can imagine thousands of different operations and we will never be
able to cover all of them with operators.
xHarbour has bit operators too:
      &   BITAND
      |   BITOR
      ^^  BITXOR
      >>  BITSHIFTR
      <<  BITSHIFTL
they are also not supported by Harbour.

The next difference is reverted behavior of item references stored in
arrays.
I think it was done to make references in such code working:
   proc main()
   local a:=1, b:=2
   p(@a,@b)
   ? a, b
   return
   proc p(...)
   hb_aParams()[1]:=10
   hb_aParams()[2]:=20
   return

and they work in xHarbour but not in Harbour - compare results.
Unfortunately this modification broke code like this:
   proc main()
   local a:=1, b:=2
   p({@a,@b})
   ? a, b
   return
   proc p(v)
   local a, b
   a:=v[1]
   b:=v[2]
   a:=10
   b:=20
   return

which works in Clipper and Harbour in the same way but does not
work in xHarbour.
Personally I do not like that Clipper allows to store references
inside arrays in such way. I haven't replicated the above in Harbour's
HASHes implementation. IMHO hashes works in much cleaner way which
does not create bad side effects in some cases, f.e. when hash items
are passed by reference or iterated with FOR EACH and later detached
inside codeblocks or local variables are out of scope by references
still exist in arrays but it's differ subject.

Next difference is using one character length string as numeric value.
The idea was to allow compilation some expresions like in C:
      i = 32 + 'a';
But in C 'a' is not one character string. It's a number in C and
for sure it's sth differ then "a".
The results of some math operation with one letter strings are still
not defined in xHarbour and were systematically changing when users
reported some "wrong" behavior. The results from this small code are
different in last xHarbour releases and I cannot say what is expected
final xHarbour behavior.
IMHO because + and - are also valid string operators the results
always have to be "strange".
   proc main()
   local a:="A", b:=1000, c:="!"
   ? a+b
   ? b+a
   ? a-b
   ? b-a
   ? a-a
   ? -a+a
   ? -(-a)
   ? a+b+c
   ? b+a+c
   ? a-b+c
   ? b-a+c
   ? a-a+c
   ? -a+a+c
   ? -(-a)+c
   return
The funny thing is that because these "feature" never really worked
then it's used by people only in very limited situations so there is
not too much code which needs it.
I do not see any way that Harbour will ever have sth like above.
FOER EACH and WITH OBJECT works in Harbour internally are absolutely
different construction then in xHarbour what may cause differences
in some case.
xHarbour does not support strings and codeblocks longer then 64KB
in compiler and macro compiler.
In general macro compiler in xHarbour is limited to 32KB. Using & for
longer strings may cause unpredictable results - GPF or some internal
memory corruption. In Harbour such limit is 8MB but you can compile
also longer strings - in the worst case you will have clean RT error
without bad side effects.
xHarbour does not support named parameters in functions with variable
number of parameters and does not allow to pass additional parameters
as ..., f.e. this code can be compiled only by Harbour:
      func f(a,b,...)
      if a==1
         return {...}
      else if a==2
         return f(b,...)
      endif
      return nil
Harbour does not have native support for hashes in FOR EACH statement.
F.e. this code will work only with Harbour:
   proc main()
   local hVal:={"A"=>1.234,"B"=>2.345,"C":=3.456}, v
      FOR EACH v in hVal
         ? v
      NEXT
   return

Harbour allows to access enumerator index, value, basevale and key using
messages send to enumerator, f.e.:
   proc main()
   local hVal:={"A"=>1.234,"B"=>2.345,"C":=3.456}, v
      FOR EACH v in hVal
         ? v, v:__enumKey(), v:__enumIndex()
      NEXT
   return

Harbour allows to assing also string items in FOR EACH.
   proc main
   local cVal:="abcdefghijk", c
      ? cVal
      FOR EACH c in (@cVal)
         if c$"aei"
            c:=upper(c)
         endif
      NEXT
      ? cVal
   return

Harbour allows to enumerate in descending order
   proc main
   local cVal:="abcdefghijk", c
      FOR EACH c IN cVal DESCEND
         ? c
      NEXT
   return

Harbour allows to enumerate more then one variable, f.e:
   func string2array(cVal)
   local aVal:=array(len(cVal)), c, a
      FOR EACH c, a IN cVal, aVal
         a:=c
      NEXT
   return aVal

etc...
It has many other features uknown to xHarbour users.
Just simply so far you were using xHarbour and you do not know
what Harbour can do.

best regards,
Przemek
From harbour.01 at syenar.hu  Thu Apr 19 22:06:46 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr 19 22:06:46 2007
Subject: [Harbour] CHANGELOG: 2007-04-20 04:05 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c782f0$Blat.v2.6.1$8cb0afe0$288b723b2d4@127.0.0.1>

2007-04-20 04:05 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/tget.prg
   * harbour/tests/Makefile
   + harbour/tests/rto_get.prg
     ; Fixed lots of minor bugs and differences between 
       CA-Cl*pper and Harbour Get system. The following 
       methods got most of the fixes:
     + ::Reform() undocumented C52 method added.
     ! ::Display() fixed when not having focus. (old TOFIX)
     ! ::UpdateBuffer() fixed when not having focus.
     ! ::SetFocus() fixed to do nothing when already having focus.      
     ! ::KillFocus() made almost fully compatible.
       (the ::Assign() call is still raising questions)
     ! ::Reset() made compatible.
     ! ::VarPut() fixed when not having focus.
     ! ::Undo() made compatible.
     ! ::Type() behaviour now fully C5x compatible.
     ! ::Block() assignment now fully C5x compatible.
     ! ::OverStrike() fixed RTE when not having focus.
     ! ::Insert() fixed RTE when not having focus.
     ! ::ToDecPos() fixed to set ::Changed.
     ! ::PutMask() fixed to not pad the string to ::nMaxLen to 
       be fully compatible with C5x.
     ! ::DecPos, ::Pos initialization made compatible.
       (here the CA-Cl*pper NG is wrong in stating that these 
       vars ever hold NIL, they don't and they hold 0s instead)
     ! ::Minus more compatible but still far from perfect.
     % ::ParsePict() integrated into ::Picture()
     - ::HasScroll() internal method removed.
     ! ::HitTest() guarded with HB_COMPAT_C53.
     + Propely marked Get vars/methods as PROTECTED/VISIBLE.
     % Several minor optimizations, meaningless code elimination.
     ; Formatting, removed many old commented code snippets.
     + Added regression style tests for basic Get methods.
       All the above fixes was the result of comparing 
       Get object var dumps after calling different methods 
       in different order.
     ; Notice that there could be new/rare cases when any of 
       the above methods would need more fixes, in that case 
       the regression test is there to check if the existing 
       behaviour stayed the same after the fix and it's also 
       very useful to add the new cases to the test.

Pls report any problems (with reduced examples), TGet() is 
still far from being perfect, but should be more compatible 
after these changes.

From lorenzo.fiorini at gmail.com  Fri Apr 20 03:19:07 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Fri Apr 20 03:19:11 2007
Subject: [Harbour] Re: [xHarbour-developers] Harbour vs xHarbour syntax
	differences
In-Reply-To: <20070420013053.GA29215@localhost.localdomain>
References: <9257026e0704190153t519f7e81wac2e6c684b463083@mail.gmail.com>
	<20070420013053.GA29215@localhost.localdomain>
Message-ID: <9257026e0704200019r6673335nb1442273563166@mail.gmail.com>

On 4/20/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

Thanks for the detailed answer.
It could be a good starting point for a xdiff.txt with the differences
from Harbour and xHarbour.

Both the projects are free to set their standards and to choose what
implement and how but my HOPE is that we could have a "standard"
Harbour syntax.
C compilers are often very different but there sth we call C language.
Everyone will choose if writing standard code or use extensions.
Clearly what today an "extension" tomorrow can be standard.

> is compatible with OTHERWISE in CASE and IMHO is much better name.
> Using C like DEFAULT confuse users which may want to use also BREAK
> and the effect will not be the same ;-)
> But these are only my own preferences.

I understand, my aim is simply to easy the exchange of prgs from the
two projects.
Today if I want to write a "portable" app I have to use SWITCH ...
DEFAULT even under Harbour because I can xtranslate DEFAULT =>
OTHERWISE but I can't do the inverse.

> It has many other features uknown to xHarbour users.
> Just simply so far you were using xHarbour and you do not know
> what Harbour can do.

Yes, time to study again :)

best regards,
Lorenzo
From harbour at rglab.pl  Fri Apr 20 04:47:00 2007
From: harbour at rglab.pl (=?iso-8859-2?Q?Ryszard_G=B3=B1b?=)
Date: Fri Apr 20 04:47:33 2007
Subject: [Harbour] Harbour vs xHarbour syntax differences
References: <9257026e0704190153t519f7e81wac2e6c684b463083@mail.gmail.com>
	<c1d131c38441e85255b2678ce0c87f2f.qmail@home.pl>
Message-ID: <93c6936da7561b3ac88086384b133a7e.qmail@home.pl>

"Lorenzo Fiorini" <lorenzo.fiorini@gmail.com> napisa?(a):
> Sorry I don't want to start a flame.
> I'm talking about SYNTAX differences not extensions or features.
> 
> The only two BIG syntax differences I've found are:
> 
> 1) SWITCH DEFAULT vs OTHERWISE

  
Please notice that in Harbour SWITCH statement is simmilar to DO CASE
statement - it accepts the normal expressions in CASE statement. This
is the reason why I have choosen OTHERWISE. In xHarbour SWITCH is simmilar
to C language SWITCH - it accepts numeric constants only thus DEFAULT
was choosen probably.

So this will not compile in xHarbour:
SWITCH var
CASE 1
 
EXIT
CASE 'ABC'
CASE .F.
CASE FunCall()
END

  
Please notice also that using DEFAULT will suggest that
programmer can use BREAK instead of EXIT.

> 2) char IN vs $ string

  
In xHarbour IN is just replaced with $ and gives the same pcode 
HB_P_INSTRING so I really don't see why it was introdused. It will be
much better if IN would be translated into a separate pcode to allow
clear distinction: $ for strings, IN operator for array and hashes.
However if $ is extended for values other then strings then IN
operator is not needed.

> without those moving prg code between projects will be much easier and
> since I know that IN operator is under "discussion" in xHarbour:
> 
> 1) could SWITCH have both DEFAULT and OTHERWISE?

  
Please notice that in Harbour SWITCH is much more flexible thus
moving code from Harbour to xHarbour will be problematic anyway.
  
I am against introducion of new keywords if it is not really
necessary.

Regards, Ryszard

From druzus at priv.onet.pl  Fri Apr 20 06:59:49 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 20 07:00:25 2007
Subject: [Harbour] Harbour vs xHarbour syntax differences
In-Reply-To: <93c6936da7561b3ac88086384b133a7e.qmail@home.pl>
References: <9257026e0704190153t519f7e81wac2e6c684b463083@mail.gmail.com>
	<c1d131c38441e85255b2678ce0c87f2f.qmail@home.pl>
	<93c6936da7561b3ac88086384b133a7e.qmail@home.pl>
Message-ID: <20070420105949.GA5926@localhost.localdomain>

On Fri, 20 Apr 2007, Ryszard G??b wrote:
> Please notice that in Harbour SWITCH statement is simmilar to DO CASE
> statement - it accepts the normal expressions in CASE statement. This
> is the reason why I have choosen OTHERWISE. In xHarbour SWITCH is simmilar
> to C language SWITCH - it accepts numeric constants only thus DEFAULT
> was choosen probably.

Only in accepted parameters but the generated code in Harbour is
more similar to sth what C compilers do (though we still not use
indexed tables for continoue values) what gives much better performance
then in xHarbour. Results from attached code:

druzus:/tmp/5/SWITCH# hbmk -n -w -es2 -gtcgi t2 && ./t2
Harbour devel build 1.1-0 Intl.
Copyright 1999-2007, http://www.harbour-project.org/
Compiling 't2.prg'...
Lines 359, Functions/Procedures 3
Generating C source output to 't2.c'... Done.

Linux 2.6.15 i686 Harbour devel build 1.1-0 Intl. 04/20/07 12:56:41
dummy loop overhead          5.63 sec.
switch cost         10.72 sec.

druzus:/tmp/5/SWITCH# xhbmk -n -w -es2 -gtcgi t2 && ./t2
xHarbour Compiler build 0.99.71 (SimpLex)
Copyright 1999-2007, http://www.xharbour.org http://www.harbour-project.org/
Compiling 't2.prg'...
Lines 344, Functions/Procedures 3
Generating C source output to 't2.c'...
Done.
Linux 2.6.15 i686 xHarbour build 0.99.71 Intl. (SimpLex) 04/20/07 12:57:16
dummy loop overhead          7.94 sec.
switch cost         55.81 sec.
druzus:/tmp/5/SWITCH#


So here Harbour is over five times faster.

> So this will not compile in xHarbour:
> SWITCH var
> CASE 1
>  
> EXIT
> CASE 'ABC'
> CASE .F.
> CASE FunCall()
> END

Do you remember what you implemented? ;-)
Harbour switch implementation allows to add other
data types. Now it accepts integer numeric values and strings up
to 255 characters. We can very easy add other constant values and
IMHO we should add at least dates.
FunCall() and other expressions can also be accepted but only
after some much deeper modifications.

best regards,
Przemek



#define N_LOOP 100000
proc main()
local t, tt, i, j

? OS(), VERSION(), DATE(), TIME()

t:=secondsCPU()
for i:=1 to N_LOOP
   for j:=0 to 120
      dummy()
   next
next
tt:=secondsCPU()-t
? "dummy loop overhead", tt, "sec."

t:=secondsCPU()
for i:=1 to N_LOOP
   for j:=0 to 120 /* 20% for default */
      switchtst(j)
   next
next
? "switch cost", secondsCPU()-t-tt, "sec."
?
return

func dummy()
local x
x:=1000
return x

func switchtst(n)
local x
switch n
   case  0
      x:= 0
      exit
   case  1
      x:= 1
      exit
   case  2
      x:= 2
      exit
   case  3
      x:= 3
      exit
   case  4
      x:= 4
      exit
   case  5
      x:= 5
      exit
   case  6
      x:= 6
      exit
   case  7
      x:= 7
      exit
   case  8
      x:= 8
      exit
   case  9
      x:= 9
      exit
   case 10
      x:=10
      exit
   case 11
      x:=11
      exit
   case 12
      x:=12
      exit
   case 13
      x:=13
      exit
   case 14
      x:=14
      exit
   case 15
      x:=15
      exit
   case 16
      x:=16
      exit
   case 17
      x:=17
      exit
   case 18
      x:=18
      exit
   case 19
      x:=19
      exit
   case 20
      x:=20
      exit
   case 21
      x:=21
      exit
   case 22
      x:=22
      exit
   case 23
      x:=23
      exit
   case 24
      x:=24
      exit
   case 25
      x:=25
      exit
   case 26
      x:=26
      exit
   case 27
      x:=27
      exit
   case 28
      x:=28
      exit
   case 29
      x:=29
      exit
   case 30
      x:=30
      exit
   case 31
      x:=31
      exit
   case 32
      x:=32
      exit
   case 33
      x:=33
      exit
   case 34
      x:=34
      exit
   case 35
      x:=35
      exit
   case 36
      x:=36
      exit
   case 37
      x:=37
      exit
   case 38
      x:=38
      exit
   case 39
      x:=39
      exit
   case 40
      x:=40
      exit
   case 41
      x:=41
      exit
   case 42
      x:=42
      exit
   case 43
      x:=43
      exit
   case 44
      x:=44
      exit
   case 45
      x:=45
      exit
   case 46
      x:=46
      exit
   case 47
      x:=47
      exit
   case 48
      x:=48
      exit
   case 49
      x:=49
      exit
   case 50
      x:=50
      exit
   case 51
      x:=51
      exit
   case 52
      x:=52
      exit
   case 53
      x:=53
      exit
   case 54
      x:=54
      exit
   case 55
      x:=55
      exit
   case 56
      x:=56
      exit
   case 57
      x:=57
      exit
   case 58
      x:=58
      exit
   case 59
      x:=59
      exit
   case 60
      x:=60
      exit
   case 61
      x:=61
      exit
   case 62
      x:=62
      exit
   case 63
      x:=63
      exit
   case 64
      x:=64
      exit
   case 65
      x:=65
      exit
   case 66
      x:=66
      exit
   case 67
      x:=67
      exit
   case 68
      x:=68
      exit
   case 69
      x:=69
      exit
   case 70
      x:=70
      exit
   case 71
      x:=71
      exit
   case 72
      x:=72
      exit
   case 73
      x:=73
      exit
   case 74
      x:=74
      exit
   case 75
      x:=75
      exit
   case 76
      x:=76
      exit
   case 77
      x:=77
      exit
   case 78
      x:=78
      exit
   case 79
      x:=79
      exit
   case 80
      x:=80
      exit
   case 81
      x:=81
      exit
   case 82
      x:=82
      exit
   case 83
      x:=83
      exit
   case 84
      x:=84
      exit
   case 85
      x:=85
      exit
   case 86
      x:=86
      exit
   case 87
      x:=87
      exit
   case 88
      x:=88
      exit
   case 89
      x:=89
      exit
   case 90
      x:=90
      exit
   case 91
      x:=91
      exit
   case 92
      x:=92
      exit
   case 93
      x:=93
      exit
   case 94
      x:=94
      exit
   case 95
      x:=95
      exit
   case 96
      x:=96
      exit
   case 97
      x:=97
      exit
   case 98
      x:=98
      exit
   case 99
      x:=99
      exit
#ifdef __XHARBOUR__
   default
#else
   otherwise
#endif
      x:=1000
end
return x
From druzus at priv.onet.pl  Fri Apr 20 07:12:36 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 20 07:13:11 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
Message-ID: <20070420111236.GB5926@localhost.localdomain>

On Wed, 18 Apr 2007, Szak?ts Viktor wrote:
> >But I have some doubts if I should commit it.
> Me too.
> Reaons 1: This syntax is hiding what is really going on "under the  
> hood", so makes the source less readable / maintainable.

I can imagine some situations when in existing code someone will
want to replace an OBJECT by HASH and probably it's the only one
serious reason to have such interface.

> Reason 2: I fail to see any advantage over the "pure" code (my fault  
> probably), where pure code is already an extension.

:-)

> Reason 3: If we ever want to introduce object interface for hash  
> type, I think we need to think it over first and find the best  
> solution considering the needs (and benefits) and development "costs".  
> This feature, as it is now, doesn't seem to be a complete solution.

Some people seem to like even with the cost of performance.

> Correct me if I'm wrong but there could be built a hash class on the  
> top of the hash functions with similar functionality (maybe not similar
> syntax  though) and with no low-level support from Harbour.

I guess you are talking about scalar classes. Harbour does not support
them yet but it will when I'll find a while and yes such interface will
interact with defined by user hash class messages.
Please also note that like in Clipper our items accepts some prebuilt
messages. All types understand CLASSH, CLASSNAME and CLASSSEL messages.
CODEBLOCKs accept EVAL, SYMBOLs accept EXEC and NAME, HASHes accept KEYS
and VALUES.

best regards,
Przemek
From dbtopas at dbtopas.lt  Fri Apr 20 07:57:33 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Fri Apr 20 07:55:02 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070420111236.GB5926@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>	<20070418140112.GA16238@localhost.localdomain>	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
Message-ID: <4628AAAD.5020502@dbtopas.lt>

bhays wrote:
> In writing GUI code for Fivewin, where there are commands to create buttons
> or windows or GETs that may have several codeblocks defined (INIT, VALID,
> WHEN, etc.), the extended syntax is VERY handy. Such codeblocks often start
> as a simple function call, but often grow in complexity. To have normal
> IF/ENDIF and other flow controls instead of nested if(,,) stuff is MUCH more
> readable.  There's always a "tipping point" as to when it should be


Przemyslaw Czerpak wrote:
> Please also note that like in Clipper our items accepts some prebuilt
> messages. All types understand CLASSH, CLASSNAME and CLASSSEL messages.
> CODEBLOCKs accept EVAL, SYMBOLs accept EXEC and NAME, HASHes accept KEYS
> and VALUES.


Hello,


I find the some relation in the posts above.
In Clipper/Harbour we have codeblock and often use it if we need a small 
inline nameless function. An example is get, set, valid, event blocks of 
GUI widgets, or even INLINE methods of classes.

Sometime these codeblocks becomes really big and we need a function for 
it. In this case we can use extended codeblocks of a simple solution:
    oGet:bValid := {|X| ValidateMe(X)}
    ...
FUNC ValidateMe(X)
    ...
RETURN lValid

But this is redundant. oGet evaluates bValid with extra call to 
ValidateMe(), instead of direct call to ValidateMe(). More fast and 
clear will be solution:
    oGet:bValid := @ValidateMe()
but this makes oGet internals to be:
    IF VALTYPE(oGet:bValid) == "B"
       EVAL(oGet:bValid, oGet:xValue)
    ELSE
       oGet:bValid:Exec(oGet:xValue)
    ENDIF
or
    IF VALTYPE(oGet:bValid) == "B"
       oGet:bValid:Eval(oGet:xValue)
    ELSE
       oGet:bValid:Exec(oGet:xValue)
    ENDIF
or we need to do additional packing parameters to array and use 
HB_EXECFROMARRAY() (I don't like name of this function :( ):
    HB_EXECFROMARRAY(oGet:bValid, {oGet:xValue})

But all of these solutions become even much more redundant than
    oGet:bValid := {|X| ValidateMe(X)}


Can we extend functionality of EVAL() to evaluate symbols also, and for 
those who like OO interface use the same method EVAL for both codeblock 
and symbols. This will allow to use:
       EVAL(oGet:bValid, oGet:xValue)
or
       oGet:bValid:Eval(oGet:xValue)
and user will be able to use function instead of codeblock if code of 
codeblock is too complex. This will partially solve problem of extended 
codeblocks.

I've not analysed the internals, but maybe we can even hide some 
difference of codeblocks and function symbols in C level. And usage of 
   ASCAN(aArray, @scan_func) or ASORT(aArray,,, @sort_func) can also be 
valid. Just an idea...



Best regards,
Mindaugas





From harbour at rglab.pl  Fri Apr 20 08:00:37 2007
From: harbour at rglab.pl (=?iso-8859-2?Q?Ryszard_G=B3=B1b?=)
Date: Fri Apr 20 08:01:07 2007
Subject: [Harbour] Harbour vs xHarbour syntax differences
References: <9257026e0704190153t519f7e81wac2e6c684b463083@mail.gmail.com>
	<c1d131c38441e85255b2678ce0c87f2f.qmail@home.pl>
	<93c6936da7561b3ac88086384b133a7e.qmail@home.pl>
	<20070420105949.GA5926@localhost.localdomain>
Message-ID: <adf37ee0c007bd59a8f9850caacd01e8.qmail@home.pl>

Przemyslaw Czerpak <druzus@priv.onet.pl> napisa?(a):
> 
> Do you remember what you implemented? ;-)
> Harbour switch implementation allows to add other
> data types. Now it accepts integer numeric values and strings up
> to 255 characters. We can very easy add other constant values and
> IMHO we should add at least dates.
> FunCall() and other expressions can also be accepted but only
> after some much deeper modifications.

  
Ops, you are right - CASE accepts any expressions that can be 
optimized at compile time either into a integer numeric constant 
or into a string constant.

Writing 'CASE FunCall()' I was confused by
CASE CHR(10)+CHR(13)

Regards, Ryszard

From harbour.01 at syenar.hu  Fri Apr 20 08:08:40 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 20 08:08:36 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <4628AAAD.5020502@dbtopas.lt>
References: <20070418110016.GA14036@localhost.localdomain>	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>	<20070418140112.GA16238@localhost.localdomain>	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
Message-ID: <843B5962-B213-45D6-8796-48CCA181408D@syenar.hu>

> But this is redundant. oGet evaluates bValid with extra call to  
> ValidateMe(), instead of direct call to ValidateMe(). More fast and  
> clear will be solution:
>    oGet:bValid := @ValidateMe()
> but this makes oGet internals to be:
>    IF VALTYPE(oGet:bValid) == "B"
>       EVAL(oGet:bValid, oGet:xValue)
>    ELSE
>       oGet:bValid:Exec(oGet:xValue)
>    ENDIF
> or
>    IF VALTYPE(oGet:bValid) == "B"
>       oGet:bValid:Eval(oGet:xValue)
>    ELSE
>       oGet:bValid:Exec(oGet:xValue)
>    ENDIF

Adding support for function pointer for places where codeblock
(or maybe even function names) are supported is a pretty nice
and natural extension of Harbour. So you have my vote for it.

I don't know if it has any negative implications, but the support would
be automatic (and faster even) if EVAL() would accept function
pointers too. From compatibility side, I don't see it a problem, as
C5x didn't have function pointers at all.

> or we need to do additional packing parameters to array and use  
> HB_EXECFROMARRAY() (I don't like name of this function :( ):
>    HB_EXECFROMARRAY(oGet:bValid, {oGet:xValue})

I don't like it either, doesn't give much clue to the functions purpose.
(But I have no breakthrough idea as a new at this time.)

Does it handle blocks and function pointers too?

> Can we extend functionality of EVAL() to evaluate symbols also, and  
> for those who like OO interface use the same method EVAL for both  
> codeblock and symbols. This will allow to use:
>       EVAL(oGet:bValid, oGet:xValue)
> or
>       oGet:bValid:Eval(oGet:xValue)
> and user will be able to use function instead of codeblock if code  
> of codeblock is too complex. This will partially solve problem of  
> extended codeblocks.
>
> I've not analysed the internals, but maybe we can even hide some  
> difference of codeblocks and function symbols in C level. And usage  
> of   ASCAN(aArray, @scan_func) or ASORT(aArray,,, @sort_func) can  
> also be valid. Just an idea...

I've just read into this part of your post :)

So yes, this would be nice, I agree, we need to check if it has any  
downsides.
(I cannot spot any right now)

Brgds,
Viktor

From harbour at rglab.pl  Fri Apr 20 08:12:45 2007
From: harbour at rglab.pl (=?iso-8859-2?Q?Ryszard_G=B3=B1b?=)
Date: Fri Apr 20 08:13:15 2007
Subject: [Harbour] About some xHarbour extensions
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
Message-ID: <d8446f5508f88e7b3d45948aade7c0aa.qmail@home.pl>

Mindaugas Kavaliauskas <dbtopas@dbtopas.lt> napisa?(a):
> 
> Can we extend functionality of EVAL() to evaluate symbols also, and for 
> those who like OO interface use the same method EVAL for both codeblock 
> and symbols. This will allow to use:
>        EVAL(oGet:bValid, oGet:xValue)
> or
>        oGet:bValid:Eval(oGet:xValue)
> and user will be able to use function instead of codeblock if code of 
> codeblock is too complex. This will partially solve problem of extended 
> codeblocks.

  
This functionality is already implemented in DO() function:

DO( "ValidateMe", ... )
DO( {|x| ValidateMe(x)}, ... )
DO( @ValidateMe(), ... )

> 
> I've not analysed the internals, but maybe we can even hide some 
> difference of codeblocks and function symbols in C level. And usage of 
>    ASCAN(aArray, @scan_func) or ASORT(aArray,,, @sort_func) can also be 
> valid. Just an idea...

  
This can be done quite easy.

Regards, Ryszard

From druzus at priv.onet.pl  Fri Apr 20 08:52:26 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 20 08:53:02 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <4628AAAD.5020502@dbtopas.lt>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
Message-ID: <20070420125226.GA9425@localhost.localdomain>

On Fri, 20 Apr 2007, Mindaugas Kavaliauskas wrote:
> Sometime these codeblocks becomes really big and we need a function for 
> it. In this case we can use extended codeblocks of a simple solution:
>    oGet:bValid := {|X| ValidateMe(X)}
>    ...
> FUNC ValidateMe(X)
>    ...
> RETURN lValid
> 
> But this is redundant. oGet evaluates bValid with extra call to 
> ValidateMe(), instead of direct call to ValidateMe().

This is interesting subject also in OOP code. We inherited name
and behavior of INLINE methods from class(y). Many people expects
that INLINE methods are faster then normal function methods. It's
false. The difference is not very big but INLINE methods are SLOWER.
I dedicated this information to all who hacks class declaration
thinking that they are increasing performance.

> More fast and 
> clear will be solution:
>    oGet:bValid := @ValidateMe()
> but this makes oGet internals to be:
>    IF VALTYPE(oGet:bValid) == "B"
>       EVAL(oGet:bValid, oGet:xValue)
>    ELSE
>       oGet:bValid:Exec(oGet:xValue)
>    ENDIF
> or
>    IF VALTYPE(oGet:bValid) == "B"
>       oGet:bValid:Eval(oGet:xValue)
>    ELSE
>       oGet:bValid:Exec(oGet:xValue)
>    ENDIF

The modification is trivial. In classes.c[1590]:
    if( pMsg == s___msgExec.pDynSym )
change to:
    if( pMsg == s___msgExec.pDynSym || pMsg == s___msgEval.pDynSym )

> or we need to do additional packing parameters to array and use 
> HB_EXECFROMARRAY() (I don't like name of this function :( ):
>    HB_EXECFROMARRAY(oGet:bValid, {oGet:xValue})

As Ryszard pointed DO() function has the functionality you are asking for.
I also do not like this name but I keep the one used in xHarbour to not
introduce new ones.

> But all of these solutions become even much more redundant than
>    oGet:bValid := {|X| ValidateMe(X)}
> Can we extend functionality of EVAL() to evaluate symbols also, and for 
> those who like OO interface use the same method EVAL for both codeblock 
> and symbols. This will allow to use:
>       EVAL(oGet:bValid, oGet:xValue)
> or
>       oGet:bValid:Eval(oGet:xValue)
> and user will be able to use function instead of codeblock if code of 
> codeblock is too complex. This will partially solve problem of extended 
> codeblocks.

Compiler translates internally EVAL(<var1>,<var2>,...) into
<var1>:EVAL(<var2>,...) so all what you need is the above
modification in classes.c.

> I've not analysed the internals, but maybe we can even hide some 
> difference of codeblocks and function symbols in C level. And usage of 
>   ASCAN(aArray, @scan_func) or ASORT(aArray,,, @sort_func) can also be 
> valid. Just an idea...

It can be also very easy done. It will be necessary to change some of
HB_IS_BLOCK() into some other macro, f.e. HB_CAN_EVAL() defined as:
    #define HB_CAN_EVAL(p)  => (HB_IS_BLOCK(p)||HB_IS_SYMBOL(p))
and add one small function with similar functionality to hb_vmDoBlock(),
f.e.: hb_vmDoSymbol() but we should remember that in functions like
ASCAN() people may expect other behavior. Thinking about future use
of SYMBOL items as CODEBLOCK replacement I haven't added support for
    ? ascan({@func1(),@func2(),@func3(),@func3()},funcSym)
so we do not have to afraid about existing user code but we should decide
what we like to have.

BTW. What about extended codeblocks? I've just added them to mu local CVS
     and I can commit so you can test it. It's not exactly the same as in
     xHarbour but most of people should not find the difference.

best regards,
Przemek
From dbtopas at dbtopas.lt  Fri Apr 20 09:00:59 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Fri Apr 20 08:58:23 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <d8446f5508f88e7b3d45948aade7c0aa.qmail@home.pl>
References: <20070418110016.GA14036@localhost.localdomain>	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>	<20070418140112.GA16238@localhost.localdomain>	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>	<20070420111236.GB5926@localhost.localdomain>	<4628AAAD.5020502@dbtopas.lt>
	<d8446f5508f88e7b3d45948aade7c0aa.qmail@home.pl>
Message-ID: <4628B98B.90103@dbtopas.lt>

Ryszard G??b wrote:
> This functionality is already implemented in DO() function:
> 
> DO( "ValidateMe", ... )
> DO( {|x| ValidateMe(x)}, ... )
> DO( @ValidateMe(), ... )


Thanks! I haven't noticed this function because DO makes me think about 
DO sentence for evaluation of code from different .prg file.

But it would better to use hb_vmFunction() instead of hb_vmDo() in DO() 
if we want to return NIL in case of procedures.

Is it function new (in [x]Harbour only) of it existed in Clipper? I can 
not find it in Clipper guide. If it's Harbour's function so it should 
have HB_ prefix, but I see evaluation of symbols as a natural extension 
of basic language syntax, which IMHO should not be some prefixed 
function. So I prefer a natural extension of unprefixed EVAL().


Viktor wrote:
> I don't know if it has any negative implications, but the support would
> be automatic (and faster even) if EVAL() would accept function
> pointers too. From compatibility side, I don't see it a problem, as
> C5x didn't have function pointers at all. 

> So yes, this would be nice, I agree, we need to check if it has any  downsides.
> (I cannot spot any right now)

There are some differences, if we make EVAL method to work on symbols, 
but it difficult for me to guess right now if it is important or not.
A simple example can be done with EXEC method:

PROC MAIN()
LOCAL s
   ? f()              // U
   s := @f()
   ? s:Exec()         // S
   ? DO(s)            // U
RETURN

FUNC f()
RETURN VALTYPE(QSELF())

We can change EXEC/EVAL method code to hide QSELF() value with a single 
hb_itemSetNil() call.

But QSELF()=SYMBOL is natural in function execution, just like 
QSELF()=CODEBLOCK in case of codeblock execution. So, QSELF() could be a 
symbol even in simple call of functions. We can do recursive 
functions/codeblocks using :)
     DO(QSELF(), param)

But perhaps it was not implemented in Clipper because it has no SYMBOL 
type variables. So, I think we are not going to enhance QSELF() because 
of Clipper compatibility.


Best regards,
Mindaugas
From harbour.01 at syenar.hu  Fri Apr 20 09:09:16 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 20 09:09:11 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070420125226.GA9425@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
Message-ID: <362ABB42-5AC0-4D51-A807-568EF5F23FA9@syenar.hu>


On 2007.04.20., at 14:52, Przemyslaw Czerpak wrote:

> This is interesting subject also in OOP code. We inherited name
> and behavior of INLINE methods from class(y). Many people expects
> that INLINE methods are faster then normal function methods. It's
> false. The difference is not very big but INLINE methods are SLOWER.
> I dedicated this information to all who hacks class declaration
> thinking that they are increasing performance.

Thanks I'll check the RTL code for such stuff, I've been wondering
about this just yesterday.

>> More fast and
>> clear will be solution:
>>    oGet:bValid := @ValidateMe()
>> but this makes oGet internals to be:
>>    IF VALTYPE(oGet:bValid) == "B"
>>       EVAL(oGet:bValid, oGet:xValue)
>>    ELSE
>>       oGet:bValid:Exec(oGet:xValue)
>>    ENDIF
>> or
>>    IF VALTYPE(oGet:bValid) == "B"
>>       oGet:bValid:Eval(oGet:xValue)
>>    ELSE
>>       oGet:bValid:Exec(oGet:xValue)
>>    ENDIF
>
> The modification is trivial. In classes.c[1590]:
>     if( pMsg == s___msgExec.pDynSym )
> change to:
>     if( pMsg == s___msgExec.pDynSym || pMsg == s___msgEval.pDynSym )
>
>> or we need to do additional packing parameters to array and use
>> HB_EXECFROMARRAY() (I don't like name of this function :( ):
>>    HB_EXECFROMARRAY(oGet:bValid, {oGet:xValue})
>
> As Ryszard pointed DO() function has the functionality you are  
> asking for.
> I also do not like this name but I keep the one used in xHarbour to  
> not
> introduce new ones.
>
>> But all of these solutions become even much more redundant than
>>    oGet:bValid := {|X| ValidateMe(X)}
>> Can we extend functionality of EVAL() to evaluate symbols also,  
>> and for
>> those who like OO interface use the same method EVAL for both  
>> codeblock
>> and symbols. This will allow to use:
>>       EVAL(oGet:bValid, oGet:xValue)
>> or
>>       oGet:bValid:Eval(oGet:xValue)
>> and user will be able to use function instead of codeblock if code of
>> codeblock is too complex. This will partially solve problem of  
>> extended
>> codeblocks.
>
> Compiler translates internally EVAL(<var1>,<var2>,...) into
> <var1>:EVAL(<var2>,...) so all what you need is the above
> modification in classes.c.
>
>> I've not analysed the internals, but maybe we can even hide some
>> difference of codeblocks and function symbols in C level. And  
>> usage of
>>   ASCAN(aArray, @scan_func) or ASORT(aArray,,, @sort_func) can  
>> also be
>> valid. Just an idea...
>
> It can be also very easy done. It will be necessary to change some of
> HB_IS_BLOCK() into some other macro, f.e. HB_CAN_EVAL() defined as:
>     #define HB_CAN_EVAL(p)  => (HB_IS_BLOCK(p)||HB_IS_SYMBOL(p))
> and add one small function with similar functionality to  
> hb_vmDoBlock(),
> f.e.: hb_vmDoSymbol() but we should remember that in functions like
> ASCAN() people may expect other behavior. Thinking about future use
> of SYMBOL items as CODEBLOCK replacement I haven't added support for
>     ? ascan({@func1(),@func2(),@func3(),@func3()},funcSym)
> so we do not have to afraid about existing user code but we should  
> decide
> what we like to have.

Nice, nice. For some reason I'd naturally expect Eval() to work
with symbols. Would it be a problem to add support for it?
This way we could keep all Harbour code unchanged and
_portable_ (back to Clipper, to xhb), while having support for
symbols? Any downsides?

(I understand that Do() is the generic function for this, but
I find it too much hidden and Harbour specific).

> BTW. What about extended codeblocks? I've just added them to mu  
> local CVS
>      and I can commit so you can test it. It's not exactly the same  
> as in
>      xHarbour but most of people should not find the difference.

I vote against it this time.

It's a drastic syntax extension to the language, and I'm not convinced
of it's future-proofness and about the real usefulness or necessity  
of it.
I also don't like the name "extended codeblocks", but it indeed implies
what it is and that's not very much in my opinion.

I'd rather like a more complete implementation of the "unnamed  
functions",
"inline functions" and "nested functions" at the same time. Now that  
would
move Harbour higher in terms of language quality.

Brgds,
Viktor

From soporte at dsgsoftware.com  Fri Apr 20 09:54:32 2007
From: soporte at dsgsoftware.com (=?ISO-8859-2?Q?Juan_G=E1lvez?=)
Date: Fri Apr 20 09:54:45 2007
Subject: [Harbour] About some xHarbour extensions
References: <20070418110016.GA14036@localhost.localdomain><002a01c781ae$2e3d9970$6c00000a@PcJuanxp><20070418140112.GA16238@localhost.localdomain><FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
Message-ID: <002001c78353$749f2720$6c00000a@PcJuanxp>

Przemek,

> ...
> I can imagine some situations when in existing code someone will
> want to replace an OBJECT by HASH and probably it's the only one
> serious reason to have such interface.
>

This is exactly my case :-)

Best regards
Juan
From dbtopas at dbtopas.lt  Fri Apr 20 10:16:03 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Fri Apr 20 10:13:31 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070420125226.GA9425@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>	<20070418140112.GA16238@localhost.localdomain>	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>	<20070420111236.GB5926@localhost.localdomain>	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
Message-ID: <4628CB23.3070402@dbtopas.lt>

Przemyslaw Czerpak wrote:
  > The modification is trivial. In classes.c[1590]:
>     if( pMsg == s___msgExec.pDynSym )
> change to:
>     if( pMsg == s___msgExec.pDynSym || pMsg == s___msgEval.pDynSym )

I'd like to tave this in Harbour.


>> I've not analysed the internals, but maybe we can even hide some 
>> difference of codeblocks and function symbols in C level. And usage of 
>>   ASCAN(aArray, @scan_func) or ASORT(aArray,,, @sort_func) can also be 
>> valid. Just an idea...
>
> It can be also very easy done. It will be necessary to change some of
> HB_IS_BLOCK() into some other macro, f.e. HB_CAN_EVAL() defined as:
>     #define HB_CAN_EVAL(p)  => (HB_IS_BLOCK(p)||HB_IS_SYMBOL(p))
> and add one small function with similar functionality to hb_vmDoBlock(),
> f.e.: hb_vmDoSymbol() but we should remember that in functions like
> ASCAN() people may expect other behavior. Thinking about future use
> of SYMBOL items as CODEBLOCK replacement I haven't added support for
>     ? ascan({@func1(),@func2(),@func3(),@func3()},funcSym)
> so we do not have to afraid about existing user code but we should decide
> what we like to have.

Yes, of cause. I do not mean we must change HB_IS_BLOCK() to 
HB_CAN_EVAL() everywhere, we must think before every change about what 
we want to have, what are features and side effects.


> BTW. What about extended codeblocks? I've just added them to mu local CVS
>      and I can commit so you can test it. It's not exactly the same as in
>      xHarbour but most of people should not find the difference.

I see Viktor's vote against, but I guess you've spend your valuable time 
on this. I trust your decision. Thanks.


Best regards,
Mindaugas
From antonioharbour at gmail.com  Fri Apr 20 10:20:38 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Fri Apr 20 10:21:05 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <362ABB42-5AC0-4D51-A807-568EF5F23FA9@syenar.hu>
Message-ID: <4628cc4a.77d12fb2.3fe9.458b@mx.google.com>

> This is interesting subject also in OOP code. We inherited name and 
> behavior of INLINE methods from class(y).

INLINE clause was originally implemented by FiveTech Software in Objects.ch
and lib library for Clipper. Class(y) copied it from us :-)

FYI :-)

Regards,

Antonio

From antonioharbour at gmail.com  Fri Apr 20 10:28:09 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Fri Apr 20 10:28:34 2007
Subject: [Harbour] About some xHarbour extensions
Message-ID: <4628ce0d.6b205bc3.4829.49db@mx.google.com>

 
>
INLINE clause was originally implemented by FiveTech Software in Objects.ch
and lib library for Clipper. Class(y) copied it from us :-)
>

The same applies for SETGET clause :-)

FYI :-)

Regards,

Antonio

From antonioharbour at gmail.com  Fri Apr 20 10:30:03 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Fri Apr 20 10:30:30 2007
Subject: [Harbour] RE: About some xHarbour extensions
Message-ID: <4628ce80.2dfd85fb.4829.4a33@mx.google.com>

>>
INLINE clause was originally implemented by FiveTech Software in Objects.ch
and lib library for Clipper. Class(y) copied it from us :-)
>>

> The same applies for SETGET clause :-)

Same applies for VIRTUAL clause :-)

FYI :-)

(pls excuse the offtopic)

Regards,

Antonio

From druzus at priv.onet.pl  Fri Apr 20 10:30:58 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 20 10:31:32 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <4628B98B.90103@dbtopas.lt>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<d8446f5508f88e7b3d45948aade7c0aa.qmail@home.pl>
	<4628B98B.90103@dbtopas.lt>
Message-ID: <20070420143058.GA17618@localhost.localdomain>

On Fri, 20 Apr 2007, Mindaugas Kavaliauskas wrote:
> There are some differences, if we make EVAL method to work on symbols, 
> but it difficult for me to guess right now if it is important or not.
> A simple example can be done with EXEC method:
> PROC MAIN()
> LOCAL s
>   ? f()              // U
>   s := @f()
>   ? s:Exec()         // S
>   ? DO(s)            // U
> RETURN
> FUNC f()
> RETURN VALTYPE(QSELF())
> 
> We can change EXEC/EVAL method code to hide QSELF() value with a single 
> hb_itemSetNil() call.
> 
> But QSELF()=SYMBOL is natural in function execution, just like 
> QSELF()=CODEBLOCK in case of codeblock execution. So, QSELF() could be a 
> symbol even in simple call of functions. We can do recursive 
> functions/codeblocks using :)
>     DO(QSELF(), param)
> But perhaps it was not implemented in Clipper because it has no SYMBOL 
> type variables. So, I think we are not going to enhance QSELF() because 
> of Clipper compatibility.

Touching QSELF() value is dangerous but I do not think it's necessary().
There are also other differences, f.e.:
    proc main()
    local cb:={|...|f1(...)}, fs:=@f1()
    ? eval(cb,"A","B","C","D")
    ? eval(fs,"A","B","C","D")
    return
    func f1(...)
    ? procname(), ...
    return 123

druzus:/tmp/6# hbmk -n -w2 -es2 -l -gtstd t && ./t
Harbour devel build 1.1-0 Intl.
Copyright 1999-2007, http://www.harbour-project.org/
Compiling 't.prg'...
Lines 25, Functions/Procedures 2
Generating C source output to 't.c'... Done.

F1 A B C D
       123
(b)EVAL A B C D
       123

and hiding all of them does not make sense for me, f.e. the
above example also shows why function symbols are faster then
codeblocks and why there is no big sense to force INLINE methods.
Here are more precise results from test code below:

druzus:/tmp/6# hbmk -n -w2 -es2 -l -gtstd t1 && ./t1
Harbour devel build 1.1-0 Intl.
Copyright 1999-2007, http://www.harbour-project.org/
Compiling 't1.prg'...
Lines 42, Functions/Procedures 2
Generating C source output to 't1.c'... Done.

Linux 2.6.15 i686 Harbour devel build 1.1-0 Intl. 04/20/07 16:24:35
CODEBLOCK          1.50 sec.
FUNCSYBOL          1.08 sec.



In both tests I used modified HVM which support EVAL as synonym of EXEC
in SYMBOL items (BTW in modification example I sent should be
hb_symEval.pDynSym instead of s___msgEval.pDynSym)

best regards,
Przemek


/*** t1.prg ***/
#define N_LOOP 1000000
proc main()
local cb:={|...|f1(...)}, fs:=@f1()
local t, i
? OS(), VERSION(), DATE(), TIME()
t:=secondsCPU()
for i:=1 to N_LOOP
  eval(cb,"A","B","C","D")
next
? "CODEBLOCK", secondsCPU()-t, "sec."
t:=secondsCPU()
for i:=1 to N_LOOP
  eval(fs,"A","B","C","D")
next
? "FUNCSYBOL", secondsCPU()-t, "sec."
return
func f1(...)
local a:={...}
return 123
From harbour.01 at syenar.hu  Fri Apr 20 10:46:25 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 20 10:46:19 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <4628CB23.3070402@dbtopas.lt>
References: <20070418110016.GA14036@localhost.localdomain>	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>	<20070418140112.GA16238@localhost.localdomain>	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>	<20070420111236.GB5926@localhost.localdomain>	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<4628CB23.3070402@dbtopas.lt>
Message-ID: <5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>

>
>> BTW. What about extended codeblocks? I've just added them to mu  
>> local CVS
>>      and I can commit so you can test it. It's not exactly the  
>> same as in
>>      xHarbour but most of people should not find the difference.
>
> I see Viktor's vote against, but I guess you've spend your valuable  
> time on this. I trust your decision. Thanks.

What about supporting commands in codeblock _without_ introducing a  
new syntax?
(this might sound wierd and can have several technical problems, but  
it's an idea, and
this way it would fit more "naturally" into the language.)

LOCAL bBlock := {| p1, p2 | QOut( "hello" )
                                                   FOR tmp := 1 TO 10
                                                           QOut( tmp )
                                                   NEXT
                                                   tmp := {|o|  
DoSomething() }
                                                   QOut( "test" ) ;  
QOut( "this" )
                                 }

(notice the first line with no line continuation char)

Is still feasible or is it a completely insane idea? :)

Brgds,
Viktor

From jorgeagiraldo at hotmail.com  Fri Apr 20 11:13:07 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Fri Apr 20 11:13:44 2007
Subject: [Harbour] Property assignment fails
Message-ID: <BAY136-F1B8BD06B5CF3572CD16FEA1560@phx.gbl>

Hi All,

The following code

---

#Include 'HbClass.ch'

FUNCTION MakeIndex( cString )
LOCAL oFile
oFile := FileX{ 'FILENAME', 'ALIASF', 'SH',,'DBFNTX'}

RETURN NIL

CLASS FileX
   PROTECT cVia      AS STRING

   MESSAGE Init( ) INLINE ::cVia := NIL

ENDCLASS

---

Fails in actual CVS with "Error BASE/44  Assigned value is wrong class: 
FILEX:CVIA" when used as a function in a Harbour Self Contained DLL (a 
Harbour DLL with your Harbour functions and the RTL inside so it can be 
called from any other language).

I don't know who else is using this approach, but I'm having some errors 
with the actual CVS, and thus making me impossible to carry four years of 
Harbour coding to the new beta2.

For that reason, I elaborated a very small test.  It will create a self 
contained DLL with the funtion described above, this function is called from 
a c++ program named test.exe.

If you want to try it, please modify bld_sdll.bat to meet your environment.  
Compile.bat will create test.exe and myprog.dll.

Im using BCC55 and Windows XP.

TIA,

Jorge A.

_________________________________________________________________
MSN Amor: busca tu ? naranja http://latam.msn.com/amor/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: MINIMAL.ZIP
Type: application/x-zip-compressed
Size: 2412 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070420/0ea3d90c/MINIMAL-0001.bin
From i at kevincarmody.com  Fri Apr 20 09:40:37 2007
From: i at kevincarmody.com (Kevin Carmody)
Date: Fri Apr 20 12:34:19 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070419115212.GA13603@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>	<010601c781fe$bc083800$0301a8c0@bh>
	<20070419115212.GA13603@localhost.localdomain>
Message-ID: <4628C2D5.8020701@kevincarmody.com>

Przemyslaw Czerpak wrote:
> On Wed, 18 Apr 2007, bhays wrote:
>   
>> There are actually a few significant qualities to these that are worth
>> noting:
>>     
> [...]
> reasonable for me arguments.
> But I still do not accept the form as in xHarbour so I will introduce
> the following modifications:
> 1. using variable declaration with STATIC, LOCAL, FIELD, MEMVAR, PARAMETERS
>    statement inside extended codeblock should be forbidden.
>    xHarbour allows to use LOCAL but in fact it does not allocate any local
>    variables but simply add declared locals to codeblock parameter list.
>    IMHO it only confuse users.
>   
I wrote something very similar to xHarbour's extended codeblocks as part 
of my general-purpose database editor, Data Globe, written completely in 
Clipper.  Data Globe info is at 
http://kevincarmody.com/software/dg.html, and download is at 
http://kevincarmody.com/software/setupdg.exe.

My version of extended codeblocks I call scripts.  At run time, my 
program translates the script source code into a Clipper code block 
expression, and then compiles it with the macro compiler.  I've put a 
sample file containing a script definition at the end of this message.  
This sample is part of the Data Globe distribution.

Naturally I don't expect Harbour to do exactly the same thing as my 
scripts, because the purposes are not exactly the same.  But there are 
many similarities, and I think that something similar can be done in 
Harbour.

The example below shows that my scripts allow LOCAL variables.  They can 
also have PRIVATE variables, and the equivalent of PUBLIC variables 
(with the MemAdd* functions), which the example does not show.  I don't 
see why anyone would want to use a PARAMETERS statement these days, but 
I could have implemented that easily.

I could not think of a good way to implement STATIC variables.  MEMVAR 
and FIELD declarations would have been too difficult for my parser.  
Otherwise I would have added them.

> Look at example below and try to guess the results then compile
> and execute it.
>
>     proc main()
>     local cb
>     cb := < | p1, p2, p3 |
>              local l1, l2, l3
>              ? p1, p2, p3
>              ? l1, l2, l3
>           >
>     ? valtype(cb)
>     ? eval(cb,1,2,3,4,5,6,7,8,9)
>     ?
>     return
>   
I also ran into this problem.  I translate a LOCAL variable declaration 
as an extra code block argument, which I think xHarbour is also doing.  
But I also assign NIL into such a variable before I begin to evaluate 
any of the user's expressions or statements.  This assures that such 
variables are properly pre-initialized, so they don't assume the values 
of extra arguments the user may have passed in through EVAL.  Harbour 
could easily do something like this.

IMHO local variables are not confusing at all to users.  In fact, it is 
something that they expect and would be disappointed not to find.  As I 
was developing my scripts, I found that local variables were natural to 
use, and I would not want to be without them.  I think that the solution 
is not to ban them, but to properly initialize them.

>    In the future we may want to add nested functions so now I do not
>    want to define any semantic for nested variable declaration which
>    because it's possible that I will not be able to keep it in nested
>    functions. We already have some rules used by Clipper for file wide
>    and function wide declaration but they are not cover all cases.
>    I would like to avoid situation like with GLOBALs in xHarbour
>    which does not respect even this few Clipper rules when name conflicts
>    appears.
>   

The example below shows how I allow a nested code block definition, with 
the SUBBLOCK statement.  I chose this syntax because the top level block 
starts with a BLOCK statement.

Again, I am not advocating this exact syntax for Harbour, but am showing 
what I found to be natural for my scripts.  I allow LOCAL variables in 
these nested codeblocks also.  They work basically the same as LOCAL 
variables at the top level script.  Again, the key to making them work 
is to properly initialize.

In the sample below, you will also see some unfamiliar statements like 
GET and SCAN.  These are suited to Data Globe, but I am not advocating 
them for Harbour.


> 2. unlike normal codeblock the extended ones by default does not leave
>    on HVM stack a return value. HVM expects such value so we should
>    force explicit: RETURN <value> at the end of extended codeblock
>    or change generated PCODE to use HB_P_ENDPROC instead of HB_P_ENDBLOCK
>    Without it users will receive unexpected results from EVAL(<ExtBlock>)
>   

My script syntax requires a RETURN statement, but that is because the 
source code could occur within a keyword based control file (a DG file) 
rather than a PRG.  I needed some way for the control file parser to 
know where the script ended.  If it had not been for that, I would not 
have required RETURN.  The return value in my RETURN statement is always 
optional and defaults to NIL.

I require a SUBBLOCK to be ended with SUBRETURN, and for a SUBBLOCK and 
SUBRETURN to occur *before* a RETURN, but these limitations are again 
due to these scripts occurring within a control file rather than a PRG.  
I wanted to reserve RETURN for the end of script processing.

In the case of Harbour, none of these limitations apply.  I don't think 
RETURN is necessary.  The return value of a top level block or a nested 
block could simply be the value of the last expression, defaulting to 
NIL.  Of course, as you say, it should return *some* value.

Kevin


---------------------------  Data Globe script sample  
---------------------------

/*

EASTER.DG

Sample Data Globe application

Copyright (C) 2002-2005 Kevin Carmody
All rights reserved
http://kevincarmody.com/software/dg.html

--------------------------------------------------------------------------

This file sets up Data Globe to compute Easter in a series of years.  It
uses one database, EASTER.DBF, which contains a year and the date of
Easter in that year.  There is one toolbar button, Shift F5, which allows
you to calculate Easter in all or some of the records.

--------------------------------------------------------------------------

For more information on these sample applications, please see the file
README2.TXT in the samples directory.

--------------------------------------------------------------------------

*/

// Display Easter database, which has year and date of Easter for several
// different years.
Database       = EASTER.DBF
Column         = YEAR
Column Picture = 9999
// The above picture keeps the column from being displayed with a
// thousands separator.
Column         = EASTER

// The folloiwng toobar button allows the user to calculate Easter for
// all or some of the records in the Easter database.
Toolbar Button = [ShiftF5], Compute Easter, eval(MEMVAR->BEACOMP)

// The following script is assigned as a code block to a memory variable
// BEACOMP.  This code block is evaluated by the above toolbar button.
Memvar = BEACOMP
Memvar Script =
  BLOCK ||

  // Variables used within the script.
  LOCAL cFor, cWhile, nNext, cScope

  // Displays a box into which the user can enter data.
  // This box allows the user to enter "For", "While", "Scope", and "Next"
  // input in the same way as standard Data Globe features.
  GET
    WITH TITLE "COMPUTE EASTER"
    PROMPT "For"
      WITH VALUE ""
      WITH VAR cFor
      WITH PICTURE "@W"
      WITH TEST _CHLEXP
    END
    PROMPT "While"
      WITH VALUE ""
      WITH VAR cWhile
      WITH PICTURE "@W"
      WITH TEST _CHLEXP
    END
    WITH PROMPT _VASCOPE
    WITH PROMPT _VANEXT
    WITH TYPE _BTDIREXP
  END
  cScope := BoxVarGet(_VASCOPE)
  nNext  := BoxVarGet(_VANEXT)

  // Lock the database, so that we can make changes.
  IF !DataLock()
    BoxWarning("Cannot lock file")
    BREAK
  END
  // Scan through database using conditions entered by user.
  SCAN
    WITH TITLE "COMPUTING EASTER"
    WITH FOR (cFor)
    WITH WHILE (cWhile)
    WITH SCOPE cScope
    WITH NEXT nNext
    WITH DONE "computed"
    // Calculate Easter for this year by calling BEACALC script below.
    FIELD->EASTER := EVAL(bDate, FIELD->YEAR)
  END
  // Refresh browse so that we can see the changes we just made.
  RefreshBrowse()

  // This subblock calculates the date of Easter from the year using a
  // standard Easter algorithm.
  SUBBLOCK bDate|nYear|

    // Variables used within the script.
    LOCAL C, G, K, H, I, J, L, nMonth, nDay, dEaster

    // Calculate month and day of Easter from the year.
    C := INT(nYear/100)
    G := nYear % 19
    K := INT((C - 17)/25)
    H := (C - INT(C/4) - INT((C - K)/3) + 19*G + 15) % 30
    I := H - INT(H/28)* (1 - INT(H/28)*INT(29/(H+1))*(INT(21 - G)/11))
    J := (nYear + INT(nYear/4) + I + 2 - C + INT(C/4)) % 7
    L := I - J
    nMonth  := 3 + INT((L + 40)/44)
    nDay    := L + 28 - 31*INT(nMonth/4)
    // Construct date from year, month, and day.
    dEaster := YMD2D(nYear, nMonth, nDay)

  // The date of Easter is the return value of this subblock script.
  SUBRETURN dEaster

  RETURN

// 
--------------------------------------------------------------------------

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070420/c2209c3c/attachment.html
From harbour.01 at syenar.hu  Fri Apr 20 13:08:04 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 20 13:08:22 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070420111236.GB5926@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
Message-ID: <F3DB7E60-5405-4D88-BBBB-D62BD6DC6872@syenar.hu>

>> Correct me if I'm wrong but there could be built a hash class on the
>> top of the hash functions with similar functionality (maybe not  
>> similar
>> syntax  though) and with no low-level support from Harbour.
>
> I guess you are talking about scalar classes. Harbour does not support
> them yet but it will when I'll find a while and yes such interface  
> will
> interact with defined by user hash class messages.
> Please also note that like in Clipper our items accepts some prebuilt
> messages. All types understand CLASSH, CLASSNAME and CLASSSEL  
> messages.
> CODEBLOCKs accept EVAL, SYMBOLs accept EXEC and NAME, HASHes accept  
> KEYS
> and VALUES.

No, I was thinking of a simple oo interface (wrapper) for the hash
feature, which would have had a slightly different syntax, but the same
functionality. (I didn't realize that the reason for the request is a  
transition
issue from object to hash code, since in this case this wouldn't help  
much).

Scalar classes are not something I'd need personally, but if it can be
added without performance loss for normal code, it's a nice feature
to have for better Class(y) compatibility (would be good to hear the
opinion of those who'd actually use it).

Brgds,
Viktor

From niki at synel.co.il  Fri Apr 20 15:41:49 2007
From: niki at synel.co.il (Chen Kedem)
Date: Fri Apr 20 15:43:56 2007
Subject: [Harbour] About some xHarbour extensions
References: <EXCHRdNOUivlQoMuDGz00000708@exch.SYNEL-COMPANY.LTD>
Message-ID: <B75D4A6BE471094AB02513DB81890397088F6B@exch.SYNEL-COMPANY.LTD>

Viktor,
 
> What about supporting commands in codeblock _without_ introducing a new syntax?
 
And what happen if the user just forget the ending "}" in the first line?
 
---
LOCAL bBlock := {| p1, p2 | QOut( "hello" )
                                                   FOR tmp := 1 TO 10
                                                           QOut( tmp )
                                                   NEXT
                                                   tmp := {|o| 
DoSomething() }
                                                   QOut( "test" ) ; 
QOut( "this" )
---

Where is the error going to bereported? the first line? the end of the proc/function/file?

The idie itself is appealing, I have a program that read almost everying dynamically at run time
from text files, and macro complie it. If a codeblock could have this, it would be very nice.
But, we need to think before rushing to things.
 
  Chen.
 
(sorry about the HTML post, its this stupid webmailer I'm using)
 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/ms-tnef
Size: 6201 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070420/af1e7017/attachment-0001.bin
From harbour.01 at syenar.hu  Fri Apr 20 15:47:57 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 20 15:47:57 2007
Subject: [Harbour] CHANGELOG: 2007-04-20 21:46 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c78384$Blat.v2.6.1$cb891e52$3b89f30adcc@127.0.0.1>

2007-04-20 21:46 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/tbcolumn.prg
   * harbour/source/rtl/tbrowse.prg
   * harbour/source/rtl/teditor.prg
   * harbour/source/rtl/tget.prg
   * harbour/source/rtl/tgetlist.prg
     % Avoiding INLINE for speed.
     % Using INIT for quicker object initialization.
     + Added TGet() NOTEs, TOFIX.
     ! Fixed some problems in TGetList. (Two GetApplyKey() 
       potential RTEs.)
     ! Fixed a few missing "CLASS TBrowse"-es.
     ; Some formatting, code cleaning.

From harbour.01 at syenar.hu  Fri Apr 20 16:02:42 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 20 16:02:55 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <B75D4A6BE471094AB02513DB81890397088F6B@exch.SYNEL-COMPANY.LTD>
References: <EXCHRdNOUivlQoMuDGz00000708@exch.SYNEL-COMPANY.LTD>
	<B75D4A6BE471094AB02513DB81890397088F6B@exch.SYNEL-COMPANY.LTD>
Message-ID: <C3D3E5D7-CF14-4BB7-9FE0-1D80F4C5B73A@syenar.hu>

Hi Chen,

> Viktor,
>
>> What about supporting commands in codeblock _without_ introducing  
>> a new syntax?
>
> And what happen if the user just forget the ending "}" in the first  
> line?
>
> ---
> LOCAL bBlock := {| p1, p2 | QOut( "hello" )
>                                                    FOR tmp := 1 TO 10
>                                                            QOut( tmp )
>                                                    NEXT
>                                                    tmp := {|o|
> DoSomething() }
>                                                    QOut( "test" ) ;
> QOut( "this" )
> ---
>
> Where is the error going to bereported? the first line? the end of  
> the proc/function/file?

Yes, this is indeed pushing the limits of the syntax and can have  
such side-effect.
In this case the error could be reported based on the unclosed  
codeblock structure
when reaching the end of the func/proc (instead of the current line,  
as it is now).
Such error will be a bit more complicated to locate with this feature.

> The idie itself is appealing, I have a program that read almost  
> everying dynamically at run time
> from text files, and macro complie it. If a codeblock could have  
> this, it would be very nice.
> But, we need to think before rushing to things.

No rush from my side :)

Brgds,
Viktor



From hbco2 at sbcglobal.net  Fri Apr 20 16:36:15 2007
From: hbco2 at sbcglobal.net (Bill Smith)
Date: Fri Apr 20 16:37:16 2007
Subject: [Harbour] CHANGELOG: 2007-04-20 21:46 UTC+0100 Viktor
	Szakats(harbour.01 syenar.hu)
References: <01c78384$Blat.v2.6.1$cb891e52$3b89f30adcc@127.0.0.1>
Message-ID: <002001c7838b$93604080$0303a8c0@hbco>

Hi Victor,

Many thanks for your work.  There has been a long standing bug in dbedit()
(and by extension tbrowse()) where if the keyboard buffer is full when a
"browse up" command is executed, the current record number is set to eof().
In practice it means that if a database is browsed, if keyboard keys are
used to rapidly navigate the database, it is possible to unexpectedly find
the browse function displaying records beginning from the end of the file.
This used to be an intermittent problem, but with improvements in Harbour
has become quite predictable.

Is there any way to correct it?

Bill

----- Original Message ----- 
From: "Szak?ts Viktor" <harbour.01@syenar.hu>
To: <harbour@harbour-project.org>
Sent: Friday, April 20, 2007 12:47 PM
Subject: [Harbour] CHANGELOG: 2007-04-20 21:46 UTC+0100 Viktor
Szakats(harbour.01 syenar.hu)


> 2007-04-20 21:46 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>    * harbour/source/rtl/tbcolumn.prg
>    * harbour/source/rtl/tbrowse.prg
>    * harbour/source/rtl/teditor.prg
>    * harbour/source/rtl/tget.prg
>    * harbour/source/rtl/tgetlist.prg
>      % Avoiding INLINE for speed.
>      % Using INIT for quicker object initialization.
>      + Added TGet() NOTEs, TOFIX.
>      ! Fixed some problems in TGetList. (Two GetApplyKey()
>        potential RTEs.)
>      ! Fixed a few missing "CLASS TBrowse"-es.
>      ; Some formatting, code cleaning.
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Fri Apr 20 16:54:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 20 16:55:11 2007
Subject: [Harbour] Property assignment fails
In-Reply-To: <BAY136-F1B8BD06B5CF3572CD16FEA1560@phx.gbl>
References: <BAY136-F1B8BD06B5CF3572CD16FEA1560@phx.gbl>
Message-ID: <20070420205435.GA21908@localhost.localdomain>

On Fri, 20 Apr 2007, Jorge A. Giraldo wrote:
> Hi All,
> The following code
> ---
> #Include 'HbClass.ch'
> FUNCTION MakeIndex( cString )
> LOCAL oFile
> oFile := FileX{ 'FILENAME', 'ALIASF', 'SH',,'DBFNTX'}
> RETURN NIL
> CLASS FileX
>   PROTECT cVia      AS STRING
>   MESSAGE Init( ) INLINE ::cVia := NIL
> ENDCLASS
> ---
> 
> Fails in actual CVS with "Error BASE/44  Assigned value is wrong class: 
> FILEX:CVIA" 

This is intentional behavior. NIL is not a STRING.
Now Harbour checks defined data types when you assign value to class
members. Also scoping is working so if you have some old code which
worked because attributes like PROTECTED, HIDDEN, READONLY or AS <type>
were ignored then you will have to fix it. Now they are working.

> when used as a function in a Harbour Self Contained DLL (a 
> Harbour DLL with your Harbour functions and the RTL inside so it can be 
> called from any other language).

AFAIK it always generate such error and this is expected behavior.

> I don't know who else is using this approach, but I'm having some errors 
> with the actual CVS, and thus making me impossible to carry four years of 
> Harbour coding to the new beta2.

If will find something wrong in Harbour code then please inform us.

best regards,
Przemek
From druzus at priv.onet.pl  Fri Apr 20 17:14:26 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 20 17:15:02 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<4628CB23.3070402@dbtopas.lt>
	<5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>
Message-ID: <20070420211426.GB21908@localhost.localdomain>

On Fri, 20 Apr 2007, Szak?ts Viktor wrote:
> What about supporting commands in codeblock _without_ introducing a  
> new syntax?
> (this might sound wierd and can have several technical problems, but  
> it's an idea, and this way it would fit more "naturally" into the language.)
> LOCAL bBlock := {| p1, p2 | QOut( "hello" )
>                                FOR tmp := 1 TO 10
>                                        QOut( tmp )
>                                NEXT
>                                tmp := {|o| DoSomething() }
>                                QOut( "test" ) ; QOut( "this" )
>                 }
> (notice the first line with no line continuation char)
> Is still feasible or is it a completely insane idea? :)

IMHO this suggest is a normal codeblock so people will expect it will
work also with in macro compiler. I've just worked a little bit with
modified Harbour version and such codeblocks and the first thing I do
not like is the fact that the syntax suggest that all lines are single
PP expression. After few minutes of testing my code evaluated from:
   local cb := < |...|
            ? ...
            return 123
         >
   ? cb:eval(1,2,3)

then I have sth like:

   < |...|
      ? ...
      return 123
   >:eval(1,2,3)

and finally I wanted to compile;

   ? < |...|
      ? ...
      return 123
   >:eval(1,2,3)

and I was surprised that it cannot be compiled. If I was confused
then for sure other users will be too. So I think that we have to
use sth differ then <||...> or {||...} to clearly show that such
definition is a statement not an expression.
So IMHO we should think about sth like:
   BEGIN BLOCK <cbVar> [WITH <params,...>]
      ...
   END[BLOCK]

or:
   DEFINE BLOCK <cbVar> [PARAMETERS <params,...>]
      ...
   END[BLOCK]

What do you think about it?

Answering to Chen question: In the implementation I created unclosed
extended block generates the same compile error message as other unclosed
multi line statements like WHILE, IF, CASE,... Exactly the same error/check
function is used - I simply added new condition.

best regards,
Przemek
From jorgeagiraldo at hotmail.com  Fri Apr 20 19:26:23 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Fri Apr 20 19:26:58 2007
Subject: [Harbour] Property assignment fails
In-Reply-To: <20070420205435.GA21908@localhost.localdomain>
Message-ID: <BAY136-F27EDC554746F693EC012ADA1560@phx.gbl>

Przemek,

>
>On Fri, 20 Apr 2007, Jorge A. Giraldo wrote:
> > Hi All,
> > The following code
> > ---
> > #Include 'HbClass.ch'
> > FUNCTION MakeIndex( cString )
> > LOCAL oFile
> > oFile := FileX{ 'FILENAME', 'ALIASF', 'SH',,'DBFNTX'}
> > RETURN NIL
> > CLASS FileX
> >   PROTECT cVia      AS STRING
> >   MESSAGE Init( ) INLINE ::cVia := NIL
> > ENDCLASS
> > ---
> >
> > Fails in actual CVS with "Error BASE/44  Assigned value is wrong class:
> > FILEX:CVIA"
>
>This is intentional behavior. NIL is not a STRING.

I would like to have NIL as an acceptable value for any type of var.

>Now Harbour checks defined data types when you assign value to class
>members. Also scoping is working so if you have some old code which
>worked because attributes like PROTECTED, HIDDEN, READONLY or AS <type>
>were ignored then you will have to fix it. Now they are working.

I am now reliefed regarding this issue, I like this a lot.

>
> > when used as a function in a Harbour Self Contained DLL (a
> > Harbour DLL with your Harbour functions and the RTL inside so it can be
> > called from any other language).
>
>AFAIK it always generate such error and this is expected behavior.

Yeah, only you tell it and now it works in both.  :-)

>
> > I don't know who else is using this approach, but I'm having some errors
> > with the actual CVS, and thus making me impossible to carry four years 
>of
> > Harbour coding to the new beta2.
>
>If will find something wrong in Harbour code then please inform us.

Great,

Thank you.

Jorge A.

_________________________________________________________________
Consigue aqu? las mejores y mas recientes ofertas de trabajo en Am?rica 
Latina y USA: http://latam.msn.com/empleos/

From druzus at priv.onet.pl  Fri Apr 20 21:10:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Fri Apr 20 21:11:12 2007
Subject: [Harbour] compiling hbrun with libct
In-Reply-To: <4624F4BA.2040106@teledetection.fr>
References: <4624F4BA.2040106@teledetection.fr>
Message-ID: <20070421011035.GA14906@localhost.localdomain>

On Tue, 17 Apr 2007, Guy Roussin wrote:
> Hi,
> I seek a (good) way of compiling hbrun with libct
> under linux (harbour cvs).

add to hbrun.prg:
    #include "ctextern.ch"

and recompile it with:
    hbmk -n -w -es2 hbrun -static

(-static is optional)

best regards,
Przemek
From harbour.01 at syenar.hu  Sat Apr 21 02:16:26 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 21 02:16:34 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070420211426.GB21908@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<4628CB23.3070402@dbtopas.lt>
	<5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>
	<20070420211426.GB21908@localhost.localdomain>
Message-ID: <0242F1DB-DE12-40F8-9049-B258E7F0AA6F@syenar.hu>

> IMHO this suggest is a normal codeblock so people will expect it will
> work also with in macro compiler. I've just worked a little bit with
> modified Harbour version and such codeblocks and the first thing I do
> not like is the fact that the syntax suggest that all lines are single
> PP expression. After few minutes of testing my code evaluated from:

Question: Can the macro compiler be extended (with reasonable work
and consequences) to process such code? If I was understanding it
correctly Chen also referred that it would be good if full blocks could
be compiled this way. (we're starting to slide into hb_Compile()
territory here though, which also raises licensing questions.)

> So IMHO we should think about sth like:
>    BEGIN BLOCK <cbVar> [WITH <params,...>]
>       ...
>    END[BLOCK]
>
> or:
>    DEFINE BLOCK <cbVar> [PARAMETERS <params,...>]
>       ...
>    END[BLOCK]
>
> What do you think about it?

The second version looks much better than <||> IMO.

Or (but I guess this would be supported anyway):

DEFINE BLOCK <cbVar>
       PARAMETERS <params>
END[BLOCK]

Brgds,
Viktor

From druzus at priv.onet.pl  Sat Apr 21 05:09:06 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat Apr 21 05:09:43 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <0242F1DB-DE12-40F8-9049-B258E7F0AA6F@syenar.hu>
References: <002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<4628CB23.3070402@dbtopas.lt>
	<5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>
	<20070420211426.GB21908@localhost.localdomain>
	<0242F1DB-DE12-40F8-9049-B258E7F0AA6F@syenar.hu>
Message-ID: <20070421090906.GA22739@localhost.localdomain>

On Sat, 21 Apr 2007, Szak?ts Viktor wrote:
> Question: Can the macro compiler be extended (with reasonable work
> and consequences) to process such code?

No, it cannot with current code. Adding compilation of statements to
macrocompiler in practice means extending macrocompiler to be normal
compiler. I can do that and probably it will be good time to change
the method in which our compiler works and add expressions for statements
like IF, WHILE, CASE, SWTICH, ... I do not like that current compiler
in practice works with lines of code generating PCODE online (with some
minor exceptions). IMHO it should work only with lines of code without any
exceptions (it will force keeping some algorithms clean and make some
problems like error reporting much easier - I think Clipper works in such
way) or create expression list for full function body and then generate
PCODE - it will consume much more memory (not a real problem for current
computers) but it will allow us to add some additional optimizations.
Now some of optimizations I had to hard code to work on generated POCDE.
Using expression list will be much easier and more efficient.
But without serious modifications macro compiler can compile only
single expression or list of expressions (f.e. comma separated).

> If I was understanding it
> correctly Chen also referred that it would be good if full blocks could
> be compiled this way.

I've also seen this message and he is not the first person confused
by the syntax which suggest that it's a single expression. Similar
messages I saw in the past on xHarbour devel and user lists.

> (we're starting to slide into hb_Compile()
> territory here though, which also raises licensing questions.)

It's impossible to make sth like that using current code and it will
be necessary to create new one. For sure not now but maybe in the
future. If I will work on it then the new code will respect Harbour
exception to avoid problems with license.
Anyhow in such case I would like to add one new condition to this
exception. Any modifications to this code (and only this code) has
to be public. I would like to eliminate situation that someone will
create compiler in few lines of .prg code (f.e. see hbrun.prg) and then
claim that it's better/fixed version of Harbour. If it's true then
such modifications will have to be public so we can check them and
add to core code if they are valuable. The second version of such
additional condition can be forbidding any modifications in
[macro]compiler code if someone will want to use it with a program
which does not respect GPL license and forcing adding some notes
to the code that programs contains unmodified Harbour [macro]compiler
code version: ... - we can even add function which will return such
text.
In such case if some will want to modify the compiler (extend it or
fix it) then he will have to ask core developers about the modifications
or send patches.
For me one of such condition should protect us enough. You may think
about it because maybe such problem will appear in the future.

> >So IMHO we should think about sth like:
> >   BEGIN BLOCK <cbVar> [WITH <params,...>]
> >      ...
> >   END[BLOCK]
> >or:
> >   DEFINE BLOCK <cbVar> [PARAMETERS <params,...>]
> >      ...
> >   END[BLOCK]
> >What do you think about it?
> The second version looks much better than <||> IMO.
> Or (but I guess this would be supported anyway):
> 
> DEFINE BLOCK <cbVar>
>       PARAMETERS <params>
> END[BLOCK]

In the first implementation I would like to forbid any variable
declaration inside codeblock body. Later when we define the conditions
we can add declarations and in such case PARAMETERS may have the same
meaning as in normal function so using it now inside block body is not
good idea. Last night I implemented:

    BEGIN BLOCK <cbVar> [WITH <params,...>]
    END

and I can commit it for tests.

best regards,
Przemek
From druzus at priv.onet.pl  Sat Apr 21 05:54:36 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat Apr 21 05:55:12 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <4628C2D5.8020701@kevincarmody.com>
References: <20070418110016.GA14036@localhost.localdomain>
	<010601c781fe$bc083800$0301a8c0@bh>
	<20070419115212.GA13603@localhost.localdomain>
	<4628C2D5.8020701@kevincarmody.com>
Message-ID: <20070421095436.GA23180@localhost.localdomain>

On Fri, 20 Apr 2007, Kevin Carmody wrote:
> I wrote something very similar to xHarbour's extended codeblocks as part 
> of my general-purpose database editor, Data Globe, written completely in 
> Clipper.  Data Globe info is at 
> http://kevincarmody.com/software/dg.html, and download is at 
> http://kevincarmody.com/software/setupdg.exe.
> My version of extended codeblocks I call scripts.  At run time, my 
> program translates the script source code into a Clipper code block 
> expression, and then compiles it with the macro compiler.  I've put a 
> sample file containing a script definition at the end of this message.  
> This sample is part of the Data Globe distribution.
> Naturally I don't expect Harbour to do exactly the same thing as my 
> scripts, because the purposes are not exactly the same.  But there are 
> many similarities, and I think that something similar can be done in 
> 
> The example below shows that my scripts allow LOCAL variables.  They can 
> also have PRIVATE variables, and the equivalent of PUBLIC variables 
> (with the MemAdd* functions), which the example does not show.  I don't 
> see why anyone would want to use a PARAMETERS statement these days, but 
> I could have implemented that easily.
> I could not think of a good way to implement STATIC variables.  MEMVAR 
> and FIELD declarations would have been too difficult for my parser.  
> Otherwise I would have added them.

This is not a problem for us. We can compile any declarations. The problem
is defining how they should work in some strange cases and keep such
definition in the future also for other constructions.

> >Look at example below and try to guess the results then compile
> >and execute it.
> >    proc main()
> >    local cb
> >    cb := < | p1, p2, p3 |
> >             local l1, l2, l3
> >             ? p1, p2, p3
> >             ? l1, l2, l3
> >          >
> >    ? valtype(cb)
> >    ? eval(cb,1,2,3,4,5,6,7,8,9)
> >    ?
> >    return
> I also ran into this problem.  I translate a LOCAL variable declaration 
> as an extra code block argument, which I think xHarbour is also doing.  
> But I also assign NIL into such a variable before I begin to evaluate 
> any of the user's expressions or statements.  This assures that such 
> variables are properly pre-initialized, so they don't assume the values 
> of extra arguments the user may have passed in through EVAL.  Harbour 
> could easily do something like this.

Yes it can. But the situation like in xHarbour when LOCAL declaration
is accepted when in fact it does not declare LOCAL variables but additional
parameters is not acceptable for me. Also if we are talking about code
blocks then please note that the codeblocks parameters works in differ
way then function parameters and cannot be accessed from nested code
blocks and later detached. It's not a problem to add a declaration.
The problem is making them fully functional to not be surprised in the
future and revert some modifications when users begin to use it and we
have problem with backward compatibility. Here probably we will have to
make modifications also in HVM. Now I simply forbid all declarations
inside multiline codeblocks.

> IMHO local variables are not confusing at all to users.  In fact, it is 
> something that they expect and would be disappointed not to find.  As I 
> was developing my scripts, I found that local variables were natural to 
> use, and I would not want to be without them.  I think that the solution 
> is not to ban them, but to properly initialize them.

You haven't understood my point. It will not confused users when they
will be real full functional local variables. Not parameters. BTW assigning
NIL does not resolve anything because additional parameters passed by
references will be cleared by this operation and after codeblock evaluation
they will contain the recent pseudo local value.
For sure it's not sth expected by users when they are declaring LOCALs
they are expecting _REAL_ locals not sth with different side effects.

> The example below shows how I allow a nested code block definition, with 
> the SUBBLOCK statement.  I chose this syntax because the top level block 
> starts with a BLOCK statement.

The syntax of nested codeblocks is not a problem but the behavior
of some operations, f.e. code blocks parameters are not exactly the
same as function parameters.

> Again, I am not advocating this exact syntax for Harbour, but am showing 
> what I found to be natural for my scripts.  I allow LOCAL variables in 
> these nested codeblocks also.  They work basically the same as LOCAL 
> variables at the top level script.  Again, the key to making them work 
> is to properly initialize.

"Basically" ;-) is not enough to add sth to core code as supported syntax.
It has to work as we expect and accept or in the future we will have
problems.

> In the sample below, you will also see some unfamiliar statements like 
> GET and SCAN.  These are suited to Data Globe, but I am not advocating 
> them for Harbour.

> >2. unlike normal codeblock the extended ones by default does not leave
> >   on HVM stack a return value. HVM expects such value so we should
> >   force explicit: RETURN <value> at the end of extended codeblock
> >   or change generated PCODE to use HB_P_ENDPROC instead of HB_P_ENDBLOCK
> >   Without it users will receive unexpected results from EVAL(<ExtBlock>)
> My script syntax requires a RETURN statement, but that is because the 
> source code could occur within a keyword based control file (a DG file) 
> rather than a PRG.  I needed some way for the control file parser to 
> know where the script ended.  If it had not been for that, I would not 
> have required RETURN.  The return value in my RETURN statement is always 
> optional and defaults to NIL.

I generate warning when no such codeblock is not finished with RETURN <exp>
just like for functions and in such case the return value is exactly the
same as for procedures (value of recently executed function, can be NIL
but does not have to - people often wrongly things that in Clipper/Harbour
PROCEDUREs return NIL)

> I require a SUBBLOCK to be ended with SUBRETURN, and for a SUBBLOCK and 
> SUBRETURN to occur *before* a RETURN, but these limitations are again 
> due to these scripts occurring within a control file rather than a PRG.  
> I wanted to reserve RETURN for the end of script processing.
> In the case of Harbour, none of these limitations apply.  I don't think 
> RETURN is necessary.  The return value of a top level block or a nested 
> block could simply be the value of the last expression, defaulting to 
> NIL.  Of course, as you say, it should return *some* value.

It's necessary to serve correctly situation when no return value is used
instead of leaving it "as is" like in xHarbour so the most top stack value
is return without respecting what it is and if it can be copied or not.

Many thanks for your notes.

best regards,
Przemek
From harbour.01 at syenar.hu  Sat Apr 21 06:02:00 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 21 06:02:07 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070421090906.GA22739@localhost.localdomain>
References: <002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<4628CB23.3070402@dbtopas.lt>
	<5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>
	<20070420211426.GB21908@localhost.localdomain>
	<0242F1DB-DE12-40F8-9049-B258E7F0AA6F@syenar.hu>
	<20070421090906.GA22739@localhost.localdomain>
Message-ID: <FAA83260-EF2C-48AE-89C9-82412003B714@syenar.hu>

> No, it cannot with current code. Adding compilation of statements to
> macrocompiler in practice means extending macrocompiler to be normal
> compiler. I can do that and probably it will be good time to change
> the method in which our compiler works and add expressions for  
> statements
> like IF, WHILE, CASE, SWTICH, ... I do not like that current compiler
> in practice works with lines of code generating PCODE online (with  
> some
> minor exceptions). IMHO it should work only with lines of code  
> without any
> exceptions (it will force keeping some algorithms clean and make some
> problems like error reporting much easier - I think Clipper works  
> in such
> way) or create expression list for full function body and then  
> generate
> PCODE - it will consume much more memory (not a real problem for  
> current
> computers) but it will allow us to add some additional optimizations.
> Now some of optimizations I had to hard code to work on generated  
> POCDE.
> Using expression list will be much easier and more efficient.
> But without serious modifications macro compiler can compile only
> single expression or list of expressions (f.e. comma separated).

These look like reasonable changes.

>> (we're starting to slide into hb_Compile()
>> territory here though, which also raises licensing questions.)
>
> It's impossible to make sth like that using current code and it will
> be necessary to create new one. For sure not now but maybe in the
> future. If I will work on it then the new code will respect Harbour
> exception to avoid problems with license.
> Anyhow in such case I would like to add one new condition to this
> exception. Any modifications to this code (and only this code) has
> to be public. I would like to eliminate situation that someone will
> create compiler in few lines of .prg code (f.e. see hbrun.prg) and  
> then
> claim that it's better/fixed version of Harbour. If it's true then
> such modifications will have to be public so we can check them and
> add to core code if they are valuable. The second version of such
> additional condition can be forbidding any modifications in
> [macro]compiler code if someone will want to use it with a program
> which does not respect GPL license and forcing adding some notes
> to the code that programs contains unmodified Harbour [macro]compiler
> code version: ... - we can even add function which will return such
> text.
> In such case if some will want to modify the compiler (extend it or
> fix it) then he will have to ask core developers about the  
> modifications
> or send patches.
> For me one of such condition should protect us enough. You may think
> about it because maybe such problem will appear in the future.

I agree with both additions.

>>> So IMHO we should think about sth like:
>>>   BEGIN BLOCK <cbVar> [WITH <params,...>]
>>>      ...
>>>   END[BLOCK]
>>> or:
>>>   DEFINE BLOCK <cbVar> [PARAMETERS <params,...>]
>>>      ...
>>>   END[BLOCK]
>>> What do you think about it?
>> The second version looks much better than <||> IMO.
>> Or (but I guess this would be supported anyway):
>>
>> DEFINE BLOCK <cbVar>
>>       PARAMETERS <params>
>> END[BLOCK]
>
> In the first implementation I would like to forbid any variable
> declaration inside codeblock body. Later when we define the conditions
> we can add declarations and in such case PARAMETERS may have the same
> meaning as in normal function so using it now inside block body is not
> good idea. Last night I implemented:
>
>     BEGIN BLOCK <cbVar> [WITH <params,...>]
>     END
>
> and I can commit it for tests.

I'd still like better to have a "full language" (without
the PP bits) macro compiler (like you described in the first
part of your mail) and have the current codeblock
system extended with such capabilities. This would fit better
with the natural expectations of programmers and the language
syntax as well. (the only downside I can now think of would be
that usage of this extension would be hard to visually detect
in actual code before porting the code off-Harbour. But this
could be solved with a -k? switch.).

Regarding this syntax, I personally and technically have no
problems with it, and it can even live in parallel with the full
codeblock support, but it would be good to see some real
world examples and opinions from prospective users to see
its usefulness before including it.

Overall I think there are more important fields in Harbour
to enhance at this moment: unicode, MT, TBrowse/TGet fixes.

Brgds,
Viktor



From dmacias at mail.udg.mx  Sat Apr 21 06:27:58 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Sat Apr 21 06:28:03 2007
Subject: [Harbour] Re: ChangeLog 2007-04-06 02:32
	UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
In-Reply-To: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
Message-ID: <4629E72E.7010205@mail.udg.mx>

Maurilio:

 >I've just rebuilt xharbour, I got your warnings but not the error.

I installed "gcc 3.3.5 Bird Build" (from netlabs.org) and yes, there are 
differences

Below are results of    xHarbour    build under OS/2, from fresh
xHarbour CVS checkout of April 7, without changes and just applying
make_gnu.cmd

It apply on same code from previous tests

This error does not appear anymore:
---------------------------------------------------------
../../../../source/rtl/os2/gcc/rtl.a(net.o): Undefined symbol
gethostname referenced from text segment
---------------------------------------------------------

It imply that both gcc 3.3.5 for OS/2:
   - gcc (GCC) 3.3.5 (Innotek Build 2005-01-17 06:42)
   - gcc (GCC) 3.3.5 (Bird Build 2006-03-18 05:37)
gave different results, at least under eCS 1.2MR

It is confusing
I will use "Bird Build"

For this error:
---------------------------------------------------------
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol
_hb_gt_SetAttributeCT referenced from text segment
---------------------------------------------------------

I found:
- Build of xHarbour show:
---------------------------------------------------------
../../gtapi.c:2275: warning: implicit declaration of function
`hb_gt_SetAttributeCT'
---------------------------------------------------------

- Error happen in: rtl.a(gtapi.o) from gtapi.c

- xHarbour Changelog contain:
---------------------------------------------------------
2007-04-06 19:15 UTC-0800 Tony Bretado <tony@bretado.com>
   * source/rtl/gtapi.c
     + New function hb_gtSaveAll(). Needed to Save WHOLE Screen from 
inside a CT Window.
     ! Fix hb_ctShadow(). In order to draw shadow attribute CA-Tools 
compatible.
       Now it calls hb_gt_SetAttributeCT() defined in gtwvt.c
          /* Please check other gt libraries! */
   + source/rtl/gtwvt/gtwvt.c
     + New function hb_gt_SetAttributeCT(). Needed to draw shadow 
attribs CA-Tools compatible.
---------------------------------------------------------

added just few hours earlier than my tests


- ... and later xHarbour Changelog contain:
---------------------------------------------------------
2007-04-08 03:18 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * source/rtl/gtapi.c
     * Temporrarily commented calls to hb_gt_SetAttributeCT()
---------------------------------------------------------

so seem that error was detected and controlled after my tests


About rest of warnings I got, xHarbour Changelog contain:
---------------------------------------------------------
2007-04-19 10:10 UTC-0300 Walter Negro <anegro/at/overnet.com.ar>
   * source/common/hbdate.c
   * source/compiler/gencc.c
   * source/rtl/dateshb.c
   * source/vm/arrays.c
     * Correct compiler warnings reported by Maurilio Longo
---------------------------------------------------------

so I suppose build of xHarbour with current code will be without these 
warnings and errors under OS/2
I will test later


 >Please do note however that using -DTCPV40HDRS is _not_ enough, you have
 >to change the library path so that the compiler finds V40 libraries
 > _before_ the 32bit ones, it is clearly explained in GCC docs.

ReleaseNotes.os2 contain:
---------------------------------------------------------
v3.2.2 Alpha 2:
---------------

     A few bugfixes and a couple of new features.

         o The TCP/IP headers and libraries scheme have been changed.
           The default is the current OS/2 tcpip toolkit (BSD 4.4 based).
           To target the older OS/2 tcpip stack (BSD 4.3 based) you must
           define TCPV40HDRS before including any TCP/IP headers and make
           sure usr/lib/tcpipv4 is searched before usr/lib (this is to
           get the right libsocket). It is recommended to use the -D
           compiler option for the define and either the LIBRARY_PATH or
           the -L compiler/linker option for the library.
---------------------------------------------------------

Przemek,
can you add some comment related to this subject in make_gnu.cmd  and/or 
config\os2\gcc.cf ?

 >Anyway, your error does not come from -DTCPV40HDRS.
OK

 > -s is used to strip the symbol table, this way you get smaller .exes
 > and .dlls

Przemek,
can you add it (if it is convenient) to config\os2\gcc.cf ?


Reference:

xHarbour os2\gcc.cf have:
------------------------------------------------------
# statical linking with GCC 3.2.2 libc as not require its presence on
user system
LDFLAGS += $(LINKPATHS) -s
------------------------------------------------------

while Harbour os2\gcc.cf have:
------------------------------------------------------
# statical linking with GCC 3.2.2 libc as not require its presence on
user system
LDFLAGS += $(LINKPATHS)
------------------------------------------------------


David Macias



../../hbdate.c: In function `hb_timeEncStr':
../../hbdate.c:899: warning: `lTime' might be used uninitialized in this 
functio
n
../../gencc.c: In function `hb_p_pushdatetime':
../../gencc.c:1737: warning: int format, LONG arg (arg 3)
../../gencc.c:1737: warning: int format, LONG arg (arg 4)
../../gencc.c: In function `hb_p_pushdate':
../../gencc.c:1747: warning: int format, LONG arg (arg 3)
../../dateshb.c: In function `hb_timectot':
../../dateshb.c:226: warning: `fin' might be used uninitialized in this 
function

../../gtapi.c: In function `hb_ctShadow':
../../gtapi.c:2275: warning: implicit declaration of function 
`hb_gt_SetAttribut
eCT'
../../gtgraph.c: In function `HB_FUN_GTRGB':
../../gtgraph.c:110: warning: left shift count >= width of type
../../gtgraph.c:137: warning: left shift count >= width of type
../../gtgraph.c:141: warning: left shift count >= width of type
../../gtos2.c: In function `hb_gt_Init':
../../gtos2.c:240: warning: dereferencing type-punned pointer will break 
strict-
aliasing rules
../../gtos2.c:247: warning: dereferencing type-punned pointer will break 
strict-
aliasing rules
../../files.c: In function `HB_FUN_SETFDATI':
../../files.c:894: warning: unused variable `szFile'
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbrun.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbdoc.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbtest.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbmake.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [hbdict.exe] Error 1
make[2]: *** [descend] Error 2
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
../../../../source/rtl/os2/gcc/rtl.a(gtapi.o): Undefined symbol 
_hb_gt_SetAttrib
uteCT referenced from text segment
make[3]: *** [xbscript.exe] Error 1
make[2]: *** [descend] Error 2
make[1]: *** [first] Error 2
make: *** [first] Error 2
From harbour.01 at syenar.hu  Sat Apr 21 06:54:20 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 21 06:54:29 2007
Subject: [Harbour] BUG: Compiler unreleased blocks under Linux
Message-ID: <A55087C3-D841-44DE-8AE8-6A13734EC42D@syenar.hu>

Hi,

Under Ubuntu 7.04 Server, GCC 4.1.2 (everything freshly installed)
with current Harbour CVS.

After I've accidentally run this command:
harbour test.prg /n
(notice /n which should have been -n)

I'm getting this:

vszakats@orange:~/test$ harbour test.prg /n
Harbour devel build 1.1-0 Intl.
Copyright 1999-2007, http://www.harbour-project.org/
Compiling 'test.prg'...
Lines 25, Functions/Procedures 2
Generating C source output to 'test.c'... Done.
Cannot open input file: /n.prg

----------------------------------------
Total memory allocated: 18198 bytes (628 blocks)
WARNING! Memory allocated but not released: 788 bytes (13 blocks)
harbour.c:329: HB_TR_ERROR Block 1 0x80de800 (size 8) "\48\E8\0D\08\00 
\00\00\00"
harbour.c:329: HB_TR_ERROR Block 2 0x80de868 (size 20) "\48\E8\0D\08 
\00\00\20\00\01\00\00\00\01\00\01\00\00\00\00\00"
harbour.c:329: HB_TR_ERROR Block 3 0x80de5e8 (size 8) "\@0\E6\0D\08\00 
\E8\0D\08"
harbour.c:329: HB_TR_ERROR Block 4 0x80de710 (size 20) "\@0\E6\0D\08 
\00\00\20\00\01\00\00\00\01\00\01\00\68\E8\0D\08"
harbour.c:329: HB_TR_ERROR Block 5 0x80de5c8 (size 8) "\B0\E2\0D\08\E8 
\E5\0D\08"
harbour.c:329: HB_TR_ERROR Block 6 0x80de498 (size 20) "\B0\E2\0D\08 
\00\00\20\00\01\00\00\00\01\00\01\00\10\E7\0D\08"
harbour.c:329: HB_TR_ERROR Block 7 0x80de340 (size 100) "\24\03\00\B0 
\02\00\6A\0C\68\65\6C\6C\6F\20\77\6F\72\6C\64\00\14\01\24\04\00\B0\02 
\00\B0\03\00\0C\00\14\01\24\05\00\B0\02\00\B0\04\00\0C\00\14\01\24\07 
\00\64\6E\07\24\07\00\64\6E\07\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00"
harbour.c:329: HB_TR_ERROR Block 8 0x80de2d0 (size 88) "\B0\E1\0D\08 
\01\00\2@\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\40\E3\0D\08\64\00\00\00\36\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\01\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
harbour.c:329: HB_TR_ERROR Block 9 0x80de180 (size 20) "\B0\E1\0D\08 
\01\02\20\00\01\00\00\00\04\00\01\00\@8\E4\0D\08"
harbour.c:329: HB_TR_ERROR Block 10 0x80de0e0 (size 100) "\07\00\00\74 
\00\00\07\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00"
harbour.c:329: HB_TR_ERROR Block 11 0x80de070 (size 88) "\48\DE\0D\08 
\01\00\04\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\E0\E0\0D\08\64\00\00\00\01\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\01\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\D0\E2\0D\08\00\00\00\00"
harbour.c:329: HB_TR_ERROR Block 12 0x80dde90 (size 20) "\48\DE\0D\08 
\05\02\20\00\01\00\00\00\00\00\00\00\80\E1\0D\08"
harbour.c:329: HB_TR_ERROR Block 13 0x80ddc98 (size 288) "\00\00\00\00 
\AD\DC\0D\08\68\50\0A\08\00\00\00\00\2E\70\72\67\00\74\65\73\74\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00 
\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00\00"
vszakats@orange:~/test$

Brgds,
Viktor

From dmacias at mail.udg.mx  Sat Apr 21 07:08:48 2007
From: dmacias at mail.udg.mx (David Arturo Macias Corona)
Date: Sat Apr 21 07:08:52 2007
Subject: [Harbour] Re: ChangeLog 2007-04-06 02:32
	UTC+0200PrzemyslawCzerpak(druzus/at/priv.onet.pl)
In-Reply-To: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
References: <20070406150043.CD0D642F919@antivirus2.noc.udg.mx>
Message-ID: <4629F0C0.2050305@mail.udg.mx>

Maurilio:

 >so I suppose build of xHarbour with current code will be without these
 >warnings and errors under OS/2
 >I will test later

Done
Results are below

Some warnings remain (gtgraph.c, gtos2.c,files.c) while others are a new set
ppcore.c warnings seem to belong to some of these changes:
--------------------------------------
2007-04-16 13:02 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * include/simplex.c
   * source/pp/ppcore.c
     * Compiler warnings

2007-04-15 23:42 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * include/hbpp.h
   * source/compiler/ppcomp.c
   * source/pp/ppcore.c
     + Added support for #pragma push ... and #pragma pop ...
       /* This allows save, modify, and later restore of any compiler 
switch */

2007-04-13 11:38 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * include/hbpp.h
     + Added:
        #define HB_PP_CMP_KEY        0x1000
        #define HB_PP_CMP_MATCHRULE  0x2000
   * source/pp/ppcore.c
     * Corrected #[x]untranslate/[x]uncommand to work as documented
   * include/hbclass.ch
     * Corrected usage of #[x]untranslate

2007-04-11 21:26 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * source/pp/ppcore.c
     * Minor correction to spaces attribute of seperated tokens of 
recent commit

2007-04-11 15:22 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * source/pp/ppcore.c
     + Added logic to break '<<' into 2 tokens ('<' '<') when prefixed 
by ESCAPE '\' in #directives.

2007-04-09 18:47 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * source/pp/ppcore.c
     * Uncommented HB_PP_NO_LINEINFO_TOKEN

2007-04-09 17:05 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * source/compiler/ppcomp.c
     ! Fixed loading of system defines to precede processing of user 
defined rules
     * Readded support of hb_pp_STD_CH_ADDITIVE
   * source/pp/ppcore.c
     * Synched with some Harbour modifications
     * Improved HB_PP_ERR_UNKNOWN_RESULT_MARKER and 
HB_PP_ERR_WRONG_LABEL to provide more details

2007-04-10 14:20 UTC-0500 Ron Pinkas <ron/at/xharbour.com>
   * include/hbapi.h
     + Added Harbour compatible hb_gcFunc() and hb_parptrGC()
   * include/hbapiitm.h
   * source/vm/itemapi.c
     + Added Harbour compatible hb_itemGetPtrGC()
   * source/vm/garbage.c
     + Added Harbour compatible hb_gcFunc()
     * Minor simplifications
   * source/pp/ppgen.c
   * source/pp/pplib.c
   * source/pp/pplib2.c
     * Synched with Harbour
--------------------------------------

David Macias


In file included from ../../ppgen.c:55:
../../ppcore.c: In function `hb_pp_setCompilerSwitch':
../../ppcore.c:2031: warning: array subscript has type `char'
../../ppcore.c:2035: warning: array subscript has type `char'
../../ppcore.c:2036: warning: array subscript has type `char'
../../ppcore.c: In function `hb_pp_pragmaPop':
../../ppcore.c:2055: warning: array subscript has type `char'
../../ppcore.c:2059: warning: array subscript has type `char'
../../ppcore.c:2060: warning: array subscript has type `char'
../../ppcore.c: In function `hb_pp_setCompilerSwitch':
../../ppcore.c:2031: warning: array subscript has type `char'
../../ppcore.c:2035: warning: array subscript has type `char'
../../ppcore.c:2036: warning: array subscript has type `char'
../../ppcore.c: In function `hb_pp_pragmaPop':
../../ppcore.c:2055: warning: array subscript has type `char'
../../ppcore.c:2059: warning: array subscript has type `char'
../../ppcore.c:2060: warning: array subscript has type `char'
../../gtgraph.c: In function `HB_FUN_GTRGB':
../../gtgraph.c:110: warning: left shift count >= width of type
../../gtgraph.c:137: warning: left shift count >= width of type
../../gtgraph.c:141: warning: left shift count >= width of type
../../gtos2.c: In function `hb_gt_Init':
../../gtos2.c:240: warning: dereferencing type-punned pointer will break 
strict-
aliasing rules
../../gtos2.c:247: warning: dereferencing type-punned pointer will break 
strict-
aliasing rules
../../files.c: In function `HB_FUN_SETFDATI':
../../files.c:894: warning: unused variable `szFile'
From druzus at priv.onet.pl  Sat Apr 21 12:00:54 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat Apr 21 12:01:30 2007
Subject: [Harbour] BUG: Compiler unreleased blocks under Linux
In-Reply-To: <A55087C3-D841-44DE-8AE8-6A13734EC42D@syenar.hu>
References: <A55087C3-D841-44DE-8AE8-6A13734EC42D@syenar.hu>
Message-ID: <20070421160054.GA3632@localhost.localdomain>

On Sat, 21 Apr 2007, Szak?ts Viktor wrote:
> Under Ubuntu 7.04 Server, GCC 4.1.2 (everything freshly installed)
> with current Harbour CVS.
> After I've accidentally run this command:
> harbour test.prg /n
[...]

thanks for the info. Fixed. Stupid typo - I moved one cleanup function
call to wrong place. Problems appeared always when more then one file
was compiled.

best regards,
Przemek
From druzus at priv.onet.pl  Sat Apr 21 12:25:03 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat Apr 21 12:25:39 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <FAA83260-EF2C-48AE-89C9-82412003B714@syenar.hu>
References: <FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<4628CB23.3070402@dbtopas.lt>
	<5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>
	<20070420211426.GB21908@localhost.localdomain>
	<0242F1DB-DE12-40F8-9049-B258E7F0AA6F@syenar.hu>
	<20070421090906.GA22739@localhost.localdomain>
	<FAA83260-EF2C-48AE-89C9-82412003B714@syenar.hu>
Message-ID: <20070421162503.GB3632@localhost.localdomain>

On Sat, 21 Apr 2007, Szak?ts Viktor wrote:
[...]
> These look like reasonable changes.
[...]
> I agree with both additions.

Fine. If possible I'd like to hear also other opinions.

> I'd still like better to have a "full language" (without
> the PP bits) macro compiler (like you described in the first
> part of your mail) and have the current codeblock
> system extended with such capabilities. This would fit better
> with the natural expectations of programmers and the language
> syntax as well. (the only downside I can now think of would be
> that usage of this extension would be hard to visually detect
> in actual code before porting the code off-Harbour. But this
> could be solved with a -k? switch.).

OK but this needs some more time consuming modifications and I do not
know when I'll be able to make them. Anyhow I think that currently
described syntax I'll be able to keep in the future without any
modifications. In the worst case we can add some PP rules for backward
compatibility but I do not think it will be necessary.

> Regarding this syntax, I personally and technically have no
> problems with it, and it can even live in parallel with the full
> codeblock support, but it would be good to see some real
> world examples and opinions from prospective users to see
> its usefulness before including it.

I have some fixes in my CVS too and I would like to know what
I should do. I will wait a day for opinions/decisions and I'll
remove extended/full block support or I'll commit it with the
rest of modifications.

> Overall I think there are more important fields in Harbour
> to enhance at this moment: unicode, MT, TBrowse/TGet fixes.

UNICODE is wide subject which has to be added step by step in different
subsystems and we have to check very carefully for interactions with
existing code and data. So far I haven't seen any language which really
play well with Unicode data in all cases so it's not trivial problem
(forget about some MS advertisement about Unicode ready products - they
have absolutely no idea about real problems but you do not come from
West Europe or America so I think you know what I'm talking about ;-))
BTW My personal opinion is that this part of project should be managed
by someone who comes from really exotic country which also uses extensively
multibyte codepages - not by me or anyone who comes from Europe or Europe
cores countries.

If nothing unexpected happens MT will be ready in this year. About 70%
of works have been already done in last year.

I'm sorry but I cannot help in TBrowse/TGet fixes - I've never used them
in Clipper.

best regards,
Przemek
From harbour.01 at syenar.hu  Sat Apr 21 14:03:46 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 21 14:03:57 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070421162503.GB3632@localhost.localdomain>
References: <FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<4628CB23.3070402@dbtopas.lt>
	<5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>
	<20070420211426.GB21908@localhost.localdomain>
	<0242F1DB-DE12-40F8-9049-B258E7F0AA6F@syenar.hu>
	<20070421090906.GA22739@localhost.localdomain>
	<FAA83260-EF2C-48AE-89C9-82412003B714@syenar.hu>
	<20070421162503.GB3632@localhost.localdomain>
Message-ID: <14E5A8ED-9197-44B6-958C-30D6C363110B@syenar.hu>

> OK but this needs some more time consuming modifications and I do not
> know when I'll be able to make them. Anyhow I think that currently
> described syntax I'll be able to keep in the future without any
> modifications. In the worst case we can add some PP rules for backward
> compatibility but I do not think it will be necessary.

okey.

> UNICODE is wide subject which has to be added step by step in  
> different
> subsystems and we have to check very carefully for interactions with
> existing code and data. So far I haven't seen any language which  
> really
> play well with Unicode data in all cases so it's not trivial problem
> (forget about some MS advertisement about Unicode ready products -  
> they
> have absolutely no idea about real problems but you do not come from
> West Europe or America so I think you know what I'm talking about ;-))
> BTW My personal opinion is that this part of project should be managed
> by someone who comes from really exotic country which also uses  
> extensively
> multibyte codepages - not by me or anyone who comes from Europe or  
> Europe
> cores countries.

Well, yes it's very wide, after all "unicode support" can mean a  
thousand
things. In an ideal compiler of an ideal world I'd like to see a  
compiler to
support "Unicode" source files with Unicode strings in it, conversion  
routines
for the outside world, and full support to display those chars. I  
prefer UTF8,
but I'm sure everyone has his/her opinions on that, along with the  
upsides/
downsides. Problem gets more interesting when dealing with a mixture
of unicode and non-unicode sources / objects and libs.... and databases
(which is just one part of the outside world albeit a pretty  
important one,
just like the screen). And of course there is the varying degree and  
chaotic
(or missing) OS support for it.

All in all I'd die to forget the word "codepage".

> If nothing unexpected happens MT will be ready in this year. About 70%
> of works have been already done in last year.

Very good news.

> I'm sorry but I cannot help in TBrowse/TGet fixes - I've never used  
> them
> in Clipper.

I'll try to help in these at least to the extend I'll need it and  
I'll have time
to go further than that. TGet() should now work smoothly as for it's  
core
functions, the editing incompatibilities are not fatal, it's quite  
usable, with
just a few important quirks to fix. As for the TBrowse() it has some  
more severe
problems, but the worst of all is missing cache support, which I'll  
have no other
choice but implementing. Today I went into compiling the xhb version,
which has it already, but it had quite many other problems, some  
fixed in
Harbour, but most are very new crashes all over the place (tested  
with my
large app using an equally complicated app framework layer above it
which works with Harbour not prefectly but at least with only one known
crash in a specific place.)

My impression is that not too many are using these classes these days,
but I still do (and Lorenzo) :) If anyone else is using them pls  
speak up.

Brgds,
Viktor

From i at kevincarmody.com  Sat Apr 21 18:16:10 2007
From: i at kevincarmody.com (Kevin Carmody)
Date: Sat Apr 21 18:14:46 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <14E5A8ED-9197-44B6-958C-30D6C363110B@syenar.hu>
References: <FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>	<20070420111236.GB5926@localhost.localdomain>	<4628AAAD.5020502@dbtopas.lt>	<20070420125226.GA9425@localhost.localdomain>	<4628CB23.3070402@dbtopas.lt>	<5EE25B2D-98AA-42CC-A2DA-8C4B3A60E9CD@syenar.hu>	<20070420211426.GB21908@localhost.localdomain>	<0242F1DB-DE12-40F8-9049-B258E7F0AA6F@syenar.hu>	<20070421090906.GA22739@localhost.localdomain>	<FAA83260-EF2C-48AE-89C9-82412003B714@syenar.hu>	<20070421162503.GB3632@localhost.localdomain>
	<14E5A8ED-9197-44B6-958C-30D6C363110B@syenar.hu>
Message-ID: <462A8D2A.1070308@kevincarmody.com>

Szak?ts Viktor wrote:
>> UNICODE is wide subject which has to be added step by step in different
>> subsystems and we have to check very carefully for interactions with
>> existing code and data. So far I haven't seen any language which really
>> play well with Unicode data in all cases so it's not trivial problem
>> (forget about some MS advertisement about Unicode ready products - they
>> have absolutely no idea about real problems but you do not come from
>> West Europe or America so I think you know what I'm talking about ;-))
I'm glad to see this mentioned.  I'm an American that has studied 
Sanskrit.  For the past several months I've been working on a Harbour 
system that converts between many of the encodings for Devanagari, the 
alphabet of Sanskrit, Hindi, and several other Indian languages.  I've 
learned a fair amount about Unicode.  My Harbour program supports some 
Unicode, but having some built-in Unicode support would make it easier.

> Well, yes it's very wide, after all "unicode support" can mean a thousand
> things. In an ideal compiler of an ideal world I'd like to see a 
> compiler to
> support "Unicode" source files with Unicode strings in it, conversion 
> routines
> for the outside world, and full support to display those chars. I 
> prefer UTF8,
> but I'm sure everyone has his/her opinions on that, along with the 
> upsides/
> downsides. 
I would like to see:

1. Harbour string functions that support Harbour Unicode strings.

2. Harbour support for UTF-8, UTF-16LE, UTF-16BE, and possibly UTF-7 
file formats, which could be read to and written from a Harbour Unicode 
string. 

3. File functions that detect and write the byte order mark automatically.

> All in all I'd die to forget the word "codepage".
 From what I hear, they are rapidly going away, so perhaps you can do 
just that -- forget them, I mean, not die! :)

Thanks for your consideration.

Kevin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070421/01c7a189/attachment.html
From jorgeagiraldo at hotmail.com  Sun Apr 22 12:35:41 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Sun Apr 22 12:36:16 2007
Subject: [Harbour] About some xHarbour extensions
Message-ID: <BAY136-F137566C5BC2AFB9DFA5D58A1540@phx.gbl>

Przemek,

>
>I have some fixes in my CVS too and I would like to know what
>I should do. I will wait a day for opinions/decisions and I'll
>remove extended/full block support or I'll commit it with the
>rest of modifications.

Right now I'm using macros from Delphi for calling any harbour functions 
inside a DLL without having to create wrappers for each of them.

So my work relies heavily on macros, I have a Callback function, so Harbour 
can talk to Delphi, as if it was part of Delphi.  This way, most of my 
bussiness code if not all is inside this DLL.   The databases are shared 
using the ADS Tdataset, so it doesn't matter where I access them from (I 
mean, from Harbour or Delphi).

I can use the Harbour debugger.  When my program crashes it's easy to 
identify the exact point where it failed.

Thanks to this method I have come with solutions in a time that would be 
very difficult to achieve in any other way.

I like the idea of using extended codeblocks, because I can begin to use 
Harbour code inside Delphi's IDE, so it is one step near the target.  If I 
could know the line where the execution is taking place, or open another 
window to trace errors, like I do right know, it would be very nice, and as 
you said I would expect the handling of LOCAL, STATIC and any type of vars 
as if it was a normal Harbour program, there should be a line inside the 
codeblock, so when I see an error it shows the place it happened.

This way I could use only one editor for both sources, there should be a 
method to compile all codeblocks before it goes to the end user.   On the 
other hand, when I have a request from a user, I make a small program in 
plain Clipper (I plan to use HbRun for this), later, when the program fills 
the basics needs I put it on my DLL, and integrate it to the environment.  
So I have small proggys being tested all the time.

I attach a zipped file where you can see how Self Contained Harbour DLLs 
work, in the case it serves to someone else, this will be in the 
Contrib\Delphi\hbdll in the moment I can overcome some CVS inconvenients.  
For now, you can erase all the hbdll content an put this in there for your 
testing purposes.  There is a Readme.1st.

Regards,

Jorge A.

_________________________________________________________________
MSN Amor: busca tu ? naranja http://latam.msn.com/amor/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 70419.ZIP
Type: application/x-zip-compressed
Size: 14362 bytes
Desc: not available
Url : http://lists.harbour-project.org/pipermail/harbour/attachments/20070422/61e6171a/70419.bin
From bhays at abacuslaw.com  Sun Apr 22 14:14:11 2007
From: bhays at abacuslaw.com (bhays)
Date: Sun Apr 22 14:12:43 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <BAY136-F137566C5BC2AFB9DFA5D58A1540@phx.gbl>
Message-ID: <012b01c7850a$0737e7e0$0301a8c0@bh>

Jorge:

I had the impression a while back that the Delphi call to
harbour could not pass parameters to your dll.
Is that correct, or did you get that worked out,
especially perhaps with parameters by reference?

--
  Brian Hays




> -----Original Message-----
> From: harbour-bounces@harbour-project.org
> [mailto:harbour-bounces@harbour-project.org] On Behalf Of
> Jorge A. Giraldo
> Sent: Sunday, April 22, 2007 9:36 AM
> To: harbour@harbour-project.org
> Subject: Re: [Harbour] About some xHarbour extensions
>
> Przemek,
>
> >
> >I have some fixes in my CVS too and I would like to know
> what I should
> >do. I will wait a day for opinions/decisions and I'll remove
> >extended/full block support or I'll commit it with the rest of
> >modifications.
>
> Right now I'm using macros from Delphi for calling any
> harbour functions inside a DLL without having to create
> wrappers for each of them.
>
> So my work relies heavily on macros, I have a Callback
> function, so Harbour can talk to Delphi, as if it was part of
> Delphi.  This way, most of my
> bussiness code if not all is inside this DLL.   The databases
> are shared
> using the ADS Tdataset, so it doesn't matter where I access
> them from (I mean, from Harbour or Delphi).
>
> I can use the Harbour debugger.  When my program crashes it's
> easy to identify the exact point where it failed.
>
> Thanks to this method I have come with solutions in a time
> that would be very difficult to achieve in any other way.
>
> I like the idea of using extended codeblocks, because I can
> begin to use Harbour code inside Delphi's IDE, so it is one
> step near the target.  If I could know the line where the
> execution is taking place, or open another window to trace
> errors, like I do right know, it would be very nice, and as
> you said I would expect the handling of LOCAL, STATIC and any
> type of vars as if it was a normal Harbour program, there
> should be a line inside the codeblock, so when I see an error
> it shows the place it happened.
>
> This way I could use only one editor for both sources, there
> should be a
> method to compile all codeblocks before it goes to the end
> user.   On the
> other hand, when I have a request from a user, I make a small
> program in plain Clipper (I plan to use HbRun for this),
> later, when the program fills the basics needs I put it on my
> DLL, and integrate it to the environment.
> So I have small proggys being tested all the time.
>
> I attach a zipped file where you can see how Self Contained
> Harbour DLLs work, in the case it serves to someone else,
> this will be in the Contrib\Delphi\hbdll in the moment I can
> overcome some CVS inconvenients.
> For now, you can erase all the hbdll content an put this in
> there for your testing purposes.  There is a Readme.1st.
>
> Regards,
>
> Jorge A.
>
> _________________________________________________________________
> MSN Amor: busca tu  naranja http://latam.msn.com/amor/
>


From bhays at abacuslaw.com  Sun Apr 22 14:26:44 2007
From: bhays at abacuslaw.com (bhays)
Date: Sun Apr 22 14:25:16 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <012b01c7850a$0737e7e0$0301a8c0@bh>
Message-ID: <013101c7850b$c78057c0$0301a8c0@bh>


Jorge:

OK, I see now that you're building the .prg function call with
parameters into a string that gets passed to your dll, and
the macro expansion does the rest.

Very nice!

--
  Brian Hays



> -----Original Message-----
> From: harbour-bounces@harbour-project.org
> [mailto:harbour-bounces@harbour-project.org] On Behalf Of bhays
> Sent: Sunday, April 22, 2007 11:14 AM
> To: 'Harbour Project Main Developer List.'
> Subject: RE: [Harbour] About some xHarbour extensions
>
> Jorge:
>
> I had the impression a while back that the Delphi call to
> harbour could not pass parameters to your dll.
> Is that correct, or did you get that worked out, especially
> perhaps with parameters by reference?
>
> --
>   Brian Hays
>
>
>
>
> > -----Original Message-----
> > From: harbour-bounces@harbour-project.org
> > [mailto:harbour-bounces@harbour-project.org] On Behalf Of Jorge A.
> > Giraldo
> > Sent: Sunday, April 22, 2007 9:36 AM
> > To: harbour@harbour-project.org
> > Subject: Re: [Harbour] About some xHarbour extensions
> >
> > Przemek,
> >
> > >
> > >I have some fixes in my CVS too and I would like to know
> > what I should
> > >do. I will wait a day for opinions/decisions and I'll remove
> > >extended/full block support or I'll commit it with the rest of
> > >modifications.
> >
> > Right now I'm using macros from Delphi for calling any harbour
> > functions inside a DLL without having to create wrappers
> for each of
> > them.
> >
> > So my work relies heavily on macros, I have a Callback function, so
> > Harbour can talk to Delphi, as if it was part of Delphi.  This way,
> > most of my
> > bussiness code if not all is inside this DLL.   The databases
> > are shared
> > using the ADS Tdataset, so it doesn't matter where I access
> them from
> > (I mean, from Harbour or Delphi).
> >
> > I can use the Harbour debugger.  When my program crashes
> it's easy to
> > identify the exact point where it failed.
> >
> > Thanks to this method I have come with solutions in a time
> that would
> > be very difficult to achieve in any other way.
> >
> > I like the idea of using extended codeblocks, because I can
> begin to
> > use Harbour code inside Delphi's IDE, so it is one step near the
> > target.  If I could know the line where the execution is
> taking place,
> > or open another window to trace errors, like I do right
> know, it would
> > be very nice, and as you said I would expect the handling of LOCAL,
> > STATIC and any type of vars as if it was a normal Harbour program,
> > there should be a line inside the codeblock, so when I see
> an error it
> > shows the place it happened.
> >
> > This way I could use only one editor for both sources,
> there should be
> > a method to compile all codeblocks before it goes to the end
> > user.   On the
> > other hand, when I have a request from a user, I make a
> small program
> > in plain Clipper (I plan to use HbRun for this), later, when the
> > program fills the basics needs I put it on my DLL, and
> integrate it to
> > the environment.
> > So I have small proggys being tested all the time.
> >
> > I attach a zipped file where you can see how Self Contained Harbour
> > DLLs work, in the case it serves to someone else, this will
> be in the
> > Contrib\Delphi\hbdll in the moment I can overcome some CVS
> > inconvenients.
> > For now, you can erase all the hbdll content an put this in
> there for
> > your testing purposes.  There is a Readme.1st.
> >
> > Regards,
> >
> > Jorge A.
> >
> > _________________________________________________________________
> > MSN Amor: busca tu  naranja http://latam.msn.com/amor/
> >
>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
>


From jorgeagiraldo at hotmail.com  Sun Apr 22 15:36:18 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Sun Apr 22 15:36:56 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <013101c7850b$c78057c0$0301a8c0@bh>
Message-ID: <BAY136-F1466E446182B928412A803A1540@phx.gbl>

Hi Brian,

>
>Jorge:
>
>OK, I see now that you're building the .prg function call with
>parameters into a string that gets passed to your dll, and
>the macro expansion does the rest.
>
>Very nice!
>
>--
>   Brian Hays

You got it.  Inside the string you can have things like:


showmessage( h( ' CtoD(" '+sDate+' "), .t., 235)  ') ) for the function:

FUNCTION ProcessReportX( dDate, lHeading, nWide )

..............
..............

RETURN 'Done'


Normally I left Harbour to handle the environment variables, I define them 
like Public so they last during the program life, to access them I do:

h(' cCompanyName := '+sCompanyName)

To pass the combobox result where I choose the value.

and

showmessage( h(' cCompanyName ') )

whenever I need the result.

Jorge A.

_________________________________________________________________
Charla con tus amigos en l?nea mediante MSN Messenger: 
http://messenger.latam.msn.com/

From harbour at rglab.pl  Sun Apr 22 17:51:59 2007
From: harbour at rglab.pl (=?iso-8859-2?Q?Ryszard_G=B3=B1b?=)
Date: Sun Apr 22 17:52:32 2007
Subject: [Harbour] About some xHarbour extensions
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<362ABB42-5AC0-4D51-A807-568EF5F23FA9@syenar.hu>
Message-ID: <5a32e2791efe14ff0f1aa1c2b77051d7.qmail@home.pl>

Szak?ts Viktor <harbour.01@syenar.hu> napisa?(a):

>> BTW. What about extended codeblocks? I've just added them to mu  
>> local CVS
>>      and I can commit so you can test it. It's not exactly the same  
>> as in
>>      xHarbour but most of people should not find the difference.
> 
> I vote against it this time.
> 
> It's a drastic syntax extension to the language, and I'm not convinced
> of it's future-proofness and about the real usefulness or necessity  
> of it.
> I also don't like the name "extended codeblocks", but it indeed implies
> what it is and that's not very much in my opinion.
> 
> I'd rather like a more complete implementation of the "unnamed  
> functions",
> "inline functions" and "nested functions" at the same time. Now that  
> would
> move Harbour higher in terms of language quality.

  
I agree with Victor here. IMHO, extended codeblock will be fully usable
(and their intoduction will make sense) if it will be an 'inlined 
function'. This means that it should support  local and static variables.
  
Internally such 'extended codeblock' can be implemented as separate 
function with hidden name (simmilar to HB_INLINE) and variable should 
store the reference (symbol) to such function.

Regards, Ryszard

From jorgeagiraldo at hotmail.com  Sun Apr 22 18:51:48 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Sun Apr 22 18:52:26 2007
Subject: [Harbour] Error BASE/1003 Variable does not exist: RPTENUM
Message-ID: <BAY136-F30F45C74EFC4F035604F29A1540@phx.gbl>

Hi,

Advancing in compiling and running my programs with the new beta2 I get new 
nice warnings, for example when a database has no records and trying to 
assign a value to a field I get this error.  I can not reproduce it in a 
small test, I should be missing something.  Any way if this is the idea 
wouldn't be it better a message like "No records in database" or something 
like that?.

I'm using ADS LOCAL.

Jorge A.

_________________________________________________________________
Consigue aqu? las mejores y mas recientes ofertas de trabajo en Am?rica 
Latina y USA: http://latam.msn.com/empleos/

From jorgeagiraldo at hotmail.com  Sun Apr 22 21:41:35 2007
From: jorgeagiraldo at hotmail.com (Jorge A. Giraldo)
Date: Sun Apr 22 21:42:14 2007
Subject: [Harbour] Debugger Issues
Message-ID: <BAY136-F2494508770BBED0C165E5EA14B0@phx.gbl>

Hi,

- In a GUI app after pressing Alt-D the debugger stops after executing 10 or 
12 lines of code.
- If I go to File Open to try to open a prg file to put a breakpoint:

TDebugger:Listbox(1634)
TDebugger:Open(1839)
(b)__DbgBuildMenu(71)

- Padding to the right when the text doesn't fit in the windows gives 
unexpected results.

Jorge A.

_________________________________________________________________
MSN Amor: busca tu ? naranja http://latam.msn.com/amor/

From druzus at priv.onet.pl  Mon Apr 23 08:09:35 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 23 08:10:12 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <5a32e2791efe14ff0f1aa1c2b77051d7.qmail@home.pl>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<4628AAAD.5020502@dbtopas.lt>
	<20070420125226.GA9425@localhost.localdomain>
	<362ABB42-5AC0-4D51-A807-568EF5F23FA9@syenar.hu>
	<5a32e2791efe14ff0f1aa1c2b77051d7.qmail@home.pl>
Message-ID: <20070423120935.GA29842@localhost.localdomain>

On Sun, 22 Apr 2007, Ryszard G??b wrote:
> I agree with Victor here. IMHO, extended codeblock will be fully usable
> (and their intoduction will make sense) if it will be an 'inlined 
> function'. This means that it should support  local and static variables.

Yes. Finally it should be extended to support LOCALs and STATICs
declarations.

> Internally such 'extended codeblock' can be implemented as separate 
> function with hidden name (simmilar to HB_INLINE) and variable should 
> store the reference (symbol) to such function.

The idea is very fine and it's very easy to implement but it will give
differ results then codeblocks. Such unnamed functions cannot share
in natural way local variables with function where they are defined.
If we want to keep codeblock compatible behavior then we have to detach
locals each time such function is initialized and free them when they
are not longer accessible so using normal SYMBOL item is not good enough
holder for them. In general unnamed functions are not the exact replacement.
We will need sth like nested functions with internal implementation more
similar to codeblocks.

Now I can commit support for:

     [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
        <statement1>
        ...
        <statementN>
        return <val>
     END[CODE]

IMHO such sytnax for user should be similar to FUNCTION/PROCEDURE
definition in code like:


   FUNCTION forBlock( cbEval, cargo, init )
   LOCAL i, cbFor

      CODEBLOCK cbFor WITH nFrom, nTo, nStep
         cargo := init
         FOR i := nFrom TO nTo STEP nStep
            EVAL( cbEval, i, @cargo )
         NEXT
         RETURN cargo
      ENDBLOCK

   RETURN cbFor


and in the future we can also add:

   BEGIN FUNCTION funcVar WITH ...
      ...
   ENDFUNC

In current version I simply blocked all declarations but I can add them
in some spare time - maybe even in this week.

best regards,
Przemek
From dbtopas at dbtopas.lt  Mon Apr 23 11:26:24 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Mon Apr 23 11:23:58 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070420111236.GB5926@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>	<20070418140112.GA16238@localhost.localdomain>	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
Message-ID: <462CD020.2040208@dbtopas.lt>

Przemyslaw Czerpak wrote:
>>Correct me if I'm wrong but there could be built a hash class on the  
>>> top of the hash functions with similar functionality (maybe not similar
>>> syntax  though) and with no low-level support from Harbour.
> 
> I guess you are talking about scalar classes. Harbour does not support
> them yet but it will when I'll find a while and yes such interface will
> interact with defined by user hash class messages.

What "scalar classes" are? I cannot find meaning of this in google or 
wikipedia.

> and finally I wanted to compile;
> 
>    ? < |...|
>       ? ...
>       return 123
>    >:eval(1,2,3)
> 
> and I was surprised that it cannot be compiled. If I was confused
> then for sure other users will be too. So I think that we have to
> use sth differ then <||...> or {||...} to clearly show that such
> definition is a statement not an expression.

It seems I'm confused too :) "Cannot be compiled" means "current 
implementation cannot compile", or are some pricipal expression/sentence 
differences which block to make such blocks compilable?


> So IMHO we should think about sth like:
>    BEGIN BLOCK <cbVar> [WITH <params,...>]
>       ...
>    END[BLOCK]

I see cbVar here, and I understand that extended codeblock could be 
assigned to variable, but cannot be used as parameter, etc.
Can I write
    ASORT(aI,,, BEGIN BLOCK WITH X, Y
                   ...
                ENDBLOCK  )
?


> I have some fixes in my CVS too and I would like to know what
> I should do. I will wait a day for opinions/decisions and I'll
> remove extended/full block support or I'll commit it with the
> rest of modifications.

Hmmm?... I must understand better + and -.


>      [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
>         <statement1>
>         ...
>         <statementN>
>         return <val>
>      END[CODE]

I don't use dBase style commmand syntax, so (<params,...>) would be more 
acceptable than WITH <params,...>

BEGIN seems to be redundant, and I see later you use "ENDBLOCK" (but not
ENDCODE). Both are OK, only this:
    CODE cbVar
    ENDBLOCK
seems strange.

> and in the future we can also add:
>    BEGIN FUNCTION funcVar WITH ...
>       ...
>    ENDFUNC

In pascal, sub-function can see variables of the main function. From 
this point of view, it is more codeblocks than just nameless functions.
What is idea of sub-functions in Harbour? Should it see variables of 
main function? How can we call sub-function, by name, or using symbol 
type variable (the example above makes me think "funcVar" is SYMBOL type 
LOCAL variable of main function)?

If sub-functions can see variables of main function, and it is nameless, 
i.e. we have only local variable with SYMBOL of this subfunction, I see 
no difference between
      SUBFUNCION funcVar()
      ENDFUNC
and
      CODEBLOCK blockVar()
      ENDBLOCK

OK, there is one: VALTYPE(funcVar) == "S", VALTYPE(blockVar) == "B" :)


Some brainstorming. I was trying to write some code to see how it looks, 
and by chance I've wrote:
    CODEBLOCK bFactorial(X)
       IF X <= 1;  RETURN 1
       ENDIF
       RETURN X * bFactorial(X-1)  // <-- look here, there is no EVAL()
    ENDBLOCK
The difference between CODEBLOCKS and FUNCTIONS are not huge. I also was 
not sure which one is correct:
    SUBFUNC funcName()
    ENDFUNC
    ? funcName()
or
    LOCAL funcVar
    SUBFUNC funcVar()
    ENDFUNC
    ? EVAL(funcVar)
All this made me to do mistake "bFactorial(X-1)", but maybe it's not the 
mistake, but idea :)
    funcVar := @funcName()
    ? funcVar()
    ? {|| 5}()
    ? {|| @funcName()}()()  // :)
OK, I see sideeffect of this in case of automatic memvar declaration, etc.

But the main conlusion I've made after reading weekend's email is: we 
must decide/understand, what we want.


Best regards,
Mindaugas
From druzus at priv.onet.pl  Mon Apr 23 12:26:56 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 23 12:27:32 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
Message-ID: <20070423162656.GA1558@localhost.localdomain>

2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
  * harbour/include/hbcomp.h
  * harbour/include/hbcompdf.h
  * harbour/include/hbexpra.c
  * harbour/include/hbexprb.c
  * harbour/include/hbexprop.h
  * harbour/source/common/expropt1.c
  * harbour/source/compiler/genc.c
  * harbour/source/compiler/harbour.y
  * harbour/source/compiler/hbmain.c
  * harbour/source/compiler/hbopt.c
    ! reverted fix for unnecessary -W2 warning:
         Function '...' does not end with RETURN statement
      in code like:
            func f(v)
            if v
               return "TRUE"
            else
               return "FALSE"
            endif
      Sorry but I had to make it because this fix was wrong and causes
      that code like:
            func f(v)
            if v
               ? v
            else
               return "FALSE"
            endif
      was compiled without any warnings but wrong PCODE was generated.
      In some spare time I'll try to implement valid RETURN detection,
      now simply add RETURN NIL at the end of such functions - it will
      be removed by dead code eliminator.
    ! fixed memory leak when more then one .prg file was given as compiler
      parameter
    + cleaned some code for future modifications

  * harbour/source/macro/macro.y
    + added small hack for two BCC/OW warnings
  * harbour/source/compiler/harbour.yyc
  * harbour/source/compiler/harbour.yyh
  * harbour/source/macro/macro.yyc
  * harbour/source/macro/macro.yyh
    * regenerated with modified Bison version which should give code
      without BCC warnings - I cannot promise I'll keep it in the
      future but I will try.

  * harbour/source/rdd/dbcmd.c
    ! use default RDD instead of current one in COPY TO and APPEND FROM

  * harbour/source/vm/classes.c
    * added support for (@func()):eval(...)

best regards,
Przemek
From e.m.giordano at emagsoftware.it  Mon Apr 23 12:34:13 2007
From: e.m.giordano at emagsoftware.it (Enrico Maria Giordano)
Date: Mon Apr 23 12:34:50 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070423162656.GA1558@localhost.localdomain>
Message-ID: <014601c785c5$3a097ba0$0100a8c0@emag>


-----Messaggio Originale----- 
Da: "Przemyslaw Czerpak" <druzus@priv.onet.pl>
A: "Harbour Project Main Developer List." <harbour@harbour-project.org>
Data invio: lunedi 23 aprile 2007 18.26
Oggetto: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw 
Czerpak(druzus/at/priv.onet.pl)


>  * harbour/source/macro/macro.y
>    + added small hack for two BCC/OW warnings
>  * harbour/source/compiler/harbour.yyc
>  * harbour/source/compiler/harbour.yyh
>  * harbour/source/macro/macro.yyc
>  * harbour/source/macro/macro.yyh
>    * regenerated with modified Bison version which should give code
>      without BCC warnings - I cannot promise I'll keep it in the
>      future but I will try.

Thank you! Now there are only two warnings:

Warning W8080 harboury.c 7077: 'yyerrorlab' is declared but never used in 
function hb_compparse

Warning W8080 macroy.c 3108: 'yyerrorlab' is declared but never used in 
function hb_macroparse

EMG

--
EMAG Software Homepage:     http://www.emagsoftware.it
The EMG's ZX-Spectrum Page: http://www.emagsoftware.it/spectrum
The Best of Spectrum Games: http://www.emagsoftware.it/tbosg
The EMG Music page:         http://www.emagsoftware.it/emgmusic 

From harbour.01 at syenar.hu  Mon Apr 23 12:40:23 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 23 12:40:33 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070423162656.GA1558@localhost.localdomain>
References: <20070423162656.GA1558@localhost.localdomain>
Message-ID: <FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>

Thanks.

How about the dbCreate() / NetErr(.T.) issue? What do you think?

Also see the usrrdd.ch report where we're violating namespace,
do you think it's possible to fix it?

Brdgs,
Viktor

On 2007.04.23., at 18:26, Przemyslaw Czerpak wrote:

> 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
>   * harbour/include/hbcomp.h
>   * harbour/include/hbcompdf.h
>   * harbour/include/hbexpra.c
>   * harbour/include/hbexprb.c
>   * harbour/include/hbexprop.h
>   * harbour/source/common/expropt1.c
>   * harbour/source/compiler/genc.c
>   * harbour/source/compiler/harbour.y
>   * harbour/source/compiler/hbmain.c
>   * harbour/source/compiler/hbopt.c
>     ! reverted fix for unnecessary -W2 warning:
>          Function '...' does not end with RETURN statement
>       in code like:
>             func f(v)
>             if v
>                return "TRUE"
>             else
>                return "FALSE"
>             endif
>       Sorry but I had to make it because this fix was wrong and causes
>       that code like:
>             func f(v)
>             if v
>                ? v
>             else
>                return "FALSE"
>             endif
>       was compiled without any warnings but wrong PCODE was generated.
>       In some spare time I'll try to implement valid RETURN detection,
>       now simply add RETURN NIL at the end of such functions - it will
>       be removed by dead code eliminator.
>     ! fixed memory leak when more then one .prg file was given as  
> compiler
>       parameter
>     + cleaned some code for future modifications
>
>   * harbour/source/macro/macro.y
>     + added small hack for two BCC/OW warnings
>   * harbour/source/compiler/harbour.yyc
>   * harbour/source/compiler/harbour.yyh
>   * harbour/source/macro/macro.yyc
>   * harbour/source/macro/macro.yyh
>     * regenerated with modified Bison version which should give code
>       without BCC warnings - I cannot promise I'll keep it in the
>       future but I will try.
>
>   * harbour/source/rdd/dbcmd.c
>     ! use default RDD instead of current one in COPY TO and APPEND  
> FROM
>
>   * harbour/source/vm/classes.c
>     * added support for (@func()):eval(...)
>
> best regards,
> Przemek
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From druzus at priv.onet.pl  Mon Apr 23 13:03:57 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 23 13:04:32 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <462CD020.2040208@dbtopas.lt>
References: <20070418110016.GA14036@localhost.localdomain>
	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>
	<20070418140112.GA16238@localhost.localdomain>
	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>
	<20070420111236.GB5926@localhost.localdomain>
	<462CD020.2040208@dbtopas.lt>
Message-ID: <20070423170357.GB1558@localhost.localdomain>

On Mon, 23 Apr 2007, Mindaugas Kavaliauskas wrote:
> What "scalar classes" are? I cannot find meaning of this in google or 
> wikipedia.

The term is taken from Class(y) 2.4 documentaion.
In in NG "Scalar Classes"

> >and finally I wanted to compile;
> >   ? < |...|
> >      ? ...
> >      return 123
> >   >:eval(1,2,3)
> It seems I'm confused too :) "Cannot be compiled" means "current 
> implementation cannot compile", or are some pricipal expression/sentence 
> differences which block to make such blocks compilable?

Don't you see the problem?
Then I'll try to help you a little bit. Compile this code using xHarbour
with -p option:
    proc main()
    qout( valtype( < ||
        ? "I'm extended block"
        return NIL
    > ) )
    return

It can be compiled without any problems.
Then nearly the same code but a little bit modified:
    proc main()
    ? valtype( < ||
        ? "I'm extended block"
        return NIL
    > )
    return

This cannot be compiled.
Compare generated .ppo files and you will find why.
This syntax breaks base PP rules so cannot be well recognized by PP.

> >So IMHO we should think about sth like:
> >   BEGIN BLOCK <cbVar> [WITH <params,...>]
> >      ...
> >   END[BLOCK]
> I see cbVar here, and I understand that extended codeblock could be 
> assigned to variable, but cannot be used as parameter, etc.
> Can I write
>    ASORT(aI,,, BEGIN BLOCK WITH X, Y
>                   ...
>                ENDBLOCK  )
> ?

Yes it cannot be compiled and it's intentional. Plese note that
current xHarbour behavior allows to create code which cannot be
preprocessed by PP. F.e. try to compile by xHarbour this code
and check generated .ppo file:

    #xtranslate ASORT( <params,...> ) => MY_ASORT( <params> )
    ASORT( al,,, <|x,y|
                    x > y
                 > )

IMHO sth like that should never be added to grammar. For me it's very
serious mistake.

> >     [BEGIN] CODE[BLOCK] <cbVar> [WITH <params,...>]
> >        <statement1>
> >        ...
> >        <statementN>
> >        return <val>
> >     END[CODE]
> I don't use dBase style commmand syntax, so (<params,...>) would be more 
> acceptable than WITH <params,...>

#command BEGIN CODEBLOCK <!cbvar!> ([<params,...>]) => ;
         BEGIN CODEBLOCK <!cbvar!> [WITH <params>]

but if you like more
    BEGIN CODEBLOCK <cbVar> [([<params,...>])]
then it's also not a problem for me.

> BEGIN seems to be redundant, and I see later you use "ENDBLOCK" (but not
> ENDCODE).

Typo in c&p from some old examples. Should be ENDCODE.

> In pascal, sub-function can see variables of the main function. From 
> this point of view, it is more codeblocks than just nameless functions.
> What is idea of sub-functions in Harbour? Should it see variables of 
> main function? How can we call sub-function, by name, or using symbol 
> type variable (the example above makes me think "funcVar" is SYMBOL type 
> LOCAL variable of main function)?

We will have to chose sth. It's not a trivial problem.
F.e. we can make them like in pascal but in such case
these function will be accessible only from function
where they were defined by name and storing pointer to
them will be forbidden. But we can also define differ
semantic. It's our choice but it will determinate many
other things and implementation.

> Some brainstorming. I was trying to write some code to see how it looks, 
> and by chance I've wrote:
>    CODEBLOCK bFactorial(X)
>       IF X <= 1;  RETURN 1
>       ENDIF
>       RETURN X * bFactorial(X-1)  // <-- look here, there is no EVAL()
>    ENDBLOCK

This should be IMHO SUBFUNCTION

> The difference between CODEBLOCKS and FUNCTIONS are not huge. I also was 
> not sure which one is correct:
>    SUBFUNC funcName()
>    ENDFUNC
>    ? funcName()

This is OK.

> or
>    LOCAL funcVar
>    SUBFUNC funcVar()
>    ENDFUNC
>    ? EVAL(funcVar)

No. For such things IMHO CODEBLOCKs should be used. These will be the
main difference. Reference to CODEBLOCKs can be stored in variable and
accessed from external function because in the creation process local
variables are detached when in SUBFUNCTIONs/SUBPROCEDUREs the aren't
so we cannot allow to access such functions externally by some references.
Of course if we define that local parameters and variables of parent
function are accessible from child one. See above.

> All this made me to do mistake "bFactorial(X-1)", but maybe it's not the 
> mistake, but idea :)
>    funcVar := @funcName()
>    ? funcVar()
>    ? {|| 5}()
>    ? {|| @funcName()}()()  // :)
> OK, I see sideeffect of this in case of automatic memvar declaration, etc.
> But the main conlusion I've made after reading weekend's email is: we 
> must decide/understand, what we want.

Exactly :-)

best regards,
Przemek
From druzus at priv.onet.pl  Mon Apr 23 13:42:10 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Mon Apr 23 13:42:46 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>
References: <20070423162656.GA1558@localhost.localdomain>
	<FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>
Message-ID: <20070423174210.GA9258@localhost.localdomain>

On Mon, 23 Apr 2007, Szak?ts Viktor wrote:
> How about the dbCreate() / NetErr(.T.) issue? What do you think?

We have this in our code for many years and not it's possible that
touching it will break existing users code so probably it will be
safer to leave it as is. I also cannot agree the the code example
you send is good because I remember that some DOS networks set
DOSERROR 32 also when file create failed so also in Clipper
dbCreate() could change NETERR() indirectly by error handler.
It's also problem for us. On some platforms we will have exactly
the same error code too. So pprobably now we should document it
and not touch the code or better implement original Clipper behavior
cover by HB_C52_STRICT macro.

> Also see the usrrdd.ch report where we're violating namespace,
> do you think it's possible to fix it?

Yes it is but it's internal RDD header file for people who want
to write new RDDs. In practice whole RDD code uses names without
HB_ prefix inherited from Clipper. I do not think it's good when
one file uses HB_ prefix and rest not and I'm think that 3-rd party
RDD developers won't like when we touch RDD core definitions now.
Anyhow usrrdd.ch is quite new so if we change only this file then
there is a chance that not too much of code will be effected.
Though you will have to answer why .prg code has to use HB_FAILURE
and HB_SUCCESS when C code uses FAILURE and SUCCESS ;-)

best regards,
Przemek
From harbour.01 at syenar.hu  Mon Apr 23 14:42:16 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 23 14:42:26 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070423174210.GA9258@localhost.localdomain>
References: <20070423162656.GA1558@localhost.localdomain>
	<FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>
	<20070423174210.GA9258@localhost.localdomain>
Message-ID: <D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu>

> We have this in our code for many years and not it's possible that
> touching it will break existing users code so probably it will be
> safer to leave it as is. I also cannot agree the the code example

There is more legacy Clipper code in the wild than there is freshly
developed Harbour code, so this doesn't look like a good reaon to
me. Harbour is in Beta stage and that means such errors are expected
and can get fixed (however old they are).

> you send is good because I remember that some DOS networks set
> DOSERROR 32 also when file create failed so also in Clipper
> dbCreate() could change NETERR() indirectly by error handler.
> It's also problem for us. On some platforms we will have exactly
> the same error code too. So pprobably now we should document it
> and not touch the code or better implement original Clipper behavior
> cover by HB_C52_STRICT macro.

My impression is that the original developers did choose the
original behaviour for a reason, simply because it would be to
huge of an omission by mistake, it's also quite clearly documented.

To make it easier for developers to detect dbCreate() errors
though, and to have less side-effect at the same time, we should
rather consider returning a logical value from this function. There
is probably no code out there that would rely on the fact that  
dbCreate()
always returns NIL, so it seems safe to extend this way. FlagShip
already does that, while XBase++ still return NIL. So I think it's
even safer to go with a logical retval.

At the same time all docs (FS, XPP, C5x) explicitly states that
NetErr() is only influenced by USE/APPEND BLANK.

With a local error handler it's pretty easy to catch dbCreate()
errors in Clipper, regardless of the DOSError() code it generates.
That's how most robust apps are doing it probably, as there is
not other way to get any details any other way.

>> Also see the usrrdd.ch report where we're violating namespace,
>> do you think it's possible to fix it?
>
> Yes it is but it's internal RDD header file for people who want
> to write new RDDs. In practice whole RDD code uses names without
> HB_ prefix inherited from Clipper. I do not think it's good when
> one file uses HB_ prefix and rest not and I'm think that 3-rd party
> RDD developers won't like when we touch RDD core definitions now.
> Anyhow usrrdd.ch is quite new so if we change only this file then
> there is a chance that not too much of code will be effected.
> Though you will have to answer why .prg code has to use HB_FAILURE
> and HB_SUCCESS when C code uses FAILURE and SUCCESS ;-)

I see no reason why C should use FAILURE / SUCCESS because
these were not originally used in C5x headers. So the answer is
that we'd need to fix the C headers too if we want to take it  
seriously :)
But it probably won't affect many normal users.

In any case the .ch name needs to be fixed IMO.
(that's the only one violating, as far as I could see)

Brgds,
Viktor

From lorenzo.fiorini at gmail.com  Mon Apr 23 17:16:19 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Mon Apr 23 17:16:24 2007
Subject: [Harbour] Help porting SET EOL <x>
Message-ID: <9257026e0704231416k5540988ch6a43e0f5616d0e3@mail.gmail.com>

I've added support of SET EOL <x> to set.c, set.h, set.ch, std.ch and
I've ported txtline.c from xHarbour but after "fixed" the api calls it
doesn't work as expected.

If there is a C expert interested in it I can share the modified files.

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Mon Apr 23 17:41:46 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Mon Apr 23 17:41:52 2007
Subject: [Harbour] CHANGELOG: 2007-04-23 23:28 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c785f0$Blat.v2.6.1$312d7e3e$f81e987ed2@127.0.0.1>

2007-04-23 23:28 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/diskspac.c
     ! Fixed to return free space instead of disk size under Unix OSes.

   * harbour/source/rtl/tget.prg
     ! Fixed checking for invalid GET var types.
     ! More C5x compatible behaviour for invalid types.
     ! ::UnTransform() fixed when not in focus.
     - ::UnTransform() cBuffer incompatible parameter removed.
     ! ::Reform() probably made more compatible.
     + ::PosInBuffer() XBase++ compatible method implemented.
       (but not tested or compared with XBase++)
     ! ::Minus assignment fixed.
     ! ::Clear assignment fixed.
     ! ::Changed assignment fixed.
     ! ::Buffer assignment fixed.
     ! ::Block assignment fixed.
     ! ::Name assignment fixed.
     ! ::UnTransform() extra parameter removed.
     ! ::UpdateBuffer() minor fix when not in focus.
     ! ::Reform() made more compatible.
     % ::SetFocus() some superfluous stuff removed.
     % ::SetFocus() some fixes, cleanups.
     ! ::KillFocus() now sets ::TypeOut properly.
     ! ::VarPut(), ::VarGet() fixed for invalid ::Subscript contents.
     ! ::VarPut(), ::VarGet() fixed for invalid ::Block content.
     ! ::Pos rewritten to be fully compatible.
     ! ::ColorSpec made fully compatible.
     ! ::UnTransform() fixed when not in focus.
     ! ::UnTransform() fixed handling "YL" in string pictures.
     % ::UnTransform() minor optimization.
     % ::PutMask() some hacks removed.
     ! ::PutMask() invalid types handling.
     ! ::BackSpace() fixed when not in focus.
     ! ::Delete() fixed when not in focus.
     ! ::DeleteAll() fixed when not in focus.
     ! ::IsEditable() fixes.
     ! ::Picture fixes for invalid types, assignment behaviour.
     ! ::Picture hacks removed.
     ! Non-assignable vars made READONLY. (will generate 
       different RTEs than in CA-Cl*pper due to the more 
       refined oo engine in Harbour.)
     ! ::BadDate changed to be a METHOD.
     ! ::ToDecPos fixes.
     ! ::Row assigment and behaviour fixes.
     ! ::Col assigment and behaviour fixes.
     + Several comments and NOTEs added.

   * harbour/include/hbapigt.h
   * harbour/source/rtl/gtapi.c
   * harbour/source/rtl/setcolor.c
     + hb_gtColorsToString() public API added.
     + hb_NToColor() function added to convert a single color 
       value (returned by hb_ColorToN()) back to a string.
       Used in TGet():ColorSpec implementation.

   * harbour/source/vm/fm.c
     * "Blocks" -> "Block(s)"

   * harbour/tests/rto_get.prg
     + Added many test cases.

   * harbour/source/vm/cmdarg.c
     + Added support to use "--" instead of "//" for internal 
       command line options.

   * harbour/source/rtl/tbcolumn.prg
     + Formatting.

   * harbour/source/rtl/tbrowse.prg
     + Added Harbour (undocumented) extension NOTE.

   * harbour/include/Makefile
   - harbour/include/usrrdd.ch
   + harbour/include/hbusrrdd.ch
   * harbour/source/rdd/usrrdd/usrrdd.c
   * harbour/source/rdd/usrrdd/rdds/dbtcdx.prg
   * harbour/source/rdd/usrrdd/rdds/fcomma.prg
   * harbour/source/rdd/usrrdd/rdds/fptcdx.prg
   * harbour/source/rdd/usrrdd/rdds/hscdx.prg
   * harbour/source/rdd/usrrdd/rdds/rlcdx.prg
   * harbour/source/rdd/usrrdd/rdds/smtcdx.prg
   * harbour/contrib/pgsql/pgrdd.prg
     ! Changed public header filename to comply with the "hb*.ch" rule.
       (namespace protection)

From antonioharbour at gmail.com  Tue Apr 24 03:18:42 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Tue Apr 24 03:19:09 2007
Subject: [Harbour] User defined indexes
Message-ID: <462daf65.005520fe.5211.ffffa93d@mx.google.com>

Przemek,

Does Harbour DBFCDX support the creation of user defined indexes, where the
user may select which records will be added to the index based on some user
conditions ? Thanks,

Regards,

Antonio

From harbour.01 at syenar.hu  Tue Apr 24 04:38:57 2007
From: harbour.01 at syenar.hu (=?iso-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 24 04:39:04 2007
Subject: [Harbour] CHANGELOG: 2007-04-24 10:38 UTC+0100 Viktor Szakats
	(harbour.01 syenar.hu)
Message-ID: <01c7864b$Blat.v2.6.1$ffd1eb48$fc8be338654@127.0.0.1>

2007-04-24 10:38 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   * harbour/source/rtl/tget.prg
   * harbour/source/rtl/tgetint.prg
   * harbour/tests/rto_get.prg
     * Minor fixes, cleanups, formatting.

From druzus at priv.onet.pl  Tue Apr 24 08:23:30 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 24 08:24:07 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu>
References: <20070423162656.GA1558@localhost.localdomain>
	<FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>
	<20070423174210.GA9258@localhost.localdomain>
	<D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu>
Message-ID: <20070424122330.GA11077@localhost.localdomain>

On Mon, 23 Apr 2007, Szak?ts Viktor wrote:
> There is more legacy Clipper code in the wild than there is freshly
> developed Harbour code, so this doesn't look like a good reaon to
> me. Harbour is in Beta stage and that means such errors are expected
> and can get fixed (however old they are).
> >you send is good because I remember that some DOS networks set
> >DOSERROR 32 also when file create failed so also in Clipper
> >dbCreate() could change NETERR() indirectly by error handler.
> >It's also problem for us. On some platforms we will have exactly
> >the same error code too. So pprobably now we should document it
> >and not touch the code or better implement original Clipper behavior
> >cover by HB_C52_STRICT macro.
> My impression is that the original developers did choose the
> original behaviour for a reason, simply because it would be to
> huge of an omission by mistake, it's also quite clearly documented.

My impression is that NETERR() was added to existing code and there is
not too much of design decisions in it ;-)

> To make it easier for developers to detect dbCreate() errors
> though, and to have less side-effect at the same time, we should
> rather consider returning a logical value from this function. There
> is probably no code out there that would rely on the fact that  
> dbCreate()
> always returns NIL, so it seems safe to extend this way. FlagShip
> already does that, while XBase++ still return NIL. So I think it's
> even safer to go with a logical retval.

changing dbCreate(), dbUseArea() and dbAppend() to return logical value
is IMHO good idea. In Clipper this functions can return any value because
that are working like procedures (I had to hard code some exceptions for
that when I was testing Clipper RDD functions - return values were
unpredictable) so it should not interact with existing code.

> At the same time all docs (FS, XPP, C5x) explicitly states that
> NetErr() is only influenced by USE/APPEND BLANK.

and in Clipper it's not true because dbSetIndex() also resets NETERR()

> With a local error handler it's pretty easy to catch dbCreate()
> errors in Clipper, regardless of the DOSError() code it generates.
> That's how most robust apps are doing it probably, as there is
> not other way to get any details any other way.

for me it is very complicated to make it well. Many different errors can
appear and it's very hard to properly recognize them on different platform.
In practice without some hacks in filesys.c (I've already began to make them
- see some error code translation functions - not perfect but covers about
75% of cases) it's IMHO impossible. F.e. in this case it will be necessary
to pass to translation function some pseudo code of operation.
Anyhow good. I'll remove all NETERR() setting from RDD code and left only
reseting in few places. NETERR() can be set only by error handler so
user will have to create their own error handlers. I'll also add support
for LockErrHandler() so users who has some xHarbour code with TRY/CATCH
emulated by preprocessor rules will have to set error block with support
for some basic exceptions.

> I see no reason why C should use FAILURE / SUCCESS because
> these were not originally used in C5x headers. So the answer is
> that we'd need to fix the C headers too if we want to take it  
> seriously :)
> But it probably won't affect many normal users.

If you want to fight with 3-rd party developers you can change it ;-)
For me it's not a problem. Remember that it means that all SELF_*(),
SUPER_*() and similar macros should also have HB_* prefix. Also FHANDLE
and other types without HB_ prefix should be modified.

> In any case the .ch name needs to be fixed IMO.
> (that's the only one violating, as far as I could see)

I see that you've changed it - thanks.

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr 24 08:30:01 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 24 08:30:37 2007
Subject: [Harbour] User defined indexes
In-Reply-To: <462daf65.005520fe.5211.ffffa93d@mx.google.com>
References: <462daf65.005520fe.5211.ffffa93d@mx.google.com>
Message-ID: <20070424123001.GB11077@localhost.localdomain>

On Tue, 24 Apr 2007, Antonio Linares wrote:
> Przemek,
> Does Harbour DBFCDX support the creation of user defined indexes, where the
> user may select which records will be added to the index based on some user
> conditions ? Thanks,

Yes. BOTH DBFCDX and DBFNTX supports custom indexes with all COMIX/CL53
extensions. See CL53NG for more info.
Additionally DBFNTX supports all SIX extensions like index temperature, etc.
and allows to enable/disable support for multikey indexes (the same index
key/record can be added more then once into a tag) with DBOI_MULTIKEY and
RDDI_MULTIKEY. In DBFCDX MULTIKEY is hard coded to true what is COMIX/CL53
compatible but not compatible with SIX3 RDDs.

best regards,
Przemek
From antonioharbour at gmail.com  Tue Apr 24 08:45:26 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Tue Apr 24 08:45:51 2007
Subject: [Harbour] User defined indexes
In-Reply-To: <20070424123001.GB11077@localhost.localdomain>
Message-ID: <462dfbfa.2595d066.0a6d.fffff2fd@mx.google.com>

Przemek, 

> Yes. BOTH DBFCDX and DBFNTX supports custom indexes with all COMIX/CL53
extensions. See CL53NG for more info.

Thanks, excellent :-)

Regards,

Antonio

From harbour.01 at syenar.hu  Tue Apr 24 09:00:03 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 24 09:00:10 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070424122330.GA11077@localhost.localdomain>
References: <20070423162656.GA1558@localhost.localdomain>
	<FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>
	<20070423174210.GA9258@localhost.localdomain>
	<D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu>
	<20070424122330.GA11077@localhost.localdomain>
Message-ID: <BD64FB05-2D0F-454C-BFF5-FCB11C2FA6A4@syenar.hu>

>> My impression is that the original developers did choose the
>> original behaviour for a reason, simply because it would be to
>> huge of an omission by mistake, it's also quite clearly documented.
>
> My impression is that NETERR() was added to existing code and there is
> not too much of design decisions in it ;-)

Well, can be :) But for this reason, they've just hacked it into
the errorhandler. Actually it's not such a bad idea, because the reasons
you mention; to handle non-portable error codes and conditions, so
they've at least gave the user the possibility to control these. If they
hard coded the logic, it would be a big showstopper when the
app runs on an OS or network system newer than DOS/Win 3.1
and this new OS has some non-compatible set, or a superset of
old error codes. So, yes it can be hard to be prepared for all these
error codes but at least it can be handled on app level.

>> To make it easier for developers to detect dbCreate() errors
>> though, and to have less side-effect at the same time, we should
>> rather consider returning a logical value from this function. There
>> is probably no code out there that would rely on the fact that
>> dbCreate()
>> always returns NIL, so it seems safe to extend this way. FlagShip
>> already does that, while XBase++ still return NIL. So I think it's
>> even safer to go with a logical retval.
>
> changing dbCreate(), dbUseArea() and dbAppend() to return logical  
> value
> is IMHO good idea. In Clipper this functions can return any value  
> because
> that are working like procedures (I had to hard code some  
> exceptions for
> that when I was testing Clipper RDD functions - return values were
> unpredictable) so it should not interact with existing code.

Okey, even better. All of them would be nice to return logical.

>> At the same time all docs (FS, XPP, C5x) explicitly states that
>> NetErr() is only influenced by USE/APPEND BLANK.
>
> and in Clipper it's not true because dbSetIndex() also resets NETERR()

Yes, they seem to have forgotten to add it to the docs, or whatnot :)

>> With a local error handler it's pretty easy to catch dbCreate()
>> errors in Clipper, regardless of the DOSError() code it generates.
>> That's how most robust apps are doing it probably, as there is
>> not other way to get any details any other way.
>
> for me it is very complicated to make it well. Many different  
> errors can
> appear and it's very hard to properly recognize them on different  
> platform.
> In practice without some hacks in filesys.c (I've already began to  
> make them
> - see some error code translation functions - not perfect but  
> covers about
> 75% of cases) it's IMHO impossible. F.e. in this case it will be  
> necessary
> to pass to translation function some pseudo code of operation.
> Anyhow good. I'll remove all NETERR() setting from RDD code and  
> left only
> reseting in few places. NETERR() can be set only by error handler so
> user will have to create their own error handlers. I'll also add  
> support
> for LockErrHandler() so users who has some xHarbour code with TRY/ 
> CATCH
> emulated by preprocessor rules will have to set error block with  
> support
> for some basic exceptions.

Okey, thank you.

>> I see no reason why C should use FAILURE / SUCCESS because
>> these were not originally used in C5x headers. So the answer is
>> that we'd need to fix the C headers too if we want to take it
>> seriously :)
>> But it probably won't affect many normal users.
>
> If you want to fight with 3-rd party developers you can change it ;-)
> For me it's not a problem. Remember that it means that all SELF_*(),
> SUPER_*() and similar macros should also have HB_* prefix. Also  
> FHANDLE
> and other types without HB_ prefix should be modified.

FHANDLE is C5x compatible, so it's okey. As for the rest, I think
we can leave it, since there is probably not too many developers
who are developing RDDs, and those who are can probably figure
to solve those namespace problems, if they happen to have any.

Brgds,
Viktor

From miguelangel at marchuet.net  Tue Apr 24 10:29:27 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue Apr 24 10:29:35 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <BD64FB05-2D0F-454C-BFF5-FCB11C2FA6A4@syenar.hu>
References: <20070423162656.GA1558@localhost.localdomain>	<FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>	<20070423174210.GA9258@localhost.localdomain>	<D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu>	<20070424122330.GA11077@localhost.localdomain>
	<BD64FB05-2D0F-454C-BFF5-FCB11C2FA6A4@syenar.hu>
Message-ID: <462E1447.1040702@marchuet.net>

Why not use GetLastError() to implement this new behavior. And NETERR()
can be used only as old clipper compatibility.

I prefer respect compatibility as possible, for this reason, the use of
GetLastError() as other languages can be good solution.

Best regards,
Miguel Angel Marchuet

Szak?ts Viktor escribi?:
>>> My impression is that the original developers did choose the
>>> original behaviour for a reason, simply because it would be to
>>> huge of an omission by mistake, it's also quite clearly documented.
>>
>> My impression is that NETERR() was added to existing code and there is
>> not too much of design decisions in it ;-)
> 
> Well, can be :) But for this reason, they've just hacked it into
> the errorhandler. Actually it's not such a bad idea, because the reasons
> you mention; to handle non-portable error codes and conditions, so
> they've at least gave the user the possibility to control these. If they
> hard coded the logic, it would be a big showstopper when the
> app runs on an OS or network system newer than DOS/Win 3.1
> and this new OS has some non-compatible set, or a superset of
> old error codes. So, yes it can be hard to be prepared for all these
> error codes but at least it can be handled on app level.
> 
>>> To make it easier for developers to detect dbCreate() errors
>>> though, and to have less side-effect at the same time, we should
>>> rather consider returning a logical value from this function. There
>>> is probably no code out there that would rely on the fact that
>>> dbCreate()
>>> always returns NIL, so it seems safe to extend this way. FlagShip
>>> already does that, while XBase++ still return NIL. So I think it's
>>> even safer to go with a logical retval.
>>
>> changing dbCreate(), dbUseArea() and dbAppend() to return logical value
>> is IMHO good idea. In Clipper this functions can return any value because
>> that are working like procedures (I had to hard code some exceptions for
>> that when I was testing Clipper RDD functions - return values were
>> unpredictable) so it should not interact with existing code.
> 
> Okey, even better. All of them would be nice to return logical.
> 
>>> At the same time all docs (FS, XPP, C5x) explicitly states that
>>> NetErr() is only influenced by USE/APPEND BLANK.
>>
>> and in Clipper it's not true because dbSetIndex() also resets NETERR()
> 
> Yes, they seem to have forgotten to add it to the docs, or whatnot :)
> 
>>> With a local error handler it's pretty easy to catch dbCreate()
>>> errors in Clipper, regardless of the DOSError() code it generates.
>>> That's how most robust apps are doing it probably, as there is
>>> not other way to get any details any other way.
>>
>> for me it is very complicated to make it well. Many different errors can
>> appear and it's very hard to properly recognize them on different
>> platform.
>> In practice without some hacks in filesys.c (I've already began to
>> make them
>> - see some error code translation functions - not perfect but covers
>> about
>> 75% of cases) it's IMHO impossible. F.e. in this case it will be
>> necessary
>> to pass to translation function some pseudo code of operation.
>> Anyhow good. I'll remove all NETERR() setting from RDD code and left only
>> reseting in few places. NETERR() can be set only by error handler so
>> user will have to create their own error handlers. I'll also add support
>> for LockErrHandler() so users who has some xHarbour code with TRY/CATCH
>> emulated by preprocessor rules will have to set error block with support
>> for some basic exceptions.
> 
> Okey, thank you.
> 
>>> I see no reason why C should use FAILURE / SUCCESS because
>>> these were not originally used in C5x headers. So the answer is
>>> that we'd need to fix the C headers too if we want to take it
>>> seriously :)
>>> But it probably won't affect many normal users.
>>
>> If you want to fight with 3-rd party developers you can change it ;-)
>> For me it's not a problem. Remember that it means that all SELF_*(),
>> SUPER_*() and similar macros should also have HB_* prefix. Also FHANDLE
>> and other types without HB_ prefix should be modified.
> 
> FHANDLE is C5x compatible, so it's okey. As for the rest, I think
> we can leave it, since there is probably not too many developers
> who are developing RDDs, and those who are can probably figure
> to solve those namespace problems, if they happen to have any.
> 
> Brgds,
> Viktor
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From harbour.01 at syenar.hu  Tue Apr 24 10:32:27 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 24 10:32:34 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <462E1447.1040702@marchuet.net>
References: <20070423162656.GA1558@localhost.localdomain>	<FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>	<20070423174210.GA9258@localhost.localdomain>	<D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu>	<20070424122330.GA11077@localhost.localdomain>
	<BD64FB05-2D0F-454C-BFF5-FCB11C2FA6A4@syenar.hu>
	<462E1447.1040702@marchuet.net>
Message-ID: <0F9AD624-C946-4C0F-9435-DBEA8F9DBAD8@syenar.hu>

Good idea.

I'd call it HB_NETERR() though.

We can extend it however we decide.

Brgds,
Viktor

On 2007.04.24., at 16:29, Miguel Angel Marchuet wrote:

> Why not use GetLastError() to implement this new behavior. And  
> NETERR()
> can be used only as old clipper compatibility.
>
> I prefer respect compatibility as possible, for this reason, the  
> use of
> GetLastError() as other languages can be good solution.
>
> Best regards,
> Miguel Angel Marchuet
>
> Szak?ts Viktor escribi?:
>>>> My impression is that the original developers did choose the
>>>> original behaviour for a reason, simply because it would be to
>>>> huge of an omission by mistake, it's also quite clearly documented.
>>>
>>> My impression is that NETERR() was added to existing code and  
>>> there is
>>> not too much of design decisions in it ;-)
>>
>> Well, can be :) But for this reason, they've just hacked it into
>> the errorhandler. Actually it's not such a bad idea, because the  
>> reasons
>> you mention; to handle non-portable error codes and conditions, so
>> they've at least gave the user the possibility to control these.  
>> If they
>> hard coded the logic, it would be a big showstopper when the
>> app runs on an OS or network system newer than DOS/Win 3.1
>> and this new OS has some non-compatible set, or a superset of
>> old error codes. So, yes it can be hard to be prepared for all these
>> error codes but at least it can be handled on app level.
>>
>>>> To make it easier for developers to detect dbCreate() errors
>>>> though, and to have less side-effect at the same time, we should
>>>> rather consider returning a logical value from this function. There
>>>> is probably no code out there that would rely on the fact that
>>>> dbCreate()
>>>> always returns NIL, so it seems safe to extend this way. FlagShip
>>>> already does that, while XBase++ still return NIL. So I think it's
>>>> even safer to go with a logical retval.
>>>
>>> changing dbCreate(), dbUseArea() and dbAppend() to return logical  
>>> value
>>> is IMHO good idea. In Clipper this functions can return any value  
>>> because
>>> that are working like procedures (I had to hard code some  
>>> exceptions for
>>> that when I was testing Clipper RDD functions - return values were
>>> unpredictable) so it should not interact with existing code.
>>
>> Okey, even better. All of them would be nice to return logical.
>>
>>>> At the same time all docs (FS, XPP, C5x) explicitly states that
>>>> NetErr() is only influenced by USE/APPEND BLANK.
>>>
>>> and in Clipper it's not true because dbSetIndex() also resets  
>>> NETERR()
>>
>> Yes, they seem to have forgotten to add it to the docs, or whatnot :)
>>
>>>> With a local error handler it's pretty easy to catch dbCreate()
>>>> errors in Clipper, regardless of the DOSError() code it generates.
>>>> That's how most robust apps are doing it probably, as there is
>>>> not other way to get any details any other way.
>>>
>>> for me it is very complicated to make it well. Many different  
>>> errors can
>>> appear and it's very hard to properly recognize them on different
>>> platform.
>>> In practice without some hacks in filesys.c (I've already began to
>>> make them
>>> - see some error code translation functions - not perfect but covers
>>> about
>>> 75% of cases) it's IMHO impossible. F.e. in this case it will be
>>> necessary
>>> to pass to translation function some pseudo code of operation.
>>> Anyhow good. I'll remove all NETERR() setting from RDD code and  
>>> left only
>>> reseting in few places. NETERR() can be set only by error handler so
>>> user will have to create their own error handlers. I'll also add  
>>> support
>>> for LockErrHandler() so users who has some xHarbour code with TRY/ 
>>> CATCH
>>> emulated by preprocessor rules will have to set error block with  
>>> support
>>> for some basic exceptions.
>>
>> Okey, thank you.
>>
>>>> I see no reason why C should use FAILURE / SUCCESS because
>>>> these were not originally used in C5x headers. So the answer is
>>>> that we'd need to fix the C headers too if we want to take it
>>>> seriously :)
>>>> But it probably won't affect many normal users.
>>>
>>> If you want to fight with 3-rd party developers you can change  
>>> it ;-)
>>> For me it's not a problem. Remember that it means that all SELF_*(),
>>> SUPER_*() and similar macros should also have HB_* prefix. Also  
>>> FHANDLE
>>> and other types without HB_ prefix should be modified.
>>
>> FHANDLE is C5x compatible, so it's okey. As for the rest, I think
>> we can leave it, since there is probably not too many developers
>> who are developing RDDs, and those who are can probably figure
>> to solve those namespace problems, if they happen to have any.
>>
>> Brgds,
>> Viktor
>>
>> _______________________________________________
>> Harbour mailing list
>> Harbour@harbour-project.org
>> http://lists.harbour-project.org/mailman/listinfo/harbour
>>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From miguelangel at marchuet.net  Tue Apr 24 10:34:12 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue Apr 24 10:34:15 2007
Subject: [Harbour] Rushmore and bitmap filters.
Message-ID: <462E1564.9030204@marchuet.net>

Prezmek can be able to implement this features
over DBF rdds.

Rushmore and bitmap filters.

I can't upload anything to harbour. I've finished
bitmaps filters, and now I'm testing Rushmore, and other
news types of fields.


Best regards,
Miguel Angel Marchuet
From druzus at priv.onet.pl  Tue Apr 24 11:19:58 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 24 11:20:34 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <462E1447.1040702@marchuet.net>
References: <20070423162656.GA1558@localhost.localdomain>
	<FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>
	<20070423174210.GA9258@localhost.localdomain>
	<D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu>
	<20070424122330.GA11077@localhost.localdomain>
	<BD64FB05-2D0F-454C-BFF5-FCB11C2FA6A4@syenar.hu>
	<462E1447.1040702@marchuet.net>
Message-ID: <20070424151958.GA656@localhost.localdomain>

On Tue, 24 Apr 2007, Miguel Angel Marchuet wrote:
> Why not use GetLastError() to implement this new behavior.

I do not understand. We are using GetLastError() in Windows build now
so what you want to change?

> And NETERR() can be used only as old clipper compatibility.
> I prefer respect compatibility as possible, for this reason, the use of
> GetLastError() as other languages can be good solution.

GetLastError() is already used to detect error code in Windows
and set FERROR() which is later used in error object so I have
absolutely no idea what you want to change.

BTW GetLastError() is Windows only function and Windows error code
are in most cases DOS compatibile so it's not Windows problem at all.

best regards,
Przemek
From druzus at priv.onet.pl  Tue Apr 24 11:43:31 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 24 11:44:07 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <462E1564.9030204@marchuet.net>
References: <462E1564.9030204@marchuet.net>
Message-ID: <20070424154331.GB656@localhost.localdomain>

On Tue, 24 Apr 2007, Miguel Angel Marchuet wrote:
> Prezmek can be able to implement this features
> over DBF rdds.
> Rushmore and bitmap filters.

Once I created such library for [x]Harbour and now I'm working
on some other things. Maybe in the future I'll work on it again
but probably together with SQL interface - some optimizations
techniques for SQL queries need bitmap filters.

> I can't upload anything to harbour. I've finished
> bitmaps filters, and now I'm testing Rushmore, and other
> news types of fields.

Ask Phil about write access to CVS.

But before you commit sth some notes about BM* RDDs in xHarbour.
Current BM* RDDs does not respect inheritance scheme.
BMDBFCDX is a copy of DBFCDX with few additional functions.
IMHO you should remove all CDX code from this RDD and change
it to inherit from DBFCDX or DBFNTX. We will not have replicated
code and bitmap filters can be used also with DBFNTX.
This RDD introduce some BM_*() functions which directly access
AREA structure without respecting RDD API. It causes few bad side
effects, f.e. they are not portable between different RDDs what
breaks the whole RDD idea or mistake in work area and executing
them for other RDDs causes GPF. In such form IMHO it cannot be
committed to core code but only into contrib directory.

best regards,
Przemek
From miguelangel at marchuet.net  Tue Apr 24 16:32:44 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue Apr 24 16:33:17 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
References: <20070423162656.GA1558@localhost.localdomain><FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu><20070423174210.GA9258@localhost.localdomain><D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu><20070424122330.GA11077@localhost.localdomain><BD64FB05-2D0F-454C-BFF5-FCB11C2FA6A4@syenar.hu><462E1447.1040702@marchuet.net>
	<20070424151958.GA656@localhost.localdomain>
Message-ID: <003c01c786af$b6f421c0$d801a8c0@ingachka>

Of course Prezmek, all programers known this fact.

I suggest the use of GetLastError() to report the last error, too in linux.
redirecting and growing NETERR() as nedded.

leaving NETERR() as clipper obsolete function.

If you want can change the name of the new function as porprouses Victor

    HB_NETERR().

But remember that GetLastError() is working on windows platform, on needs
to add some new especific features from Harbour, and find similar in other
platforms.

But this is only an idea.


Best regards,
Miguel Angel Marchuet
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070424/51cd2ff3/attachment.html
From miguelangel at marchuet.net  Tue Apr 24 16:44:12 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Tue Apr 24 16:44:47 2007
Subject: [Harbour] Rushmore and bitmap filters.
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
Message-ID: <004501c786b1$50e22600$d801a8c0@ingachka>

Yes, but we lost perfomance inheriting from DBFCDX without
duplicating code.

If you remember, DBFCDX of Clipper 5.3 uses Bitmap Filters
and Rushmore when SET OPTIMIZE is activated. The actual
DBFCDX of harbour don't use it.

I think that is better only one RDD DBFCDX + BMDBFCDX = DBFCDX

the actual BMDBFCDX has new corrections , too in DBFCDX of actual xharbour

I prefer to port to Harbour in DBFCDX rdd, we don't need a BM rdd.

For the moment I'm testing rushmore, but is not uploaded.

xharbour RDD has implemented DATETIME and TIMESTAMP, in a few days
I upload to autoincremental fields.

Other extensions BM_*, I think can be changed and implemented at DBF an future DB level.
I'm developing DBPX, at the moment I have finised DB and working on PX.

All this and more can be ported to harbour.

I hope Phil give me write access to CVS.

Best regards,
Miguel Angel Marchuet


  ----- Original Message ----- 
  From: Przemyslaw Czerpak 
  To: Harbour Project Main Developer List. 
  Sent: Tuesday, April 24, 2007 5:43 PM
  Subject: Re: [Harbour] Rushmore and bitmap filters.


  On Tue, 24 Apr 2007, Miguel Angel Marchuet wrote:
  > Prezmek can be able to implement this features
  > over DBF rdds.
  > Rushmore and bitmap filters.

  Once I created such library for [x]Harbour and now I'm working
  on some other things. Maybe in the future I'll work on it again
  but probably together with SQL interface - some optimizations
  techniques for SQL queries need bitmap filters.

  > I can't upload anything to harbour. I've finished
  > bitmaps filters, and now I'm testing Rushmore, and other
  > news types of fields.

  Ask Phil about write access to CVS.

  But before you commit sth some notes about BM* RDDs in xHarbour.
  Current BM* RDDs does not respect inheritance scheme.
  BMDBFCDX is a copy of DBFCDX with few additional functions.
  IMHO you should remove all CDX code from this RDD and change
  it to inherit from DBFCDX or DBFNTX. We will not have replicated
  code and bitmap filters can be used also with DBFNTX.
  This RDD introduce some BM_*() functions which directly access
  AREA structure without respecting RDD API. It causes few bad side
  effects, f.e. they are not portable between different RDDs what
  breaks the whole RDD idea or mistake in work area and executing
  them for other RDDs causes GPF. In such form IMHO it cannot be
  committed to core code but only into contrib directory.

  best regards,
  Przemek
  _______________________________________________
  Harbour mailing list
  Harbour@harbour-project.org
  http://lists.harbour-project.org/mailman/listinfo/harbour

  __________ Informaci?n de NOD32, revisi?n 2215 (20070424) __________

  Este mensaje ha sido analizado con  NOD32 antivirus system
  http://www.nod32.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070424/3eb40a02/attachment.html
From lorenzo.fiorini at gmail.com  Tue Apr 24 17:06:09 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Tue Apr 24 17:06:13 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <004501c786b1$50e22600$d801a8c0@ingachka>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
Message-ID: <9257026e0704241406p7e096afg45a2e3a29c1ab3ac@mail.gmail.com>

On 4/24/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:

> Yes, but we lost perfomance inheriting from DBFCDX without
> duplicating code.
>   ...
> I prefer to port to Harbour in DBFCDX rdd, we don't need a BM rdd.
>   ...
> xharbour RDD has implemented DATETIME and TIMESTAMP, in a few days
> I upload to autoincremental fields.

I vote against it. RDD is one of the core subsystems and every single
modification should be carefully planned, evaluated and approved by
the projects leaders.

regards,
Lorenzo Fiorini
From harbour.01 at syenar.hu  Tue Apr 24 17:14:55 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 24 17:15:15 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <9257026e0704241406p7e096afg45a2e3a29c1ab3ac@mail.gmail.com>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<9257026e0704241406p7e096afg45a2e3a29c1ab3ac@mail.gmail.com>
Message-ID: <50040714-4419-4CD6-9EC7-A27CA0F793A4@syenar.hu>

Yes, while I think rushmore optimization is essential for any
(non-ADS/SQL) database apps, I also think it should be done
as a proper RDD layer, or if not, the RDD is very welcome as
a contrib.

Brgds,
Viktor

On 2007.04.24., at 23:06, Lorenzo Fiorini wrote:

> On 4/24/07, Miguel Angel Marchuet <miguelangel@marchuet.net> wrote:
>
>> Yes, but we lost perfomance inheriting from DBFCDX without
>> duplicating code.
>>   ...
>> I prefer to port to Harbour in DBFCDX rdd, we don't need a BM rdd.
>>   ...
>> xharbour RDD has implemented DATETIME and TIMESTAMP, in a few days
>> I upload to autoincremental fields.
>
> I vote against it. RDD is one of the core subsystems and every single
> modification should be carefully planned, evaluated and approved by
> the projects leaders.
>
> regards,
> Lorenzo Fiorini
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From dbtopas at dbtopas.lt  Tue Apr 24 18:14:49 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Tue Apr 24 18:12:13 2007
Subject: [Harbour] About some xHarbour extensions
In-Reply-To: <20070423170357.GB1558@localhost.localdomain>
References: <20070418110016.GA14036@localhost.localdomain>	<002a01c781ae$2e3d9970$6c00000a@PcJuanxp>	<20070418140112.GA16238@localhost.localdomain>	<FC3C4AC4-CF72-4F3F-A5DF-C37B6E529698@syenar.hu>	<20070420111236.GB5926@localhost.localdomain>	<462CD020.2040208@dbtopas.lt>
	<20070423170357.GB1558@localhost.localdomain>
Message-ID: <462E8159.9090302@dbtopas.lt>

Przemyslaw Czerpak wrote:
> Don't you see the problem?
> Then I'll try to help you a little bit. Compile this code using xHarbour
> with -p option:
> ...

OK. Now it's much more clear :)


Best regards,
Mindaugas
From druzus at priv.onet.pl  Tue Apr 24 18:12:00 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 24 18:12:36 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <004501c786b1$50e22600$d801a8c0@ingachka>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
Message-ID: <20070424221200.GA3517@localhost.localdomain>

On Tue, 24 Apr 2007, Miguel Angel Marchuet wrote:
> Yes, but we lost perfomance inheriting from DBFCDX without
> duplicating code.

It is not true.
I'm repeated the above 4 words forth or fifth time and you still
ignore it.
One of the most important reason that Harbour is faster then in xHarbour
is clean API. I removed all hacks with inlined code and clearly divided
it into different subsystems. It allowed me to easy introduce some simple
optimization which gave much better performance improvement. When I'm
reading that you want to hack RDD code to reach some few percent speed
improvement (few percent only in some seldom cases when whole data is
read from cache because without it the difference cannot be noticed at
all - IO operations consumes 95% of times so you have few percent in
rest 5%) then I cannot agree for it.

In 2006-12-11 14:20 UTC+0100 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
I enabled some small peace of code which increase the performance
of bitmap filters to the level unreachable for current BMDBFCDX for
code which uses RDD API. I hoped that you begin to use it and I will
not have to return to the problem of using RDD API. So far you haven't
even tried.

> If you remember, DBFCDX of Clipper 5.3 uses Bitmap Filters
> and Rushmore when SET OPTIMIZE is activated. The actual
> DBFCDX of harbour don't use it.

I cannot say how internally CL5.3 RDDs are divided. In general
RDD names in CL53 are horribly hacked. AFAIR "DBFCDX" is FPT RDD
when real CDX driver is "_DBFCDX".
If you want and other developers will agree we can also hack RDD
names when you create separate RDD with bitmap filters. We can
call it DBFCDX and rename current RDD but IMHO it's not good idea.

> I think that is better only one RDD DBFCDX + BMDBFCDX = DBFCDX

If you can implement it well (not like in BMDBFCDX) then yes.
Please do it and then we can add it to core code. Meanwhile I suggest
to use contrib directory.
If you want to create single RDD with mixed code then you can also
do it. Probably you can reach in optimistic situations some few
percent but IMHO it's very bad idea. If you want to make some real
speed improvement then redesign DBFCDX internals and create sth
similar to current DBFNTX. It uses much more efficient internal
structures then DBFCDX and implement most of DBOI_* actions which
allow to port all SX_* functions from SIX3 to xHarbour. They have
to be added to DBFCDX too.

> the actual BMDBFCDX has new corrections , too in DBFCDX of actual xharbour

Which ones?

> I prefer to port to Harbour in DBFCDX rdd, we don't need a BM rdd.

So make a copy of current DBFCDX and change it just like BMDBFCDX in
xHarbour but keep it in contrib directory.

> xharbour RDD has implemented DATETIME and TIMESTAMP

It will be implemented in the future in Harbour but in differ way.

> For the moment I'm testing rushmore, but is not uploaded.
> in a few days I upload to autoincremental fields.

Fine, please upload it so we can see the implementation.

> Other extensions BM_*, I think can be changed and implemented at DBF an
> future DB level.

which extensions? Please define the functionality in precise way so
we can talk about it and think about some common to different RDDs
implementation.

> I'm developing DBPX, at the moment I have finised DB and working on PX.
> All this and more can be ported to harbour.

Very good news. I think DELPHI users and many others will find very usable.

> I hope Phil give me write access to CVS.

Me too, Phil?

best regards,
Przemek
From dbtopas at dbtopas.lt  Tue Apr 24 18:24:24 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Tue Apr 24 18:21:47 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw Czerpak
	(druzus/at/priv.onet.pl)
In-Reply-To: <20070424151958.GA656@localhost.localdomain>
References: <20070423162656.GA1558@localhost.localdomain>	<FC6075FD-ADCB-4303-9781-A22BEF1C1191@syenar.hu>	<20070423174210.GA9258@localhost.localdomain>	<D6350059-900C-4C86-AD17-7BA9AC6DBB09@syenar.hu>	<20070424122330.GA11077@localhost.localdomain>	<BD64FB05-2D0F-454C-BFF5-FCB11C2FA6A4@syenar.hu>	<462E1447.1040702@marchuet.net>
	<20070424151958.GA656@localhost.localdomain>
Message-ID: <462E8398.8080408@dbtopas.lt>

Przemyslaw Czerpak wrote:
> On Tue, 24 Apr 2007, Miguel Angel Marchuet wrote:
>>Why not use GetLastError() to implement this new behavior.
> 
> I do not understand. We are using GetLastError() in Windows build now
> so what you want to change?

I guess, Miguel just wanted to propose a name for a new extended 
function for obtaining error code and had intention to make a compatible 
function for other platforms.

I guess you, Miguel, are using WinAPI, a use a simple GetLastError() 
[x]Harbour to C function to get error code. But this is not 
cross-platform solution. There is no WinAPI, no CreateFile(), no 
GetStockObject(), and no GetLastError() on non-Win systems.


Best regards,
Mindaugas
From druzus at priv.onet.pl  Tue Apr 24 18:36:41 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Tue Apr 24 18:37:17 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
In-Reply-To: <003c01c786af$b6f421c0$d801a8c0@ingachka>
References: <20070424151958.GA656@localhost.localdomain>
	<003c01c786af$b6f421c0$d801a8c0@ingachka>
Message-ID: <20070424223641.GB3517@localhost.localdomain>

On Tue, 24 Apr 2007, Miguel Angel Marchuet wrote:
> Of course Prezmek, all programers known this fact.
> I suggest the use of GetLastError() to report the last error, too in linux.

I do not understand. Linux and other *nixes does not have GetLastError()
function. What exactly do you want to do and what will be the difference
to FERROR() behavior.

> redirecting and growing NETERR() as nedded.
> leaving NETERR() as clipper obsolete function.

But what do you exactly want to do? The above tells me that you
want to change NETERR() but I have no idea how such modification
will look.

> If you want can change the name of the new function as porprouses Victor
>     HB_NETERR().
> But remember that GetLastError() is working on windows platform, on needs
> to add some new especific features from Harbour, and find similar in other
> platforms.
> But this is only an idea.

Sorry, do you want to implement NETERR() as:
   HB_FUNC( NETERR )
   {
      hb_retl( GetLastError() == ERROR_SHARING_VIOLATION );
   }
?

If yes then it's very bad idea. It will not work on POSIX systems
where there is no DENY_* flags and we have to emulate them and even
on Windows this code is buggy by definition. Making it working
will force adding a lot of GetLastError()/SetLastError() to the code.
For me it's enough that I have to save/restore hb_fsError() flag and
I do not need new one.
Victor suggested HB_NETERR() but it was not clear for me if it should
work like above function or it will try to keep current NETERR() behavior
when we restore the original Clipper one. If the second version then
I'm also against it. I strongly prefer to return logical value from
dbCreate()/dbAppend()/dbUseArea() functions without adding new static
variable for which I will have to add representation on HB_STACK in
MT HVM version.

best regards,
Przemek
From harbour.01 at syenar.hu  Tue Apr 24 18:42:51 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Tue Apr 24 18:43:11 2007
Subject: [Harbour] ChangeLog 2007-04-23 18:25 UTC+0200 Przemyslaw
	Czerpak(druzus/at/priv.onet.pl)
In-Reply-To: <20070424223641.GB3517@localhost.localdomain>
References: <20070424151958.GA656@localhost.localdomain>
	<003c01c786af$b6f421c0$d801a8c0@ingachka>
	<20070424223641.GB3517@localhost.localdomain>
Message-ID: <11F057EE-ED40-4E79-B4E9-F9A837B71019@syenar.hu>

> Sorry, do you want to implement NETERR() as:
>    HB_FUNC( NETERR )
>    {
>       hb_retl( GetLastError() == ERROR_SHARING_VIOLATION );
>    }
> ?
>
> If yes then it's very bad idea. It will not work on POSIX systems
> where there is no DENY_* flags and we have to emulate them and even
> on Windows this code is buggy by definition. Making it working
> will force adding a lot of GetLastError()/SetLastError() to the code.
> For me it's enough that I have to save/restore hb_fsError() flag and
> I do not need new one.
> Victor suggested HB_NETERR() but it was not clear for me if it should
> work like above function or it will try to keep current NETERR()  
> behavior
> when we restore the original Clipper one. If the second version then
> I'm also against it. I strongly prefer to return logical value from
> dbCreate()/dbAppend()/dbUseArea() functions without adding new static
> variable for which I will have to add representation on HB_STACK in
> MT HVM version.

If this has such consequences, I don't think it's worth it either.

Brgds,
Viktor



From philb at philb.us  Tue Apr 24 19:46:59 2007
From: philb at philb.us (Phil Barnett)
Date: Tue Apr 24 19:47:02 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <004501c786b1$50e22600$d801a8c0@ingachka>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
Message-ID: <200704241946.59338.philb@philb.us>

On Tuesday 24 April 2007 16:44, Miguel Angel Marchuet wrote:

> I hope Phil give me write access to CVS.

I will need your SourceForge ID.

-- 
Phil Barnett
AI4OF
SKCC #600
From philb at philb.us  Tue Apr 24 19:49:08 2007
From: philb at philb.us (Phil Barnett)
Date: Tue Apr 24 19:49:10 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070424221200.GA3517@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
Message-ID: <200704241949.08202.philb@philb.us>

On Tuesday 24 April 2007 18:12, Przemyslaw Czerpak wrote:

> If you want to create single RDD with mixed code then you can also
> do it. Probably you can reach in optimistic situations some few
> percent but IMHO it's very bad idea. If you want to make some real
> speed improvement then redesign DBFCDX internals and create sth
> similar to current DBFNTX. It uses much more efficient internal
> structures then DBFCDX and implement most of DBOI_* actions which
> allow to port all SX_* functions from SIX3 to xHarbour. They have
> to be added to DBFCDX too.

In ALL code... function first, speed last.

-- 
Phil Barnett
AI4OF
SKCC #600
From dbtopas at dbtopas.lt  Tue Apr 24 20:49:41 2007
From: dbtopas at dbtopas.lt (Mindaugas Kavaliauskas)
Date: Tue Apr 24 20:47:04 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070424221200.GA3517@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>	<20070424154331.GB656@localhost.localdomain>	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
Message-ID: <462EA5A5.5050905@dbtopas.lt>

>>xharbour RDD has implemented DATETIME and TIMESTAMP
> 
> It will be implemented in the future in Harbour but in differ way.

Hello,


after I looked to xHarbour's DATETIME implementation, I didn't like that 
it was implemented under HB_IT_DATE. I don't know why, maybe to save one 
more bit in HB_TYPE... I see two different data "types" related to 
date/time variable: absolute and interval. In case of Clipper date type, 
we have date type for the absolute value, and integer for the interval. 
Operations could be performed:
ABS = ABS + INT + INT,
INT = ABS - ABS,
but ABS + ABS could not be calculated, I even prefere runtime error for 
DATE() + DATE() (but Clipper allows do this with unexpected result).

In case of datetime type, both absolute value and interval value are 
complex (consists of date and time parts), so it is not possible to use 
the same date type for both: datetime absolute value, and datatime 
interval value. OK, maybe it could be possible if datetime is not 
complex but scalar, smth like amount of Julian milliseconds, but then it 
is not compatible with Clipper's date arithmetic.

In case of xHarbour datetime implementation, there is no interval type 
at all.
{^2004/01/01 01:59} + {^00:01} + {^00:01} is allowed, but these time 
values has default FoxPro date 1899-12-31 inside, so result is:
// 02/06/8616 02:00:00.00

After datetime implementation user request about "DateTime substraction 
possibility" appeared on comp.lang.xharbour. It was left unanswered. The 
problem is:
VALTYPE(DATETIME() + {^ 00:10}) == "D", but
VALTYPE(DATETIME() - {^ 00:10}) == "N" and DATETIME() value 10 minutes 
ago could not be calculated.

So, this implementation allows to store DATETIME absolute value, but any 
datetime calculations are meaningless. But, I guess we expect it. So, we 
need a separate datetime (or timestamp) value, perhaps with VALTYPE()=="T".

There are some other things I do not like:
1) {^ ...} syntax
2) iAmPm parameter in C level API

I do not know, if it's good to store both absolute value and interval 
value inside the same type of variable. We can, but we need to divide 
Julian date into absolute/interval ranges or store absolute/interval flag.

Let's look at the Clipper implementation. DATE()+DATE() trick allows us 
to see internals :) Today is 2007-04-25.
? DATE() + DATE() - DATE()  // 2454216, it is Julian date for today :)
? DATE() - 732790           // 0001-01-01

So the first valid date, 0001-01-01 is 2454216-732790=1721426. The year 
before year 0001 was 1 B.C., and there was no year 0000, but Clipper 
allows to use such year:
? DATE() - 732791           // 0000-12-31
...
? DATE() - 733156           // 0000-01-01

Value for 0000-01-01 is 2454216-733156=1721060. The date before 
0000-01-01 is showed as 0000-00-00 and the real Julian date value is 
ignored, but these values are still different:
d1 := DATE() - 733157
d2 := DATE() - 733158
? d1                        // 0000-00-00
? d2                        // 0000-00-00
? d1 - d2                   // 1
up to the
? DATE() - 2454215          // 0000-00-00 Julian date 1
? DATE() - 2454216          // "    -  -  " Julian date 0, empty date

? DATE() - 2454217  // 1449-02-15, because of underflow to MAX_UINT32, 
but in this case year is much larger than 1449

The largest valid yyyy-mm-dd date without overflow is
? DATE() + 2919268  // 9999-12-31, Julian date: 5373484
Larger value DATE() + 2919269 is also displayed "0001-01-01", but it's 
different from previous:
d1 := DATE() + 2919269
d2 := DATE() - 733156
? d1                   // 0001-01-01
? d2                   // 0001-01-01
? d1 - d2              // 3652425, it's exactly 10000 years :)

So, if we want to use current datetime structure, i.e., Julian date and 
milliseconds. We can use Julian date:
    MIN_INT32, ..., -1, 0, 1, ..., 1721059 - for interval,
    1721060, ..., 5373484 - for absolute date valid Clipper date from 
0000-01-01 to 9999-12-31,
    5373484, ..., MAX_INT32 - undefined, any.

But largest interval value 1721059 is about 4715 years, so it will not 
allow to calculate intervals for all valid dates. We need to use 
different base number for 0000-01-01 date, or we can use highest bit of 
milliseconds to indicate, if date value is Julian date or numeric date 
interval.


Best regards,
Mindaugas



From philb at philb.us  Tue Apr 24 22:38:36 2007
From: philb at philb.us (Phil Barnett)
Date: Tue Apr 24 22:38:41 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <462EA5A5.5050905@dbtopas.lt>
References: <462E1564.9030204@marchuet.net>
	<20070424221200.GA3517@localhost.localdomain>
	<462EA5A5.5050905@dbtopas.lt>
Message-ID: <200704242238.37018.philb@philb.us>

On Tuesday 24 April 2007 20:49, Mindaugas Kavaliauskas wrote:
> >>xharbour RDD has implemented DATETIME and TIMESTAMP
> >
> > It will be implemented in the future in Harbour but in differ way.
>
> Hello,
>
>
> after I looked to xHarbour's DATETIME implementation, I didn't like that
> it was implemented under HB_IT_DATE. I don't know why, maybe to save one
> more bit in HB_TYPE... I see two different data "types" related to
> date/time variable: absolute and interval. In case of Clipper date type,
> we have date type for the absolute value, and integer for the interval.
> Operations could be performed:
> ABS = ABS + INT + INT,
> INT = ABS - ABS,
> but ABS + ABS could not be calculated, I even prefere runtime error for
> DATE() + DATE() (but Clipper allows do this with unexpected result).
>
> In case of datetime type, both absolute value and interval value are
> complex (consists of date and time parts), so it is not possible to use
> the same date type for both: datetime absolute value, and datatime
> interval value. OK, maybe it could be possible if datetime is not
> complex but scalar, smth like amount of Julian milliseconds, but then it
> is not compatible with Clipper's date arithmetic.
>
> In case of xHarbour datetime implementation, there is no interval type
> at all.
> {^2004/01/01 01:59} + {^00:01} + {^00:01} is allowed, but these time
> values has default FoxPro date 1899-12-31 inside, so result is:
> // 02/06/8616 02:00:00.00
>
> After datetime implementation user request about "DateTime substraction
> possibility" appeared on comp.lang.xharbour. It was left unanswered. The
> problem is:
> VALTYPE(DATETIME() + {^ 00:10}) == "D", but
> VALTYPE(DATETIME() - {^ 00:10}) == "N" and DATETIME() value 10 minutes
> ago could not be calculated.
>
> So, this implementation allows to store DATETIME absolute value, but any
> datetime calculations are meaningless. But, I guess we expect it. So, we
> need a separate datetime (or timestamp) value, perhaps with VALTYPE()=="T".
>
> There are some other things I do not like:
> 1) {^ ...} syntax
> 2) iAmPm parameter in C level API
>
> I do not know, if it's good to store both absolute value and interval
> value inside the same type of variable. We can, but we need to divide
> Julian date into absolute/interval ranges or store absolute/interval flag.
>
> Let's look at the Clipper implementation. DATE()+DATE() trick allows us
> to see internals :) Today is 2007-04-25.
> ? DATE() + DATE() - DATE()  // 2454216, it is Julian date for today :)
> ? DATE() - 732790           // 0001-01-01
>
> So the first valid date, 0001-01-01 is 2454216-732790=1721426. The year
> before year 0001 was 1 B.C., and there was no year 0000, but Clipper
> allows to use such year:
> ? DATE() - 732791           // 0000-12-31
> ...
> ? DATE() - 733156           // 0000-01-01
>
> Value for 0000-01-01 is 2454216-733156=1721060. The date before
> 0000-01-01 is showed as 0000-00-00 and the real Julian date value is
> ignored, but these values are still different:
> d1 := DATE() - 733157
> d2 := DATE() - 733158
> ? d1                        // 0000-00-00
> ? d2                        // 0000-00-00
> ? d1 - d2                   // 1
> up to the
> ? DATE() - 2454215          // 0000-00-00 Julian date 1
> ? DATE() - 2454216          // "    -  -  " Julian date 0, empty date
>
> ? DATE() - 2454217  // 1449-02-15, because of underflow to MAX_UINT32,
> but in this case year is much larger than 1449
>
> The largest valid yyyy-mm-dd date without overflow is
> ? DATE() + 2919268  // 9999-12-31, Julian date: 5373484
> Larger value DATE() + 2919269 is also displayed "0001-01-01", but it's
> different from previous:
> d1 := DATE() + 2919269
> d2 := DATE() - 733156
> ? d1                   // 0001-01-01
> ? d2                   // 0001-01-01
> ? d1 - d2              // 3652425, it's exactly 10000 years :)
>
> So, if we want to use current datetime structure, i.e., Julian date and
> milliseconds. We can use Julian date:
>     MIN_INT32, ..., -1, 0, 1, ..., 1721059 - for interval,
>     1721060, ..., 5373484 - for absolute date valid Clipper date from
> 0000-01-01 to 9999-12-31,
>     5373484, ..., MAX_INT32 - undefined, any.
>
> But largest interval value 1721059 is about 4715 years, so it will not
> allow to calculate intervals for all valid dates. We need to use
> different base number for 0000-01-01 date, or we can use highest bit of
> milliseconds to indicate, if date value is Julian date or numeric date
> interval.

The Gregorian calendar was invented in 1582, so there's no point in doing math 
on it behind there.

http://en.wikipedia.org/wiki/Gregorian_calendar

It gets rediculously difficult to calculate dates behind that point because 
there were huge errors in previous calendars and several huge jumps to 
realign the months with the seasons.

Don't bother. 

-- 
Phil Barnett
AI4OF
SKCC #600
From lorenzo.fiorini at gmail.com  Wed Apr 25 03:09:07 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr 25 03:09:11 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070424221200.GA3517@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
Message-ID: <9257026e0704250009k6ac90e00l2ebc592ce7c20207@mail.gmail.com>

On 4/25/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:

> One of the most important reason that Harbour is faster then in xHarbour
> is clean API. I removed all hacks with inlined code and clearly divided
> ...
> Me too, Phil?

May I suggest to open a new branch for these modifications sth like 1.2 or 2.0?
Usually 1.1 only adds features but keeps stability.

IMHO Harbour "core" developers should define rules that every new
developer has to accept.

I've seen that without rules open source projects easily become a mess.

Look in the NET for "The future of NetBSD":

"... Unfortunately, we made some mistakes here.  As we've seen over the
years, one of the great successes of Linux was that it had a strong
leader, who set goals and directions..."

I think it is an interesting reading for everyone.

regards,
Lorenzo
From harbour.01 at syenar.hu  Wed Apr 25 03:36:47 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 25 03:37:07 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <9257026e0704250009k6ac90e00l2ebc592ce7c20207@mail.gmail.com>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<9257026e0704250009k6ac90e00l2ebc592ce7c20207@mail.gmail.com>
Message-ID: <B68C3739-EF12-49DE-8C75-9E5D46C348E3@syenar.hu>

I think this RDD contribution - as it now - has to go to the contrib
and not the core (just like ADS_RDD), regardless of the branch used.

As a contrib it can be used just as well, but it doesn't need to
follow the strict rules of the core.

Brgds,
Viktor

On 2007.04.25., at 9:09, Lorenzo Fiorini wrote:

> On 4/25/07, Przemyslaw Czerpak <druzus@priv.onet.pl> wrote:
>
>> One of the most important reason that Harbour is faster then in  
>> xHarbour
>> is clean API. I removed all hacks with inlined code and clearly  
>> divided
>> ...
>> Me too, Phil?
>
> May I suggest to open a new branch for these modifications sth like  
> 1.2 or 2.0?
> Usually 1.1 only adds features but keeps stability.
>
> IMHO Harbour "core" developers should define rules that every new
> developer has to accept.
>
> I've seen that without rules open source projects easily become a  
> mess.
>
> Look in the NET for "The future of NetBSD":
>
> "... Unfortunately, we made some mistakes here.  As we've seen over  
> the
> years, one of the great successes of Linux was that it had a strong
> leader, who set goals and directions..."
>
> I think it is an interesting reading for everyone.
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From niki at synel.co.il  Wed Apr 25 04:16:35 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed Apr 25 04:17:10 2007
Subject: [Harbour] SF bugtracker#1706729: HB_CHRMAP vs. HB_CHARMAP
Message-ID: <462F0E63.58D6@synel.co.il>

http://sourceforge.net/tracker/index.php?func=detail&aid=1706729&group_id=681&atid=100681

,-
| source/rtl/gtcrs/hb-charmap.def says that program will look for
| HB_CHARMAP envvar, while in reality it looks for HB_CHRMAP
| see source/rtl/gtcrs/chrmap.c:326
`-

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From miguelangel at marchuet.net  Wed Apr 25 04:24:30 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Wed Apr 25 04:24:36 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <200704241946.59338.philb@philb.us>
References: <462E1564.9030204@marchuet.net>	<20070424154331.GB656@localhost.localdomain>	<004501c786b1$50e22600$d801a8c0@ingachka>
	<200704241946.59338.philb@philb.us>
Message-ID: <462F103E.7050107@marchuet.net>

Phil Barnett escribi?:
> On Tuesday 24 April 2007 16:44, Miguel Angel Marchuet wrote:
> 
>> I hope Phil give me write access to CVS.
> 
> I will need your SourceForge ID.
> 

User ID:  	1611982
Login Name:
(User Name) 	marchuet

Best regards,
Miguel Angel Marchuet
From lorenzo.fiorini at gmail.com  Wed Apr 25 04:29:00 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Wed Apr 25 04:29:09 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <B68C3739-EF12-49DE-8C75-9E5D46C348E3@syenar.hu>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<9257026e0704250009k6ac90e00l2ebc592ce7c20207@mail.gmail.com>
	<B68C3739-EF12-49DE-8C75-9E5D46C348E3@syenar.hu>
Message-ID: <9257026e0704250129q481e3b44se9f106dca10e5da1@mail.gmail.com>

On 4/25/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:

> I think this RDD contribution - as it now - has to go to the contrib
> and not the core (just like ADS_RDD), regardless of the branch used.
>
> As a contrib it can be used just as well, but it doesn't need to
> follow the strict rules of the core.

I agree, but since English is not our native language and for kindness
we use term like "should", "IMHO", "I think" there can be
misunderstandings.

I don't want to sound too rude or offensive for other developers, but
for me Przemyslaw IS ACTUALLY the "project leader" and if he says:

"I'm repeated the above 4 words forth or fifth time and you still
ignore it.", I want to be sure that he is well understood.

IMHO every "no-core" developer should clearly agree that every change
that doesn't go in the contrib should be announced, discussed and
approved by core developers.

regards,
Lorenzo
From niki at synel.co.il  Wed Apr 25 04:55:02 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed Apr 25 04:55:34 2007
Subject: [Harbour] Rushmore and bitmap filters.
Message-ID: <462F1766.5592@synel.co.il>

Miguel,

> I hope Phil give me write access to CVS
> User ID: 1611982
> Login Name: marchuet

Done. Welcome to the project :)

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From harbour.01 at syenar.hu  Wed Apr 25 05:05:41 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Wed Apr 25 05:06:02 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <9257026e0704250129q481e3b44se9f106dca10e5da1@mail.gmail.com>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<9257026e0704250009k6ac90e00l2ebc592ce7c20207@mail.gmail.com>
	<B68C3739-EF12-49DE-8C75-9E5D46C348E3@syenar.hu>
	<9257026e0704250129q481e3b44se9f106dca10e5da1@mail.gmail.com>
Message-ID: <EB0D0934-254B-462B-BAB7-B99AC2BA8FE2@syenar.hu>

I agree.

On 2007.04.25., at 10:29, Lorenzo Fiorini wrote:

> On 4/25/07, Szak?ts Viktor <harbour.01@syenar.hu> wrote:
>
>> I think this RDD contribution - as it now - has to go to the contrib
>> and not the core (just like ADS_RDD), regardless of the branch used.
>>
>> As a contrib it can be used just as well, but it doesn't need to
>> follow the strict rules of the core.
>
> I agree, but since English is not our native language and for kindness
> we use term like "should", "IMHO", "I think" there can be
> misunderstandings.
>
> I don't want to sound too rude or offensive for other developers, but
> for me Przemyslaw IS ACTUALLY the "project leader" and if he says:
>
> "I'm repeated the above 4 words forth or fifth time and you still
> ignore it.", I want to be sure that he is well understood.
>
> IMHO every "no-core" developer should clearly agree that every change
> that doesn't go in the contrib should be announced, discussed and
> approved by core developers.
>
> regards,
> Lorenzo
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From niki at synel.co.il  Wed Apr 25 05:56:00 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed Apr 25 05:56:54 2007
Subject: [Harbour] SF bugtracker#1706318: IsPrinter function
Message-ID: <462F25B0.83D@synel.co.il>

http://sourceforge.net/tracker/index.php?func=detail&aid=1706318&group_

The following program gives Unrecoverable error and lots of CodeGuard
errors when executed (this is probably a Win32 specific problem):

--tt35.prg--
proc main
? isprinter()   // .T. with Clipper 5.2e on the same env
------------

bld_b32 tt35 /w/a/n
tt35

Unrecoverable error 9023: hb_xgrab requested to allocate zero bytes
Called from ISPRINTER(0)
Called from MAIN(2)

And then 557 CG errors, probably because the program just quit
without freeing the already allowcated blocks. Here are some of
the errors:

Error 00001. 0x300010 (Thread 0x003F):
Resource leak: The memory block (0xCB9F5C) was never freed

The memory block (0x00CB9F5C) [size: 116 bytes] was allocated with malloc
Call Tree:
   0x004196AB(=TT35.EXE:0x01:0186AB) source\vm\FM.C#244
   0x00413C92(=TT35.EXE:0x01:012C92) source\vm\ESTACK.C#224
   0x0041ED98(=TT35.EXE:0x01:01DD98) source\vm\HVM.C#381
   0x00447795(=TT35.EXE:0x01:046795) source\vm\MAINSTD.C#66
   0x004D719A(=TT35.EXE:0x01:0D619A)

------------------------------------------
Error 00002. 0x300010 (Thread 0x003F):
Resource leak: The memory block (0xCB3F78) was never freed

The memory block (0x00CB3F78) [size: 115 bytes] was allocated with malloc
Call Tree:
   0x004196AB(=TT35.EXE:0x01:0186AB) source\vm\FM.C#244
   0x004CB927(=TT35.EXE:0x01:0CA927) source\common\HBSTR.C#139
   0x00431600(=TT35.EXE:0x01:030600) source\vm\HVM.C#6349
   0x00431AE8(=TT35.EXE:0x01:030AE8) source\vm\HVM.C#6482
   0x0046C12D(=TT35.EXE:0x01:06B12D) obj\b32\tobject.c#46
   0x004D6F71(=TT35.EXE:0x01:0D5F71)
------------------------------------------

:

------------------------------------------
Error 00556. 0x300010 (Thread 0x003F):
Resource leak: The memory block (0xCC2084) was never freed

The memory block (0x00CC2084) [size: 132 bytes] was allocated with malloc
Call Tree:
   0x004196AB(=TT35.EXE:0x01:0186AB) source\vm\FM.C#244
   0x004896E3(=TT35.EXE:0x01:0886E3) source\rdd\DBF1.C#4499
   0x0046F7BF(=TT35.EXE:0x01:06E7BF) source\rdd\DBCMD.C#434
   0x004C26A2(=TT35.EXE:0x01:0C16A2) source\rdd\dbfntx\DBFNTX1.C#7660
   0x0041EC07(=TT35.EXE:0x01:01DC07) source\vm\HVM.C#329
   0x0041EE3E(=TT35.EXE:0x01:01DE3E) source\vm\HVM.C#435

------------------------------------------
Error 00557. 0x300010 (Thread 0x003F):
Resource leak: The memory block (0xCB40A0) was never freed

The memory block (0x00CB40A0) [size: 104 bytes] was allocated with malloc
Call Tree:
   0x004196AB(=TT35.EXE:0x01:0186AB) source\vm\FM.C#244
   0x0041292F(=TT35.EXE:0x01:01192F) source\vm\DYNSYM.C#152
   0x0043198B(=TT35.EXE:0x01:03098B) source\vm\HVM.C#6447
   0x00431AE8(=TT35.EXE:0x01:030AE8) source\vm\HVM.C#6482
   0x0046C12D(=TT35.EXE:0x01:06B12D) obj\b32\tobject.c#46
   0x004D6F71(=TT35.EXE:0x01:0D5F71)

------------------------------------------

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From druzus at priv.onet.pl  Wed Apr 25 06:10:46 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Wed Apr 25 06:11:23 2007
Subject: [Harbour] SF bugtracker#1706729: HB_CHRMAP vs. HB_CHARMAP
In-Reply-To: <462F0E63.58D6@synel.co.il>
References: <462F0E63.58D6@synel.co.il>
Message-ID: <20070425101046.GA18916@localhost.localdomain>

On Wed, 25 Apr 2007, Chen Kedem wrote:
> http://sourceforge.net/tracker/index.php?func=detail&aid=1706729&group_id=681&atid=100681
[B> ,-
> | source/rtl/gtcrs/hb-charmap.def says that program will look for
> | HB_CHARMAP envvar, while in reality it looks for HB_CHRMAP
> | see source/rtl/gtcrs/chrmap.c:326
> `-

Typo. Fixed, HB_CHARMAP set in both. Thanks for the information.

Best regards,
Przemek
From niki at synel.co.il  Wed Apr 25 06:25:16 2007
From: niki at synel.co.il (Chen Kedem)
Date: Wed Apr 25 06:25:49 2007
Subject: [Harbour] Re: SF bugtracker#1706318: IsPrinter function
References: <462F25B0.83D@synel.co.il>
Message-ID: <462F2C8C.7CAE@synel.co.il>

Just to add more information:

Tested with devel ChangeLog 2007-04-24 10:38 UTC+0100 Viktor Szakats
with BCC32 under WinNT4.0

source/rtl/isprint.c function: GetJobs()

At line#274 there is a call to the WinAPI function EnumJobs()
which return a non zero value (=Ok), but the cByteNeeded is set
to 0. At later at line#290 hb_xgrab() fail because of this zero
allocation request.

  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From antonioharbour at gmail.com  Thu Apr 26 04:32:52 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr 26 04:33:10 2007
Subject: [Harbour] New ADORDD for Harbour
Message-ID: <463063c0.17fc8d03.782c.ffffec56@mx.google.com>

ViaOpen (Fernando Mancera www.viaopen.com) and FiveTech Software have
developed an early release of an ADORDD for Harbour using the excellent
USRRDD from Przemek.

As the ADORDD uses the Class TOleAuto recently included in the Harbour CVS
contrib section, we ask permission to include the ADORDD source code in the
contrib section of the Harbour CVS.

ADORDD has been already tested with Access and MySQL databases engines and
works very nicely. It should work with any database engine that supports
Microsoft ADO.

Waiting for your authorization,

Best regards,

ViaOpen & FiveTech Software

Antonio

From harbour.01 at syenar.hu  Thu Apr 26 04:42:55 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr 26 04:43:08 2007
Subject: [Harbour] New ADORDD for Harbour
In-Reply-To: <463063c0.17fc8d03.782c.ffffec56@mx.google.com>
References: <463063c0.17fc8d03.782c.ffffec56@mx.google.com>
Message-ID: <4C40B1CF-567B-4CA7-AA46-36486E6697BE@syenar.hu>

Hi Antonio,

It's a nice contribution.
You have my vote for it.

Brgds,
Viktor

On 2007.04.26., at 10:32, Antonio Linares wrote:

> ViaOpen (Fernando Mancera www.viaopen.com) and FiveTech Software have
> developed an early release of an ADORDD for Harbour using the  
> excellent
> USRRDD from Przemek.
>
> As the ADORDD uses the Class TOleAuto recently included in the  
> Harbour CVS
> contrib section, we ask permission to include the ADORDD source  
> code in the
> contrib section of the Harbour CVS.
>
> ADORDD has been already tested with Access and MySQL databases  
> engines and
> works very nicely. It should work with any database engine that  
> supports
> Microsoft ADO.
>
> Waiting for your authorization,
>
> Best regards,
>
> ViaOpen & FiveTech Software
>
> Antonio
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From gabor.salai at euroherc.hr  Thu Apr 26 04:58:30 2007
From: gabor.salai at euroherc.hr (gabor salai [intranet242])
Date: Thu Apr 26 05:00:04 2007
Subject: [Harbour] New ADORDD for Harbour
References: <463063c0.17fc8d03.782c.ffffec56@mx.google.com>
Message-ID: <006e01c787e1$263be7c0$7e00520a@euroherc.ba>

when would be details availabe?
is it intended to be clipper [dbfntx, prg sorce code level] compatible,
fully or partialy?

----- Original Message -----
From: "Antonio Linares" <antonioharbour@gmail.com>
To: "'Harbour Project Main Developer List.'" <harbour@harbour-project.org>
Sent: Thursday, April 26, 2007 10:32 AM
Subject: [Harbour] New ADORDD for Harbour


> ViaOpen (Fernando Mancera www.viaopen.com) and FiveTech Software have
> developed an early release of an ADORDD for Harbour using the excellent
> USRRDD from Przemek.


From antonioharbour at gmail.com  Thu Apr 26 05:15:10 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr 26 05:15:27 2007
Subject: [Harbour] New ADORDD for Harbour
In-Reply-To: <006e01c787e1$263be7c0$7e00520a@euroherc.ba>
Message-ID: <46306daa.72eb4c0d.3bdd.ffffef45@mx.google.com>

Gabo, 

> when would be details availabe?

As soon as we get the authorization from the Harbour team leaders and we
upload it to the Harbour CVS, full source code and current implementation
details will be available. As an advance can tell that browses are fully
working, with cells editing too.

> is it intended to be clipper [dbfntx, prg sorce code level] compatible,
fully or partialy?

Our target is that a Harbour application may totally migrate from DBFs
management to any ADO supported database engine like Access, MySQL, Oracle,
etc. simply using VIA ADORDD, without changes in the source code, or at
least with minor changes.

Regards,

Antonio

From druzus at priv.onet.pl  Thu Apr 26 05:21:24 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Thu Apr 26 05:21:58 2007
Subject: [Harbour] New ADORDD for Harbour
In-Reply-To: <463063c0.17fc8d03.782c.ffffec56@mx.google.com>
References: <463063c0.17fc8d03.782c.ffffec56@mx.google.com>
Message-ID: <20070426092124.GA2903@localhost.localdomain>

On Thu, 26 Apr 2007, Antonio Linares wrote:
> ViaOpen (Fernando Mancera www.viaopen.com) and FiveTech Software have
> developed an early release of an ADORDD for Harbour using the excellent
> USRRDD from Przemek.
> As the ADORDD uses the Class TOleAuto recently included in the Harbour CVS
> contrib section, we ask permission to include the ADORDD source code in the
> contrib section of the Harbour CVS.
> ADORDD has been already tested with Access and MySQL databases engines and
> works very nicely. It should work with any database engine that supports
> Microsoft ADO.
> Waiting for your authorization,

Very nice contribution. Thank you and my vote to upload it.

best regards,
Przemek
From gabor.salai at euroherc.hr  Thu Apr 26 05:37:15 2007
From: gabor.salai at euroherc.hr (gabor salai [intranet242])
Date: Thu Apr 26 05:38:53 2007
Subject: [Harbour] New ADORDD for Harbour
References: <46306daa.72eb4c0d.3bdd.ffffef45@mx.google.com>
Message-ID: <008d01c787e6$8cf5df20$7e00520a@euroherc.ba>

there is also sqlrdd for xharbour, which is 100% dbfntx compatible [as i
remember, i migrated our big test app with (almost) zero changes].

problem was with index handling [especially built on udf].
while dbfntx is single record optimized, sqlrdd was recordset optimized [it
is much more like clipper's "set filter". skipping through database still
required whole dbf to be copied to workstation over network.

i know, without heavy app restructuring, it is very hard to gain some
performance advantage [except to change the storage, dbf -> sql]


----- Original Message -----
From: "Antonio Linares" <antonioharbour@gmail.com>
To: "'Harbour Project Main Developer List.'" <harbour@harbour-project.org>
Sent: Thursday, April 26, 2007 11:15 AM
Subject: RE: [Harbour] New ADORDD for Harbour


> Gabor,
>
> > is it intended to be clipper [dbfntx, prg sorce code level] compatible,
> fully or partialy?
>
> Our target is that a Harbour application may totally migrate from DBFs
> management to any ADO supported database engine like Access, MySQL,
Oracle,
> etc. simply using VIA ADORDD, without changes in the source code, or at
> least with minor changes.


From niki at synel.co.il  Thu Apr 26 06:16:37 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu Apr 26 06:17:11 2007
Subject: [Harbour] New ADORDD for Harbour
Message-ID: <46307C05.3BCD@synel.co.il>

Antonio,

> we ask permission to include the ADORDD source code
> in the contrib section of the Harbour CVS

What licence does it have? (GPL, GPL+Harbour Execption, other)

Does it require FiveWin or other proprietary product (other than the
ADO drivers) in order to build/work with?

Nothing specific to ADORDD, but Contrib is already 6MB out of the
total 22MB Harbour tree. It was once said that toward version-1
some of it should be separated as another SF project, and some
of it would be taken as core (or at least with the same core
standards). We are now in beta stage, and I think its time to talk
about this.


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From antonioharbour at gmail.com  Thu Apr 26 06:22:30 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr 26 06:22:48 2007
Subject: [Harbour] New ADORDD for Harbour
In-Reply-To: <46307C05.3BCD@synel.co.il>
Message-ID: <46307d73.1f5b54fc.5efa.fffff92f@mx.google.com>

Chen, 

> What licence does it have? (GPL, GPL+Harbour Execption, other)

GPL + Harbour Exception

>
Does it require FiveWin or other proprietary product (other than the ADO
drivers) in order to build/work with?
>

No, none at all

Regards,

Antonio

From niki at synel.co.il  Thu Apr 26 06:36:15 2007
From: niki at synel.co.il (Chen Kedem)
Date: Thu Apr 26 06:37:20 2007
Subject: [Harbour] New ADORDD for Harbour
References: <46307C05.3BCD@synel.co.il>
Message-ID: <4630809F.6EE9@synel.co.il>

Antonio,

>> What licence does it have? (GPL, GPL+Harbour Execption, other)

> GPL + Harbour Exception

>> Does it require FiveWin or other proprietary product
>> (other than the ADO drivers) in order to build/work with?

> No, none at all

In this case, I have no objection to include it.

It is yet to discuss what to include in this project and what
to split into an [x]HBContrib project.


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From antonioharbour at gmail.com  Thu Apr 26 06:49:20 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr 26 06:49:39 2007
Subject: [Harbour] New ADORDD for Harbour
In-Reply-To: <4C40B1CF-567B-4CA7-AA46-36486E6697BE@syenar.hu>
Message-ID: <463083bd.1ea6271d.4ac4.31ab@mx.google.com>

Viktor, 

What directory name you propose for it ? Thanks,


Regards,

Antonio

From lorenzo.fiorini at gmail.com  Thu Apr 26 07:10:45 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Thu Apr 26 07:10:48 2007
Subject: [Harbour] New ADORDD for Harbour
In-Reply-To: <463083bd.1ea6271d.4ac4.31ab@mx.google.com>
References: <4C40B1CF-567B-4CA7-AA46-36486E6697BE@syenar.hu>
	<463083bd.1ea6271d.4ac4.31ab@mx.google.com>
Message-ID: <9257026e0704260410m659240c1u9acb83687e6e8a70@mail.gmail.com>

On 4/26/07, Antonio Linares <antonioharbour@gmail.com> wrote:

> What directory name you propose for it ? Thanks,

Just for information, I did a pgrdd.prg for postgresql and I've left
it in contrib/pgsql since they are interdependent.

regards,
Lorenzo
From miguelangel at marchuet.net  Thu Apr 26 07:35:13 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Thu Apr 26 07:35:22 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070424221200.GA3517@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>	<20070424154331.GB656@localhost.localdomain>	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
Message-ID: <46308E71.4050104@marchuet.net>

Test of speed comparing rdds with bitmap filters and without it:

		Harbour	xHarbour xHarbour  Harbour
		DBFCDX  DBFCDX   BMDBFCDX  DBFCDX with Bitmap Filters
LastRec		0.11	0.14	 0.14	   0.14
OrdKeyCount	0.22	0.19	 0.20	   0.20
Filter		0.42	0.47	 0.44	   0.44
LastRec		0.49	0.56	 0.11      0.11
OrdKeyCount	0.50	0.55	 0.14      0.13

inheriting from                  DBFCDX    DBFCDX
LastRec				 0.14	   0.14
OrdKeyCount			 0.20	   0.20
Filter				 0.55	   0.52
LastRec				 0.11      0.11
OrdKeyCount			 0.13      0.13

REMEMBER that this test is not concurrent.

we and other users are using bitmap filters without any problem

inheriting from DBFCDX has low performance creating filter why
we can't access to some functions of dbfcdx:

part of code inheriting:

            SELF_GOTOP( ( AREAP ) pArea );
            while ( ! pArea->fEof )
            {
                pResult = hb_vmEvalBlock( pArea->dbfi.itmCobExpr );
                if ( HB_IS_LOGICAL( pResult ) && hb_itemGetL( pResult ) )
		{
                    BM_SetBit( ( ( LPBM_FILTER ) pArea->dbfi.lpvCargo)->rmap, ulRecCount, (pArea)->ulRecNo );
                    ulLogKeyCount++;
		}
                SELF_SKIP( ( AREAP ) pArea, 1 );
            }
            pTag->curKeyState &= ~( CDX_CURKEY_RAWPOS | CDX_CURKEY_RAWCNT );
            CURKEY_SETLOGCNT( pTag, ulLogKeyCount );


without inheriting:

            if ( FAST_GOCOLD( ( AREAP ) pArea ) == FAILURE )
               return FAILURE;

            hb_cdxIndexLockRead( pTag->pIndex );
            hb_cdxTagRefreshScope( pTag );
            hb_cdxTagGoTop( pTag );
            ulLogKeyCount = 0;
            while ( !pTag->TagEOF )
            {
               if( pArea->ulRecNo != pTag->CurKey->rec || pArea->lpdbPendingRel )
                  SELF_GOTO( (AREAP) pArea, pTag->CurKey->rec );
               pResult = hb_vmEvalBlock( pArea->dbfi.itmCobExpr );
               if ( HB_IS_LOGICAL( pResult ) && hb_itemGetL( pResult ) )
               {
                  BM_SetBit( ( ( LPBM_FILTER ) pArea->dbfi.lpvCargo)->rmap, ulRecCount, pTag->CurKey->rec );
                  ulLogKeyCount++;
               }
               hb_cdxTagSkipNext( pTag );
            }
            hb_cdxIndexUnLockRead( pTag->pIndex );
            pTag->curKeyState &= ~( CDX_CURKEY_RAWPOS | CDX_CURKEY_RAWCNT );
            CURKEY_SETLOGCNT( pTag, ulLogKeyCount );


Przemyslaw Czerpak escribi?:
> On Tue, 24 Apr 2007, Miguel Angel Marchuet wrote:
>> Yes, but we lost perfomance inheriting from DBFCDX without
>> duplicating code.
> 
> It is not true.
> I'm repeated the above 4 words forth or fifth time and you still
> ignore it.
> One of the most important reason that Harbour is faster then in xHarbour
> is clean API. I removed all hacks with inlined code and clearly divided
> it into different subsystems. It allowed me to easy introduce some simple
> optimization which gave much better performance improvement. When I'm
> reading that you want to hack RDD code to reach some few percent speed
> improvement (few percent only in some seldom cases when whole data is
> read from cache because without it the difference cannot be noticed at
> all - IO operations consumes 95% of times so you have few percent in
> rest 5%) then I cannot agree for it.
> 
> In 2006-12-11 14:20 UTC+0100 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> I enabled some small peace of code which increase the performance
> of bitmap filters to the level unreachable for current BMDBFCDX for
> code which uses RDD API. I hoped that you begin to use it and I will
> not have to return to the problem of using RDD API. So far you haven't
> even tried.

Please can you resend me this peace of code to increase the perfomance ?

>> If you remember, DBFCDX of Clipper 5.3 uses Bitmap Filters
>> and Rushmore when SET OPTIMIZE is activated. The actual
>> DBFCDX of harbour don't use it.
> 
> I cannot say how internally CL5.3 RDDs are divided. In general
> RDD names in CL53 are horribly hacked. AFAIR "DBFCDX" is FPT RDD
> when real CDX driver is "_DBFCDX".
> If you want and other developers will agree we can also hack RDD
> names when you create separate RDD with bitmap filters. We can
> call it DBFCDX and rename current RDD but IMHO it's not good idea.

The tests realized with clipper 5.3b in DBFCDX and documentation
about SET OPTIMIZE informs that it uses static Bitmap filters or similar.
For this reason I think actual DBFCDX needs Bitmap Filters to be
fully compatible with clipper, SPEED and funcionality.

>> I think that is better only one RDD DBFCDX + BMDBFCDX = DBFCDX
> 
> If you can implement it well (not like in BMDBFCDX) then yes.
> Please do it and then we can add it to core code. Meanwhile I suggest
> to use contrib directory.
> If you want to create single RDD with mixed code then you can also
> do it. Probably you can reach in optimistic situations some few
> percent but IMHO it's very bad idea. If you want to make some real
> speed improvement then redesign DBFCDX internals and create sth
> similar to current DBFNTX. It uses much more efficient internal
> structures then DBFCDX and implement most of DBOI_* actions which
> allow to port all SX_* functions from SIX3 to xHarbour. They have
> to be added to DBFCDX too.

Not only optimistic, I test it, I can upload immediately.
About DBFNTX I need to study it and test.

>> the actual BMDBFCDX has new corrections , too in DBFCDX of actual xharbour
> 
> Which ones?

about custom index with for clause. is one.

>> I prefer to port to Harbour in DBFCDX rdd, we don't need a BM rdd.
> 
> So make a copy of current DBFCDX and change it just like BMDBFCDX in
> xHarbour but keep it in contrib directory.

I dont't have any problem to upload new DBFCDX rdd as a contrib. But really will be
a DBFCDX to finish compatibility with clipper.

>> xharbour RDD has implemented DATETIME and TIMESTAMP
> 
> It will be implemented in the future in Harbour but in differ way.

Ok I hope for this. Are important types in some databases.

>> For the moment I'm testing rushmore, but is not uploaded.
>> in a few days I upload to autoincremental fields.
> 
> Fine, please upload it so we can see the implementation.

Ok, in a few days, I don't have any free time.

>> Other extensions BM_*, I think can be changed and implemented at DBF an
>> future DB level.
> 
> which extensions? Please define the functionality in precise way so
> we can talk about it and think about some common to different RDDs
> implementation.

ArrayFromFilter
SetFilterFromArray
AddArrayToFilter
DelArrayFromFilter

which are nedded too for rushmore implementation.

>> I'm developing DBPX, at the moment I have finised DB and working on PX.
>> All this and more can be ported to harbour.
> 

At the moment, I have one problem because index of paradox has more than one
extension .px ant others :(


Best regards,
Miguel Angel Marchuet
-------------- next part --------------
#DEFINE TEST_RECORDS 100000  // Change this value to make some tests

PROCEDURE Main()

   LOCAL n,x,y

   REQUEST BMDBFCDX
   RddSetDefault( "BMDBFCDX" )
   SET AUTOPEN ON
   SET OPTIMIZE ON
   CLEAR SCREEN

   n := 0

//   FErase( 'test.dbf')
//   FErase( 'test.cdx')
//   DbCreate( "Test", { {"One", "C", 6, 0} } )

   USE Test SHARED
   ORDSETFOCUS(1)
   ? ORDKEY()
   INKEY( 0 )
//   INDEX ON FIELD->One TAG One TO Test FOR ! Deleted()


   @ n++,0 SAY VERSION()
/*   @ n++,0 SAY "Adding records ..."
   x := Seconds()
   FOR y := 1 TO TEST_RECORDS
      APPEND BLANK
      FIELD->One := Str( y, 6 )
   NEXT y
   @ n++,0 SAY "Added records : " + Str( LastRec(), 7 )
   @ n++,0 SAY "Seconds : " + Str( Seconds() - x, 5, 2 )
*/
   FOR y := 1 TO 2

      n++

      IF y = 1
         @ n++,0 SAY "No Filter :"
      ELSE
         x := Seconds()
         SET FILTER TO Val( FIELD->One ) % 10 = 0
         @ n++,0 SAY "Filter : Val( FIELD->One ) % 3 = 0"
         @ n++,0 SAY "Resulting registers : " + Str( OrdKeyCount(), 7 )
         DbGoBottom()
         @ n++,0 SAY "Filter creation + OrdKeyCount Seconds : " + Str( Seconds() - x, 5, 2 )
      ENDIF

      n++

      @ n++,2 SAY "RecNo() / LastRec() : "
      x := Seconds()
      DbGoTop()
      WHILE ! Eof()
         //@ n,2 SAY "Pos : " + Str( RecNo(), 7 ) + " de " + Str( LastRec(), 7 )
         RecNo();LastRec()
         DbSkip()
      END
      @ ++n,2 SAY "Seconds : " + Str( Seconds() - x, 5, 2 )

      n += 2

      @ n++,2 SAY "OrdKeyNo() / OrdKeyCount() : "
      x := Seconds()
      DbGoTop()
      WHILE ! Eof()
         //@ n,2 SAY "Pos : " + Str( OrdKeyNo(), 7 ) + " de " + Str( OrdKeyCount(), 7 )
         OrdKeyCount();OrdKeyNo()
         DbSkip()
      END
      @ ++n,2 SAY "Seconds : " + Str( Seconds() - x, 5, 2 )

      n++

   NEXT y

   ?
   ?
   CLOSE ALL

RETURN
From harbour.01 at syenar.hu  Thu Apr 26 08:45:48 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr 26 08:45:59 2007
Subject: [Harbour] New ADORDD for Harbour
In-Reply-To: <463083bd.1ea6271d.4ac4.31ab@mx.google.com>
References: <463083bd.1ea6271d.4ac4.31ab@mx.google.com>
Message-ID: <846C7FED-C657-478D-BA8A-73E604D5233C@syenar.hu>

Hi Antonio,

RDD_ADO to have it next to ADS. (or ADORDD as an alternativ
choice if the other gets some objections)

Brgds,
Viktor

On 2007.04.26., at 12:49, Antonio Linares wrote:

> Viktor,
>
> What directory name you propose for it ? Thanks,
>
>
> Regards,
>
> Antonio
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From antonioharbour at gmail.com  Thu Apr 26 13:22:40 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Thu Apr 26 13:23:01 2007
Subject: [Harbour] New ADORDD for Harbour
In-Reply-To: <846C7FED-C657-478D-BA8A-73E604D5233C@syenar.hu>
Message-ID: <4630dff0.0ea85613.3fa3.ffff815e@mx.google.com>

Viktor, 

>
RDD_ADO to have it next to ADS. (or ADORDD as an alternativ choice if the
other gets some objections)
>

I am waiting for Fernando to upload the files, as he has done most of the
development work. I just assisted him, provided some help, and did tests.

Also he will need permission for that,

Regards,

Antonio

From fmancera at viaopen.com  Thu Apr 26 13:54:24 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Thu Apr 26 13:55:00 2007
Subject: [Harbour] harbour cvs authorization
Message-ID: <005101c7882b$ed6db630$0402a8c0@PORTATIL>

Hello,

 

Please kindly provide me access to the Harbour CVS so I can upload the
AdoRdd files. 

 

My sourceforge ID is: 1778991

My username is : fmancera

 

Thank you,

 

Fernando Mancera

www.viaopen.com

 

 a

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070426/88efcd01/attachment.html
From harbour.01 at syenar.hu  Thu Apr 26 17:14:00 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Thu Apr 26 17:14:12 2007
Subject: [Harbour] SF bugtracker#1706318: IsPrinter function
In-Reply-To: <462F25B0.83D@synel.co.il>
References: <462F25B0.83D@synel.co.il>
Message-ID: <93A92A20-82E2-4393-8021-42C9967C387D@syenar.hu>

Hi Chen,

There is a Win32 specific part hacked to the ISPRINTER()
function. I have some doubts about the quality of the code
(and your example and one previous report also suggest this),
and the code is non-portable anyway and added by
a developer no longer active here since long.

There are fundamental problems too.

Harbour/Clipper supports only direct (raw) line printer
handling, and in Harbour ISPRINTER() was extended to check
for any such line printer ports (LPT2, /dev/lp) (not just LPT1 as
in CA-Cl*pper). The currently failing Win32 extension though
is checking for actual _Windows printer names_, which are not
accessible directly by any other parts of Harbour, so the
extension is very much out of scope, and doesn't belong to
Harbour, and it makes this function incompatible under Windows.
It does belong to a Win32 specific printer handling lib though
(which can otherwise be very useful), but we have not such
thing in Harbour.

So, I'd like to propose to remove this extension, and reset it to
properly support ISPRINTER("LPT1") and the like. If there are
no objections I can do this.

(I we absolutely need such functionality in core Harbour, we
might add a separate function which would check for "GDI"
printers, on all platforms)

Brgds,
Viktor

On 2007.04.25., at 11:56, Chen Kedem wrote:

> http://sourceforge.net/tracker/index.php? 
> func=detail&aid=1706318&group_
>
> The following program gives Unrecoverable error and lots of CodeGuard
> errors when executed (this is probably a Win32 specific problem):
>
> --tt35.prg--
> proc main
> ? isprinter()   // .T. with Clipper 5.2e on the same env
> ------------
>
> bld_b32 tt35 /w/a/n
> tt35
>
> Unrecoverable error 9023: hb_xgrab requested to allocate zero bytes
> Called from ISPRINTER(0)
> Called from MAIN(2)
>
> And then 557 CG errors, probably because the program just quit
> without freeing the already allowcated blocks. Here are some of
> the errors:
>
> Error 00001. 0x300010 (Thread 0x003F):
> Resource leak: The memory block (0xCB9F5C) was never freed
>
> The memory block (0x00CB9F5C) [size: 116 bytes] was allocated with  
> malloc
> Call Tree:
>    0x004196AB(=TT35.EXE:0x01:0186AB) source\vm\FM.C#244
>    0x00413C92(=TT35.EXE:0x01:012C92) source\vm\ESTACK.C#224
>    0x0041ED98(=TT35.EXE:0x01:01DD98) source\vm\HVM.C#381
>    0x00447795(=TT35.EXE:0x01:046795) source\vm\MAINSTD.C#66
>    0x004D719A(=TT35.EXE:0x01:0D619A)
>
> ------------------------------------------
> Error 00002. 0x300010 (Thread 0x003F):
> Resource leak: The memory block (0xCB3F78) was never freed
>
> The memory block (0x00CB3F78) [size: 115 bytes] was allocated with  
> malloc
> Call Tree:
>    0x004196AB(=TT35.EXE:0x01:0186AB) source\vm\FM.C#244
>    0x004CB927(=TT35.EXE:0x01:0CA927) source\common\HBSTR.C#139
>    0x00431600(=TT35.EXE:0x01:030600) source\vm\HVM.C#6349
>    0x00431AE8(=TT35.EXE:0x01:030AE8) source\vm\HVM.C#6482
>    0x0046C12D(=TT35.EXE:0x01:06B12D) obj\b32\tobject.c#46
>    0x004D6F71(=TT35.EXE:0x01:0D5F71)
> ------------------------------------------
>
> :
>
> ------------------------------------------
> Error 00556. 0x300010 (Thread 0x003F):
> Resource leak: The memory block (0xCC2084) was never freed
>
> The memory block (0x00CC2084) [size: 132 bytes] was allocated with  
> malloc
> Call Tree:
>    0x004196AB(=TT35.EXE:0x01:0186AB) source\vm\FM.C#244
>    0x004896E3(=TT35.EXE:0x01:0886E3) source\rdd\DBF1.C#4499
>    0x0046F7BF(=TT35.EXE:0x01:06E7BF) source\rdd\DBCMD.C#434
>    0x004C26A2(=TT35.EXE:0x01:0C16A2) source\rdd\dbfntx\DBFNTX1.C#7660
>    0x0041EC07(=TT35.EXE:0x01:01DC07) source\vm\HVM.C#329
>    0x0041EE3E(=TT35.EXE:0x01:01DE3E) source\vm\HVM.C#435
>
> ------------------------------------------
> Error 00557. 0x300010 (Thread 0x003F):
> Resource leak: The memory block (0xCB40A0) was never freed
>
> The memory block (0x00CB40A0) [size: 104 bytes] was allocated with  
> malloc
> Call Tree:
>    0x004196AB(=TT35.EXE:0x01:0186AB) source\vm\FM.C#244
>    0x0041292F(=TT35.EXE:0x01:01192F) source\vm\DYNSYM.C#152
>    0x0043198B(=TT35.EXE:0x01:03098B) source\vm\HVM.C#6447
>    0x00431AE8(=TT35.EXE:0x01:030AE8) source\vm\HVM.C#6482
>    0x0046C12D(=TT35.EXE:0x01:06B12D) obj\b32\tobject.c#46
>    0x004D6F71(=TT35.EXE:0x01:0D5F71)
>
> ------------------------------------------
>
>   Chen.
> ********************************************************************** 
> ************************
> IMPORTANT: The contents of this email and any attachments are  
> confidential. They are intended for the
> named recipient(s) only.
> If you have received this email in error, please notify the system  
> manager or the sender immediately and do
> not disclose the contents to anyone or make copies thereof.
> *** eSafe scanned this email for viruses, vandals, and malicious  
> content. ***
> ********************************************************************** 
> ************************
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From philb at philb.us  Thu Apr 26 19:07:43 2007
From: philb at philb.us (Phil Barnett)
Date: Thu Apr 26 19:07:47 2007
Subject: [Harbour] harbour cvs authorization
In-Reply-To: <005101c7882b$ed6db630$0402a8c0@PORTATIL>
References: <005101c7882b$ed6db630$0402a8c0@PORTATIL>
Message-ID: <200704261907.43708.philb@philb.us>

On Thursday 26 April 2007 13:54, Fernando Mancera wrote:

> Please kindly provide me access to the Harbour CVS so I can upload the
> AdoRdd files.
>
> My sourceforge ID is: 1778991
>
> My username is : fmancera

Done.

-- 
Phil Barnett
AI4OF
SKCC #600
From sircaulises at gmail.com  Fri Apr 27 00:11:03 2007
From: sircaulises at gmail.com (Sirca Ulises)
Date: Fri Apr 27 00:11:12 2007
Subject: [Harbour] harbour cvs authorization
In-Reply-To: <200704261907.43708.philb@philb.us>
References: <005101c7882b$ed6db630$0402a8c0@PORTATIL>
	<200704261907.43708.philb@philb.us>
Message-ID: <001901c78882$135c98b0$0402a8c0@PORTATIL>

Phil,

> Please kindly provide me access to the Harbour CVS so I can upload the
> AdoRdd files.
>
> My sourceforge ID is: 1778991
>
> My username is : fmancera
>
> Done.

Thank you very much,

Best Regards,

Fernando Mancera
www.viaopen.com

From fmancera at viaopen.com  Fri Apr 27 05:02:14 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Fri Apr 27 05:02:51 2007
Subject: [Harbour] changelog 2007-04-27 10:53 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
Message-ID: <003001c788aa$c05bad80$3e02a8c0@PORTATIL>

2007-04-27 10:53 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
   + contrib/adordd/adordd.ch
   + contrib/adordd/adordd.prg
   + contrib/adordd/make_b32.bat
   + contrib/adordd/makefile.bc
   + contrib/adordd/access1.prg
   + contrib/adordd/mysql1.prg
     * ADORDD header file, source code, makefiles and samples

I have a test.mdb (Access database) sample (120 Kbs) that is used by
access1.prg sample.
Should I upoload it ? If yes, how to upload a binary file ?

MySql1.prg uses a remote MySQL database located at www.freesql.org 

Regards,

Fernando Mancera

From fmancera at viaopen.com  Fri Apr 27 05:06:06 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Fri Apr 27 05:06:41 2007
Subject: [Harbour] ADORDD screenshots
Message-ID: <003101c788ab$4a31a0a0$3e02a8c0@PORTATIL>

Hi,

Using an Access database:

#include "adordd.ch"

REQUEST ADORDD

function Main()

   USE Test.mdb VIA "ADORDD" TABLE "Tabla1"

   Browse()

   USE

return nil

http://img148.imageshack.us/img148/2133/accesssa9.png

Using a MySQL database:

#include "adordd.ch"

REQUEST ADORDD

function Main()

   USE test00 VIA "ADORDD" TABLE "ACCOUNTS" MYSQL ;
      FROM "www.freesql.org" USER "myuser" PASSWORD "mypass"

   Browse()

   USE

return nil

http://img148.imageshack.us/img148/795/mysqlca2.png

Best Regards,

Fernando Mancera


From miguelangel at marchuet.net  Fri Apr 27 06:22:42 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Fri Apr 27 06:22:46 2007
Subject: [Harbour] ADORDD screenshots
In-Reply-To: <003101c788ab$4a31a0a0$3e02a8c0@PORTATIL>
References: <003101c788ab$4a31a0a0$3e02a8c0@PORTATIL>
Message-ID: <4631CEF2.5060602@marchuet.net>

Hello Fernando,

What do you think about to inform only a connection
in use clause.

Connection created with tOleAuto.

Why?, Because normally connection strings are very diferents in some cases

example of connections used in ourXdbu, with its own OLEDBRDD.

 'OLEDB-Provider=MSDASQL.1;Persist Security Info=False;Extended Properties="DSN=Visual FoxPro Tables;UID=[user];SourceDB=[path];
SourceType=DBF;Exclusive=No;BackgroundFetch=Yes;Collate=Machine;Null=Yes;Deleted=Yes;";Initial Catalog=[fichero]'
 'OLEDB-Provider=MSDASQL.1;Persist Security Info=False;Extended
Properties="DSN=[fichero];UID=;SourceDB=[path];SourceType=DBF;Exclusive=No;BackgroundFetch=Yes;Collate=Machine;Null=Yes;Deleted=Yes;";Initial
Catalog=[fichero]'
 'OLEDB-Provider=vfpoledb.1;Data Source=[fichero];Collating Sequence=general'
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[fichero];"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.3.51;Data Source=[fichero];"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[fichero];Extended Properties='Excel 8.0;HDR=YES';"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[path];Extended Properties='Paradox 5.x';"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[path];Extended Properties='Paradox 4.x';"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[path];Extended Properties='Paradox 3.x';"
 "OLEDB-Provider=MSDAORA;Data Source=[fichero];User ID=[user];Password=[password];"
 "OLEDB-Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=False;Initial Catalog=[fichero];Data Source=[servidor]"
 "OLEDB-Provider=MySQLProv;Data Source=[fichero];User Id=[user];Password=[password];"
 "OLEDB-Provider=Ifxoledbc.2;password=[password];User ID=[user];Data Source=[fichero];Persist Security Info=true;"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[path];Extended Properties=dBASE IV;"
 "OLEDB-Provider=IBMDA400;DATA SOURCE=[fichero];USER ID=[user];PASSWORD=[password];"
 "OLEDB-Driver={PostgreSQL};Server=[servidor];Port=5432;Database=[fichero];Uid=[user];Pwd=[password];"
 "OLEDB-Driver=Firebird/InterBase(r) driver;Uid=[user];Pwd=[password];DbName=[fichero];"
 "OLEDB-File Name=[fichero];"

and it strings changes for example for access tables when its has password.


Example:

	USE <tabla> ...... FROM <idConecction>

	where id conection is a TOleAuto connection to an OLEDB (ADO driver)

Best regards,
Miguel Angel Marchuet


Fernando Mancera escribi?:
> Hi,
> 
> Using an Access database:
> 
> #include "adordd.ch"
> 
> REQUEST ADORDD
> 
> function Main()
> 
>    USE Test.mdb VIA "ADORDD" TABLE "Tabla1"
> 
>    Browse()
> 
>    USE
> 
> return nil
> 
> http://img148.imageshack.us/img148/2133/accesssa9.png
> 
> Using a MySQL database:
> 
> #include "adordd.ch"
> 
> REQUEST ADORDD
> 
> function Main()
> 
>    USE test00 VIA "ADORDD" TABLE "ACCOUNTS" MYSQL ;
>       FROM "www.freesql.org" USER "myuser" PASSWORD "mypass"
> 
>    Browse()
> 
>    USE
> 
> return nil
> 
> http://img148.imageshack.us/img148/795/mysqlca2.png
> 
> Best Regards,
> 
> Fernando Mancera
> 
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From fmancera at viaopen.com  Fri Apr 27 07:58:52 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Fri Apr 27 07:59:29 2007
Subject: [Harbour] ADORDD screenshots
In-Reply-To: <4631CEF2.5060602@marchuet.net>
References: <003101c788ab$4a31a0a0$3e02a8c0@PORTATIL>
	<4631CEF2.5060602@marchuet.net>
Message-ID: <004201c788c3$6d128900$3e02a8c0@PORTATIL>

Hello Miguel Angel,

Yes, you are right, we could add a USE new CLAUSE to specify those different
connections strings.

We appreciate your cooperation on the free ADORDD development :-)

Best Regards,


Fernando Mancera

-----Mensaje original-----
De: harbour-bounces@harbour-project.org
[mailto:harbour-bounces@harbour-project.org] En nombre de Miguel Angel
Marchuet
Enviado el: viernes, 27 de abril de 2007 12:23
Para: Harbour Project Main Developer List.
Asunto: Re: [Harbour] ADORDD screenshots

Hello Fernando,

What do you think about to inform only a connection
in use clause.

Connection created with tOleAuto.

Why?, Because normally connection strings are very diferents in some cases

example of connections used in ourXdbu, with its own OLEDBRDD.

 'OLEDB-Provider=MSDASQL.1;Persist Security Info=False;Extended
Properties="DSN=Visual FoxPro Tables;UID=[user];SourceDB=[path];
SourceType=DBF;Exclusive=No;BackgroundFetch=Yes;Collate=Machine;Null=Yes;Del
eted=Yes;";Initial Catalog=[fichero]'
 'OLEDB-Provider=MSDASQL.1;Persist Security Info=False;Extended
Properties="DSN=[fichero];UID=;SourceDB=[path];SourceType=DBF;Exclusive=No;B
ackgroundFetch=Yes;Collate=Machine;Null=Yes;Deleted=Yes;";Initial
Catalog=[fichero]'
 'OLEDB-Provider=vfpoledb.1;Data Source=[fichero];Collating
Sequence=general'
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[fichero];"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.3.51;Data Source=[fichero];"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[fichero];Extended
Properties='Excel 8.0;HDR=YES';"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[path];Extended
Properties='Paradox 5.x';"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[path];Extended
Properties='Paradox 4.x';"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[path];Extended
Properties='Paradox 3.x';"
 "OLEDB-Provider=MSDAORA;Data Source=[fichero];User
ID=[user];Password=[password];"
 "OLEDB-Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security
Info=False;Initial Catalog=[fichero];Data Source=[servidor]"
 "OLEDB-Provider=MySQLProv;Data Source=[fichero];User
Id=[user];Password=[password];"
 "OLEDB-Provider=Ifxoledbc.2;password=[password];User ID=[user];Data
Source=[fichero];Persist Security Info=true;"
 "OLEDB-Provider=Microsoft.Jet.OLEDB.4.0;Data Source=[path];Extended
Properties=dBASE IV;"
 "OLEDB-Provider=IBMDA400;DATA SOURCE=[fichero];USER
ID=[user];PASSWORD=[password];"
 
"OLEDB-Driver={PostgreSQL};Server=[servidor];Port=5432;Database=[fichero];Ui
d=[user];Pwd=[password];"
 "OLEDB-Driver=Firebird/InterBase(r)
driver;Uid=[user];Pwd=[password];DbName=[fichero];"
 "OLEDB-File Name=[fichero];"

and it strings changes for example for access tables when its has password.


Example:

	USE <tabla> ...... FROM <idConecction>

	where id conection is a TOleAuto connection to an OLEDB (ADO driver)

Best regards,
Miguel Angel Marchuet


Fernando Mancera escribi?:
> Hi,
> 
> Using an Access database:
> 
> #include "adordd.ch"
> 
> REQUEST ADORDD
> 
> function Main()
> 
>    USE Test.mdb VIA "ADORDD" TABLE "Tabla1"
> 
>    Browse()
> 
>    USE
> 
> return nil
> 
> http://img148.imageshack.us/img148/2133/accesssa9.png
> 
> Using a MySQL database:
> 
> #include "adordd.ch"
> 
> REQUEST ADORDD
> 
> function Main()
> 
>    USE test00 VIA "ADORDD" TABLE "ACCOUNTS" MYSQL ;
>       FROM "www.freesql.org" USER "myuser" PASSWORD "mypass"
> 
>    Browse()
> 
>    USE
> 
> return nil
> 
> http://img148.imageshack.us/img148/795/mysqlca2.png
> 
> Best Regards,
> 
> Fernando Mancera
> 
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

_______________________________________________
Harbour mailing list
Harbour@harbour-project.org
http://lists.harbour-project.org/mailman/listinfo/harbour

From jacek at achilles.wam.lodz.pl  Fri Apr 27 08:13:22 2007
From: jacek at achilles.wam.lodz.pl (Jacek Kubica)
Date: Fri Apr 27 08:13:31 2007
Subject: [Harbour] changelog 2007-04-27 10:53 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
In-Reply-To: <003001c788aa$c05bad80$3e02a8c0@PORTATIL>
References: <003001c788aa$c05bad80$3e02a8c0@PORTATIL>
Message-ID: <948079607.20070427141322@achilles.wam.lodz.pl>

Hello Fernando,

Friday, April 27, 2007, 11:02:14 AM, you wrote:

FM> 2007-04-27 10:53 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
FM>    + contrib/adordd/adordd.ch
FM>    + contrib/adordd/adordd.prg
FM>    + contrib/adordd/make_b32.bat
FM>    + contrib/adordd/makefile.bc
FM>    + contrib/adordd/access1.prg
FM>    + contrib/adordd/mysql1.prg
FM>      * ADORDD header file, source code, makefiles and samples

FM> I have a test.mdb (Access database) sample (120 Kbs) that is used by
FM> access1.prg sample.
FM> Should I upoload it ? If yes, how to upload a binary file ?

FM> MySql1.prg uses a remote MySQL database located at www.freesql.org 

Thank`s a lot for this contribution!

remarks and question:

in   /contrib/adordd/adordd.prg
     #include "usrrdd.ch"
     should be renamed to
     #include "hbusrrdd.ch"

regarding to changes from CVS
2007-04-23 23:28 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
   - harbour/include/usrrdd.ch
   + harbour/include/hbusrrdd.ch

Second question, which ole lib should be used with your samples
standard harbour hbole or hboleaut (ported from xhb)  ??

Trying to run mysql1 sample I`m getting error:
Error TOleAuto/-1  REGDB_E_CLASSNOTREG: TOLEAUTO:NEW

(Env. Win98SE, BCC)

What I`m doing wrong ??


-- 
Best regards,
 Jacek Kubica


From fmancera at viaopen.com  Fri Apr 27 08:21:41 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Fri Apr 27 08:22:18 2007
Subject: [Harbour] changelog 2007-04-27 10:53 UTC+0100 Fernando
	Mancera(fmancera@viaopen.com)
In-Reply-To: <948079607.20070427141322@achilles.wam.lodz.pl>
References: <003001c788aa$c05bad80$3e02a8c0@PORTATIL>
	<948079607.20070427141322@achilles.wam.lodz.pl>
Message-ID: <005201c788c6$9cedf0d0$3e02a8c0@PORTATIL>

Hi Jacek,


>>Thank`s a lot for this contribution!

>>remarks and question:

>>in   /contrib/adordd/adordd.prg
>>     #include "usrrdd.ch"
>>     should be renamed to
>>     #include "hbusrrdd.ch"

Thank you !

>>Second question, which ole lib should be used with your samples
>>standard harbour hbole or hboleaut (ported from xhb)  ??
>>Trying to run mysql1 sample I`m getting error:
>>Error TOleAuto/-1  REGDB_E_CLASSNOTREG: TOLEAUTO:NEW
>>(Env. Win98SE, BCC)

>>What I`m doing wrong ??

You need to use HBOLEAUT.LIB only. You can build it from Harbour CVS,
Or just download it from here: 


Best Regards,


Fernando Mancera

From fmancera at viaopen.com  Fri Apr 27 08:30:47 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Fri Apr 27 08:31:25 2007
Subject: [Harbour] changelog 2007-04-27 10:53 UTC+0100
	FernandoMancera(fmancera@viaopen.com)
In-Reply-To: <005201c788c6$9cedf0d0$3e02a8c0@PORTATIL>
References: <003001c788aa$c05bad80$3e02a8c0@PORTATIL><948079607.20070427141322@achilles.wam.lodz.pl>
	<005201c788c6$9cedf0d0$3e02a8c0@PORTATIL>
Message-ID: <005401c788c7$e2f2c960$3e02a8c0@PORTATIL>

>> Or just download it from here: 
http://rapidshare.com/files/28166215/adordd.zip.html


Best Regards,


Fernando Mancera

From fmancera at viaopen.com  Fri Apr 27 08:42:42 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Fri Apr 27 08:43:21 2007
Subject: [Harbour] changelog 07-04-27 14:35 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
Message-ID: <005501c788c9$8de026f0$3e02a8c0@PORTATIL>

07-04-27 14:35 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
   * contrib/adordd/adordd.prg
     * Minor change to header file name


Best Regards,


Fernando Mancera

From antonioharbour at gmail.com  Fri Apr 27 08:59:26 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Fri Apr 27 08:59:40 2007
Subject: [Harbour] ADORDD & FWH
In-Reply-To: <005501c788c9$8de026f0$3e02a8c0@PORTATIL>
Message-ID: <4631f3b6.10eb528d.0232.ffffa530@mx.google.com>

Using the ADORDD with FiveWin:

#include "adordd.ch"
#include "FiveWin.ch"

REQUEST ADORDD

function Main()

   USE test00 VIA "ADORDD" TABLE "ACCOUNTS" MYSQL ;
      FROM "www.freesql.org" USER "myuser" PASSWORD "mypass"

   Browse()

   USE

return nil

http://img157.imageshack.us/img157/8922/fwhqk1.png

Regards,

Antonio

From harbour.01 at syenar.hu  Fri Apr 27 09:13:47 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Fri Apr 27 09:13:56 2007
Subject: [Harbour] changelog 2007-04-27 10:53 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
In-Reply-To: <948079607.20070427141322@achilles.wam.lodz.pl>
References: <003001c788aa$c05bad80$3e02a8c0@PORTATIL>
	<948079607.20070427141322@achilles.wam.lodz.pl>
Message-ID: <BA535DC5-8A71-43E2-B79F-A884D98F58C8@syenar.hu>

As far as I could see, it needs the recently added OLE2
lib from Harbour contrib.

I didn't try it though.

Brgds,
Viktor

On 2007.04.27., at 14:13, Jacek Kubica wrote:

> Hello Fernando,
>
> Friday, April 27, 2007, 11:02:14 AM, you wrote:
>
> FM> 2007-04-27 10:53 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
> FM>    + contrib/adordd/adordd.ch
> FM>    + contrib/adordd/adordd.prg
> FM>    + contrib/adordd/make_b32.bat
> FM>    + contrib/adordd/makefile.bc
> FM>    + contrib/adordd/access1.prg
> FM>    + contrib/adordd/mysql1.prg
> FM>      * ADORDD header file, source code, makefiles and samples
>
> FM> I have a test.mdb (Access database) sample (120 Kbs) that is  
> used by
> FM> access1.prg sample.
> FM> Should I upoload it ? If yes, how to upload a binary file ?
>
> FM> MySql1.prg uses a remote MySQL database located at www.freesql.org
>
> Thank`s a lot for this contribution!
>
> remarks and question:
>
> in   /contrib/adordd/adordd.prg
>      #include "usrrdd.ch"
>      should be renamed to
>      #include "hbusrrdd.ch"
>
> regarding to changes from CVS
> 2007-04-23 23:28 UTC+0100 Viktor Szakats (harbour.01 syenar.hu)
>    - harbour/include/usrrdd.ch
>    + harbour/include/hbusrrdd.ch
>
> Second question, which ole lib should be used with your samples
> standard harbour hbole or hboleaut (ported from xhb)  ??
>
> Trying to run mysql1 sample I`m getting error:
> Error TOleAuto/-1  REGDB_E_CLASSNOTREG: TOLEAUTO:NEW
>
> (Env. Win98SE, BCC)
>
> What I`m doing wrong ??
>
>
> -- 
> Best regards,
>  Jacek Kubica
>
>
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour

From antonioharbour at gmail.com  Fri Apr 27 13:37:35 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Fri Apr 27 13:37:50 2007
Subject: [Harbour] Changelog 2007-04-27 19:33 UTC+0100 Antonio Linares
Message-ID: <463234e8.3234d4e0.3fa3.ffffb94b@mx.google.com>

2007-04-27 19:33 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.ch
   * contrib/adordd/adordd.prg
      * QUERY support and MS SQL support (thanks to Vikthor!)

Vikthor already successfully tested the ADORDD on Microsoft SQL server and
added 
a new clause QUERY :-)

Regards,

Antonio

From lorenzo.fiorini at gmail.com  Sat Apr 28 01:43:08 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr 28 01:43:11 2007
Subject: [Harbour] memoline bug with test
Message-ID: <9257026e0704272243q262b873bl3bbb3c158a035568@mail.gmail.com>

Try the code below with Harbour and C53b with both lWrap = .f. and lWrap = .t..
The results are very different.

Any suggestions?

regards,
Lorenzo

#define _CR chr(13)
#define _LF chr(10)
#define _SOFT1 chr( 141 )
#define _CRLF ( _CR + _LF )

procedure main()

   local cString := ""
   local aPos
   local nPos
   local lWrap := .f.

   cString += "first line first line first line first line first line
first line first line" + _SOFT1 + _LF
   cString += "second line second line second line second line second
line second line second line second line"

   ? mlcount( cString, 40,, lWrap )

   ? memoline( cString, 40, 1,, lWrap )
   ? memoline( cString, 40, 2,, lWrap )
   ? memoline( cString, 40, 3,, lWrap )
   ? memoline( cString, 40, 4,, lWrap )
   ? memoline( cString, 40, 5,, lWrap )

   aPos := mpostolc( cString, 5, 10 )

   ? aPos[1], aPos[2]

   nPos := mlctopos( cString, 2, 5 )

   ? nPos

return
From druzus at priv.onet.pl  Sat Apr 28 05:15:14 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat Apr 28 05:15:51 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <46308E71.4050104@marchuet.net>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<46308E71.4050104@marchuet.net>
Message-ID: <20070428091514.GA17193@localhost.localdomain>

On Thu, 26 Apr 2007, Miguel Angel Marchuet wrote:
> Test of speed comparing rdds with bitmap filters and without it:
> 		Harbour	xHarbour xHarbour  Harbour
> 		DBFCDX  DBFCDX   BMDBFCDX  DBFCDX with Bitmap Filters
> LastRec		0.11	0.14	 0.14	   0.14
> OrdKeyCount	0.22	0.19	 0.20	   0.20
> Filter		0.42	0.47	 0.44	   0.44
> LastRec		0.49	0.56	 0.11      0.11
> OrdKeyCount	0.50	0.55	 0.14      0.13
> 
> inheriting from                  DBFCDX    DBFCDX
> LastRec				 0.14	   0.14
> OrdKeyCount			 0.20	   0.20
> Filter				 0.55	   0.52
> LastRec				 0.11      0.11
> OrdKeyCount			 0.13      0.13
> REMEMBER that this test is not concurrent.

Miguel, this test shows that chaching OrdKeyCount() and OrdKeyPos()
I added few years ago is very effiecient. Thank you for confirmation.
Without it the result will be horrible. Clipper 5.3 also has such
caching system but it disables it when bitmap filer is allocated
for workarea to optimize SET FILTER command.
Your test uses expression which is never optimized by CL53 and CL53
_NEVER_ creates bitmap filter for such filter expressions. So your
test can be used only to show the efficiency of OrdKeyCount()/OrdKeyPos()
caching if RDD is Clipper compatible.
I'm attaching cleaned version of your code. Now is real self contain example,
I removed hacks which hide some important things like real costs of
SET FILTER TO ... and changed generated data to be more realistic - if fields
are already well sorted then table does not need index at all so it's not
good data to make any tests. I also added one important modification:
    SET FILTER TO Val( FIELD->One ) % 10 = 0
is replaced by:
    SET FILTER TO RIGHT( FIELD->One, 1 ) = "0"
Both gives exactly the same record set but for the second one CL53 creates
bitmap filter when for the first version it doesn't.
Please compile it by CL53 and compare the results for both version
of the above filter expression.

Finally small exercise: think a while why CL53 disables caching system
for OrdKeyCount()/OrdKeyPos() when bitmap filters are used.

> we and other users are using bitmap filters without any problem

and what does it mean for us?

> inheriting from DBFCDX has low performance creating filter why

It's not true.

> we can't access to some functions of dbfcdx:

You do not have to access anything. It will be good if you will check
what DBFCDX already does and what you have.

> part of code inheriting:
>             SELF_GOTOP( ( AREAP ) pArea );
>             while ( ! pArea->fEof )
>             {
>                 pResult = hb_vmEvalBlock( pArea->dbfi.itmCobExpr );
>                 if ( HB_IS_LOGICAL( pResult ) && hb_itemGetL( pResult ) )
> 		{
>                     BM_SetBit( ( ( LPBM_FILTER ) pArea->dbfi.lpvCargo)->rmap, ulRecCount, (pArea)->ulRecNo );
>                     ulLogKeyCount++;
> 		}
>                 SELF_SKIP( ( AREAP ) pArea, 1 );
>             }
>             pTag->curKeyState &= ~( CDX_CURKEY_RAWPOS | CDX_CURKEY_RAWCNT );
>             CURKEY_SETLOGCNT( pTag, ulLogKeyCount );

Wrong. You will not be able to access pTag.

> without inheriting:
>             if ( FAST_GOCOLD( ( AREAP ) pArea ) == FAILURE )
>                return FAILURE;
> 
>             hb_cdxIndexLockRead( pTag->pIndex );
>             hb_cdxTagRefreshScope( pTag );
>             hb_cdxTagGoTop( pTag );
>             ulLogKeyCount = 0;
>             while ( !pTag->TagEOF )
>             {
>                if( pArea->ulRecNo != pTag->CurKey->rec || pArea->lpdbPendingRel )
>                   SELF_GOTO( (AREAP) pArea, pTag->CurKey->rec );
>                pResult = hb_vmEvalBlock( pArea->dbfi.itmCobExpr );
>                if ( HB_IS_LOGICAL( pResult ) && hb_itemGetL( pResult ) )
>                {
>                   BM_SetBit( ( ( LPBM_FILTER ) pArea->dbfi.lpvCargo)->rmap, ulRecCount, pTag->CurKey->rec );
>                   ulLogKeyCount++;
>                }
>                hb_cdxTagSkipNext( pTag );
>             }
>             hb_cdxIndexUnLockRead( pTag->pIndex );
>             pTag->curKeyState &= ~( CDX_CURKEY_RAWPOS | CDX_CURKEY_RAWCNT );
>             CURKEY_SETLOGCNT( pTag, ulLogKeyCount );

And these is the reason why BMDBFCDX is about 3 times slower on pure
SKIP operation in filtered tables then RMDBFCDX. These are results from
your test and RMDBFCDX hacked to not disable OrdKeyCount()/OrdKeyPos()
caching system when bitmap filters are used (commented one line):

              DBFCDX BMDBFCDX RMDBFCDX
LastRec       0.40   0.41     0.42
OrdKeyCount   0.84   0.90     0.90
Filter        0.28   0.28     0.28
LastRec       0.56   0.29     0.10
OrdKeyCount   0.59   0.33     0.14

But it's not realistic test. Here are much more realistic results
from the test code in attachment (I used xHarbour for all tests to
make the results comparable):

druzus:/tmp/0# ./tst DBFCDX
Linux 2.6.15 i686 xHarbour build 0.99.71 Intl. (SimpLex) => DBFCDX
ORDKEY: FIELD->One , OrdKeyCount:    1000000
No Filter.
RecNo() / LastRec():                   4.17 seconds
OrdKeyNo() / OrdKeyCount():            8.87 seconds
Filter: RIGHT( FIELD->One, 1 )         0.00 seconds
Resulting registers:  100196
RecNo() / LastRec():                   5.27 seconds
OrdKeyNo() / OrdKeyCount():            5.72 seconds

druzus:/tmp/0# ./tst BMDBFCDX
Linux 2.6.15 i686 xHarbour build 0.99.71 Intl. (SimpLex) => BMDBFCDX
ORDKEY: FIELD->One , OrdKeyCount:    1000000
No Filter.
RecNo() / LastRec():                   4.17 seconds
OrdKeyNo() / OrdKeyCount():            8.54 seconds
Filter: RIGHT( FIELD->One, 1 )         2.34 seconds
Resulting registers:  100196
RecNo() / LastRec():                   2.94 seconds
OrdKeyNo() / OrdKeyCount():            3.40 seconds

druzus:/tmp/0# ./tst RMDBFCDX
Linux 2.6.15 i686 xHarbour build 0.99.71 Intl. (SimpLex) => RMDBFCDX
ORDKEY: FIELD->One , OrdKeyCount:    1000000
No Filter.
RecNo() / LastRec():                   4.04 seconds
OrdKeyNo() / OrdKeyCount():            8.86 seconds
Filter: RIGHT( FIELD->One, 1 )         0.00 seconds
Resulting registers:  100196
RecNo() / LastRec():                   0.79 seconds
OrdKeyNo() / OrdKeyCount():            1.28 seconds

> > In 2006-12-11 14:20 UTC+0100 Przemyslaw Czerpak (druzus/at/priv.onet.pl)
> > I enabled some small peace of code which increase the performance
> > of bitmap filters to the level unreachable for current BMDBFCDX for
> > code which uses RDD API. I hoped that you begin to use it and I will
> > not have to return to the problem of using RDD API. So far you haven't
> > even tried.
> Please can you resend me this peace of code to increase the perfomance ?

I can upload basic bitmap filter RDD which will inherit from DBFCDX or
DBFNTX and it will be as in example above about 3 times faster in raw
skipping on strongly filtered tables then BMDBFCDX but only if you agree
to stop hacking CDX internals. I'll be very happy if you invest your time
in real improving DBFCDX code (there are many things which should be
implemented much better/more efficient/cleaner) but if you plan to
continue modifications like in BMDBFCDX and you want to finally replace
current DBFCDX with them then sorry I do not plan to take a part in it.

> The tests realized with clipper 5.3b in DBFCDX and documentation
> about SET OPTIMIZE informs that it uses static Bitmap filters or similar.
> For this reason I think actual DBFCDX needs Bitmap Filters to be
> fully compatible with clipper, SPEED and funcionality.

I can only say that you have no idea how CL53 works, see what I wrote
above. In your test CL53 does not use any bitmap filters.

> > If you can implement it well (not like in BMDBFCDX) then yes.
> > Please do it and then we can add it to core code. Meanwhile I suggest
> > to use contrib directory.
> > If you want to create single RDD with mixed code then you can also
> > do it. Probably you can reach in optimistic situations some few
> > percent but IMHO it's very bad idea. If you want to make some real
> > speed improvement then redesign DBFCDX internals and create sth
> > similar to current DBFNTX. It uses much more efficient internal
> > structures then DBFCDX and implement most of DBOI_* actions which
> > allow to port all SX_* functions from SIX3 to xHarbour. They have
> > to be added to DBFCDX too.
> Not only optimistic, I test it, I can upload immediately.

You are wrong and I can present real examples why. I hope that
it will begin to cause some effects and you will stop doing what
you think is the best even if the facts are differ :-(

> About DBFNTX I need to study it and test.

No. You do not need _ANY_ knowledge about CDX, NTX or future NSX
internals. You only have to cleanly divide code and use RDD API
functions. These is one of the reasons I'm asking about separating
bitmap filters from index management code. Any hacks will be forbidden
by API and it will also force solutions which can work also with other
RDDs.

> >> the actual BMDBFCDX has new corrections , too in DBFCDX of actual xharbour
> > Which ones?
> about custom index with for clause. is one.

2007-03-30 09:26 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * source/rdd/dbfcdx/dbfcdx.c
    * modified to admit DBOI_KEYDELETE and DBOI_KEYADD ignoring the FOR clause,
      that does not have meaning in customer index in order to add or del KEYS.

You removed two lines from if() statement in this modification
but I do not know why you committed it because the above is not true.
CL53 DBFCDX respects FOR clause in custom indexes. Maybe you found
some special case or were confused by return value from ordKeyAdd()/
ordKeyDel() - in practice they are always returning .T. even if they
are not adding/deleting keys. I do not know but for sure this modification
has to be reverted and this small test shows why:

    #include "dbinfo.ch"
    #include "ord.ch"
    proc main()
    field F1, F2
    request DBFCDX
    rddSetDefault("DBFCDX")
    dbcreate("_tst",{{"F1","C",1,0},{"F2","L",1,0}},,.t.)
    dbappend(); F1:="A"; F2:=.t.
    dbappend(); F1:="B"; F2:=.f.
    close
    use _tst
    index on F1 to _tstx for F2 custom
    ? ordKey(), ordFor(), ordKeyCount()
    dbgoto(1)
    ? ordKeyAdd(), ordKeyCount(), recNo(), lastRec()
    dbgoto(2)
    ? ordKeyAdd(), ordKeyCount(), recNo(), lastRec()
    dbappend(); F1:="C"; F2:=.t.
    ? ordKeyAdd(), ordKeyCount(), recNo(), lastRec()
    dbappend(); F1:="D"; F2:=.f.
    ? ordKeyAdd(), ordKeyCount(), recNo(), lastRec()
    ? ordKeyCount()
    ? "."
    return

If you have some other examples or you can explain why you committed it
then we can talk about it and find what is the real problem.

Looking at the CVS history I've found yet two modifications in core CDX
code you made:

2006-11-14 10:42 UTC+0100 Miguel Angel Marchuet <miguelangel/at/marchuet.net>
  * include/fileio.ch
  * source\rdd\bmdbfcdx\bmdbfcdx.c
  * source\rdd\dbfcdx\dbfcdx.c
  * source\rtl\filesys.c
    + Added flag FC_TEMPORARY to give to support to the creation of real
      temporary files under platform Windows. That whenever possible the
      system will maintain them in buffer. Other platforms are not proven.

      FILE_ATTRIBUTE_TEMPORARY:

      A file is being used for temporary storage. File systems avoid writing data
      back to mass storage if sufficient cache memory is available, because an
      application deletes a temporary file after a handle is closed. In that case, the system
      can entirely avoid writing the data. Otherwise, the data is written after the handle is closed.

Not ported to Harbour because it's MS-Windows only extension though
maybe It will be added in the future. The whole modification was adding
FC_TEMPORARY to hb_fsCreateTemp() parameters.

and:
2006-11-02 12:19 UTC+0100 Miguel Angel Marchuet <miguelangel@marchuet.net>
   *source/rdd/bmdbfcdx/bmdbfcdx1.c
   *source/rdd/dbfcdx/dbfcdx1.c
    ! Corrected OrdKeyGoto( nKeyNo ) on a DBF without index and with filter,
      it was positioned in nKeyNo + 1, when it had to do it in nKeyNo.

Many thanks for the fix but the whole modification was changing:
    retval = SELF_SKIP( ( AREAP ) pArea, ulKeyCnt );
to
    retval = SELF_SKIP( ( AREAP ) pArea, ulKeyCnt - 1 );

For me all of the above is not enough reason to make a copy of whole
DBFCDX code inside BMDBFCDX.

> >> I prefer to port to Harbour in DBFCDX rdd, we don't need a BM rdd.
> > So make a copy of current DBFCDX and change it just like BMDBFCDX in
> > xHarbour but keep it in contrib directory.
> I dont't have any problem to upload new DBFCDX rdd as a contrib.
> But really will be
> a DBFCDX to finish compatibility with clipper.

First, not Clipper but DBFCDX from CL53 only. You used to talk about
Clipper compatibility when in fact you are talking about COMIX CDX
implementation and many Clipper users will not agree with you because
they were using CL52 or SuccessWare RDDs.
Second, If you invest some time to check what CL53 DBFCDX exactly
does then maybe you can create sth compatible but now I do not see
any chance for such results.
It's not the first time that you are creating theory to your
imagination about some things without making real tests. You are
finding some special case or simply make a mistake but instead
of checking details of the problem you are committing sth or sending
messages with some false informations which can only confuse users.
F.e. to make this tests I download current xHarbour version from CVS.
Some recent modifications broke GCC builds so I had to check what
has been changed to fix the problem. I checked ChangeLog and recent
messages on xHarbour devel and I've found your message that there is
very big problem with new PP because it cannot longer preprocess code
like:
    x := 0x1234567L
you have such code and it's very serious compatibility problem for you
and we shouldn't make such modifications. Funny. You haven't even try
to invest 1 minute for tests in which you had to find that it was bug
in old PP which was not generating error when after hex number were
some other text, f.e.:
    x := 0x1234567_here_we_can_put_any_stupid_text_
In your case _here_we_can_put_any_stupid_text_ was L.

So far I was ignoring your messages because it's not a pleasure for
me to create answers like these one. It's also waste of time I could
spend on some more productive things and I do not want to kill your
motivation at startup but I will not agree for hacking core code
because someone does not understand sth.

> >> Other extensions BM_*, I think can be changed and implemented at DBF an
> >> future DB level.
> > which extensions? Please define the functionality in precise way so
> > we can talk about it and think about some common to different RDDs
> > implementation.
> ArrayFromFilter
> SetFilterFromArray
> AddArrayToFilter
> DelArrayFromFilter
> which are nedded too for rushmore implementation.

Non of the above functions is necessary to create RushMore filters.
The RM implementation can be extended with such functions but for sure
they are not needed and they cannot be base of any serious implementation
due to insufficient performance and memory consumption of .prg level arrays.
I still do not see any reason to keep them hard coded inside DBFCDX.
They can be implemented in external RM library and please do not talk
me about the performance. I cannot imagine anything slower in our CVS
then current implementation of BM_DBGETFILTERARRAY() or BM_DBSEEKWILD()
with 5-th parameter set to true. The cost which is square to number of
records will kill everything. So far we haven't produced computers which
can finished these operations during our life for really big tables.
With some small modifications the cost of both functions can be made
linear to number of records.

> >> I'm developing DBPX, at the moment I have finised DB and working on PX.
> >> All this and more can be ported to harbour.
> At the moment, I have one problem because index of paradox has more than one
> extension .px ant others :(

In Clipper's RDD such situation also exists. DBFCDX in CL52 and SIXCDX
can create .idx and .cdx indexes. I do not know paradox but if you give
me some more precise information about index extensions then maybe I can
suggest you some solutions. Now I do not know what is the real problem.

best regards,
Przemek
-------------- next part --------------
#DEFINE TEST_RECORDS 100000  // Change this value to make some tests
PROCEDURE Main(cRdd)
   LOCAL cFile := "tst"
   LOCAL x, y
   REQUEST DBFCDX
#ifdef __HARBOUR__
   REQUEST RMDBFCDX
   IF EMPTY(cRdd)
#ifdef __XHARBOUR__
      REQUEST BMDBFCDX
      cRdd:="BMDBFCDX"
#else
      cRdd:="RMDBFCDX"
#endif
   ENDIF
#else
   #xtranslate SecondsCPU( => Seconds(
   IF EMPTY(cRdd)
      cRdd:="DBFCDX"
   ENDIF
#endif
   RddSetDefault( cRdd )
   SET AUTOPEN ON
   SET OPTIMIZE ON

   ? OS(), VERSION(), "=>", RddSetDefault()
   IF !file( cFile+dbTableExt() ) .or. !file( cFile+OrdBagExt() )
      FErase( cFile+dbTableExt() )
      FErase( cFile+OrdBagExt() )
      dbCreate( cFile, { {"One", "C", 6, 0} } )
      USE ( cFile )
      INDEX ON FIELD->One TAG One TO (cFile) FOR ! Deleted()
      ? "Adding records ..."
      x := SecondsCPU()
      FOR y := 1 TO TEST_RECORDS
         APPEND BLANK
         FIELD->One := Str( y%509, 6 )
      NEXT y
      ? padr( "Added records :" + Str( LastRec(), 7 ),30)
      ?? SecondsCPU() - x, "seconds"
      CLOSE
   ENDIF

   USE (cFile) SHARED
   ORDSETFOCUS(1)
   ? "ORDKEY:", ORDKEY(), ", OrdKeyCount:", OrdKeyCount()
   FOR y := 1 TO 2
      IF y = 1
         ? "No Filter."
      ELSE
         x := SecondsCPU()
         /* CL53 never create bitmap filters for such expression */
         //SET FILTER TO Val( FIELD->One ) % 10 = 0
         /* but it does for expressions like: */
         SET FILTER TO RIGHT( FIELD->One, 1 ) = "0"
         ? padr("Filter: " + dbFilter(),30)
         ?? SecondsCPU() - x, "seconds"
         ? "Resulting registers:", Str( OrdKeyCount(), 7 )
         DbGoBottom()
      ENDIF
      ? padr("RecNo() / LastRec():",30)
      x := SecondsCPU()
      DbGoTop()
      WHILE ! Eof()
         RecNo();LastRec()
         DbSkip()
      END
      ?? SecondsCPU() - x, "seconds"
      ? padr("OrdKeyNo() / OrdKeyCount():",30)
      x := SecondsCPU()
      DbGoTop()
      WHILE ! Eof()
         OrdKeyCount();OrdKeyNo()
         DbSkip()
      END
      ?? SecondsCPU() - x, "seconds"
   NEXT y
   ?
   CLOSE ALL
RETURN
From druzus at priv.onet.pl  Sat Apr 28 06:09:18 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat Apr 28 06:09:55 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <462EA5A5.5050905@dbtopas.lt>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<462EA5A5.5050905@dbtopas.lt>
Message-ID: <20070428100918.GB17193@localhost.localdomain>

On Wed, 25 Apr 2007, Mindaugas Kavaliauskas wrote:
> after I looked to xHarbour's DATETIME implementation, I didn't like that 
> it was implemented under HB_IT_DATE. I don't know why, maybe to save one 
> more bit in HB_TYPE... I see two different data "types" related to 
> date/time variable: absolute and interval. In case of Clipper date type, 
> we have date type for the absolute value, and integer for the interval. 
> Operations could be performed:
> ABS = ABS + INT + INT,
> INT = ABS - ABS,
> but ABS + ABS could not be calculated, I even prefere runtime error for 
> DATE() + DATE() (but Clipper allows do this with unexpected result).

I agree. In summary we should define:
    -INT => INT
    ABS - ABS => INT
    ABS [+-] INT => ABS
    INT [+-] ABS => ABS
    INT [+-] INT => INT
ABS + ABS does not make sense for me too. I could understand such
operation if negation (-ABS) will also be defined so it will be possible
to make code like: ABS+(-ABS) but for dates negation is illegal in Clipper
so do not know why Clipper's VM accepts DATE + DATE.

> In case of datetime type, both absolute value and interval value are 
> complex (consists of date and time parts), so it is not possible to use 
> the same date type for both: datetime absolute value, and datatime 
> interval value. OK, maybe it could be possible if datetime is not 
> complex but scalar, smth like amount of Julian milliseconds, but then it 
> is not compatible with Clipper's date arithmetic.

We need sth to mark the difference between interval and absolute value
or we will not be able to properly implement above operations and forbid
some illegal combinations. The internal representation is less important.
We can make any conversions on the fly as long as we will know what data
we are processing.

> In case of xHarbour datetime implementation, there is no interval type 
> at all.
> {^2004/01/01 01:59} + {^00:01} + {^00:01} is allowed, but these time 
> values has default FoxPro date 1899-12-31 inside, so result is:
> // 02/06/8616 02:00:00.00

I have no idea how FoxPro works and which operations are legal or
illegal in FoxPro. I also do not know if FoxPro compatibility in
internal datetime representation is important for users or not.
If someone can present FP date and daytime types and arithmetic
then I can say sth more.

> After datetime implementation user request about "DateTime substraction 
> possibility" appeared on comp.lang.xharbour. It was left unanswered. The 
> problem is:
> VALTYPE(DATETIME() + {^ 00:10}) == "D", but
> VALTYPE(DATETIME() - {^ 00:10}) == "N" and DATETIME() value 10 minutes 
> ago could not be calculated.

It's wrong but in xHarbour you can find more similar situations, f.e.:
    ? 100-"A"
    ? 100+"A"

> So, this implementation allows to store DATETIME absolute value, but any 
> datetime calculations are meaningless. But, I guess we expect it. So, we 
> need a separate datetime (or timestamp) value, perhaps with VALTYPE()=="T".

We need to define operations and expected results. The implementation and
representation will be effect of this definition and has minor meaning now.
If you start from good place then rest is usually very easy ;-)

> There are some other things I do not like:
> 1) {^ ...} syntax
> 2) iAmPm parameter in C level API

I cannot say how widely the above syntax is used amd if it's important
or not to keep it.

> I do not know, if it's good to store both absolute value and interval 
> value inside the same type of variable. We can, but we need to divide 
> Julian date into absolute/interval ranges or store absolute/interval flag.

Exactly. See above. Without such marker we cannot properly implement
math operations on such types.

> Let's look at the Clipper implementation. DATE()+DATE() trick allows us 
> to see internals :) Today is 2007-04-25.
> ? DATE() + DATE() - DATE()  // 2454216, it is Julian date for today :)

or simpler:
    ? date() - ctod("")

> ? DATE() - 732790           // 0001-01-01
> So the first valid date, 0001-01-01 is 2454216-732790=1721426. The year 
> before year 0001 was 1 B.C., and there was no year 0000, but Clipper 
> allows to use such year:
> ? DATE() - 732791           // 0000-12-31
> ...
> ? DATE() - 733156           // 0000-01-01
> Value for 0000-01-01 is 2454216-733156=1721060. The date before 
> 0000-01-01 is showed as 0000-00-00 and the real Julian date value is 
> ignored, but these values are still different:
> d1 := DATE() - 733157
> d2 := DATE() - 733158
> ? d1                        // 0000-00-00
> ? d2                        // 0000-00-00
> ? d1 - d2                   // 1
> up to the
> ? DATE() - 2454215          // 0000-00-00 Julian date 1
> ? DATE() - 2454216          // "    -  -  " Julian date 0, empty date
> ? DATE() - 2454217  // 1449-02-15, because of underflow to MAX_UINT32, 
> but in this case year is much larger than 1449
> The largest valid yyyy-mm-dd date without overflow is
> ? DATE() + 2919268  // 9999-12-31, Julian date: 5373484
> Larger value DATE() + 2919269 is also displayed "0001-01-01", but it's 
> different from previous:
> d1 := DATE() + 2919269
> d2 := DATE() - 733156
> ? d1                   // 0001-01-01
> ? d2                   // 0001-01-01
> ? d1 - d2              // 3652425, it's exactly 10000 years :)
> So, if we want to use current datetime structure, i.e., Julian date and 
> milliseconds. We can use Julian date:
>    MIN_INT32, ..., -1, 0, 1, ..., 1721059 - for interval,
>    1721060, ..., 5373484 - for absolute date valid Clipper date from 
> 0000-01-01 to 9999-12-31,
>    5373484, ..., MAX_INT32 - undefined, any.
> But largest interval value 1721059 is about 4715 years, so it will not 
> allow to calculate intervals for all valid dates. We need to use 
> different base number for 0000-01-01 date, or we can use highest bit of 
> milliseconds to indicate, if date value is Julian date or numeric date 
> interval.

Many thanks for you analyze - very helpful as usual.
We can create two different types or even use internally current date item
like in xHarbour. What will be better I can say when we agree if some FP
compatibility is important of us or not. Now I can only say about pure
daytime implementation I can create from scratch in my mind but maybe
keeping FP compatibility in some cases is very important. I do not know
and I would like to hear FP users opinion and of course I need information
about FP daytime arithmetic.

best regards,
Przemek
From harbour.01 at syenar.hu  Sat Apr 28 06:35:36 2007
From: harbour.01 at syenar.hu (=?ISO-8859-2?Q?Szak=E1ts_Viktor?=)
Date: Sat Apr 28 06:35:55 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070428100918.GB17193@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<462EA5A5.5050905@dbtopas.lt>
	<20070428100918.GB17193@localhost.localdomain>
Message-ID: <2DE79C33-87B7-4417-95D6-CA58248DBE91@syenar.hu>

>> There are some other things I do not like:
>> 1) {^ ...} syntax
>> 2) iAmPm parameter in C level API
>
> I cannot say how widely the above syntax is used amd if it's important
> or not to keep it.

Instead of using new wierd combinations of special chars, I think
it would be cleaner to use some special function-like enclosures,
like: hb_datetime("....") or hb_date("...") or hb_ts("...") (like  
TimeStamp).
The string content then could be optimized by the compiler to the
internal representation (just like it is now for Chr() for example).
The string can be "free-form" here (I'm not sure if this is a  
requirement
though).

If we want to represent a simple value in a non-freeform way (which
will be the majority of cases in real-life), we should rather use  
constructs
like these:

interval (in secs) = 0s60
[ interval (in minutes) = 0m60 ]
[ interval (in hours) = 0h60 ... etc]
timeofday = 0t1430
timestamp = 0d200704281930 (with maybe an optional
       visual separator between the date and time: 0d20070428_1930)

We will also need conversion from numbers to intervals, like:
hb_i2secs( nInt ) -> interval (in secs)
hb_i2mins( nInt ) -> interval (in minutess)
hb_i2hours( nInt ) -> interval (in hours)

etcetc

As for FoxPro compatibility in this special case, I don't see it as a  
priority,
or something to overly influence our design decisions, since we never  
had
FoxPro compatibility as a goal in general. If we can achieve some degree
of FoxPro compatibility using PP or an added function layer, it's  
nice to
have it though.

Brgds,
Viktor

From druzus at priv.onet.pl  Sat Apr 28 08:51:31 2007
From: druzus at priv.onet.pl (Przemyslaw Czerpak)
Date: Sat Apr 28 08:52:07 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070428100918.GB17193@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>
	<20070424154331.GB656@localhost.localdomain>
	<004501c786b1$50e22600$d801a8c0@ingachka>
	<20070424221200.GA3517@localhost.localdomain>
	<462EA5A5.5050905@dbtopas.lt>
	<20070428100918.GB17193@localhost.localdomain>
Message-ID: <20070428125131.GA24073@localhost.localdomain>

On Sat, 28 Apr 2007, Przemyslaw Czerpak wrote:
> I agree. In summary we should define:
>     -INT => INT
>     ABS - ABS => INT
>     ABS [+-] INT => ABS
>     INT [+-] ABS => ABS
>     INT [+-] INT => INT
[...]
> > VALTYPE(DATETIME() + {^ 00:10}) == "D", but
> > VALTYPE(DATETIME() - {^ 00:10}) == "N" and DATETIME() value 10 minutes 
> > ago could not be calculated.
> It's wrong but in xHarbour you can find more similar situations, f.e.:
>     ? 100-"A"
>     ? 100+"A"

I've just made some test with xHarbour and the idea if representing
the time interval (INT) as numeric value where integer part is number of
days from Julian's day and fractional part is time in this day seems to
be reasonable for me. But it means that {^ 00:10} should be translate to
such numeric value not to date what causes that used syntax can confuse
users. The base for such numeric value should be Julian's day not
12/30/1899 00:00:00.00 like in FP. I'm not a Windows users but it's
possible that these starting date will be also used by some MS-Windows
components so maybe we will have to add some functions to translate
our time interval to MS-Windows ones.
Without separated daytime item type we will have problem in forbiding
DATETIME()+DATETIME() operation (of course if we want to keep Clipper
compatible behavior in DATE()+DATE())
IMHO Victor's idea to start with some functions (without date constants)
will be good choice. Finally we can add support for some constants.
For RDD IMHO it's time to drop using HB_IT_* values as field type markers.
In the real world we will always have more types in different databases
then our HVM can support so as long as we will use HB_IT_* values we will
have problems. Few years ago I sent to xharbour-devel message with
proposition of some modifications in RDD. In general I wanted to introduce
field flags HB_FF_* to field description. But maybe it will be even better
to replace HB_IT_* values by HB_FT_* (field type) ones. I'm attaching part
of this message below. Please think about it. So far I have no time to
realize it but sooner or later we will have to resolve this problem and
it will be better if we will make it ourself then we will have to inherit
sth like in ADS now from other RDDs.

best regards,
Przemek

ps. I'll be out of city in next days so probably I will not be able
    to answer for any question for a week but when I'll be back or
    find inet access I'll try.


==========================================================================
I would like to clean the supported database types to make them common
for all RDDs if possible. Now we have the following database types:

   HB_IT_LOGICAL        "L"         {1,0}
   HB_IT_LONG           "N"         {n1,n2}
   HB_IT_DATE           "D"         {3,0}, {4,0}, {8,0}
   HB_IT_STRING         "C"         {n,0) (real: {n%256,n/256})
   HB_IT_MEMO           "M"         {4,0}, {10,0}
   HB_IT_INTEGER        "I"         {n1<=8,n2} (binary little endian / 10^n2)
                                               (n2 is not present yet in DBF)
   HB_FT_DOUBLE         "B"         {8,n} (binary IEEE754 little endian double)
and some of their synonyms used by some xBase compatible languages.

As I can see in ADS RDD some other types where added by exteneding the field
type to:
      C  "RAW"                
      M  "VARCHAR"            
      M  "BINARY"             
      M  "IMAGE"              
      D  "SHORTDATE"          
      N  "INTEGER"            
      N  "SHORTINT"           
      N  "DOUBLE"             
      N  "TIME"               
      N  "TIMESTAMP"          
      N  "AUTOINC"            
      N  "CURDOUBLE"          
As you can see some of these types are redundant and can be well covered by
existing formats. For some others are we will need new types. I want to
define them, document and add to work area. Even with the cost of changing
existing code. So far we were adding new types separately to different RDDs
without common agreement and we will not be able to make common interface
without breaking backward compatibility. Now it's the last moment to clean
it or we can forget about COPY TO / APPEND FROM between RDDs using extended
types.
So I want define now list of all supported FIELD types which will cover
existing types in all RDDs. I do not want to use multi character types
like in ADS. This is nice solution as long as we do not introduce field
flags (which are also missing so far but I'll plan to add them soon).
In such case we will have very long field description like:
   "MEMVAR_COMPRESSED_HIDDEN_ENCRYPTED_BINARY"
which are hard to use and parse in RDDs.
I strongly prefer to make it like in FlagShip where the first latter is
field type and next flags, f.e.: "MCHEB"
Unfortunately different xBase languages uses their own letters to sign
extended types. We have to define our own choosing some base and RDDs
internally will make some translations if necessary. We can chose as base:
dBase, FVP, FlagShip, SIX3 (ADS internally uses SIX3 types as I can see,
DBF, MEMO files, CDX seems to be exactly the same as in SIX3, looking at
google I've found that older version were "bug compatible" with SIX3 so
I guess SIX3 and ADS had some common sources in the past) or some other
which you'll propose.
So you may not like me ;-) but I will try to force modification in ADS
which will eliminate theses long name types (it could be done in longer
time and we can leave some code for backward compatibility in CREATEFIELDS()
method. I also decided to clean and change the types I already add to DBF
depending on the convention we chose for field type names so no one will
be forced.
Looking at different xBase language documentation I've found the
following types (dBase naming convention):

   HB_IT_LOGICAL        "L"         {1,0}
   HB_IT_LONG           "N"         {n1,n2}
   HB_IT_DATE           "D"         {3,0}, {4,0}, {8,0}
   HB_IT_STRING         "C"         {n,0) (real: {n%256,n/256})
   HB_IT_MEMO           "M"         {4,0}, {10,0}
   HB_IT_INTEGER        "I"         {n1<=8,n2} (binary little endian / 10^n2)
   HB_IT_DOUBLE         "O"         {8,n} (binary IEEE754 little endian double)
   HB_IT_ANY            "V"         {n>=6,0} (weekly-typed field) (SIX3/ADS)

   /* They will be mapped to TIME[STAMP] ITEM when we will have it. Walter? */
   HB_IT_TIMESTAMP      "@"         {8,0} (2*4bytes: julian's day and millisec.)
   HB_IT_TIME[STAMP]    "T"         {4,0} binary little endian in milliseconds

and this flags which may change the how fields above works:
   flag                  field types
   HB_FF_NULLABLE        any
   HB_FF_COMPRESSED      "C", "M", "V"
   HB_FF_ENCRYPTED       "C", "M", "V"
   HB_FF_BINARY          "C", "M", "V"
   HB_FF_IMAGE           "M", "V"
   HB_FF_VARIABLE        "C", "M", "N", (for "N" means "F", for "M" means "V")
   HB_FF_AUTOINCREMENT   {"I",1-4,0}
   HB_FF_HIDDEN          any (also called system column)

And now some synonyms used in different DBF implementations:
   "1"       ->   {"I", 1, 0}
   "2"       ->   {"I", 2, 0} (in FlagShip)
   ...
   "7"       ->   {"I", 7, 0}
   "8"       ->   {"I", 8, 0}

   "8"       ->   "O"         (in FlagShip)

   "B"       ->   "O"         (in VFP)
   "F"       ->   "N" & HB_FF_VARIABLE    ("N" with variable decimal point position)
   "Y"       ->   {"I", 8, 4}             (Currency) and should be rounded to 4 decimal places (VFP cut not round the value)
   "+"       ->   {"I", 4, 0} & HB_FF_AUTOINCEMENT
   "G"       ->   "M" & HB_FF_BINARY      (OLE object in Windows DBASE version)
   "B"       ->   "M" & HB_FF_BINARY      (in DBASE-V)
   "P"       ->   "M" & HB_FF_IMAGE       (picture)
   {"V",3,0} ->   {"D",3,0}   (in SIX3 packed date)
   {"V",2,0} ->   {"I",2,0}   (in SIX3)
   {"V",4,0} ->   {"I",4,0}   (in SIX3)

As you can see the same letters are used for different types by different
languages (I haven't presented many of other types but in practice they
are combination of the above and some flags - nothing what gives additional
functionality)

Now the representation of ADS field types in this convention:

      C  "RAW"                "C" + HB_FF_BINARY,
      M  "VARCHAR"            "V"  or  "M" + HB_FF_VARIABLE,
      M  "BINARY"             "M" + HB_FF_BINARY,
      M  "IMAGE"              "P"  or  "M" + HB_FF_IMAGE,
      D  "SHORTDATE"          "D", 3, 0
      N  "INTEGER"            "I", 4, 0
      N  "SHORTINT"           "I", 2, 0
      N  "DOUBLE"             "O", 8, n
      N  "TIME"               "T", 4, 0
      N  "TIMESTAMP"          "@", 8, 0
      N  "AUTOINC"            "+" or "I" + HB_FF_AUTOINCREMENT
      N  "CURDOUBLE"          "Y" or {"I", 8, 4} + CURRENCY flag

The biggest problem I can see is "B" type which have differ meaning
in different languages.
"B" is double in VFP (and in xHarbour where I accepted VFP users
proposition without rethinking it) and binary memo object in dBase.
In above I used intentionally "O" to eliminate confusion.
What we will finally use will depend on our decision.
I would like to hear your opinion and create a list of supported field
types for all RDDs.
==========================================================================
From i at kevincarmody.com  Sat Apr 28 09:10:57 2007
From: i at kevincarmody.com (Kevin Carmody)
Date: Sat Apr 28 09:09:26 2007
Subject: [Harbour] memoline bug with test
In-Reply-To: <9257026e0704272243q262b873bl3bbb3c158a035568@mail.gmail.com>
References: <9257026e0704272243q262b873bl3bbb3c158a035568@mail.gmail.com>
Message-ID: <463347E1.2030902@kevincarmody.com>

Lorenzo,

There is a bug in the Harbour version of MLCTOPOS.  I reported this in 
January but so far no one has stepped forward to fix it.  Memo functions 
are normally used only in console mode programs, and I think there is 
decreasing interest in fixing problems that affect only console mode.  
For the bug report, please see 
https://sourceforge.net/tracker/index.php?func=detail&aid=1635288&group_id=681&atid=100681.

Kevin


Lorenzo Fiorini wrote:
> Try the code below with Harbour and C53b with both lWrap = .f. and 
> lWrap = .t..
> The results are very different.
>
> Any suggestions?
>
> regards,
> Lorenzo
>
> #define _CR chr(13)
> #define _LF chr(10)
> #define _SOFT1 chr( 141 )
> #define _CRLF ( _CR + _LF )
>
> procedure main()
>
>   local cString := ""
>   local aPos
>   local nPos
>   local lWrap := .f.
>
>   cString += "first line first line first line first line first line
> first line first line" + _SOFT1 + _LF
>   cString += "second line second line second line second line second
> line second line second line second line"
>
>   ? mlcount( cString, 40,, lWrap )
>
>   ? memoline( cString, 40, 1,, lWrap )
>   ? memoline( cString, 40, 2,, lWrap )
>   ? memoline( cString, 40, 3,, lWrap )
>   ? memoline( cString, 40, 4,, lWrap )
>   ? memoline( cString, 40, 5,, lWrap )
>
>   aPos := mpostolc( cString, 5, 10 )
>
>   ? aPos[1], aPos[2]
>
>   nPos := mlctopos( cString, 2, 5 )
>
>   ? nPos
>
> return
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070428/76c5d150/attachment.html
From lorenzo.fiorini at gmail.com  Sat Apr 28 10:54:18 2007
From: lorenzo.fiorini at gmail.com (Lorenzo Fiorini)
Date: Sat Apr 28 10:54:21 2007
Subject: [Harbour] memoline bug with test
In-Reply-To: <463347E1.2030902@kevincarmody.com>
References: <9257026e0704272243q262b873bl3bbb3c158a035568@mail.gmail.com>
	<463347E1.2030902@kevincarmody.com>
Message-ID: <9257026e0704280754y3f4d5c33vfb9ce803da3db621@mail.gmail.com>

On 4/28/07, Kevin Carmody <i@kevincarmody.com> wrote:

>  There is a bug in the Harbour version of MLCTOPOS.  I reported this in
> January but so far no one has stepped forward to fix it.  Memo functions are
> normally used only in console mode programs, and I think there is decreasing
> interest in fixing problems that affect only console mode.  For the bug
> report, please see

Thanks Kevin, the bug is also shown in my test.

While mlctopos is an "exotic" function ( is it broken in xHarbour also
) memoline and mlcount  are the only functions I know to get data from
memos.

regards,
Lorenzo
From i at kevincarmody.com  Sat Apr 28 11:39:00 2007
From: i at kevincarmody.com (Kevin Carmody)
Date: Sat Apr 28 11:37:30 2007
Subject: [Harbour] memoline bug with test
In-Reply-To: <9257026e0704280754y3f4d5c33vfb9ce803da3db621@mail.gmail.com>
References: <9257026e0704272243q262b873bl3bbb3c158a035568@mail.gmail.com>	<463347E1.2030902@kevincarmody.com>
	<9257026e0704280754y3f4d5c33vfb9ce803da3db621@mail.gmail.com>
Message-ID: <46336A94.4030505@kevincarmody.com>

Lorenzo Fiorini wrote:
> On 4/28/07, Kevin Carmody <i@kevincarmody.com> wrote:
>
>>  There is a bug in the Harbour version of MLCTOPOS.  I reported this in
>> January but so far no one has stepped forward to fix it.  Memo 
>> functions are
>> normally used only in console mode programs, and I think there is 
>> decreasing
>> interest in fixing problems that affect only console mode.  For the bug
>> report, please see
>
> Thanks Kevin, the bug is also shown in my test.
>
> While mlctopos is an "exotic" function ( is it broken in xHarbour also
> ) memoline and mlcount  are the only functions I know to get data from
> memos. 

I discovered this bug when I tried to port a Clipper program that used 
MLCTOPOS(cString, nWidth, 2, 0, nTab).  If this is your situation, let 
me know and I will post my workaround.

If you need a different form of MLCTOPOS, consider fixing it yourself.  
Harbour depends on contributions from those who are are willing and able 
to contribute.  Download the Harbour source, and look at 
\source\rtl\mlctopos.c.

Kevin

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.harbour-project.org/pipermail/harbour/attachments/20070428/1eff5dd6/attachment-0001.html
From niki at synel.co.il  Sun Apr 29 02:38:35 2007
From: niki at synel.co.il (Chen Kedem)
Date: Sun Apr 29 02:38:55 2007
Subject: [Harbour] Rushmore and bitmap filters.
Message-ID: <46343D6B.6838@synel.co.il>

Przemek,

>> At the moment, I have one problem because index of paradox has
>> more than one extension .px ant others :(

> In Clipper's RDD such situation also exists. DBFCDX in CL52 and
> SIXCDX can create .idx and .cdx indexes. I do not know paradox
> but if you give me some more precise information about index
> extensions then maybe I can suggest you some solutions. Now I do
> not know what is the real problem.

Paradox use the following file extensions:

DB  = Main database file, once open it usually auto-open all the rest.
MB  = Memo file.
VAL = Validity checks and default values.
PX  = Primary index.
XGn = Secondary index - (Maintained, Case sensivive) key is one field
                        "n" is the field number.
YGn = Secondary index - (Maintained, Case sensivive) key is one field
                        "n" is the field number.
Xnn = Secondary index (other index type). "nn" is the index number.
Ynn = Secondary index (other index type). "nn" is the index number.

Apart from the DB all other files are optional
(you must have a primary index before you can have a Secondary index).
Secondary indices are paired X and Y.


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From philb at philb.us  Sun Apr 29 03:05:20 2007
From: philb at philb.us (Phil Barnett)
Date: Sun Apr 29 03:05:23 2007
Subject: [Harbour] Julian date functions
Message-ID: <200704290305.20241.philb@philb.us>


If anyone is thinking of including Julian date functions, they are here:

http://www.the-oasis.net/files/general/julian.zip

I'll change the license if you want me to.

-- 
Phil Barnett
AI4OF
SKCC #600
From antonioharbour at gmail.com  Sun Apr 29 06:46:59 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun Apr 29 06:47:07 2007
Subject: [Harbour] Changelog 2007-04-29 12:42 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <463477a6.54efd8f5.7e01.ffff97e4@mx.google.com>

2007-04-29 12:42 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * SET FILTER TO ... support

   i.e.: SET FILTER TO First = "Homer"
     
   To use special SQL expressions, place commas around them, i.e.:
   SET FILTER TO "City LIKE 'Chi*'"


Regards,

Antonio

From antonioharbour at gmail.com  Sun Apr 29 07:11:37 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun Apr 29 07:11:45 2007
Subject: [Harbour] Quotation marks
Message-ID: <46347d6b.71e46696.533e.5b02@mx.google.com>

 
>
   To use special SQL expressions, place commas around them, i.e.:
   SET FILTER TO "City LIKE 'Chi*'"
>

I meant quotation marks :-)

Regards,

Antonio

From niki at synel.co.il  Sun Apr 29 09:48:19 2007
From: niki at synel.co.il (Chen Kedem)
Date: Sun Apr 29 09:48:42 2007
Subject: [Harbour] SF feature requests#1707855: Option --version for Version
	check
Message-ID: <4634A223.338D@synel.co.il>

http://sourceforge.net/tracker/index.php?func=detail&aid=1707855&group_id=681&atid=350681

Basically ask to add --version switch to harbour. The output should
looks the same as: harbour /q

Note that at the moment Harbour does not have "--" command line
switches. And "/" and "-" are used based on the envirumnent it was
compiled. Should this one added for users use to GNU semantics?


  Chen.
**********************************************************************************************
IMPORTANT: The contents of this email and any attachments are confidential. They are intended for the 
named recipient(s) only.
If you have received this email in error, please notify the system manager or the sender immediately and do 
not disclose the contents to anyone or make copies thereof.
*** eSafe scanned this email for viruses, vandals, and malicious content. ***
**********************************************************************************************

From antonioharbour at gmail.com  Sun Apr 29 11:36:59 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Sun Apr 29 11:37:06 2007
Subject: [Harbour] Changelog 2007-04-29 17:34 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <4634bb9e.2d4cb456.6b85.ffffa494@mx.google.com>

2007-04-29 17:34 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * Oracle support, thanks to Srdjan Dragojlovic
     
   * contrib/adordd/adordd.ch
     * formatting


Regards,

Antonio

From fmancera at viaopen.com  Mon Apr 30 04:19:53 2007
From: fmancera at viaopen.com (Fernando Mancera)
Date: Mon Apr 30 04:20:27 2007
Subject: [Harbour] changelog 2007-04-30 10:15 UTC+0100 Fernando Mancera
	(fmancera@viaopen.com)
Message-ID: <000601c78b00$54d1e090$3e02a8c0@PORTATIL>

2007-04-30 10:15 UTC+0100 Fernando Mancera (fmancera@viaopen.com)
   * contrib/adordd/adordd.prg
     * ADO connection objects and ADO catalog objects are automatically
created, stored and used by the ADORDD

Regards,

Fernando Mancera

From miguelangel at marchuet.net  Mon Apr 30 05:17:32 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Mon Apr 30 05:17:25 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <2DE79C33-87B7-4417-95D6-CA58248DBE91@syenar.hu>
References: <462E1564.9030204@marchuet.net>	<20070424154331.GB656@localhost.localdomain>	<004501c786b1$50e22600$d801a8c0@ingachka>	<20070424221200.GA3517@localhost.localdomain>	<462EA5A5.5050905@dbtopas.lt>	<20070428100918.GB17193@localhost.localdomain>
	<2DE79C33-87B7-4417-95D6-CA58248DBE91@syenar.hu>
Message-ID: <4635B42C.6010206@marchuet.net>

And what about

DBF compatibility

FieldType @ for Timestamp
format : 8 bytes (two longs)  	 First long repecents date and second long time. Date is the number of days since January 1st,
4713 BC. Time is hours * 3600000L + minutes * 60000L + seconds * 1000L.

Best regards,
Miguel Angel Marchuet


Szak?ts Viktor escribi?:
>>> There are some other things I do not like:
>>> 1) {^ ...} syntax
>>> 2) iAmPm parameter in C level API
>>
>> I cannot say how widely the above syntax is used amd if it's important
>> or not to keep it.
> 
> Instead of using new wierd combinations of special chars, I think
> it would be cleaner to use some special function-like enclosures,
> like: hb_datetime("....") or hb_date("...") or hb_ts("...") (like
> TimeStamp).
> The string content then could be optimized by the compiler to the
> internal representation (just like it is now for Chr() for example).
> The string can be "free-form" here (I'm not sure if this is a requirement
> though).
> 
> If we want to represent a simple value in a non-freeform way (which
> will be the majority of cases in real-life), we should rather use
> constructs
> like these:
> 
> interval (in secs) = 0s60
> [ interval (in minutes) = 0m60 ]
> [ interval (in hours) = 0h60 ... etc]
> timeofday = 0t1430
> timestamp = 0d200704281930 (with maybe an optional
>       visual separator between the date and time: 0d20070428_1930)
> 
> We will also need conversion from numbers to intervals, like:
> hb_i2secs( nInt ) -> interval (in secs)
> hb_i2mins( nInt ) -> interval (in minutess)
> hb_i2hours( nInt ) -> interval (in hours)
> 
> etcetc
> 
> As for FoxPro compatibility in this special case, I don't see it as a
> priority,
> or something to overly influence our design decisions, since we never had
> FoxPro compatibility as a goal in general. If we can achieve some degree
> of FoxPro compatibility using PP or an added function layer, it's nice to
> have it though.
> 
> Brgds,
> Viktor
> 
> _______________________________________________
> Harbour mailing list
> Harbour@harbour-project.org
> http://lists.harbour-project.org/mailman/listinfo/harbour
> 

From miguelangel at marchuet.net  Mon Apr 30 07:48:13 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Mon Apr 30 07:48:07 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070428091514.GA17193@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>	<20070424154331.GB656@localhost.localdomain>	<004501c786b1$50e22600$d801a8c0@ingachka>	<20070424221200.GA3517@localhost.localdomain>	<46308E71.4050104@marchuet.net>
	<20070428091514.GA17193@localhost.localdomain>
Message-ID: <4635D77D.7080505@marchuet.net>

> > The tests realized with clipper 5.3b in DBFCDX and documentation
> > about SET OPTIMIZE informs that it uses static Bitmap filters or similar.
> > For this reason I think actual DBFCDX needs Bitmap Filters to be
> > fully compatible with clipper, SPEED and funcionality.

>I can only say that you have no idea how CL53 works, see what I wrote
>above. In your test CL53 does not use any bitmap filters.


Paste of the clipper 5.3b documentation :

==============================================================================
 SET OPTIMIZE
 Change the setting that determines whether to optimize using the open orders
 when processing a filtered database file
------------------------------------------------------------------------------
 Syntax

     SET OPTIMIZE ON | OFF | (<lToggle>)

 Arguments

     ON enables optimization.

     OFF disables optimization.

     <lToggle> is a logical expression that must be enclosed in
     parentheses.  A value of true (.T.) is the same as ON, and a value of
     false (.F.) is the same as OFF.

     Note:  The initial default of this setting depends on the RDD.

 Description

     For RDDs that support optimization, such as DBFCDX, SET OPTIMIZE
     determines whether to optimize filters based on the orders open in the
     current work area.  If this flag is ON, the RDD will optimize the search
     for records that meet the filter condition to the fullest extent
     possible, minimizing the need to read the actual data from the database
     file.

     If this flag is OFF, the RDD will not optimize.

 Examples

     ?  The following example enables optimization for the Inventor
        database file using the SET OPTIMIZE command:

        USE Inventor NEW VIA "DBFCDX"
        SET OPTIMIZE ON

 Files   Library is CLIPPER.LIB.

==============================================================================

This command that we test that affects FILTERS creating static bitmap filters, (I'm
not speaking about RUSHMORE). If 2 users reads the same table and one has OPTIMIZE ON
the records added by the other user has no effect in the filter. THIS IS A FACT.

The bitmap filters that i implement (not rushmore yet is uploaded) works as Clipper 5.3.

the functions affected are:

 *    hb_cdxAppend
 *    hb_cdxCheckRecordFilter	
 *    hb_cdxClearFilter
 *    hb_cdxDeleteRec
 *    hb_cdxPutRec
 *    hb_cdxRecall
 *    hb_cdxSetFilter
 *    hb_cdxSkipFilter

Creating BITMAP FILTERS
this code is 20 % more slow (inheriting):

             SELF_GOTOP( ( AREAP ) pArea );
             while ( ! pArea->fEof )
             {
                 pResult = hb_vmEvalBlock( pArea->dbfi.itmCobExpr );
                 if ( HB_IS_LOGICAL( pResult ) && hb_itemGetL( pResult ) )
 		{
                     BM_SetBit( ( ( LPBM_FILTER ) pArea->dbfi.lpvCargo)->rmap, ulRecCount, (pArea)->ulRecNo );
                     ulLogKeyCount++;
 		}
                 SELF_SKIP( ( AREAP ) pArea, 1 );
             }

than (without inheriting):

             if ( FAST_GOCOLD( ( AREAP ) pArea ) == FAILURE )
                return FAILURE;

             hb_cdxIndexLockRead( pTag->pIndex );
             hb_cdxTagRefreshScope( pTag );
             hb_cdxTagGoTop( pTag );
             ulLogKeyCount = 0;
             while ( !pTag->TagEOF )
             {
                if( pArea->ulRecNo != pTag->CurKey->rec || pArea->lpdbPendingRel )
                   SELF_GOTO( (AREAP) pArea, pTag->CurKey->rec );
                pResult = hb_vmEvalBlock( pArea->dbfi.itmCobExpr );
                if ( HB_IS_LOGICAL( pResult ) && hb_itemGetL( pResult ) )
                {
                   BM_SetBit( ( ( LPBM_FILTER ) pArea->dbfi.lpvCargo)->rmap, ulRecCount, pTag->CurKey->rec );
                   ulLogKeyCount++;
                }
                hb_cdxTagSkipNext( pTag );
             }
             hb_cdxIndexUnLockRead( pTag->pIndex );
             pTag->curKeyState &= ~( CDX_CURKEY_RAWPOS | CDX_CURKEY_RAWCNT );
             CURKEY_SETLOGCNT( pTag, ulLogKeyCount );

> I can upload basic bitmap filter RDD which will inherit from DBFCDX or
> DBFNTX and it will be as in example above about 3 times faster in raw
> skipping on strongly filtered tables then BMDBFCDX but only if you agree
> to stop hacking CDX internals. I'll be very happy if you invest your time
> in real improving DBFCDX code (there are many things which should be
> implemented much better/more efficient/cleaner) but if you plan to
> continue modifications like in BMDBFCDX and you want to finally replace
> current DBFCDX with them then sorry I do not plan to take a part in it.
	
I would be thankful to you very many who you upload it, therefore I would
continue working from in the RUSHMORE implementation.

But developers are not interested in DBFCDX with clipper 5.3 implementation
of SET OPTIMIZE. I don't upload it. I upload it as separated contrib.

But please, you do not say to me that I do not have nor idea of clipper 5.3.
if I have bothered to you, pardons.


Best regards,
Miguel Angel Marchuet
From miguelangel at marchuet.net  Mon Apr 30 12:09:11 2007
From: miguelangel at marchuet.net (Miguel Angel Marchuet)
Date: Mon Apr 30 12:09:04 2007
Subject: [Harbour] Rushmore and bitmap filters.
In-Reply-To: <20070428091514.GA17193@localhost.localdomain>
References: <462E1564.9030204@marchuet.net>	<20070424154331.GB656@localhost.localdomain>	<004501c786b1$50e22600$d801a8c0@ingachka>	<20070424221200.GA3517@localhost.localdomain>	<46308E71.4050104@marchuet.net>
	<20070428091514.GA17193@localhost.localdomain>
Message-ID: <463614A7.6000209@marchuet.net>

With this code

   x := Seconds()
   FOR y := 1 TO 100000
      APPEND BLANK
      FIELD->One := '90000'
   NEXT y
   @ n++,0 SAY "Added records : " + Str( LastRec(), 7 )
   @ n++,0 SAY "Seconds : " + Str( Seconds() - x, 5, 2 )

clipper 5.3b (Rev.338) (1997-04-25) 	 7.58 s
harbour	devel build 1.1-1 Intl.	   	10.11 s
xharbour build 0.99.71 Intl. (Simplex)	10.22 s

with this code

   x := Seconds()
   FOR y := 1 TO 100000
      APPEND BLANK
      FIELD->One := Str( y%509, 6 )
   NEXT y
   @ n++,0 SAY "Added records : " + Str( LastRec(), 7 )
   @ n++,0 SAY "Seconds : " + Str( Seconds() - x, 5, 2 )

clipper 5.3b (Rev.338) (1997-04-25) 	 8.40 s
harbour	devel build 1.1-1 Intl.	   	13.55 s
xharbour build 0.99.71 Intl. (Simplex)	13.92 s



Any idea how to increase speed ... ?


Best regards,
Miguel Angel Marchuet
From antonioharbour at gmail.com  Mon Apr 30 15:00:25 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 30 15:00:42 2007
Subject: [Harbour] Changelog 2007-04-30 20:58 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <46363ccc.3286c2eb.0593.62b0@mx.google.com>

2007-04-30 20:58 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * ZAP implemented. GO TOP fixed for empty tables

Regards,

Antonio

From antonioharbour at gmail.com  Mon Apr 30 15:51:57 2007
From: antonioharbour at gmail.com (Antonio Linares)
Date: Mon Apr 30 15:52:06 2007
Subject: [Harbour] Changelog 2007-04-30 21:58 UTC+0100 Antonio Linares
	(alinares@fivetechsoft.com)
Message-ID: <463648e0.41d7514f.7b94.6c12@mx.google.com>

2007-04-30 21:58 UTC+0100 Antonio Linares (alinares@fivetechsoft.com)
   * contrib/adordd/adordd.prg
     * IndexKey( n ) support

Regards,

Antonio

